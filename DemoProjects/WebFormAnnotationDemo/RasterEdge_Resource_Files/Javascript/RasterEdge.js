var isIE=(document.all)?true:false;var div_$=function(A){return"string"==typeof A?document.getElementById(A):A};var Class={create:function(){return function(){this.initialize.apply(this,arguments)}}};var Extend=function(A,B){for(var C in B){A[C]=B[C]}};var Bind=function(B,A){return function(){return A.apply(B,arguments)}};var BindAsEventListener=function(B,A){var C=Array.prototype.slice.call(arguments).slice(2);return function(D){return A.apply(B,[D||window.event].concat(C))}};var CurrentStyle=function(A){return A.currentStyle||document.defaultView.getComputedStyle(A,null)};function addEventHandler(B,C,A){if(B.addEventListener){B.addEventListener(C,A,false)}else{if(B.attachEvent){B.attachEvent("on"+C,A)}else{B["on"+C]=A}}}function removeEventHandler(B,C,A){if(B.removeEventListener){B.removeEventListener(C,A,false)}else{if(B.detachEvent){B.detachEvent("on"+C,A)}else{B["on"+C]=null}}}var Resize=Class.create();Resize.prototype={initialize:function(A,B){this._obj=div_$(A);this._styleWidth=this._styleHeight=this._styleLeft=this._styleTop=0;this._sideRight=this._sideDown=this._sideLeft=this._sideUp=0;this._fixLeft=this._fixTop=0;this._scaleLeft=this._scaleTop=0;this._mxSet=function(){};this._mxRightWidth=this._mxDownHeight=this._mxUpHeight=this._mxLeftWidth=0;this._mxScaleWidth=this._mxScaleHeight=0;this._fun=function(){};var C=CurrentStyle(this._obj);this._borderX=(parseInt(C.borderLeftWidth)||0)+(parseInt(C.borderRightWidth)||0);this._borderY=(parseInt(C.borderTopWidth)||0)+(parseInt(C.borderBottomWidth)||0);this._fR=BindAsEventListener(this,this.Resize);this._fS=Bind(this,this.Stop);this.SetOptions(B);this.Max=!!this.options.Max;this._mxContainer=div_$(this.options.mxContainer)||null;this.mxLeft=Math.round(this.options.mxLeft);this.mxRight=Math.round(this.options.mxRight);this.mxTop=Math.round(this.options.mxTop);this.mxBottom=Math.round(this.options.mxBottom);this.Min=!!this.options.Min;this.minWidth=Math.round(this.options.minWidth);this.minHeight=Math.round(this.options.minHeight);this.Scale=!!this.options.Scale;this.Ratio=Math.max(this.options.Ratio,0);this.onResize=this.options.onResize;this._obj.style.position="absolute"},SetOptions:function(A){this.options={Max:false,mxContainer:"",mxLeft:0,mxRight:9999,mxTop:0,mxBottom:9999,Min:false,minWidth:50,minHeight:50,Scale:false,Ratio:0,onResize:function(){}};Extend(this.options,A||{})},Set:function(B,C){var B=div_$(B),A;if(!B){return}switch(C.toLowerCase()){case"up":A=this.Up;break;case"down":A=this.Down;break;case"left":A=this.Left;break;case"right":A=this.Right;break;case"left-up":A=this.LeftUp;break;case"right-up":A=this.RightUp;break;case"left-down":A=this.LeftDown;break;case"right-down":default:A=this.RightDown}addEventHandler(B,"mousedown",BindAsEventListener(this,this.Start,A))},Start:function(A,B,E){$(".showByDrag").unbind("mousedown",dragImageMouseDown);$(".showByDrag").unbind("mousemove",dragImageMouseMove);$(".showByDrag").unbind("mouseup",dragImageMouseUp);$(".showByDrag").removeClass("mouseStyleMove");$(".showByDrag").addClass("mouseStyleAnnotation");A.stopPropagation?A.stopPropagation():(A.cancelBubble=true);this._fun=B;this._styleWidth=this._obj.clientWidth;this._styleHeight=this._obj.clientHeight;this._styleLeft=this._obj.offsetLeft;this._styleTop=this._obj.offsetTop;this._sideLeft=A.clientX-this._styleWidth;this._sideRight=A.clientX+this._styleWidth;this._sideUp=A.clientY-this._styleHeight;this._sideDown=A.clientY+this._styleHeight;this._fixLeft=this._styleLeft+this._styleWidth;this._fixTop=this._styleTop+this._styleHeight;if(this.Scale){this.Ratio=Math.max(this.Ratio,0)||this._styleWidth/this._styleHeight;this._scaleLeft=this._styleLeft+this._styleWidth/2;this._scaleTop=this._styleTop+this._styleHeight/2}if(this.Max){var C=this.mxLeft,F=this.mxRight,G=this.mxTop,D=this.mxBottom;F=Math.max(F,C+(this.Min?this.minWidth:0)+this._borderX);D=Math.max(D,G+(this.Min?this.minHeight:0)+this._borderY);this._mxSet=function(){this._mxRightWidth=F-this._styleLeft-this._borderX;this._mxDownHeight=D-this._styleTop-this._borderY;this._mxUpHeight=Math.max(this._fixTop-G,this.Min?this.minHeight:0);this._mxLeftWidth=Math.max(this._fixLeft-C,this.Min?this.minWidth:0)};this._mxSet();if(this.Scale){this._mxScaleWidth=Math.min(this._scaleLeft-C,F-this._scaleLeft-this._borderX)*2;this._mxScaleHeight=Math.min(this._scaleTop-G,D-this._scaleTop-this._borderY)*2}}addEventHandler(document,"mousemove",this._fR);addEventHandler(document,"mouseup",this._fS);if(isIE){addEventHandler(this._obj,"losecapture",this._fS);this._obj.setCapture()}else{addEventHandler(window,"blur",this._fS);A.preventDefault()}},Resize:function(e){window.getSelection?window.getSelection().removeAllRanges():document.selection.empty();this._fun(e);with(this._obj.style){width=this._styleWidth+"px";height=this._styleHeight+"px";top=this._styleTop+"px";left=this._styleLeft+"px"}this.onResize()},Up:function(A){this.RepairY(this._sideDown-A.clientY,this._mxUpHeight);this.RepairTop();this.TurnDown(this.Down)},Down:function(A){this._mxDownHeight=this._mxDownHeight>0?this._mxDownHeight:-this._mxDownHeight;this.RepairY(A.clientY-this._sideUp,this._mxDownHeight);this.TurnUp(this.Up)},Right:function(A){this.RepairX(A.clientX-this._sideLeft,this._mxRightWidth);this.TurnLeft(this.Left)},Left:function(A){this.RepairX(this._sideRight-A.clientX,this._mxLeftWidth);this.RepairLeft();this.TurnRight(this.Right)},RightDown:function(A){this._mxDownHeight=this._mxDownHeight>0?this._mxDownHeight:-this._mxDownHeight;this.RepairAngle(A.clientX-this._sideLeft,this._mxRightWidth,A.clientY-this._sideUp,this._mxDownHeight);this.TurnLeft(this.LeftDown)||this.Scale||this.TurnUp(this.RightUp)},RightUp:function(A){this.RepairAngle(A.clientX-this._sideLeft,this._mxRightWidth,this._sideDown-A.clientY,this._mxUpHeight);this.RepairTop();this.TurnLeft(this.LeftUp)||this.Scale||this.TurnDown(this.RightDown)},LeftDown:function(A){this._mxDownHeight=this._mxDownHeight>0?this._mxDownHeight:-this._mxDownHeight;this.RepairAngle(this._sideRight-A.clientX,this._mxLeftWidth,A.clientY-this._sideUp,this._mxDownHeight);this.RepairLeft();this.TurnRight(this.RightDown)||this.Scale||this.TurnUp(this.LeftUp)},LeftUp:function(A){this.RepairAngle(this._sideRight-A.clientX,this._mxLeftWidth,this._sideDown-A.clientY,this._mxUpHeight);this.RepairTop();this.RepairLeft();this.TurnRight(this.RightUp)||this.Scale||this.TurnDown(this.LeftDown)},RepairX:function(A,B){A=this.RepairWidth(A,B);if(this.Scale){var D=this.RepairScaleHeight(A);if(this.Max&&D>this._mxScaleHeight){D=this._mxScaleHeight;A=this.RepairScaleWidth(D)}else{if(this.Min&&D<this.minHeight){var C=this.RepairScaleWidth(this.minHeight);if(C<B){D=this.minHeight;A=C}}}this._styleHeight=D;this._styleTop=this._scaleTop-D/2}this._styleWidth=A},RepairY:function(D,C){D=this.RepairHeight(D,C);if(this.Scale){var A=this.RepairScaleWidth(D);if(this.Max&&A>this._mxScaleWidth){A=this._mxScaleWidth;D=this.RepairScaleHeight(A)}else{if(this.Min&&A<this.minWidth){var B=this.RepairScaleHeight(this.minWidth);if(B<C){A=this.minWidth;D=B}}}this._styleWidth=A;this._styleLeft=this._scaleLeft-A/2}this._styleHeight=D},RepairAngle:function(A,B,E,C){A=this.RepairWidth(A,B);if(this.Scale){E=this.RepairScaleHeight(A);if(this.Max&&E>C){E=C;A=this.RepairScaleWidth(E)}else{if(this.Min&&E<this.minHeight){var D=this.RepairScaleWidth(this.minHeight);if(D<B){E=this.minHeight;A=D}}}}else{E=this.RepairHeight(E,C)}this._styleWidth=A;this._styleHeight=E},RepairTop:function(){this._styleTop=this._fixTop-this._styleHeight},RepairLeft:function(){this._styleLeft=this._fixLeft-this._styleWidth},RepairHeight:function(B,A){B=Math.min(this.Max?A:B,B);B=Math.max(this.Min?this.minHeight:B,B,0);return B},RepairWidth:function(A,B){A=Math.min(this.Max?B:A,A);A=Math.max(this.Min?this.minWidth:A,A,0);return A},RepairScaleHeight:function(A){return Math.max(Math.round((A+this._borderX)/this.Ratio-this._borderY),0)},RepairScaleWidth:function(A){return Math.max(Math.round((A+this._borderY)*this.Ratio-this._borderX),0)},TurnRight:function(A){if(!(this.Min||this._styleWidth)){this._fun=A;this._sideLeft=this._sideRight;this.Max&&this._mxSet();return true}},TurnLeft:function(A){if(!(this.Min||this._styleWidth)){this._fun=A;this._sideRight=this._sideLeft;this._fixLeft=this._styleLeft;this.Max&&this._mxSet();return true}},TurnUp:function(A){if(!(this.Min||this._styleHeight)){this._fun=A;this._sideDown=this._sideUp;this._fixTop=this._styleTop;this.Max&&this._mxSet();return true}},TurnDown:function(A){if(!(this.Min||this._styleHeight)){this._fun=A;this._sideUp=this._sideDown;this.Max&&this._mxSet();return true}},Stop:function(){removeEventHandler(document,"mousemove",this._fR);removeEventHandler(document,"mouseup",this._fS);if(isIE){removeEventHandler(this._obj,"losecapture",this._fS);this._obj.releaseCapture()}else{removeEventHandler(window,"blur",this._fS)}$(".showByDrag").bind("mousedown",dragImageMouseDown);$(".showByDrag").bind("mousemove",dragImageMouseMove);$(".showByDrag").bind("mouseup",dragImageMouseUp);$(".showByDrag").removeClass("mouseStyleAnnotation");$(".showByDrag").addClass("mouseStyleMove")}};var RasterEdgeViewer=Class.create();RasterEdgeViewer.prototype={initialize:function(A){this.SetOptions(A);this._viewerWidth=this.options._viewerWidth;this._viewerHeight=this.options._viewerHeight;this._serverUrl=this.options._serverUrl;this._defaultPage=this.options._defaultPage;this._pdfViewer=this.options._pdfViewer;this._wordViewer=this.options._wordViewer;this._excelViewer=this.options._excelViewer;this._pptViewer=this.options._pptViewer;this._leftPanelDefaultShow=this.options._leftPanelDefaultShow;this._btnFull=this.options._btnFull;this._initialFullScreen=this.options._initialFullScreen},SetOptions:function(A){this.options={_viewerWidth:1024,_viewerHeight:730,_serverUrl:"",_defaultPage:"Default.aspx",_pdfViewer:0,_wordViewer:0,_excelViewer:0,_pptViewer:0,_leftPanelDefaultShow:false,_btnFull:true,_initialFullScreen:false,};Extend(this.options,A||{})},};var _viewerTopToolbar=new TopToolbar();function TopToolbar(){this.items=new Array();this.addTab=function(A){this.items.push(A)};this.removeTab=function(A){this.items.remove(A)}}function RECommand(A){this._operation=A}function CommandSet(B){this.items=new Array();for(var A=0;A<B.length;A++){this.items.push(new RECommand(B[A]))}this.addCommand=function(C){this.items.push(C)};this.removeCommand=function(C){this.items.Remove(C)}}function CommandAnnotation(A,B){this._operation=A;if(A=="text"){TextAnnoStyle=B}else{if(A=="freeHand"){FreehandAnnoStyle=B}else{if(A=="highLight"){HighlightAnnoStyle=B}else{if(A=="rectangle"){RectangleAnnoStyle=B}else{if(A=="filledRectangle"){FilledRectangleAnnoStyle=B}else{if(A=="ellipse"){EllipseAnnoStyle=B}else{if(A=="rubberStamp"){RubberStampAnnoStyle=B}else{if(A=="polygonLines"){PolygonLinesAnnoStyle=B}else{if(A=="polygon"){PolygonAnnoStyle=B}else{if(A=="line"){LineAnnoStyle=B}else{if(A=="arrow"){ArrowAnnoStyle=B}}}}}}}}}}}}function customStyle(A){this.cusCss=A}function customCmd(A){this.cusCmd=A}function UserCommand(A){this._operation=A;this.id="";this.style="";this.event="";this.params="";this.htmlDom="";this.addId=function(B){this.id=B};this.addCSS=function(B){this.style=B};this.addEvent=function(B){this.event=B};this.addParameter=function(B){this.params=B};this.addHtmlDOM=function(B){this.htmlDom=B}}function ToolbarTab(A,B){this.title=A;this.items=new Array();this.addCommand=function(C){this.items.push(C)};this.removeCommand=function(C){this.items.Remove(C)};this.addCommandSet=function(D){for(var C=0;C<D.items.length;C++){this.items.push(D.items[C])}};this.removeCommandSet=function(D){for(var C=0;C<D.items.length;C++){this.items.Remove(D.items[C])}}}var AnnoStyle=Class.create();AnnoStyle.prototype={initialize:function(A){this.SetOptions(A);this.OutLineColor=this.options.OutLineColor;this.OutLineWidth=this.options.OutLineWidth;this.FillColor=this.options.FillColor;this.ShowedText=this.options.ShowedText;this.TextColor=this.options.TextColor;this.TextFont=this.options.TextFont;this.TextSize=this.options.TextSize;this.TextStyle=this.options.TextStyle;this.TextPadding=this.options.TextPadding;this.Transparency=this.options.Transparency},SetOptions:function(A){this.options={OutLineColor:"",OutLineWidth:0,FillColor:"",ShowedText:"",TextColor:"",TextFont:"",TextSize:0,TextStyle:new Array(),TextPadding:6,Transparency:0.4,};Extend(this.options,A||{})},};var PageTextRedacts=Class.create();PageTextRedacts.prototype={initialize:function(A){this.SetOptions(A);this.relativePages=this.options.relativePages;this.curPageRectRedacts=this.options.curPageRectRedacts},SetOptions:function(A){this.options={relativePages:new Array(),curPageRectRedacts:new Array(),};Extend(this.options,A||{})},};(function($){var escape=/["\\\x00-\x1f\x7f-\x9f]/g,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},hasOwn=Object.prototype.hasOwnProperty;$.toJSON=typeof JSON==="object"&&JSON.stringify?JSON.stringify:function(o){if(o===null){return"null"}var pairs,k,name,val,type=$.type(o);if(type==="undefined"){return undefined}if(type==="number"||type==="boolean"){return String(o)}if(type==="string"){return $.quoteString(o)}if(typeof o.toJSON==="function"){return $.toJSON(o.toJSON())}if(type==="date"){var month=o.getUTCMonth()+1,day=o.getUTCDate(),year=o.getUTCFullYear(),hours=o.getUTCHours(),minutes=o.getUTCMinutes(),seconds=o.getUTCSeconds(),milli=o.getUTCMilliseconds();if(month<10){month="0"+month}if(day<10){day="0"+day}if(hours<10){hours="0"+hours}if(minutes<10){minutes="0"+minutes}if(seconds<10){seconds="0"+seconds}if(milli<100){milli="0"+milli}if(milli<10){milli="0"+milli}return'"'+year+"-"+month+"-"+day+"T"+hours+":"+minutes+":"+seconds+"."+milli+'Z"'}pairs=[];if($.isArray(o)){for(k=0;k<o.length;k++){pairs.push($.toJSON(o[k])||"null")}return"["+pairs.join(",")+"]"}if(typeof o==="object"){for(k in o){if(hasOwn.call(o,k)){type=typeof k;if(type==="number"){name='"'+k+'"'}else{if(type==="string"){name=$.quoteString(k)}else{continue}}type=typeof o[k];if(type!=="function"&&type!=="undefined"){val=$.toJSON(o[k]);pairs.push(name+":"+val)}}}return"{"+pairs.join(",")+"}"}};$.evalJSON=typeof JSON==="object"&&JSON.parse?JSON.parse:function(str){return eval("("+str+")")};$.secureEvalJSON=typeof JSON==="object"&&JSON.parse?JSON.parse:function(str){var filtered=str.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"");if(/^[\],:{}\s]*$/.test(filtered)){return eval("("+str+")")}throw new SyntaxError("Error parsing JSON, source is not valid.")};$.quoteString=function(str){if(str.match(escape)){return'"'+str.replace(escape,function(a){var c=meta[a];if(typeof c==="string"){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"'}return'"'+str+'"'}}(jQuery));
/* jQuery UI - v1.10.4 - 2014-05-25
* http://jqueryui.com
* Includes: jquery.ui.core.js, jquery.ui.widget.js, jquery.ui.mouse.js, jquery.ui.position.js, jquery.ui.draggable.js, jquery.ui.droppable.js, jquery.ui.resizable.js, jquery.ui.selectable.js, jquery.ui.sortable.js, jquery.ui.accordion.js, jquery.ui.autocomplete.js, jquery.ui.button.js, jquery.ui.datepicker.js, jquery.ui.dialog.js, jquery.ui.menu.js, jquery.ui.progressbar.js, jquery.ui.slider.js, jquery.ui.spinner.js, jquery.ui.tabs.js, jquery.ui.tooltip.js, jquery.ui.effect.js, jquery.ui.effect-blind.js, jquery.ui.effect-bounce.js, jquery.ui.effect-clip.js, jquery.ui.effect-drop.js, jquery.ui.effect-explode.js, jquery.ui.effect-fade.js, jquery.ui.effect-fold.js, jquery.ui.effect-highlight.js, jquery.ui.effect-pulsate.js, jquery.ui.effect-scale.js, jquery.ui.effect-shake.js, jquery.ui.effect-slide.js, jquery.ui.effect-transfer.js
* Copyright 2014 jQuery Foundation and other contributors; Licensed MIT */
(function(F,C){var D=0,A=/^ui-id-\d+$/;F.ui=F.ui||{};F.extend(F.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});F.fn.extend({focus:(function(G){return function(I,H){return typeof I==="number"?this.each(function(){var J=this;setTimeout(function(){F(J).focus();if(H){H.call(J)}},I)}):G.apply(this,arguments)}})(F.fn.focus),scrollParent:function(){var G;if((F.ui.ie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){G=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test(F.css(this,"position"))&&(/(auto|scroll)/).test(F.css(this,"overflow")+F.css(this,"overflow-y")+F.css(this,"overflow-x"))}).eq(0)}else{G=this.parents().filter(function(){return(/(auto|scroll)/).test(F.css(this,"overflow")+F.css(this,"overflow-y")+F.css(this,"overflow-x"))}).eq(0)}return(/fixed/).test(this.css("position"))||!G.length?F(document):G},zIndex:function(H){if(H!==C){return this.css("zIndex",H)}if(this.length){var I=F(this[0]),G,J;while(I.length&&I[0]!==document){G=I.css("position");if(G==="absolute"||G==="relative"||G==="fixed"){J=parseInt(I.css("zIndex"),10);if(!isNaN(J)&&J!==0){return J}}I=I.parent()}}return 0},uniqueId:function(){return this.each(function(){if(!this.id){this.id="ui-id-"+(++D)}})},removeUniqueId:function(){return this.each(function(){if(A.test(this.id)){F(this).removeAttr("id")}})}});function B(J,L){var G,H,K,I=J.nodeName.toLowerCase();if("area"===I){G=J.parentNode;H=G.name;if(!J.href||!H||G.nodeName.toLowerCase()!=="map"){return false}K=F("img[usemap=#"+H+"]")[0];return !!K&&E(K)}return(/input|select|textarea|button|object/.test(I)?!J.disabled:"a"===I?J.href||L:L)&&E(J)}function E(G){return F.expr.filters.visible(G)&&!F(G).parents().addBack().filter(function(){return F.css(this,"visibility")==="hidden"}).length}F.extend(F.expr[":"],{data:F.expr.createPseudo?F.expr.createPseudo(function(G){return function(H){return !!F.data(H,G)}}):function(I,G,H){return !!F.data(I,H[3])},focusable:function(G){return B(G,!isNaN(F.attr(G,"tabindex")))},tabbable:function(G){var I=F.attr(G,"tabindex"),H=isNaN(I);return(H||I>=0)&&B(G,!H)}});if(!F("<a>").outerWidth(1).jquery){F.each(["Width","Height"],function(H,I){var K=I==="Width"?["Left","Right"]:["Top","Bottom"],G=I.toLowerCase(),J={innerWidth:F.fn.innerWidth,innerHeight:F.fn.innerHeight,outerWidth:F.fn.outerWidth,outerHeight:F.fn.outerHeight};function L(O,M,P,N){F.each(K,function(){M-=parseFloat(F.css(O,"padding"+this))||0;if(P){M-=parseFloat(F.css(O,"border"+this+"Width"))||0}if(N){M-=parseFloat(F.css(O,"margin"+this))||0}});return M}F.fn["inner"+I]=function(M){if(M===C){return J["inner"+I].call(this)}return this.each(function(){F(this).css(G,L(this,M)+"px")})};F.fn["outer"+I]=function(M,N){if(typeof M!=="number"){return J["outer"+I].call(this,M)}return this.each(function(){F(this).css(G,L(this,M,true,N)+"px")})}})}if(!F.fn.addBack){F.fn.addBack=function(G){return this.add(G==null?this.prevObject:this.prevObject.filter(G))}}if(F("<a>").data("a-b","a").removeData("a-b").data("a-b")){F.fn.removeData=(function(G){return function(H){if(arguments.length){return G.call(this,F.camelCase(H))}else{return G.call(this)}}})(F.fn.removeData)}F.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());F.support.selectstart="onselectstart" in document.createElement("div");F.fn.extend({disableSelection:function(){return this.bind((F.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(G){G.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});F.extend(F.ui,{plugin:{add:function(J,G,K){var H,I=F.ui[J].prototype;for(H in K){I.plugins[H]=I.plugins[H]||[];I.plugins[H].push([G,K[H]])}},call:function(H,I,K){var G,J=H.plugins[I];if(!J||!H.element[0].parentNode||H.element[0].parentNode.nodeType===11){return}for(G=0;G<J.length;G++){if(H.options[J[G][0]]){J[G][1].apply(H.element,K)}}}},hasScroll:function(G,I){if(F(G).css("overflow")==="hidden"){return false}var H=(I&&I==="left")?"scrollLeft":"scrollTop",J=false;if(G[H]>0){return true}G[H]=1;J=(G[H]>0);G[H]=0;return J}})})(jQuery);(function(E,A){var C=0,D=Array.prototype.slice,B=E.cleanData;E.cleanData=function(H){for(var F=0,I;(I=H[F])!=null;F++){try{E(I).triggerHandler("remove")}catch(G){}}B(H)};E.widget=function(H,G,M){var K,J,F,L,I={},N=H.split(".")[0];H=H.split(".")[1];K=N+"-"+H;if(!M){M=G;G=E.Widget}E.expr[":"][K.toLowerCase()]=function(O){return !!E.data(O,K)};E[N]=E[N]||{};J=E[N][H];F=E[N][H]=function(O,P){if(!this._createWidget){return new F(O,P)}if(arguments.length){this._createWidget(O,P)}};E.extend(F,J,{version:M.version,_proto:E.extend({},M),_childConstructors:[]});L=new G();L.options=E.widget.extend({},L.options);E.each(M,function(O,P){if(!E.isFunction(P)){I[O]=P;return}I[O]=(function(){var Q=function(){return G.prototype[O].apply(this,arguments)},R=function(S){return G.prototype[O].apply(this,S)};return function(){var T=this._super,U=this._superApply,S;this._super=Q;this._superApply=R;S=P.apply(this,arguments);this._super=T;this._superApply=U;return S}})()});F.prototype=E.widget.extend(L,{widgetEventPrefix:J?(L.widgetEventPrefix||H):H},I,{constructor:F,namespace:N,widgetName:H,widgetFullName:K});if(J){E.each(J._childConstructors,function(O,P){var Q=P.prototype;E.widget(Q.namespace+"."+Q.widgetName,F,P._proto)});delete J._childConstructors}else{G._childConstructors.push(F)}E.widget.bridge(H,F)};E.widget.extend=function(J){var H=D.call(arguments,1),F=0,K=H.length,G,I;for(;F<K;F++){for(G in H[F]){I=H[F][G];if(H[F].hasOwnProperty(G)&&I!==A){if(E.isPlainObject(I)){J[G]=E.isPlainObject(J[G])?E.widget.extend({},J[G],I):E.widget.extend({},I)}else{J[G]=I}}}}return J};E.widget.bridge=function(G,F){var H=F.prototype.widgetFullName||G;E.fn[G]=function(J){var K=typeof J==="string",L=D.call(arguments,1),I=this;J=!K&&L.length?E.widget.extend.apply(null,[J].concat(L)):J;if(K){this.each(function(){var M,N=E.data(this,H);if(!N){return E.error("cannot call methods on "+G+" prior to initialization; attempted to call method '"+J+"'")}if(!E.isFunction(N[J])||J.charAt(0)==="_"){return E.error("no such method '"+J+"' for "+G+" widget instance")}M=N[J].apply(N,L);if(M!==N&&M!==A){I=M&&M.jquery?I.pushStack(M.get()):M;return false}})}else{this.each(function(){var M=E.data(this,H);if(M){M.option(J||{})._init()}else{E.data(this,H,new F(J,this))}})}return I}};E.Widget=function(){};E.Widget._childConstructors=[];E.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:false,create:null},_createWidget:function(F,G){G=E(G||this.defaultElement||this)[0];this.element=E(G);this.uuid=C++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=E.widget.extend({},this.options,this._getCreateOptions(),F);this.bindings=E();this.hoverable=E();this.focusable=E();if(G!==this){E.data(G,this.widgetFullName,this);this._on(true,this.element,{remove:function(H){if(H.target===G){this.destroy()}}});this.document=E(G.style?G.ownerDocument:G.document||G);this.window=E(this.document[0].defaultView||this.document[0].parentWindow)}this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:E.noop,_getCreateEventData:E.noop,_create:E.noop,_init:E.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(E.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:E.noop,widget:function(){return this.element},option:function(G,J){var I=G,F,K,H;if(arguments.length===0){return E.widget.extend({},this.options)}if(typeof G==="string"){I={};F=G.split(".");G=F.shift();if(F.length){K=I[G]=E.widget.extend({},this.options[G]);for(H=0;H<F.length-1;H++){K[F[H]]=K[F[H]]||{};K=K[F[H]]}G=F.pop();if(arguments.length===1){return K[G]===A?null:K[G]}K[G]=J}else{if(arguments.length===1){return this.options[G]===A?null:this.options[G]}I[G]=J}}this._setOptions(I);return this},_setOptions:function(G){var F;for(F in G){this._setOption(F,G[F])}return this},_setOption:function(F,G){this.options[F]=G;if(F==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!G).attr("aria-disabled",G);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}return this},enable:function(){return this._setOption("disabled",false)},disable:function(){return this._setOption("disabled",true)},_on:function(H,I,F){var J,G=this;if(typeof H!=="boolean"){F=I;I=H;H=false}if(!F){F=I;I=this.element;J=this.widget()}else{I=J=E(I);this.bindings=this.bindings.add(I)}E.each(F,function(N,L){function P(){if(!H&&(G.options.disabled===true||E(this).hasClass("ui-state-disabled"))){return}return(typeof L==="string"?G[L]:L).apply(G,arguments)}if(typeof L!=="string"){P.guid=L.guid=L.guid||P.guid||E.guid++}var K=N.match(/^(\w+)\s*(.*)$/),M=K[1]+G.eventNamespace,O=K[2];if(O){J.delegate(O,M,P)}else{I.bind(M,P)}})},_off:function(G,F){F=(F||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;G.unbind(F).undelegate(F)},_delay:function(G,I){function H(){return(typeof G==="string"?F[G]:G).apply(F,arguments)}var F=this;return setTimeout(H,I||0)},_hoverable:function(F){this.hoverable=this.hoverable.add(F);this._on(F,{mouseenter:function(G){E(G.currentTarget).addClass("ui-state-hover")},mouseleave:function(G){E(G.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(F){this.focusable=this.focusable.add(F);this._on(F,{focusin:function(G){E(G.currentTarget).addClass("ui-state-focus")},focusout:function(G){E(G.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(F,I,K){var H,G,J=this.options[F];K=K||{};I=E.Event(I);I.type=(F===this.widgetEventPrefix?F:this.widgetEventPrefix+F).toLowerCase();I.target=this.element[0];G=I.originalEvent;if(G){for(H in G){if(!(H in I)){I[H]=G[H]}}}this.element.trigger(I,K);return !(E.isFunction(J)&&J.apply(this.element[0],[I].concat(K))===false||I.isDefaultPrevented())}};E.each({show:"fadeIn",hide:"fadeOut"},function(F,G){E.Widget.prototype["_"+F]=function(L,J,H){if(typeof J==="string"){J={effect:J}}var I,K=!J?F:J===true||typeof J==="number"?G:J.effect||G;J=J||{};if(typeof J==="number"){J={duration:J}}I=!E.isEmptyObject(J);J.complete=H;if(J.delay){L.delay(J.delay)}if(I&&E.effects&&E.effects.effect[K]){L[F](J)}else{if(K!==F&&L[K]){L[K](J.duration,J.easing,H)}else{L.queue(function(M){E(this)[F]();if(H){H.call(L[0])}M()})}}}})})(jQuery);(function(C,B){var A=false;C(document).mouseup(function(){A=false});C.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var D=this;this.element.bind("mousedown."+this.widgetName,function(E){return D._mouseDown(E)}).bind("click."+this.widgetName,function(E){if(true===C.data(E.target,D.widgetName+".preventClickEvent")){C.removeData(E.target,D.widgetName+".preventClickEvent");E.stopImmediatePropagation();return false}});this.started=false},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);if(this._mouseMoveDelegate){C(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)}},_mouseDown:function(F){if(A){return}(this._mouseStarted&&this._mouseUp(F));this._mouseDownEvent=F;var D=this,G=(F.which===1),E=(typeof this.options.cancel==="string"&&F.target.nodeName?C(F.target).closest(this.options.cancel).length:false);if(!G||E||!this._mouseCapture(F)){return true}this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){D.mouseDelayMet=true},this.options.delay)}if(this._mouseDistanceMet(F)&&this._mouseDelayMet(F)){this._mouseStarted=(this._mouseStart(F)!==false);if(!this._mouseStarted){F.preventDefault();return true}}if(true===C.data(F.target,this.widgetName+".preventClickEvent")){C.removeData(F.target,this.widgetName+".preventClickEvent")}this._mouseMoveDelegate=function(H){return D._mouseMove(H)};this._mouseUpDelegate=function(H){return D._mouseUp(H)};C(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);F.preventDefault();A=true;return true},_mouseMove:function(D){if(C.ui.ie&&(!document.documentMode||document.documentMode<9)&&!D.button){return this._mouseUp(D)}if(this._mouseStarted){this._mouseDrag(D);return D.preventDefault()}if(this._mouseDistanceMet(D)&&this._mouseDelayMet(D)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,D)!==false);(this._mouseStarted?this._mouseDrag(D):this._mouseUp(D))}return !this._mouseStarted},_mouseUp:function(D){C(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=false;if(D.target===this._mouseDownEvent.target){C.data(D.target,this.widgetName+".preventClickEvent",true)}this._mouseStop(D)}return false},_mouseDistanceMet:function(D){return(Math.max(Math.abs(this._mouseDownEvent.pageX-D.pageX),Math.abs(this._mouseDownEvent.pageY-D.pageY))>=this.options.distance)},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return true}})})(jQuery);(function(K,A){K.ui=K.ui||{};var E,C=Math.max,M=Math.abs,D=Math.round,H=/left|center|right/,B=/top|center|bottom/,G=/[\+\-]\d+(\.[\d]+)?%?/,L=/^\w+/,O=/%$/,J=K.fn.position;function N(Q,R,P){return[parseFloat(Q[0])*(O.test(Q[0])?R/100:1),parseFloat(Q[1])*(O.test(Q[1])?P/100:1)]}function I(Q,P){return parseInt(K.css(Q,P),10)||0}function F(P){var Q=P[0];if(Q.nodeType===9){return{width:P.width(),height:P.height(),offset:{top:0,left:0}}}if(K.isWindow(Q)){return{width:P.width(),height:P.height(),offset:{top:P.scrollTop(),left:P.scrollLeft()}}}if(Q.preventDefault){return{width:0,height:0,offset:{top:Q.pageY,left:Q.pageX}}}return{width:P.outerWidth(),height:P.outerHeight(),offset:P.offset()}}K.position={scrollbarWidth:function(){if(E!==A){return E}var R,P,Q=K("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),S=Q.children()[0];K("body").append(Q);R=S.offsetWidth;Q.css("overflow","scroll");P=S.offsetWidth;if(R===P){P=Q[0].clientWidth}Q.remove();return(E=R-P)},getScrollInfo:function(Q){var S=Q.isWindow||Q.isDocument?"":Q.element.css("overflow-x"),P=Q.isWindow||Q.isDocument?"":Q.element.css("overflow-y"),R=S==="scroll"||(S==="auto"&&Q.width<Q.element[0].scrollWidth),T=P==="scroll"||(P==="auto"&&Q.height<Q.element[0].scrollHeight);return{width:T?K.position.scrollbarWidth():0,height:R?K.position.scrollbarWidth():0}},getWithinInfo:function(S){var Q=K(S||window),R=K.isWindow(Q[0]),P=!!Q[0]&&Q[0].nodeType===9;return{element:Q,isWindow:R,isDocument:P,offset:Q.offset()||{left:0,top:0},scrollLeft:Q.scrollLeft(),scrollTop:Q.scrollTop(),width:R?Q.width():Q.outerWidth(),height:R?Q.height():Q.outerHeight()}}};K.fn.position=function(X){if(!X||!X.of){return J.apply(this,arguments)}X=K.extend({},X);var Q,a,U,V,T,P,Y=K(X.of),Z=K.position.getWithinInfo(X.within),S=K.position.getScrollInfo(Z),R=(X.collision||"flip").split(" "),W={};P=F(Y);if(Y[0].preventDefault){X.at="left top"}a=P.width;U=P.height;V=P.offset;T=K.extend({},V);K.each(["my","at"],function(){var c=(X[this]||"").split(" "),b,d;if(c.length===1){c=H.test(c[0])?c.concat(["center"]):B.test(c[0])?["center"].concat(c):["center","center"]}c[0]=H.test(c[0])?c[0]:"center";c[1]=B.test(c[1])?c[1]:"center";b=G.exec(c[0]);d=G.exec(c[1]);W[this]=[b?b[0]:0,d?d[0]:0];X[this]=[L.exec(c[0])[0],L.exec(c[1])[0]]});if(R.length===1){R[1]=R[0]}if(X.at[0]==="right"){T.left+=a}else{if(X.at[0]==="center"){T.left+=a/2}}if(X.at[1]==="bottom"){T.top+=U}else{if(X.at[1]==="center"){T.top+=U/2}}Q=N(W.at,a,U);T.left+=Q[0];T.top+=Q[1];return this.each(function(){var b,i,e=K(this),k=e.outerWidth(),d=e.outerHeight(),l=I(this,"marginLeft"),h=I(this,"marginTop"),f=k+l+I(this,"marginRight")+S.width,c=d+h+I(this,"marginBottom")+S.height,g=K.extend({},T),j=N(W.my,e.outerWidth(),e.outerHeight());if(X.my[0]==="right"){g.left-=k}else{if(X.my[0]==="center"){g.left-=k/2}}if(X.my[1]==="bottom"){g.top-=d}else{if(X.my[1]==="center"){g.top-=d/2}}g.left+=j[0];g.top+=j[1];if(!K.support.offsetFractions){g.left=D(g.left);g.top=D(g.top)}b={marginLeft:l,marginTop:h};K.each(["left","top"],function(n,m){if(K.ui.position[R[n]]){K.ui.position[R[n]][m](g,{targetWidth:a,targetHeight:U,elemWidth:k,elemHeight:d,collisionPosition:b,collisionWidth:f,collisionHeight:c,offset:[Q[0]+j[0],Q[1]+j[1]],my:X.my,at:X.at,within:Z,elem:e})}});if(X.using){i=function(p){var n=V.left-g.left,m=n+a-k,o=V.top-g.top,r=o+U-d,q={target:{element:Y,left:V.left,top:V.top,width:a,height:U},element:{element:e,left:g.left,top:g.top,width:k,height:d},horizontal:m<0?"left":n>0?"right":"center",vertical:r<0?"top":o>0?"bottom":"middle"};if(a<k&&M(n+m)<a){q.horizontal="center"}if(U<d&&M(o+r)<U){q.vertical="middle"}if(C(M(n),M(m))>C(M(o),M(r))){q.important="horizontal"}else{q.important="vertical"}X.using.call(this,p,q)}}e.offset(K.extend(g,{using:i}))})};K.ui.position={fit:{left:function(W,Q){var X=Q.within,P=X.isWindow?X.scrollLeft:X.offset.left,S=X.width,V=W.left-Q.collisionPosition.marginLeft,R=P-V,T=V+Q.collisionWidth-S-P,U;if(Q.collisionWidth>S){if(R>0&&T<=0){U=W.left+R+Q.collisionWidth-S-P;W.left+=R-U}else{if(T>0&&R<=0){W.left=P}else{if(R>T){W.left=P+S-Q.collisionWidth}else{W.left=P}}}}else{if(R>0){W.left+=R}else{if(T>0){W.left-=T}else{W.left=C(W.left-V,W.left)}}}},top:function(W,R){var X=R.within,Q=X.isWindow?X.scrollTop:X.offset.top,U=R.within.height,S=W.top-R.collisionPosition.marginTop,V=Q-S,T=S+R.collisionHeight-U-Q,P;if(R.collisionHeight>U){if(V>0&&T<=0){P=W.top+V+R.collisionHeight-U-Q;W.top+=V-P}else{if(T>0&&V<=0){W.top=Q}else{if(V>T){W.top=Q+U-R.collisionHeight}else{W.top=Q}}}}else{if(V>0){W.top+=V}else{if(T>0){W.top-=T}else{W.top=C(W.top-S,W.top)}}}}},flip:{left:function(a,T){var c=T.within,Q=c.offset.left+c.scrollLeft,V=c.width,P=c.isWindow?c.scrollLeft:c.offset.left,Z=a.left-T.collisionPosition.marginLeft,U=Z-P,W=Z+T.collisionWidth-V-P,X=T.my[0]==="left"?-T.elemWidth:T.my[0]==="right"?T.elemWidth:0,S=T.at[0]==="left"?T.targetWidth:T.at[0]==="right"?-T.targetWidth:0,R=-2*T.offset[0],Y,b;if(U<0){Y=a.left+X+S+R+T.collisionWidth-V-Q;if(Y<0||Y<M(U)){a.left+=X+S+R}}else{if(W>0){b=a.left-T.collisionPosition.marginLeft+X+S+R-P;if(b>0||M(b)<W){a.left+=X+S+R}}}},top:function(a,T){var b=T.within,R=b.offset.top+b.scrollTop,Y=b.height,d=b.isWindow?b.scrollTop:b.offset.top,U=a.top-T.collisionPosition.marginTop,Z=U-d,W=U+T.collisionHeight-Y-d,V=T.my[1]==="top",X=V?-T.elemHeight:T.my[1]==="bottom"?T.elemHeight:0,P=T.at[1]==="top"?T.targetHeight:T.at[1]==="bottom"?-T.targetHeight:0,S=-2*T.offset[1],c,Q;if(Z<0){Q=a.top+X+P+S+T.collisionHeight-Y-R;if((a.top+X+P+S)>Z&&(Q<0||Q<M(Z))){a.top+=X+P+S}}else{if(W>0){c=a.top-T.collisionPosition.marginTop+X+P+S-d;if((a.top+X+P+S)>W&&(c>0||M(c)<W)){a.top+=X+P+S}}}}},flipfit:{left:function(){K.ui.position.flip.left.apply(this,arguments);K.ui.position.fit.left.apply(this,arguments)},top:function(){K.ui.position.flip.top.apply(this,arguments);K.ui.position.fit.top.apply(this,arguments)}}};(function(){var P,Q,R,U,S,T=document.getElementsByTagName("body")[0],V=document.createElement("div");P=document.createElement(T?"div":"body");R={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};if(T){K.extend(R,{position:"absolute",left:"-1000px",top:"-1000px"})}for(S in R){P.style[S]=R[S]}P.appendChild(V);Q=T||document.documentElement;Q.insertBefore(P,Q.firstChild);V.style.cssText="position: absolute; left: 10.7432222px;";U=K(V).offset().left;K.support.offsetFractions=U>10&&U<11;P.innerHTML="";Q.removeChild(P)})()}(jQuery));(function(B,A){B.widget("ui.draggable",B.ui.mouse,{version:"1.10.4",widgetEventPrefix:"drag",options:{addClasses:true,appendTo:"parent",axis:false,connectToSortable:false,containment:false,cursor:"auto",cursorAt:false,grid:false,handle:false,helper:"original",iframeFix:false,opacity:false,refreshPositions:false,revert:false,revertDuration:500,scope:"default",scroll:true,scrollSensitivity:20,scrollSpeed:20,snap:false,snapMode:"both",snapTolerance:20,stack:false,zIndex:false,drag:null,start:null,stop:null},_create:function(){if(this.options.helper==="original"&&!(/^(?:r|a|f)/).test(this.element.css("position"))){this.element[0].style.position="relative"}if(this.options.addClasses){this.element.addClass("ui-draggable")}if(this.options.disabled){this.element.addClass("ui-draggable-disabled")}this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled");this._mouseDestroy()},_mouseCapture:function(D){var C=this.options;if(this.helper||C.disabled||B(D.target).closest(".ui-resizable-handle").length>0){return false}this.handle=this._getHandle(D);if(!this.handle){return false}B(C.iframeFix===true?"iframe":C.iframeFix).each(function(){B("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1000}).css(B(this).offset()).appendTo("body")});return true},_mouseStart:function(D){var C=this.options;this.helper=this._createHelper(D);this.helper.addClass("ui-draggable-dragging");this._cacheHelperProportions();if(B.ui.ddmanager){B.ui.ddmanager.current=this}this._cacheMargins();this.cssPosition=this.helper.css("position");this.scrollParent=this.helper.scrollParent();this.offsetParent=this.helper.offsetParent();this.offsetParentCssPosition=this.offsetParent.css("position");this.offset=this.positionAbs=this.element.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};this.offset.scroll=false;B.extend(this.offset,{click:{left:D.pageX-this.offset.left,top:D.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.originalPosition=this.position=this._generatePosition(D);this.originalPageX=D.pageX;this.originalPageY=D.pageY;(C.cursorAt&&this._adjustOffsetFromHelper(C.cursorAt));this._setContainment();if(this._trigger("start",D)===false){this._clear();return false}this._cacheHelperProportions();if(B.ui.ddmanager&&!C.dropBehaviour){B.ui.ddmanager.prepareOffsets(this,D)}this._mouseDrag(D,true);if(B.ui.ddmanager){B.ui.ddmanager.dragStart(this,D)}return true},_mouseDrag:function(E,D){if(this.offsetParentCssPosition==="fixed"){this.offset.parent=this._getParentOffset()}this.position=this._generatePosition(E);this.positionAbs=this._convertPositionTo("absolute");if(!D){var C=this._uiHash();if(this._trigger("drag",E,C)===false){this._mouseUp({});return false}this.position=C.position}if(!this.options.axis||this.options.axis!=="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!=="x"){this.helper[0].style.top=this.position.top+"px"}if(B.ui.ddmanager){B.ui.ddmanager.drag(this,E)}return false},_mouseStop:function(E){var D=this,C=false;if(B.ui.ddmanager&&!this.options.dropBehaviour){C=B.ui.ddmanager.drop(this,E)}if(this.dropped){C=this.dropped;this.dropped=false}if(this.options.helper==="original"&&!B.contains(this.element[0].ownerDocument,this.element[0])){return false}if((this.options.revert==="invalid"&&!C)||(this.options.revert==="valid"&&C)||this.options.revert===true||(B.isFunction(this.options.revert)&&this.options.revert.call(this.element,C))){B(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){if(D._trigger("stop",E)!==false){D._clear()}})}else{if(this._trigger("stop",E)!==false){this._clear()}}return false},_mouseUp:function(C){B("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)});if(B.ui.ddmanager){B.ui.ddmanager.dragStop(this,C)}return B.ui.mouse.prototype._mouseUp.call(this,C)},cancel:function(){if(this.helper.is(".ui-draggable-dragging")){this._mouseUp({})}else{this._clear()}return this},_getHandle:function(C){return this.options.handle?!!B(C.target).closest(this.element.find(this.options.handle)).length:true},_createHelper:function(D){var C=this.options,E=B.isFunction(C.helper)?B(C.helper.apply(this.element[0],[D])):(C.helper==="clone"?this.element.clone().removeAttr("id"):this.element);if(!E.parents("body").length){E.appendTo((C.appendTo==="parent"?this.element[0].parentNode:C.appendTo))}if(E[0]!==this.element[0]&&!(/(fixed|absolute)/).test(E.css("position"))){E.css("position","absolute")}return E},_adjustOffsetFromHelper:function(C){if(typeof C==="string"){C=C.split(" ")}if(B.isArray(C)){C={left:+C[0],top:+C[1]||0}}if("left" in C){this.offset.click.left=C.left+this.margins.left}if("right" in C){this.offset.click.left=this.helperProportions.width-C.right+this.margins.left}if("top" in C){this.offset.click.top=C.top+this.margins.top}if("bottom" in C){this.offset.click.top=this.helperProportions.height-C.bottom+this.margins.top}},_getParentOffset:function(){var C=this.offsetParent.offset();if(this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&B.contains(this.scrollParent[0],this.offsetParent[0])){C.left+=this.scrollParent.scrollLeft();C.top+=this.scrollParent.scrollTop()}if((this.offsetParent[0]===document.body)||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&B.ui.ie)){C={top:0,left:0}}return{top:C.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:C.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var C=this.element.position();return{top:C.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:C.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.element.css("marginLeft"),10)||0),top:(parseInt(this.element.css("marginTop"),10)||0),right:(parseInt(this.element.css("marginRight"),10)||0),bottom:(parseInt(this.element.css("marginBottom"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var F,E,C,D=this.options;if(!D.containment){this.containment=null;return}if(D.containment==="window"){this.containment=[B(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,B(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,B(window).scrollLeft()+B(window).width()-this.helperProportions.width-this.margins.left,B(window).scrollTop()+(B(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(D.containment==="document"){this.containment=[0,0,B(document).width()-this.helperProportions.width-this.margins.left,(B(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];return}if(D.containment.constructor===Array){this.containment=D.containment;return}if(D.containment==="parent"){D.containment=this.helper[0].parentNode}E=B(D.containment);C=E[0];if(!C){return}F=E.css("overflow")!=="hidden";this.containment=[(parseInt(E.css("borderLeftWidth"),10)||0)+(parseInt(E.css("paddingLeft"),10)||0),(parseInt(E.css("borderTopWidth"),10)||0)+(parseInt(E.css("paddingTop"),10)||0),(F?Math.max(C.scrollWidth,C.offsetWidth):C.offsetWidth)-(parseInt(E.css("borderRightWidth"),10)||0)-(parseInt(E.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(F?Math.max(C.scrollHeight,C.offsetHeight):C.offsetHeight)-(parseInt(E.css("borderBottomWidth"),10)||0)-(parseInt(E.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom];this.relative_container=E},_convertPositionTo:function(C,D){if(!D){D=this.position}var F=C==="absolute"?1:-1,E=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&B.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent;if(!this.offset.scroll){this.offset.scroll={top:E.scrollTop(),left:E.scrollLeft()}}return{top:(D.top+this.offset.relative.top*F+this.offset.parent.top*F-((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():this.offset.scroll.top)*F)),left:(D.left+this.offset.relative.left*F+this.offset.parent.left*F-((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():this.offset.scroll.left)*F))}},_generatePosition:function(D){var G,C,E,F,H=this.options,I=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&B.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,K=D.pageX,J=D.pageY;if(!this.offset.scroll){this.offset.scroll={top:I.scrollTop(),left:I.scrollLeft()}}if(this.originalPosition){if(this.containment){if(this.relative_container){C=this.relative_container.offset();G=[this.containment[0]+C.left,this.containment[1]+C.top,this.containment[2]+C.left,this.containment[3]+C.top]}else{G=this.containment}if(D.pageX-this.offset.click.left<G[0]){K=G[0]+this.offset.click.left}if(D.pageY-this.offset.click.top<G[1]){J=G[1]+this.offset.click.top}if(D.pageX-this.offset.click.left>G[2]){K=G[2]+this.offset.click.left}if(D.pageY-this.offset.click.top>G[3]){J=G[3]+this.offset.click.top}}if(H.grid){E=H.grid[1]?this.originalPageY+Math.round((J-this.originalPageY)/H.grid[1])*H.grid[1]:this.originalPageY;J=G?((E-this.offset.click.top>=G[1]||E-this.offset.click.top>G[3])?E:((E-this.offset.click.top>=G[1])?E-H.grid[1]:E+H.grid[1])):E;F=H.grid[0]?this.originalPageX+Math.round((K-this.originalPageX)/H.grid[0])*H.grid[0]:this.originalPageX;K=G?((F-this.offset.click.left>=G[0]||F-this.offset.click.left>G[2])?F:((F-this.offset.click.left>=G[0])?F-H.grid[0]:F+H.grid[0])):F}}return{top:(J-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(this.cssPosition==="fixed"?-this.scrollParent.scrollTop():this.offset.scroll.top)),left:(K-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():this.offset.scroll.left))}},_clear:function(){this.helper.removeClass("ui-draggable-dragging");if(this.helper[0]!==this.element[0]&&!this.cancelHelperRemoval){this.helper.remove()}this.helper=null;this.cancelHelperRemoval=false},_trigger:function(C,E,D){D=D||this._uiHash();B.ui.plugin.call(this,C,[E,D]);if(C==="drag"){this.positionAbs=this._convertPositionTo("absolute")}return B.Widget.prototype._trigger.call(this,C,E,D)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}});B.ui.plugin.add("draggable","connectToSortable",{start:function(F,C){var E=B(this).data("ui-draggable"),D=E.options,G=B.extend({},C,{item:E.element});E.sortables=[];B(D.connectToSortable).each(function(){var H=B.data(this,"ui-sortable");if(H&&!H.options.disabled){E.sortables.push({instance:H,shouldRevert:H.options.revert});H.refreshPositions();H._trigger("activate",F,G)}})},stop:function(E,C){var D=B(this).data("ui-draggable"),F=B.extend({},C,{item:D.element});B.each(D.sortables,function(){if(this.instance.isOver){this.instance.isOver=0;D.cancelHelperRemoval=true;this.instance.cancelHelperRemoval=false;if(this.shouldRevert){this.instance.options.revert=this.shouldRevert}this.instance._mouseStop(E);this.instance.options.helper=this.instance.options._helper;if(D.options.helper==="original"){this.instance.currentItem.css({top:"auto",left:"auto"})}}else{this.instance.cancelHelperRemoval=false;this.instance._trigger("deactivate",E,F)}})},drag:function(F,C){var E=B(this).data("ui-draggable"),D=this;B.each(E.sortables,function(){var H=false,G=this;this.instance.positionAbs=E.positionAbs;this.instance.helperProportions=E.helperProportions;this.instance.offset.click=E.offset.click;if(this.instance._intersectsWith(this.instance.containerCache)){H=true;B.each(E.sortables,function(){this.instance.positionAbs=E.positionAbs;this.instance.helperProportions=E.helperProportions;this.instance.offset.click=E.offset.click;if(this!==G&&this.instance._intersectsWith(this.instance.containerCache)&&B.contains(G.instance.element[0],this.instance.element[0])){H=false}return H})}if(H){if(!this.instance.isOver){this.instance.isOver=1;this.instance.currentItem=B(D).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",true);this.instance.options._helper=this.instance.options.helper;this.instance.options.helper=function(){return C.helper[0]};F.target=this.instance.currentItem[0];this.instance._mouseCapture(F,true);this.instance._mouseStart(F,true,true);this.instance.offset.click.top=E.offset.click.top;this.instance.offset.click.left=E.offset.click.left;this.instance.offset.parent.left-=E.offset.parent.left-this.instance.offset.parent.left;this.instance.offset.parent.top-=E.offset.parent.top-this.instance.offset.parent.top;E._trigger("toSortable",F);E.dropped=this.instance.element;E.currentItem=E.element;this.instance.fromOutside=E}if(this.instance.currentItem){this.instance._mouseDrag(F)}}else{if(this.instance.isOver){this.instance.isOver=0;this.instance.cancelHelperRemoval=true;this.instance.options.revert=false;this.instance._trigger("out",F,this.instance._uiHash(this.instance));this.instance._mouseStop(F,true);this.instance.options.helper=this.instance.options._helper;this.instance.currentItem.remove();if(this.instance.placeholder){this.instance.placeholder.remove()}E._trigger("fromSortable",F);E.dropped=false}}})}});B.ui.plugin.add("draggable","cursor",{start:function(){var D=B("body"),C=B(this).data("ui-draggable").options;if(D.css("cursor")){C._cursor=D.css("cursor")}D.css("cursor",C.cursor)},stop:function(){var C=B(this).data("ui-draggable").options;if(C._cursor){B("body").css("cursor",C._cursor)}}});B.ui.plugin.add("draggable","opacity",{start:function(E,C){var F=B(C.helper),D=B(this).data("ui-draggable").options;if(F.css("opacity")){D._opacity=F.css("opacity")}F.css("opacity",D.opacity)},stop:function(E,C){var D=B(this).data("ui-draggable").options;if(D._opacity){B(C.helper).css("opacity",D._opacity)}}});B.ui.plugin.add("draggable","scroll",{start:function(){var C=B(this).data("ui-draggable");if(C.scrollParent[0]!==document&&C.scrollParent[0].tagName!=="HTML"){C.overflowOffset=C.scrollParent.offset()}},drag:function(F){var C=B(this).data("ui-draggable"),D=C.options,E=false;if(C.scrollParent[0]!==document&&C.scrollParent[0].tagName!=="HTML"){if(!D.axis||D.axis!=="x"){if((C.overflowOffset.top+C.scrollParent[0].offsetHeight)-F.pageY<D.scrollSensitivity){C.scrollParent[0].scrollTop=E=C.scrollParent[0].scrollTop+D.scrollSpeed}else{if(F.pageY-C.overflowOffset.top<D.scrollSensitivity){C.scrollParent[0].scrollTop=E=C.scrollParent[0].scrollTop-D.scrollSpeed}}}if(!D.axis||D.axis!=="y"){if((C.overflowOffset.left+C.scrollParent[0].offsetWidth)-F.pageX<D.scrollSensitivity){C.scrollParent[0].scrollLeft=E=C.scrollParent[0].scrollLeft+D.scrollSpeed}else{if(F.pageX-C.overflowOffset.left<D.scrollSensitivity){C.scrollParent[0].scrollLeft=E=C.scrollParent[0].scrollLeft-D.scrollSpeed}}}}else{if(!D.axis||D.axis!=="x"){if(F.pageY-B(document).scrollTop()<D.scrollSensitivity){E=B(document).scrollTop(B(document).scrollTop()-D.scrollSpeed)}else{if(B(window).height()-(F.pageY-B(document).scrollTop())<D.scrollSensitivity){E=B(document).scrollTop(B(document).scrollTop()+D.scrollSpeed)}}}if(!D.axis||D.axis!=="y"){if(F.pageX-B(document).scrollLeft()<D.scrollSensitivity){E=B(document).scrollLeft(B(document).scrollLeft()-D.scrollSpeed)}else{if(B(window).width()-(F.pageX-B(document).scrollLeft())<D.scrollSensitivity){E=B(document).scrollLeft(B(document).scrollLeft()+D.scrollSpeed)}}}}if(E!==false&&B.ui.ddmanager&&!D.dropBehaviour){B.ui.ddmanager.prepareOffsets(C,F)}}});B.ui.plugin.add("draggable","snap",{start:function(){var C=B(this).data("ui-draggable"),D=C.options;C.snapElements=[];B(D.snap.constructor!==String?(D.snap.items||":data(ui-draggable)"):D.snap).each(function(){var F=B(this),E=F.offset();if(this!==C.element[0]){C.snapElements.push({item:this,width:F.outerWidth(),height:F.outerHeight(),top:E.top,left:E.left})}})},drag:function(O,G){var E,I,J,U,K,C,F,M,H,D,L=B(this).data("ui-draggable"),R=L.options,N=R.snapTolerance,P=G.offset.left,S=P+L.helperProportions.width,Q=G.offset.top,T=Q+L.helperProportions.height;for(H=L.snapElements.length-1;H>=0;H--){K=L.snapElements[H].left;C=K+L.snapElements[H].width;F=L.snapElements[H].top;M=F+L.snapElements[H].height;if(S<K-N||P>C+N||T<F-N||Q>M+N||!B.contains(L.snapElements[H].item.ownerDocument,L.snapElements[H].item)){if(L.snapElements[H].snapping){(L.options.snap.release&&L.options.snap.release.call(L.element,O,B.extend(L._uiHash(),{snapItem:L.snapElements[H].item})))}L.snapElements[H].snapping=false;continue}if(R.snapMode!=="inner"){E=Math.abs(F-T)<=N;I=Math.abs(M-Q)<=N;J=Math.abs(K-S)<=N;U=Math.abs(C-P)<=N;if(E){G.position.top=L._convertPositionTo("relative",{top:F-L.helperProportions.height,left:0}).top-L.margins.top}if(I){G.position.top=L._convertPositionTo("relative",{top:M,left:0}).top-L.margins.top}if(J){G.position.left=L._convertPositionTo("relative",{top:0,left:K-L.helperProportions.width}).left-L.margins.left}if(U){G.position.left=L._convertPositionTo("relative",{top:0,left:C}).left-L.margins.left}}D=(E||I||J||U);if(R.snapMode!=="outer"){E=Math.abs(F-Q)<=N;I=Math.abs(M-T)<=N;J=Math.abs(K-P)<=N;U=Math.abs(C-S)<=N;if(E){G.position.top=L._convertPositionTo("relative",{top:F,left:0}).top-L.margins.top}if(I){G.position.top=L._convertPositionTo("relative",{top:M-L.helperProportions.height,left:0}).top-L.margins.top}if(J){G.position.left=L._convertPositionTo("relative",{top:0,left:K}).left-L.margins.left}if(U){G.position.left=L._convertPositionTo("relative",{top:0,left:C-L.helperProportions.width}).left-L.margins.left}}if(!L.snapElements[H].snapping&&(E||I||J||U||D)){(L.options.snap.snap&&L.options.snap.snap.call(L.element,O,B.extend(L._uiHash(),{snapItem:L.snapElements[H].item})))}L.snapElements[H].snapping=(E||I||J||U||D)}}});B.ui.plugin.add("draggable","stack",{start:function(){var C,E=this.data("ui-draggable").options,D=B.makeArray(B(E.stack)).sort(function(G,F){return(parseInt(B(G).css("zIndex"),10)||0)-(parseInt(B(F).css("zIndex"),10)||0)});if(!D.length){return}C=parseInt(B(D[0]).css("zIndex"),10)||0;B(D).each(function(F){B(this).css("zIndex",C+F)});this.css("zIndex",(C+D.length))}});B.ui.plugin.add("draggable","zIndex",{start:function(E,C){var F=B(C.helper),D=B(this).data("ui-draggable").options;if(F.css("zIndex")){D._zIndex=F.css("zIndex")}F.css("zIndex",D.zIndex)},stop:function(E,C){var D=B(this).data("ui-draggable").options;if(D._zIndex){B(C.helper).css("zIndex",D._zIndex)}}})})(jQuery);(function(C,B){function A(F,E,D){return(F>E)&&(F<(E+D))}C.widget("ui.droppable",{version:"1.10.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:false,addClasses:true,greedy:false,hoverClass:false,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var D,E=this.options,F=E.accept;this.isover=false;this.isout=true;this.accept=C.isFunction(F)?F:function(G){return G.is(F)};this.proportions=function(){if(arguments.length){D=arguments[0]}else{return D?D:D={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}}};C.ui.ddmanager.droppables[E.scope]=C.ui.ddmanager.droppables[E.scope]||[];C.ui.ddmanager.droppables[E.scope].push(this);(E.addClasses&&this.element.addClass("ui-droppable"))},_destroy:function(){var D=0,E=C.ui.ddmanager.droppables[this.options.scope];for(;D<E.length;D++){if(E[D]===this){E.splice(D,1)}}this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(D,E){if(D==="accept"){this.accept=C.isFunction(E)?E:function(F){return F.is(E)}}C.Widget.prototype._setOption.apply(this,arguments)},_activate:function(E){var D=C.ui.ddmanager.current;if(this.options.activeClass){this.element.addClass(this.options.activeClass)}if(D){this._trigger("activate",E,this.ui(D))}},_deactivate:function(E){var D=C.ui.ddmanager.current;if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(D){this._trigger("deactivate",E,this.ui(D))}},_over:function(E){var D=C.ui.ddmanager.current;if(!D||(D.currentItem||D.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],(D.currentItem||D.element))){if(this.options.hoverClass){this.element.addClass(this.options.hoverClass)}this._trigger("over",E,this.ui(D))}},_out:function(E){var D=C.ui.ddmanager.current;if(!D||(D.currentItem||D.element)[0]===this.element[0]){return}if(this.accept.call(this.element[0],(D.currentItem||D.element))){if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("out",E,this.ui(D))}},_drop:function(G,D){var E=D||C.ui.ddmanager.current,F=false;if(!E||(E.currentItem||E.element)[0]===this.element[0]){return false}this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var H=C.data(this,"ui-droppable");if(H.options.greedy&&!H.options.disabled&&H.options.scope===E.options.scope&&H.accept.call(H.element[0],(E.currentItem||E.element))&&C.ui.intersect(E,C.extend(H,{offset:H.element.offset()}),H.options.tolerance)){F=true;return false}});if(F){return false}if(this.accept.call(this.element[0],(E.currentItem||E.element))){if(this.options.activeClass){this.element.removeClass(this.options.activeClass)}if(this.options.hoverClass){this.element.removeClass(this.options.hoverClass)}this._trigger("drop",G,this.ui(E));return this.element}return false},ui:function(D){return{draggable:(D.currentItem||D.element),helper:D.helper,position:D.position,offset:D.positionAbs}}});C.ui.intersect=function(I,L,M){if(!L.offset){return false}var E,F,N=(I.positionAbs||I.position.absolute).left,G=(I.positionAbs||I.position.absolute).top,K=N+I.helperProportions.width,J=G+I.helperProportions.height,P=L.offset.left,H=L.offset.top,D=P+L.proportions().width,O=H+L.proportions().height;switch(M){case"fit":return(P<=N&&K<=D&&H<=G&&J<=O);case"intersect":return(P<N+(I.helperProportions.width/2)&&K-(I.helperProportions.width/2)<D&&H<G+(I.helperProportions.height/2)&&J-(I.helperProportions.height/2)<O);case"pointer":E=((I.positionAbs||I.position.absolute).left+(I.clickOffset||I.offset.click).left);F=((I.positionAbs||I.position.absolute).top+(I.clickOffset||I.offset.click).top);return A(F,H,L.proportions().height)&&A(E,P,L.proportions().width);case"touch":return((G>=H&&G<=O)||(J>=H&&J<=O)||(G<H&&J>O))&&((N>=P&&N<=D)||(K>=P&&K<=D)||(N<P&&K>D));default:return false}};C.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(I,H){var E,J,G=C.ui.ddmanager.droppables[I.options.scope]||[],D=H?H.type:null,F=(I.currentItem||I.element).find(":data(ui-droppable)").addBack();droppablesLoop:for(E=0;E<G.length;E++){if(G[E].options.disabled||(I&&!G[E].accept.call(G[E].element[0],(I.currentItem||I.element)))){continue}for(J=0;J<F.length;J++){if(F[J]===G[E].element[0]){G[E].proportions().height=0;continue droppablesLoop}}G[E].visible=G[E].element.css("display")!=="none";if(!G[E].visible){continue}if(D==="mousedown"){G[E]._activate.call(G[E],H)}G[E].offset=G[E].element.offset();G[E].proportions({width:G[E].element[0].offsetWidth,height:G[E].element[0].offsetHeight})}},drop:function(D,F){var E=false;C.each((C.ui.ddmanager.droppables[D.options.scope]||[]).slice(),function(){if(!this.options){return}if(!this.options.disabled&&this.visible&&C.ui.intersect(D,this,this.options.tolerance)){E=this._drop.call(this,F)||E}if(!this.options.disabled&&this.visible&&this.accept.call(this.element[0],(D.currentItem||D.element))){this.isout=true;this.isover=false;this._deactivate.call(this,F)}});return E},dragStart:function(D,E){D.element.parentsUntil("body").bind("scroll.droppable",function(){if(!D.options.refreshPositions){C.ui.ddmanager.prepareOffsets(D,E)}})},drag:function(D,E){if(D.options.refreshPositions){C.ui.ddmanager.prepareOffsets(D,E)}C.each(C.ui.ddmanager.droppables[D.options.scope]||[],function(){if(this.options.disabled||this.greedyChild||!this.visible){return}var F,G,H,J=C.ui.intersect(D,this,this.options.tolerance),I=!J&&this.isover?"isout":(J&&!this.isover?"isover":null);if(!I){return}if(this.options.greedy){G=this.options.scope;H=this.element.parents(":data(ui-droppable)").filter(function(){return C.data(this,"ui-droppable").options.scope===G});if(H.length){F=C.data(H[0],"ui-droppable");F.greedyChild=(I==="isover")}}if(F&&I==="isover"){F.isover=false;F.isout=true;F._out.call(F,E)}this[I]=true;this[I==="isout"?"isover":"isout"]=false;this[I==="isover"?"_over":"_out"].call(this,E);if(F&&I==="isout"){F.isout=false;F.isover=true;F._over.call(F,E)}})},dragStop:function(D,E){D.element.parentsUntil("body").unbind("scroll.droppable");if(!D.options.refreshPositions){C.ui.ddmanager.prepareOffsets(D,E)}}}})(jQuery);(function(D,B){function C(E){return parseInt(E,10)||0}function A(E){return !isNaN(parseInt(E,10))}D.widget("ui.resizable",D.ui.mouse,{version:"1.10.4",widgetEventPrefix:"resize",options:{alsoResize:false,animate:false,animateDuration:"slow",animateEasing:"swing",aspectRatio:false,autoHide:false,containment:false,ghost:false,grid:false,handles:"e,s,se",helper:false,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var G,F,E,K,J,H=this,I=this.options;this.element.addClass("ui-resizable");D.extend(this,{_aspectRatio:!!(I.aspectRatio),aspectRatio:I.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:I.helper||I.ghost||I.animate?I.helper||"ui-resizable-helper":null});if(this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)){this.element.wrap(D("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")}));this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable"));this.elementIsWrapper=true;this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")});this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0});this.originalResizeStyle=this.originalElement.css("resize");this.originalElement.css("resize","none");this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"}));this.originalElement.css({margin:this.originalElement.css("margin")});this._proportionallyResize()}this.handles=I.handles||(!D(".ui-resizable-handle",this.element).length?"e,s,se":{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"});if(this.handles.constructor===String){if(this.handles==="all"){this.handles="n,e,s,w,se,sw,ne,nw"}G=this.handles.split(",");this.handles={};for(F=0;F<G.length;F++){E=D.trim(G[F]);J="ui-resizable-"+E;K=D("<div class='ui-resizable-handle "+J+"'></div>");K.css({zIndex:I.zIndex});if("se"===E){K.addClass("ui-icon ui-icon-gripsmall-diagonal-se")}this.handles[E]=".ui-resizable-"+E;this.element.append(K)}}this._renderAxis=function(O){var L,P,M,N;O=O||this.element;for(L in this.handles){if(this.handles[L].constructor===String){this.handles[L]=D(this.handles[L],this.element).show()}if(this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)){P=D(this.handles[L],this.element);N=/sw|ne|nw|se|n|s/.test(L)?P.outerHeight():P.outerWidth();M=["padding",/ne|nw|n/.test(L)?"Top":/se|sw|s/.test(L)?"Bottom":/^e$/.test(L)?"Right":"Left"].join("");O.css(M,N);this._proportionallyResize()}if(!D(this.handles[L]).length){continue}}};this._renderAxis(this.element);this._handles=D(".ui-resizable-handle",this.element).disableSelection();this._handles.mouseover(function(){if(!H.resizing){if(this.className){K=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)}H.axis=K&&K[1]?K[1]:"se"}});if(I.autoHide){this._handles.hide();D(this.element).addClass("ui-resizable-autohide").mouseenter(function(){if(I.disabled){return}D(this).removeClass("ui-resizable-autohide");H._handles.show()}).mouseleave(function(){if(I.disabled){return}if(!H.resizing){D(this).addClass("ui-resizable-autohide");H._handles.hide()}})}this._mouseInit()},_destroy:function(){this._mouseDestroy();var E,F=function(G){D(G).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};if(this.elementIsWrapper){F(this.element);E=this.element;this.originalElement.css({position:E.css("position"),width:E.outerWidth(),height:E.outerHeight(),top:E.css("top"),left:E.css("left")}).insertAfter(E);E.remove()}this.originalElement.css("resize",this.originalResizeStyle);F(this.originalElement);return this},_mouseCapture:function(G){var F,E,H=false;for(F in this.handles){E=D(this.handles[F])[0];if(E===G.target||D.contains(E,G.target)){H=true}}return !this.options.disabled&&H},_mouseStart:function(I){var H,J,E,F=this.options,G=this.element.position(),K=this.element;this.resizing=true;if((/absolute/).test(K.css("position"))){K.css({position:"absolute",top:K.css("top"),left:K.css("left")})}else{if(K.is(".ui-draggable")){K.css({position:"absolute",top:G.top,left:G.left})}}this._renderProxy();H=C(this.helper.css("left"));J=C(this.helper.css("top"));if(F.containment){H+=D(F.containment).scrollLeft()||0;J+=D(F.containment).scrollTop()||0}this.offset=this.helper.offset();this.position={left:H,top:J};this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:K.width(),height:K.height()};this.originalSize=this._helper?{width:K.outerWidth(),height:K.outerHeight()}:{width:K.width(),height:K.height()};this.originalPosition={left:H,top:J};this.sizeDiff={width:K.outerWidth()-K.width(),height:K.outerHeight()-K.height()};this.originalMousePosition={left:I.pageX,top:I.pageY};this.aspectRatio=(typeof F.aspectRatio==="number")?F.aspectRatio:((this.originalSize.width/this.originalSize.height)||1);E=D(".ui-resizable-"+this.axis).css("cursor");D("body").css("cursor",E==="auto"?this.axis+"-resize":E);K.addClass("ui-resizable-resizing");this._propagate("start",I);return true},_mouseDrag:function(G){var F,I=this.helper,H={},P=this.originalMousePosition,O=this.axis,Q=this.position.top,J=this.position.left,M=this.size.width,N=this.size.height,K=(G.pageX-P.left)||0,L=(G.pageY-P.top)||0,E=this._change[O];if(!E){return false}F=E.apply(this,[G,K,L]);this._updateVirtualBoundaries(G.shiftKey);if(this._aspectRatio||G.shiftKey){F=this._updateRatio(F,G)}F=this._respectSize(F,G);this._updateCache(F);this._propagate("resize",G);if(this.position.top!==Q){H.top=this.position.top+"px"}if(this.position.left!==J){H.left=this.position.left+"px"}if(this.size.width!==M){H.width=this.size.width+"px"}if(this.size.height!==N){H.height=this.size.height+"px"}I.css(H);if(!this._helper&&this._proportionallyResizeElements.length){this._proportionallyResize()}if(!D.isEmptyObject(H)){this._trigger("resize",G,this.ui())}return false},_mouseStop:function(H){this.resizing=false;var F,E,L,N,G,J,I,M=this.options,K=this;if(this._helper){F=this._proportionallyResizeElements;E=F.length&&(/textarea/i).test(F[0].nodeName);L=E&&D.ui.hasScroll(F[0],"left")?0:K.sizeDiff.height;N=E?0:K.sizeDiff.width;G={width:(K.helper.width()-N),height:(K.helper.height()-L)};J=(parseInt(K.element.css("left"),10)+(K.position.left-K.originalPosition.left))||null;I=(parseInt(K.element.css("top"),10)+(K.position.top-K.originalPosition.top))||null;if(!M.animate){this.element.css(D.extend(G,{top:I,left:J}))}K.helper.height(K.size.height);K.helper.width(K.size.width);if(this._helper&&!M.animate){this._proportionallyResize()}}D("body").css("cursor","auto");this.element.removeClass("ui-resizable-resizing");this._propagate("stop",H);if(this._helper){this.helper.remove()}return false},_updateVirtualBoundaries:function(H){var I,J,G,F,K,E=this.options;K={minWidth:A(E.minWidth)?E.minWidth:0,maxWidth:A(E.maxWidth)?E.maxWidth:Infinity,minHeight:A(E.minHeight)?E.minHeight:0,maxHeight:A(E.maxHeight)?E.maxHeight:Infinity};if(this._aspectRatio||H){I=K.minHeight*this.aspectRatio;G=K.minWidth/this.aspectRatio;J=K.maxHeight*this.aspectRatio;F=K.maxWidth/this.aspectRatio;if(I>K.minWidth){K.minWidth=I}if(G>K.minHeight){K.minHeight=G}if(J<K.maxWidth){K.maxWidth=J}if(F<K.maxHeight){K.maxHeight=F}}this._vBoundaries=K},_updateCache:function(E){this.offset=this.helper.offset();if(A(E.left)){this.position.left=E.left}if(A(E.top)){this.position.top=E.top}if(A(E.height)){this.size.height=E.height}if(A(E.width)){this.size.width=E.width}},_updateRatio:function(H){var F=this.position,E=this.size,G=this.axis;if(A(H.height)){H.width=(H.height*this.aspectRatio)}else{if(A(H.width)){H.height=(H.width/this.aspectRatio)}}if(G==="sw"){H.left=F.left+(E.width-H.width);H.top=null}if(G==="nw"){H.top=F.top+(E.height-H.height);H.left=F.left+(E.width-H.width)}return H},_respectSize:function(H){var L=this._vBoundaries,O=this.axis,J=A(H.width)&&L.maxWidth&&(L.maxWidth<H.width),F=A(H.height)&&L.maxHeight&&(L.maxHeight<H.height),K=A(H.width)&&L.minWidth&&(L.minWidth>H.width),G=A(H.height)&&L.minHeight&&(L.minHeight>H.height),I=this.originalPosition.left+this.originalSize.width,M=this.position.top+this.size.height,E=/sw|nw|w/.test(O),N=/nw|ne|n/.test(O);if(K){H.width=L.minWidth}if(G){H.height=L.minHeight}if(J){H.width=L.maxWidth}if(F){H.height=L.maxHeight}if(K&&E){H.left=I-L.minWidth}if(J&&E){H.left=I-L.maxWidth}if(G&&N){H.top=M-L.minHeight}if(F&&N){H.top=M-L.maxHeight}if(!H.width&&!H.height&&!H.left&&H.top){H.top=null}else{if(!H.width&&!H.height&&!H.top&&H.left){H.left=null}}return H},_proportionallyResize:function(){if(!this._proportionallyResizeElements.length){return}var F,J,G,E,H,I=this.helper||this.element;for(F=0;F<this._proportionallyResizeElements.length;F++){H=this._proportionallyResizeElements[F];if(!this.borderDif){this.borderDif=[];G=[H.css("borderTopWidth"),H.css("borderRightWidth"),H.css("borderBottomWidth"),H.css("borderLeftWidth")];E=[H.css("paddingTop"),H.css("paddingRight"),H.css("paddingBottom"),H.css("paddingLeft")];for(J=0;J<G.length;J++){this.borderDif[J]=(parseInt(G[J],10)||0)+(parseInt(E[J],10)||0)}}H.css({height:(I.height()-this.borderDif[0]-this.borderDif[2])||0,width:(I.width()-this.borderDif[1]-this.borderDif[3])||0})}},_renderProxy:function(){var E=this.element,F=this.options;this.elementOffset=E.offset();if(this._helper){this.helper=this.helper||D("<div style='overflow:hidden;'></div>");this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++F.zIndex});this.helper.appendTo("body").disableSelection()}else{this.helper=this.element}},_change:{e:function(F,E){return{width:this.originalSize.width+E}},w:function(G,F){var H=this.originalSize,E=this.originalPosition;return{left:E.left+F,width:H.width-F}},n:function(H,G,E){var I=this.originalSize,F=this.originalPosition;return{top:F.top+E,height:I.height-E}},s:function(G,F,E){return{height:this.originalSize.height+E}},se:function(G,F,E){return D.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[G,F,E]))},sw:function(G,F,E){return D.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[G,F,E]))},ne:function(G,F,E){return D.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[G,F,E]))},nw:function(G,F,E){return D.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[G,F,E]))}},_propagate:function(E,F){D.ui.plugin.call(this,E,[F,this.ui()]);(E!=="resize"&&this._trigger(E,F,this.ui()))},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}});D.ui.plugin.add("resizable","animate",{stop:function(H){var K=D(this).data("ui-resizable"),L=K.options,M=K._proportionallyResizeElements,E=M.length&&(/textarea/i).test(M[0].nodeName),F=E&&D.ui.hasScroll(M[0],"left")?0:K.sizeDiff.height,N=E?0:K.sizeDiff.width,J={width:(K.size.width-N),height:(K.size.height-F)},G=(parseInt(K.element.css("left"),10)+(K.position.left-K.originalPosition.left))||null,I=(parseInt(K.element.css("top"),10)+(K.position.top-K.originalPosition.top))||null;K.element.animate(D.extend(J,I&&G?{top:I,left:G}:{}),{duration:L.animateDuration,easing:L.animateEasing,step:function(){var O={width:parseInt(K.element.css("width"),10),height:parseInt(K.element.css("height"),10),top:parseInt(K.element.css("top"),10),left:parseInt(K.element.css("left"),10)};if(M&&M.length){D(M[0]).css({width:O.width,height:O.height})}K._updateCache(O);K._propagate("resize",H)}})}});D.ui.plugin.add("resizable","containment",{start:function(){var E,G,H,I,O,L,F,J=D(this).data("ui-resizable"),K=J.options,M=J.element,P=K.containment,N=(P instanceof D)?P.get(0):(/parent/.test(P))?M.parent().get(0):P;if(!N){return}J.containerElement=D(N);if(/document/.test(P)||P===document){J.containerOffset={left:0,top:0};J.containerPosition={left:0,top:0};J.parentData={element:D(document),left:0,top:0,width:D(document).width(),height:D(document).height()||document.body.parentNode.scrollHeight}}else{E=D(N);G=[];D(["Top","Right","Left","Bottom"]).each(function(Q,R){G[Q]=C(E.css("padding"+R))});J.containerOffset=E.offset();J.containerPosition=E.position();J.containerSize={height:(E.innerHeight()-G[3]),width:(E.innerWidth()-G[1])};H=J.containerOffset;I=J.containerSize.height;O=J.containerSize.width;L=(D.ui.hasScroll(N,"left")?N.scrollWidth:O);F=(D.ui.hasScroll(N)?N.scrollHeight:I);J.parentData={element:N,left:H.left,top:H.top,width:L,height:F}}},resize:function(I){var N,K,E,G,L=D(this).data("ui-resizable"),M=L.options,H=L.containerOffset,P=L.position,O=L._aspectRatio||I.shiftKey,J={top:0,left:0},F=L.containerElement;if(F[0]!==document&&(/static/).test(F.css("position"))){J=H}if(P.left<(L._helper?H.left:0)){L.size.width=L.size.width+(L._helper?(L.position.left-H.left):(L.position.left-J.left));if(O){L.size.height=L.size.width/L.aspectRatio}L.position.left=M.helper?H.left:0}if(P.top<(L._helper?H.top:0)){L.size.height=L.size.height+(L._helper?(L.position.top-H.top):L.position.top);if(O){L.size.width=L.size.height*L.aspectRatio}L.position.top=L._helper?H.top:0}L.offset.left=L.parentData.left+L.position.left;L.offset.top=L.parentData.top+L.position.top;N=Math.abs((L._helper?L.offset.left-J.left:(L.offset.left-J.left))+L.sizeDiff.width);K=Math.abs((L._helper?L.offset.top-J.top:(L.offset.top-H.top))+L.sizeDiff.height);E=L.containerElement.get(0)===L.element.parent().get(0);G=/relative|absolute/.test(L.containerElement.css("position"));if(E&&G){N-=Math.abs(L.parentData.left)}if(N+L.size.width>=L.parentData.width){L.size.width=L.parentData.width-N;if(O){L.size.height=L.size.width/L.aspectRatio}}if(K+L.size.height>=L.parentData.height){L.size.height=L.parentData.height-K;if(O){L.size.width=L.size.height*L.aspectRatio}}},stop:function(){var I=D(this).data("ui-resizable"),J=I.options,G=I.containerOffset,H=I.containerPosition,L=I.containerElement,M=D(I.helper),E=M.offset(),F=M.outerWidth()-I.sizeDiff.width,K=M.outerHeight()-I.sizeDiff.height;if(I._helper&&!J.animate&&(/relative/).test(L.css("position"))){D(this).css({left:E.left-H.left-G.left,width:F,height:K})}if(I._helper&&!J.animate&&(/static/).test(L.css("position"))){D(this).css({left:E.left-H.left-G.left,width:F,height:K})}}});D.ui.plugin.add("resizable","alsoResize",{start:function(){var E=D(this).data("ui-resizable"),F=E.options,G=function(H){D(H).each(function(){var I=D(this);I.data("ui-resizable-alsoresize",{width:parseInt(I.width(),10),height:parseInt(I.height(),10),left:parseInt(I.css("left"),10),top:parseInt(I.css("top"),10)})})};if(typeof(F.alsoResize)==="object"&&!F.alsoResize.parentNode){if(F.alsoResize.length){F.alsoResize=F.alsoResize[0];G(F.alsoResize)}else{D.each(F.alsoResize,function(H){G(H)})}}else{G(F.alsoResize)}},resize:function(G,E){var H=D(this).data("ui-resizable"),I=H.options,L=H.originalSize,K=H.originalPosition,J={height:(H.size.height-L.height)||0,width:(H.size.width-L.width)||0,top:(H.position.top-K.top)||0,left:(H.position.left-K.left)||0},F=function(M,N){D(M).each(function(){var O=D(this),R=D(this).data("ui-resizable-alsoresize"),P={},Q=N&&N.length?N:O.parents(E.originalElement[0]).length?["width","height"]:["width","height","top","left"];D.each(Q,function(S,T){var U=(R[T]||0)+(J[T]||0);if(U&&U>=0){P[T]=U||null}});O.css(P)})};if(typeof(I.alsoResize)==="object"&&!I.alsoResize.nodeType){D.each(I.alsoResize,function(M,N){F(M,N)})}else{F(I.alsoResize)}},stop:function(){D(this).removeData("resizable-alsoresize")}});D.ui.plugin.add("resizable","ghost",{start:function(){var E=D(this).data("ui-resizable"),F=E.options,G=E.size;E.ghost=E.originalElement.clone();E.ghost.css({opacity:0.25,display:"block",position:"relative",height:G.height,width:G.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass(typeof F.ghost==="string"?F.ghost:"");E.ghost.appendTo(E.helper)},resize:function(){var E=D(this).data("ui-resizable");if(E.ghost){E.ghost.css({position:"relative",height:E.size.height,width:E.size.width})}},stop:function(){var E=D(this).data("ui-resizable");if(E.ghost&&E.helper){E.helper.get(0).removeChild(E.ghost.get(0))}}});D.ui.plugin.add("resizable","grid",{resize:function(){var S=D(this).data("ui-resizable"),J=S.options,K=S.size,I=S.originalSize,R=S.originalPosition,M=S.axis,E=typeof J.grid==="number"?[J.grid,J.grid]:J.grid,T=(E[0]||1),G=(E[1]||1),F=Math.round((K.width-I.width)/T)*T,O=Math.round((K.height-I.height)/G)*G,N=I.width+F,Q=I.height+O,U=J.maxWidth&&(J.maxWidth<N),H=J.maxHeight&&(J.maxHeight<Q),P=J.minWidth&&(J.minWidth>N),L=J.minHeight&&(J.minHeight>Q);J.grid=E;if(P){N=N+T}if(L){Q=Q+G}if(U){N=N-T}if(H){Q=Q-G}if(/^(se|s|e)$/.test(M)){S.size.width=N;S.size.height=Q}else{if(/^(ne)$/.test(M)){S.size.width=N;S.size.height=Q;S.position.top=R.top-O}else{if(/^(sw)$/.test(M)){S.size.width=N;S.size.height=Q;S.position.left=R.left-F}else{if(Q-G>0){S.size.height=Q;S.position.top=R.top-O}else{S.size.height=G;S.position.top=R.top+I.height-G}if(N-T>0){S.size.width=N;S.position.left=R.left-F}else{S.size.width=T;S.position.left=R.left+I.width-T}}}}}})})(jQuery);(function(B,A){B.widget("ui.selectable",B.ui.mouse,{version:"1.10.4",options:{appendTo:"body",autoRefresh:true,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var D,C=this;this.element.addClass("ui-selectable");this.dragged=false;this.refresh=function(){D=B(C.options.filter,C.element[0]);D.addClass("ui-selectee");D.each(function(){var E=B(this),F=E.offset();B.data(this,"selectable-item",{element:this,$element:E,left:F.left,top:F.top,right:F.left+E.outerWidth(),bottom:F.top+E.outerHeight(),startselected:false,selected:E.hasClass("ui-selected"),selecting:E.hasClass("ui-selecting"),unselecting:E.hasClass("ui-unselecting")})})};this.refresh();this.selectees=D.addClass("ui-selectee");this._mouseInit();this.helper=B("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item");this.element.removeClass("ui-selectable ui-selectable-disabled");this._mouseDestroy()},_mouseStart:function(E){var C=this,D=this.options;this.opos=[E.pageX,E.pageY];if(this.options.disabled){return}this.selectees=B(D.filter,this.element[0]);this._trigger("start",E);B(D.appendTo).append(this.helper);this.helper.css({"left":E.pageX,"top":E.pageY,"width":0,"height":0});if(D.autoRefresh){this.refresh()}this.selectees.filter(".ui-selected").each(function(){var F=B.data(this,"selectable-item");F.startselected=true;if(!E.metaKey&&!E.ctrlKey){F.$element.removeClass("ui-selected");F.selected=false;F.$element.addClass("ui-unselecting");F.unselecting=true;C._trigger("unselecting",E,{unselecting:F.element})}});B(E.target).parents().addBack().each(function(){var G,F=B.data(this,"selectable-item");if(F){G=(!E.metaKey&&!E.ctrlKey)||!F.$element.hasClass("ui-selected");F.$element.removeClass(G?"ui-unselecting":"ui-selected").addClass(G?"ui-selecting":"ui-unselecting");F.unselecting=!G;F.selecting=G;F.selected=G;if(G){C._trigger("selecting",E,{selecting:F.element})}else{C._trigger("unselecting",E,{unselecting:F.element})}return false}})},_mouseDrag:function(F){this.dragged=true;if(this.options.disabled){return}var G,H=this,I=this.options,C=this.opos[0],D=this.opos[1],E=F.pageX,J=F.pageY;if(C>E){G=E;E=C;C=G}if(D>J){G=J;J=D;D=G}this.helper.css({left:C,top:D,width:E-C,height:J-D});this.selectees.each(function(){var K=B.data(this,"selectable-item"),L=false;if(!K||K.element===H.element[0]){return}if(I.tolerance==="touch"){L=(!(K.left>E||K.right<C||K.top>J||K.bottom<D))}else{if(I.tolerance==="fit"){L=(K.left>C&&K.right<E&&K.top>D&&K.bottom<J)}}if(L){if(K.selected){K.$element.removeClass("ui-selected");K.selected=false}if(K.unselecting){K.$element.removeClass("ui-unselecting");K.unselecting=false}if(!K.selecting){K.$element.addClass("ui-selecting");K.selecting=true;H._trigger("selecting",F,{selecting:K.element})}}else{if(K.selecting){if((F.metaKey||F.ctrlKey)&&K.startselected){K.$element.removeClass("ui-selecting");K.selecting=false;K.$element.addClass("ui-selected");K.selected=true}else{K.$element.removeClass("ui-selecting");K.selecting=false;if(K.startselected){K.$element.addClass("ui-unselecting");K.unselecting=true}H._trigger("unselecting",F,{unselecting:K.element})}}if(K.selected){if(!F.metaKey&&!F.ctrlKey&&!K.startselected){K.$element.removeClass("ui-selected");K.selected=false;K.$element.addClass("ui-unselecting");K.unselecting=true;H._trigger("unselecting",F,{unselecting:K.element})}}}});return false},_mouseStop:function(D){var C=this;this.dragged=false;B(".ui-unselecting",this.element[0]).each(function(){var E=B.data(this,"selectable-item");E.$element.removeClass("ui-unselecting");E.unselecting=false;E.startselected=false;C._trigger("unselected",D,{unselected:E.element})});B(".ui-selecting",this.element[0]).each(function(){var E=B.data(this,"selectable-item");E.$element.removeClass("ui-selecting").addClass("ui-selected");E.selecting=false;E.selected=true;E.startselected=true;C._trigger("selected",D,{selected:E.element})});this._trigger("stop",D);this.helper.remove();return false}})})(jQuery);(function(D,B){function A(G,F,E){return(G>F)&&(G<(F+E))}function C(E){return(/left|right/).test(E.css("float"))||(/inline|table-cell/).test(E.css("display"))}D.widget("ui.sortable",D.ui.mouse,{version:"1.10.4",widgetEventPrefix:"sort",ready:false,options:{appendTo:"parent",axis:false,connectWith:false,containment:false,cursor:"auto",cursorAt:false,dropOnEmpty:true,forcePlaceholderSize:false,forceHelperSize:false,grid:false,handle:false,helper:"original",items:"> *",opacity:false,placeholder:false,revert:false,scroll:true,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var E=this.options;this.containerCache={};this.element.addClass("ui-sortable");this.refresh();this.floating=this.items.length?E.axis==="x"||C(this.items[0].item):false;this.offset=this.element.offset();this._mouseInit();this.ready=true},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled");this._mouseDestroy();for(var E=this.items.length-1;E>=0;E--){this.items[E].item.removeData(this.widgetName+"-item")}return this},_setOption:function(E,F){if(E==="disabled"){this.options[E]=F;this.widget().toggleClass("ui-sortable-disabled",!!F)}else{D.Widget.prototype._setOption.apply(this,arguments)}},_mouseCapture:function(H,I){var E=null,G=false,F=this;if(this.reverting){return false}if(this.options.disabled||this.options.type==="static"){return false}this._refreshItems(H);D(H.target).parents().each(function(){if(D.data(this,F.widgetName+"-item")===F){E=D(this);return false}});if(D.data(H.target,F.widgetName+"-item")===F){E=D(H.target)}if(!E){return false}if(this.options.handle&&!I){D(this.options.handle,E).find("*").addBack().each(function(){if(this===H.target){G=true}});if(!G){return false}}this.currentItem=E;this._removeCurrentsFromItems();return true},_mouseStart:function(I,J,F){var E,H,G=this.options;this.currentContainer=this;this.refreshPositions();this.helper=this._createHelper(I);this._cacheHelperProportions();this._cacheMargins();this.scrollParent=this.helper.scrollParent();this.offset=this.currentItem.offset();this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left};D.extend(this.offset,{click:{left:I.pageX-this.offset.left,top:I.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()});this.helper.css("position","absolute");this.cssPosition=this.helper.css("position");this.originalPosition=this._generatePosition(I);this.originalPageX=I.pageX;this.originalPageY=I.pageY;(G.cursorAt&&this._adjustOffsetFromHelper(G.cursorAt));this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]};if(this.helper[0]!==this.currentItem[0]){this.currentItem.hide()}this._createPlaceholder();if(G.containment){this._setContainment()}if(G.cursor&&G.cursor!=="auto"){H=this.document.find("body");this.storedCursor=H.css("cursor");H.css("cursor",G.cursor);this.storedStylesheet=D("<style>*{ cursor: "+G.cursor+" !important; }</style>").appendTo(H)}if(G.opacity){if(this.helper.css("opacity")){this._storedOpacity=this.helper.css("opacity")}this.helper.css("opacity",G.opacity)}if(G.zIndex){if(this.helper.css("zIndex")){this._storedZIndex=this.helper.css("zIndex")}this.helper.css("zIndex",G.zIndex)}if(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"){this.overflowOffset=this.scrollParent.offset()}this._trigger("start",I,this._uiHash());if(!this._preserveHelperProportions){this._cacheHelperProportions()}if(!F){for(E=this.containers.length-1;E>=0;E--){this.containers[E]._trigger("activate",I,this._uiHash(this))}}if(D.ui.ddmanager){D.ui.ddmanager.current=this}if(D.ui.ddmanager&&!G.dropBehaviour){D.ui.ddmanager.prepareOffsets(this,I)}this.dragging=true;this.helper.addClass("ui-sortable-helper");this._mouseDrag(I);return true},_mouseDrag:function(J){var F,I,K,H,G=this.options,E=false;this.position=this._generatePosition(J);this.positionAbs=this._convertPositionTo("absolute");if(!this.lastPositionAbs){this.lastPositionAbs=this.positionAbs}if(this.options.scroll){if(this.scrollParent[0]!==document&&this.scrollParent[0].tagName!=="HTML"){if((this.overflowOffset.top+this.scrollParent[0].offsetHeight)-J.pageY<G.scrollSensitivity){this.scrollParent[0].scrollTop=E=this.scrollParent[0].scrollTop+G.scrollSpeed}else{if(J.pageY-this.overflowOffset.top<G.scrollSensitivity){this.scrollParent[0].scrollTop=E=this.scrollParent[0].scrollTop-G.scrollSpeed}}if((this.overflowOffset.left+this.scrollParent[0].offsetWidth)-J.pageX<G.scrollSensitivity){this.scrollParent[0].scrollLeft=E=this.scrollParent[0].scrollLeft+G.scrollSpeed}else{if(J.pageX-this.overflowOffset.left<G.scrollSensitivity){this.scrollParent[0].scrollLeft=E=this.scrollParent[0].scrollLeft-G.scrollSpeed}}}else{if(J.pageY-D(document).scrollTop()<G.scrollSensitivity){E=D(document).scrollTop(D(document).scrollTop()-G.scrollSpeed)}else{if(D(window).height()-(J.pageY-D(document).scrollTop())<G.scrollSensitivity){E=D(document).scrollTop(D(document).scrollTop()+G.scrollSpeed)}}if(J.pageX-D(document).scrollLeft()<G.scrollSensitivity){E=D(document).scrollLeft(D(document).scrollLeft()-G.scrollSpeed)}else{if(D(window).width()-(J.pageX-D(document).scrollLeft())<G.scrollSensitivity){E=D(document).scrollLeft(D(document).scrollLeft()+G.scrollSpeed)}}}if(E!==false&&D.ui.ddmanager&&!G.dropBehaviour){D.ui.ddmanager.prepareOffsets(this,J)}}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!=="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!=="x"){this.helper[0].style.top=this.position.top+"px"}for(F=this.items.length-1;F>=0;F--){I=this.items[F];K=I.item[0];H=this._intersectsWithPointer(I);if(!H){continue}if(I.instance!==this.currentContainer){continue}if(K!==this.currentItem[0]&&this.placeholder[H===1?"next":"prev"]()[0]!==K&&!D.contains(this.placeholder[0],K)&&(this.options.type==="semi-dynamic"?!D.contains(this.element[0],K):true)){this.direction=H===1?"down":"up";if(this.options.tolerance==="pointer"||this._intersectsWithSides(I)){this._rearrange(J,I)}else{break}this._trigger("change",J,this._uiHash());break}}this._contactContainers(J);if(D.ui.ddmanager){D.ui.ddmanager.drag(this,J)}this._trigger("sort",J,this._uiHash());this.lastPositionAbs=this.positionAbs;return false},_mouseStop:function(I,H){if(!I){return}if(D.ui.ddmanager&&!this.options.dropBehaviour){D.ui.ddmanager.drop(this,I)}if(this.options.revert){var G=this,E=this.placeholder.offset(),J=this.options.axis,F={};if(!J||J==="x"){F.left=E.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)}if(!J||J==="y"){F.top=E.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)}this.reverting=true;D(this.helper).animate(F,parseInt(this.options.revert,10)||500,function(){G._clear(I)})}else{this._clear(I,H)}return false},cancel:function(){if(this.dragging){this._mouseUp({target:null});if(this.options.helper==="original"){this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}for(var E=this.containers.length-1;E>=0;E--){this.containers[E]._trigger("deactivate",null,this._uiHash(this));if(this.containers[E].containerCache.over){this.containers[E]._trigger("out",null,this._uiHash(this));this.containers[E].containerCache.over=0}}}if(this.placeholder){if(this.placeholder[0].parentNode){this.placeholder[0].parentNode.removeChild(this.placeholder[0])}if(this.options.helper!=="original"&&this.helper&&this.helper[0].parentNode){this.helper.remove()}D.extend(this,{helper:null,dragging:false,reverting:false,_noFinalSort:null});if(this.domPosition.prev){D(this.domPosition.prev).after(this.currentItem)}else{D(this.domPosition.parent).prepend(this.currentItem)}}return this},serialize:function(E){var G=this._getItemsAsjQuery(E&&E.connected),F=[];E=E||{};D(G).each(function(){var H=(D(E.item||this).attr(E.attribute||"id")||"").match(E.expression||(/(.+)[\-=_](.+)/));if(H){F.push((E.key||H[1]+"[]")+"="+(E.key&&E.expression?H[1]:H[2]))}});if(!F.length&&E.key){F.push(E.key+"=")}return F.join("&")},toArray:function(E){var G=this._getItemsAsjQuery(E&&E.connected),F=[];E=E||{};G.each(function(){F.push(D(E.item||this).attr(E.attribute||"id")||"")});return F},_intersectsWith:function(R){var F=this.positionAbs.left,I=F+this.helperProportions.width,G=this.positionAbs.top,J=G+this.helperProportions.height,L=R.left,E=L+R.width,H=R.top,M=H+R.height,N=this.offset.click.top,K=this.offset.click.left,O=(this.options.axis==="x")||((G+N)>H&&(G+N)<M),P=(this.options.axis==="y")||((F+K)>L&&(F+K)<E),Q=O&&P;if(this.options.tolerance==="pointer"||this.options.forcePointerForContainers||(this.options.tolerance!=="pointer"&&this.helperProportions[this.floating?"width":"height"]>R[this.floating?"width":"height"])){return Q}else{return(L<F+(this.helperProportions.width/2)&&I-(this.helperProportions.width/2)<E&&H<G+(this.helperProportions.height/2)&&J-(this.helperProportions.height/2)<M)}},_intersectsWithPointer:function(H){var E=(this.options.axis==="x")||A(this.positionAbs.top+this.offset.click.top,H.top,H.height),J=(this.options.axis==="y")||A(this.positionAbs.left+this.offset.click.left,H.left,H.width),F=E&&J,G=this._getDragVerticalDirection(),I=this._getDragHorizontalDirection();if(!F){return false}return this.floating?(((I&&I==="right")||G==="down")?2:1):(G&&(G==="down"?2:1))},_intersectsWithSides:function(F){var E=A(this.positionAbs.top+this.offset.click.top,F.top+(F.height/2),F.height),G=A(this.positionAbs.left+this.offset.click.left,F.left+(F.width/2),F.width),I=this._getDragVerticalDirection(),H=this._getDragHorizontalDirection();if(this.floating&&H){return((H==="right"&&G)||(H==="left"&&!G))}else{return I&&((I==="down"&&E)||(I==="up"&&!E))}},_getDragVerticalDirection:function(){var E=this.positionAbs.top-this.lastPositionAbs.top;return E!==0&&(E>0?"down":"up")},_getDragHorizontalDirection:function(){var E=this.positionAbs.left-this.lastPositionAbs.left;return E!==0&&(E>0?"right":"left")},refresh:function(E){this._refreshItems(E);this.refreshPositions();return this},_connectWith:function(){var E=this.options;return E.connectWith.constructor===String?[E.connectWith]:E.connectWith},_getItemsAsjQuery:function(F){var K,I,E,G,L=[],J=[],M=this._connectWith();if(M&&F){for(K=M.length-1;K>=0;K--){E=D(M[K]);for(I=E.length-1;I>=0;I--){G=D.data(E[I],this.widgetFullName);if(G&&G!==this&&!G.options.disabled){J.push([D.isFunction(G.options.items)?G.options.items.call(G.element):D(G.options.items,G.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),G])}}}}J.push([D.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):D(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);function H(){L.push(this)}for(K=J.length-1;K>=0;K--){J[K][0].each(H)}return D(L)},_removeCurrentsFromItems:function(){var E=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=D.grep(this.items,function(F){for(var G=0;G<E.length;G++){if(E[G]===F.item[0]){return false}}return true})},_refreshItems:function(O){this.items=[];this.containers=[this];var K,I,E,F,P,G,L,H,N=this.items,J=[[D.isFunction(this.options.items)?this.options.items.call(this.element[0],O,{item:this.currentItem}):D(this.options.items,this.element),this]],M=this._connectWith();if(M&&this.ready){for(K=M.length-1;K>=0;K--){E=D(M[K]);for(I=E.length-1;I>=0;I--){F=D.data(E[I],this.widgetFullName);if(F&&F!==this&&!F.options.disabled){J.push([D.isFunction(F.options.items)?F.options.items.call(F.element[0],O,{item:this.currentItem}):D(F.options.items,F.element),F]);this.containers.push(F)}}}}for(K=J.length-1;K>=0;K--){P=J[K][1];G=J[K][0];for(I=0,H=G.length;I<H;I++){L=D(G[I]);L.data(this.widgetName+"-item",P);N.push({item:L,instance:P,width:0,height:0,left:0,top:0})}}},refreshPositions:function(G){if(this.offsetParent&&this.helper){this.offset.parent=this._getParentOffset()}var E,H,I,F;for(E=this.items.length-1;E>=0;E--){H=this.items[E];if(H.instance!==this.currentContainer&&this.currentContainer&&H.item[0]!==this.currentItem[0]){continue}I=this.options.toleranceElement?D(this.options.toleranceElement,H.item):H.item;if(!G){H.width=I.outerWidth();H.height=I.outerHeight()}F=I.offset();H.left=F.left;H.top=F.top}if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(E=this.containers.length-1;E>=0;E--){F=this.containers[E].element.offset();this.containers[E].containerCache.left=F.left;this.containers[E].containerCache.top=F.top;this.containers[E].containerCache.width=this.containers[E].element.outerWidth();this.containers[E].containerCache.height=this.containers[E].element.outerHeight()}}return this},_createPlaceholder:function(F){F=F||this;var E,G=F.options;if(!G.placeholder||G.placeholder.constructor===String){E=G.placeholder;G.placeholder={element:function(){var I=F.currentItem[0].nodeName.toLowerCase(),H=D("<"+I+">",F.document[0]).addClass(E||F.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");if(I==="tr"){F.currentItem.children().each(function(){D("<td>&#160;</td>",F.document[0]).attr("colspan",D(this).attr("colspan")||1).appendTo(H)})}else{if(I==="img"){H.attr("src",F.currentItem.attr("src"))}}if(!E){H.css("visibility","hidden")}return H},update:function(I,H){if(E&&!G.forcePlaceholderSize){return}if(!H.height()){H.height(F.currentItem.innerHeight()-parseInt(F.currentItem.css("paddingTop")||0,10)-parseInt(F.currentItem.css("paddingBottom")||0,10))}if(!H.width()){H.width(F.currentItem.innerWidth()-parseInt(F.currentItem.css("paddingLeft")||0,10)-parseInt(F.currentItem.css("paddingRight")||0,10))}}}}F.placeholder=D(G.placeholder.element.call(F.element,F.currentItem));F.currentItem.after(F.placeholder);G.placeholder.update(F,F.placeholder)},_contactContainers:function(Q){var K,I,N,L,M,G,F,E,P,J,O=null,H=null;for(K=this.containers.length-1;K>=0;K--){if(D.contains(this.currentItem[0],this.containers[K].element[0])){continue}if(this._intersectsWith(this.containers[K].containerCache)){if(O&&D.contains(this.containers[K].element[0],O.element[0])){continue}O=this.containers[K];H=K}else{if(this.containers[K].containerCache.over){this.containers[K]._trigger("out",Q,this._uiHash(this));this.containers[K].containerCache.over=0}}}if(!O){return}if(this.containers.length===1){if(!this.containers[H].containerCache.over){this.containers[H]._trigger("over",Q,this._uiHash(this));this.containers[H].containerCache.over=1}}else{N=10000;L=null;J=O.floating||C(this.currentItem);M=J?"left":"top";G=J?"width":"height";F=this.positionAbs[M]+this.offset.click[M];for(I=this.items.length-1;I>=0;I--){if(!D.contains(this.containers[H].element[0],this.items[I].item[0])){continue}if(this.items[I].item[0]===this.currentItem[0]){continue}if(J&&!A(this.positionAbs.top+this.offset.click.top,this.items[I].top,this.items[I].height)){continue}E=this.items[I].item.offset()[M];P=false;if(Math.abs(E-F)>Math.abs(E+this.items[I][G]-F)){P=true;E+=this.items[I][G]}if(Math.abs(E-F)<N){N=Math.abs(E-F);L=this.items[I];this.direction=P?"up":"down"}}if(!L&&!this.options.dropOnEmpty){return}if(this.currentContainer===this.containers[H]){return}L?this._rearrange(Q,L,null,true):this._rearrange(Q,null,this.containers[H].element,true);this._trigger("change",Q,this._uiHash());this.containers[H]._trigger("change",Q,this._uiHash(this));this.currentContainer=this.containers[H];this.options.placeholder.update(this.currentContainer,this.placeholder);this.containers[H]._trigger("over",Q,this._uiHash(this));this.containers[H].containerCache.over=1}},_createHelper:function(F){var E=this.options,G=D.isFunction(E.helper)?D(E.helper.apply(this.element[0],[F,this.currentItem])):(E.helper==="clone"?this.currentItem.clone():this.currentItem);if(!G.parents("body").length){D(E.appendTo!=="parent"?E.appendTo:this.currentItem[0].parentNode)[0].appendChild(G[0])}if(G[0]===this.currentItem[0]){this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}}if(!G[0].style.width||E.forceHelperSize){G.width(this.currentItem.width())}if(!G[0].style.height||E.forceHelperSize){G.height(this.currentItem.height())}return G},_adjustOffsetFromHelper:function(E){if(typeof E==="string"){E=E.split(" ")}if(D.isArray(E)){E={left:+E[0],top:+E[1]||0}}if("left" in E){this.offset.click.left=E.left+this.margins.left}if("right" in E){this.offset.click.left=this.helperProportions.width-E.right+this.margins.left}if("top" in E){this.offset.click.top=E.top+this.margins.top}if("bottom" in E){this.offset.click.top=this.helperProportions.height-E.bottom+this.margins.top}},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var E=this.offsetParent.offset();if(this.cssPosition==="absolute"&&this.scrollParent[0]!==document&&D.contains(this.scrollParent[0],this.offsetParent[0])){E.left+=this.scrollParent.scrollLeft();E.top+=this.scrollParent.scrollTop()}if(this.offsetParent[0]===document.body||(this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()==="html"&&D.ui.ie)){E={top:0,left:0}}return{top:E.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:E.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition==="relative"){var E=this.currentItem.position();return{top:E.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:E.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}else{return{top:0,left:0}}},_cacheMargins:function(){this.margins={left:(parseInt(this.currentItem.css("marginLeft"),10)||0),top:(parseInt(this.currentItem.css("marginTop"),10)||0)}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var G,E,H,F=this.options;if(F.containment==="parent"){F.containment=this.helper[0].parentNode}if(F.containment==="document"||F.containment==="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,D(F.containment==="document"?document:window).width()-this.helperProportions.width-this.margins.left,(D(F.containment==="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!(/^(document|window|parent)$/).test(F.containment)){G=D(F.containment)[0];E=D(F.containment).offset();H=(D(G).css("overflow")!=="hidden");this.containment=[E.left+(parseInt(D(G).css("borderLeftWidth"),10)||0)+(parseInt(D(G).css("paddingLeft"),10)||0)-this.margins.left,E.top+(parseInt(D(G).css("borderTopWidth"),10)||0)+(parseInt(D(G).css("paddingTop"),10)||0)-this.margins.top,E.left+(H?Math.max(G.scrollWidth,G.offsetWidth):G.offsetWidth)-(parseInt(D(G).css("borderLeftWidth"),10)||0)-(parseInt(D(G).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,E.top+(H?Math.max(G.scrollHeight,G.offsetHeight):G.offsetHeight)-(parseInt(D(G).css("borderTopWidth"),10)||0)-(parseInt(D(G).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(E,F){if(!F){F=this.position}var I=E==="absolute"?1:-1,H=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&D.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,G=(/(html|body)/i).test(H[0].tagName);return{top:(F.top+this.offset.relative.top*I+this.offset.parent.top*I-((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(G?0:H.scrollTop()))*I)),left:(F.left+this.offset.relative.left*I+this.offset.parent.left*I-((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():G?0:H.scrollLeft())*I))}},_generatePosition:function(G){var H,F,J=this.options,I=G.pageX,L=G.pageY,K=this.cssPosition==="absolute"&&!(this.scrollParent[0]!==document&&D.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,E=(/(html|body)/i).test(K[0].tagName);if(this.cssPosition==="relative"&&!(this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0])){this.offset.relative=this._getRelativeOffset()}if(this.originalPosition){if(this.containment){if(G.pageX-this.offset.click.left<this.containment[0]){I=this.containment[0]+this.offset.click.left}if(G.pageY-this.offset.click.top<this.containment[1]){L=this.containment[1]+this.offset.click.top}if(G.pageX-this.offset.click.left>this.containment[2]){I=this.containment[2]+this.offset.click.left}if(G.pageY-this.offset.click.top>this.containment[3]){L=this.containment[3]+this.offset.click.top}}if(J.grid){H=this.originalPageY+Math.round((L-this.originalPageY)/J.grid[1])*J.grid[1];L=this.containment?((H-this.offset.click.top>=this.containment[1]&&H-this.offset.click.top<=this.containment[3])?H:((H-this.offset.click.top>=this.containment[1])?H-J.grid[1]:H+J.grid[1])):H;F=this.originalPageX+Math.round((I-this.originalPageX)/J.grid[0])*J.grid[0];I=this.containment?((F-this.offset.click.left>=this.containment[0]&&F-this.offset.click.left<=this.containment[2])?F:((F-this.offset.click.left>=this.containment[0])?F-J.grid[0]:F+J.grid[0])):F}}return{top:(L-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+((this.cssPosition==="fixed"?-this.scrollParent.scrollTop():(E?0:K.scrollTop())))),left:(I-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+((this.cssPosition==="fixed"?-this.scrollParent.scrollLeft():E?0:K.scrollLeft())))}},_rearrange:function(H,F,I,E){I?I[0].appendChild(this.placeholder[0]):F.item[0].parentNode.insertBefore(this.placeholder[0],(this.direction==="down"?F.item[0]:F.item[0].nextSibling));this.counter=this.counter?++this.counter:1;var G=this.counter;this._delay(function(){if(G===this.counter){this.refreshPositions(!E)}})},_clear:function(G,F){this.reverting=false;var E,H=[];if(!this._noFinalSort&&this.currentItem.parent().length){this.placeholder.before(this.currentItem)}this._noFinalSort=null;if(this.helper[0]===this.currentItem[0]){for(E in this._storedCSS){if(this._storedCSS[E]==="auto"||this._storedCSS[E]==="static"){this._storedCSS[E]=""}}this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}if(this.fromOutside&&!F){H.push(function(J){this._trigger("receive",J,this._uiHash(this.fromOutside))})}if((this.fromOutside||this.domPosition.prev!==this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!==this.currentItem.parent()[0])&&!F){H.push(function(J){this._trigger("update",J,this._uiHash())})}if(this!==this.currentContainer){if(!F){H.push(function(J){this._trigger("remove",J,this._uiHash())});H.push((function(J){return function(K){J._trigger("receive",K,this._uiHash(this))}}).call(this,this.currentContainer));H.push((function(J){return function(K){J._trigger("update",K,this._uiHash(this))}}).call(this,this.currentContainer))}}function I(J,K,L){return function(M){L._trigger(J,M,K._uiHash(K))}}for(E=this.containers.length-1;E>=0;E--){if(!F){H.push(I("deactivate",this,this.containers[E]))}if(this.containers[E].containerCache.over){H.push(I("out",this,this.containers[E]));this.containers[E].containerCache.over=0}}if(this.storedCursor){this.document.find("body").css("cursor",this.storedCursor);this.storedStylesheet.remove()}if(this._storedOpacity){this.helper.css("opacity",this._storedOpacity)}if(this._storedZIndex){this.helper.css("zIndex",this._storedZIndex==="auto"?"":this._storedZIndex)}this.dragging=false;if(this.cancelHelperRemoval){if(!F){this._trigger("beforeStop",G,this._uiHash());for(E=0;E<H.length;E++){H[E].call(this,G)}this._trigger("stop",G,this._uiHash())}this.fromOutside=false;return false}if(!F){this._trigger("beforeStop",G,this._uiHash())}this.placeholder[0].parentNode.removeChild(this.placeholder[0]);if(this.helper[0]!==this.currentItem[0]){this.helper.remove()}this.helper=null;if(!F){for(E=0;E<H.length;E++){H[E].call(this,G)}this._trigger("stop",G,this._uiHash())}this.fromOutside=false;return true},_trigger:function(){if(D.Widget.prototype._trigger.apply(this,arguments)===false){this.cancel()}},_uiHash:function(E){var F=E||this;return{helper:F.helper,placeholder:F.placeholder||D([]),position:F.position,originalPosition:F.originalPosition,offset:F.positionAbs,item:F.currentItem,sender:E?E.element:null}}})})(jQuery);(function(E,B){var A=0,D={},C={};D.height=D.paddingTop=D.paddingBottom=D.borderTopWidth=D.borderBottomWidth="hide";C.height=C.paddingTop=C.paddingBottom=C.borderTopWidth=C.borderBottomWidth="show";E.widget("ui.accordion",{version:"1.10.4",options:{active:0,animate:{},collapsible:false,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var F=this.options;this.prevShow=this.prevHide=E();this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist");if(!F.collapsible&&(F.active===false||F.active==null)){F.active=0}this._processPanels();if(F.active<0){F.active+=this.headers.length}this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:!this.active.length?E():this.active.next(),content:!this.active.length?E():this.active.next()}},_createIcons:function(){var F=this.options.icons;if(F){E("<span>").addClass("ui-accordion-header-icon ui-icon "+F.header).prependTo(this.headers);this.active.children(".ui-accordion-header-icon").removeClass(F.header).addClass(F.activeHeader);this.headers.addClass("ui-accordion-icons")}},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var F;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role");this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){if(/^ui-accordion/.test(this.id)){this.removeAttribute("id")}});this._destroyIcons();F=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){if(/^ui-accordion/.test(this.id)){this.removeAttribute("id")}});if(this.options.heightStyle!=="content"){F.css("height","")}},_setOption:function(F,G){if(F==="active"){this._activate(G);return}if(F==="event"){if(this.options.event){this._off(this.headers,this.options.event)}this._setupEvents(G)}this._super(F,G);if(F==="collapsible"&&!G&&this.options.active===false){this._activate(0)}if(F==="icons"){this._destroyIcons();if(G){this._createIcons()}}if(F==="disabled"){this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!G)}},_keydown:function(H){if(H.altKey||H.ctrlKey){return}var G=E.ui.keyCode,F=this.headers.length,I=this.headers.index(H.target),J=false;switch(H.keyCode){case G.RIGHT:case G.DOWN:J=this.headers[(I+1)%F];break;case G.LEFT:case G.UP:J=this.headers[(I-1+F)%F];break;case G.SPACE:case G.ENTER:this._eventHandler(H);break;case G.HOME:J=this.headers[0];break;case G.END:J=this.headers[F-1];break}if(J){E(H.target).attr("tabIndex",-1);E(J).attr("tabIndex",0);J.focus();H.preventDefault()}},_panelKeyDown:function(F){if(F.keyCode===E.ui.keyCode.UP&&F.ctrlKey){E(F.currentTarget).prev().focus()}},refresh:function(){var F=this.options;this._processPanels();if((F.active===false&&F.collapsible===true)||!this.headers.length){F.active=false;this.active=E()}else{if(F.active===false){this._activate(0)}else{if(this.active.length&&!E.contains(this.element[0],this.active[0])){if(this.headers.length===this.headers.find(".ui-state-disabled").length){F.active=false;this.active=E()}else{this._activate(Math.max(0,F.active-1))}}else{F.active=this.headers.index(this.active)}}}this._destroyIcons();this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all");this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var I,G=this.options,J=G.heightStyle,H=this.element.parent(),F=this.accordionId="ui-accordion-"+(this.element.attr("id")||++A);this.active=this._findActive(G.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all");this.active.next().addClass("ui-accordion-content-active").show();this.headers.attr("role","tab").each(function(L){var N=E(this),O=N.attr("id"),K=N.next(),M=K.attr("id");if(!O){O=F+"-header-"+L;N.attr("id",O)}if(!M){M=F+"-panel-"+L;K.attr("id",M)}N.attr("aria-controls",M);K.attr("aria-labelledby",O)}).next().attr("role","tabpanel");this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide();if(!this.active.length){this.headers.eq(0).attr("tabIndex",0)}else{this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"})}this._createIcons();this._setupEvents(G.event);if(J==="fill"){I=H.height();this.element.siblings(":visible").each(function(){var L=E(this),K=L.css("position");if(K==="absolute"||K==="fixed"){return}I-=L.outerHeight(true)});this.headers.each(function(){I-=E(this).outerHeight(true)});this.headers.next().each(function(){E(this).height(Math.max(0,I-E(this).innerHeight()+E(this).height()))}).css("overflow","auto")}else{if(J==="auto"){I=0;this.headers.next().each(function(){I=Math.max(I,E(this).css("height","").height())}).height(I)}}},_activate:function(G){var F=this._findActive(G)[0];if(F===this.active[0]){return}F=F||this.active[0];this._eventHandler({target:F,currentTarget:F,preventDefault:E.noop})},_findActive:function(F){return typeof F==="number"?this.headers.eq(F):E()},_setupEvents:function(F){var G={keydown:"_keydown"};if(F){E.each(F.split(" "),function(I,H){G[H]="_eventHandler"})}this._off(this.headers.add(this.headers.next()));this._on(this.headers,G);this._on(this.headers.next(),{keydown:"_panelKeyDown"});this._hoverable(this.headers);this._focusable(this.headers)},_eventHandler:function(I){var K=this.options,L=this.active,F=E(I.currentTarget),N=F[0]===L[0],H=N&&K.collapsible,M=H?E():F.next(),G=L.next(),J={oldHeader:L,oldPanel:G,newHeader:H?E():F,newPanel:M};I.preventDefault();if((N&&!K.collapsible)||(this._trigger("beforeActivate",I,J)===false)){return}K.active=H?false:this.headers.index(F);this.active=N?E():F;this._toggle(J);L.removeClass("ui-accordion-header-active ui-state-active");if(K.icons){L.children(".ui-accordion-header-icon").removeClass(K.icons.activeHeader).addClass(K.icons.header)}if(!N){F.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top");if(K.icons){F.children(".ui-accordion-header-icon").removeClass(K.icons.header).addClass(K.icons.activeHeader)}F.next().addClass("ui-accordion-content-active")}},_toggle:function(H){var G=H.newPanel,F=this.prevShow.length?this.prevShow:H.oldPanel;this.prevShow.add(this.prevHide).stop(true,true);this.prevShow=G;this.prevHide=F;if(this.options.animate){this._animate(G,F,H)}else{F.hide();G.show();this._toggleComplete(H)}F.attr({"aria-hidden":"true"});F.prev().attr("aria-selected","false");if(G.length&&F.length){F.prev().attr({"tabIndex":-1,"aria-expanded":"false"})}else{if(G.length){this.headers.filter(function(){return E(this).attr("tabIndex")===0}).attr("tabIndex",-1)}}G.attr("aria-hidden","false").prev().attr({"aria-selected":"true",tabIndex:0,"aria-expanded":"true"})},_animate:function(O,H,F){var M,N,J,K=this,P=0,G=O.length&&(!H.length||(O.index()<H.index())),I=this.options.animate||{},L=G&&I.down||I,Q=function(){K._toggleComplete(F)};if(typeof L==="number"){J=L}if(typeof L==="string"){N=L}N=N||L.easing||I.easing;J=J||L.duration||I.duration;if(!H.length){return O.animate(C,J,N,Q)}if(!O.length){return H.animate(D,J,N,Q)}M=O.show().outerHeight();H.animate(D,{duration:J,easing:N,step:function(S,R){R.now=Math.round(S)}});O.hide().animate(C,{duration:J,easing:N,complete:Q,step:function(S,R){R.now=Math.round(S);if(R.prop!=="height"){P+=R.now}else{if(K.options.heightStyle!=="content"){R.now=Math.round(M-H.outerHeight()-P);P=0}}}})},_toggleComplete:function(G){var F=G.oldPanel;F.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all");if(F.length){F.parent()[0].className=F.parent()[0].className}this._trigger("activate",null,G)}})})(jQuery);(function(B,A){B.widget("ui.autocomplete",{version:"1.10.4",defaultElement:"<input>",options:{appendTo:null,autoFocus:false,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,_create:function(){var F,E,C,H=this.element[0].nodeName.toLowerCase(),G=H==="textarea",D=H==="input";this.isMultiLine=G?true:D?false:this.element.prop("isContentEditable");this.valueMethod=this.element[G||D?"val":"text"];this.isNewMenu=true;this.element.addClass("ui-autocomplete-input").attr("autocomplete","off");this._on(this.element,{keydown:function(J){if(this.element.prop("readOnly")){F=true;C=true;E=true;return}F=false;C=false;E=false;var I=B.ui.keyCode;switch(J.keyCode){case I.PAGE_UP:F=true;this._move("previousPage",J);break;case I.PAGE_DOWN:F=true;this._move("nextPage",J);break;case I.UP:F=true;this._keyEvent("previous",J);break;case I.DOWN:F=true;this._keyEvent("next",J);break;case I.ENTER:case I.NUMPAD_ENTER:if(this.menu.active){F=true;J.preventDefault();this.menu.select(J)}break;case I.TAB:if(this.menu.active){this.menu.select(J)}break;case I.ESCAPE:if(this.menu.element.is(":visible")){this._value(this.term);this.close(J);J.preventDefault()}break;default:E=true;this._searchTimeout(J);break}},keypress:function(J){if(F){F=false;if(!this.isMultiLine||this.menu.element.is(":visible")){J.preventDefault()}return}if(E){return}var I=B.ui.keyCode;switch(J.keyCode){case I.PAGE_UP:this._move("previousPage",J);break;case I.PAGE_DOWN:this._move("nextPage",J);break;case I.UP:this._keyEvent("previous",J);break;case I.DOWN:this._keyEvent("next",J);break}},input:function(I){if(C){C=false;I.preventDefault();return}this._searchTimeout(I)},focus:function(){this.selectedItem=null;this.previous=this._value()},blur:function(I){if(this.cancelBlur){delete this.cancelBlur;return}clearTimeout(this.searching);this.close(I);this._change(I)}});this._initSource();this.menu=B("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu");this._on(this.menu.element,{mousedown:function(J){J.preventDefault();this.cancelBlur=true;this._delay(function(){delete this.cancelBlur});var I=this.menu.element[0];if(!B(J.target).closest(".ui-menu-item").length){this._delay(function(){var K=this;this.document.one("mousedown",function(L){if(L.target!==K.element[0]&&L.target!==I&&!B.contains(I,L.target)){K.close()}})})}},menufocus:function(K,I){if(this.isNewMenu){this.isNewMenu=false;if(K.originalEvent&&/^mouse/.test(K.originalEvent.type)){this.menu.blur();this.document.one("mousemove",function(){B(K.target).trigger(K.originalEvent)});return}}var J=I.item.data("ui-autocomplete-item");if(false!==this._trigger("focus",K,{item:J})){if(K.originalEvent&&/^key/.test(K.originalEvent.type)){this._value(J.value)}}else{this.liveRegion.text(J.value)}},menuselect:function(K,I){var J=I.item.data("ui-autocomplete-item"),L=this.previous;if(this.element[0]!==this.document[0].activeElement){this.element.focus();this.previous=L;this._delay(function(){this.previous=L;this.selectedItem=J})}if(false!==this._trigger("select",K,{item:J})){this._value(J.value)}this.term=this._value();this.close(K);this.selectedItem=J}});this.liveRegion=B("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element);this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching);this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete");this.menu.element.remove();this.liveRegion.remove()},_setOption:function(C,D){this._super(C,D);if(C==="source"){this._initSource()}if(C==="appendTo"){this.menu.element.appendTo(this._appendTo())}if(C==="disabled"&&D&&this.xhr){this.xhr.abort()}},_appendTo:function(){var C=this.options.appendTo;if(C){C=C.jquery||C.nodeType?B(C):this.document.find(C).eq(0)}if(!C){C=this.element.closest(".ui-front")}if(!C.length){C=this.document[0].body}return C},_initSource:function(){var C,D,E=this;if(B.isArray(this.options.source)){C=this.options.source;this.source=function(F,G){G(B.ui.autocomplete.filter(C,F.term))}}else{if(typeof this.options.source==="string"){D=this.options.source;this.source=function(F,G){if(E.xhr){E.xhr.abort()}E.xhr=B.ajax({url:D,data:F,dataType:"json",success:function(H){G(H)},error:function(){G([])}})}}else{this.source=this.options.source}}},_searchTimeout:function(C){clearTimeout(this.searching);this.searching=this._delay(function(){if(this.term!==this._value()){this.selectedItem=null;this.search(null,C)}},this.options.delay)},search:function(D,C){D=D!=null?D:this._value();this.term=this._value();if(D.length<this.options.minLength){return this.close(C)}if(this._trigger("search",C)===false){return}return this._search(D)},_search:function(C){this.pending++;this.element.addClass("ui-autocomplete-loading");this.cancelSearch=false;this.source({term:C},this._response())},_response:function(){var C=++this.requestIndex;return B.proxy(function(D){if(C===this.requestIndex){this.__response(D)}this.pending--;if(!this.pending){this.element.removeClass("ui-autocomplete-loading")}},this)},__response:function(C){if(C){C=this._normalize(C)}this._trigger("response",null,{content:C});if(!this.options.disabled&&C&&C.length&&!this.cancelSearch){this._suggest(C);this._trigger("open")}else{this._close()}},close:function(C){this.cancelSearch=true;this._close(C)},_close:function(C){if(this.menu.element.is(":visible")){this.menu.element.hide();this.menu.blur();this.isNewMenu=true;this._trigger("close",C)}},_change:function(C){if(this.previous!==this._value()){this._trigger("change",C,{item:this.selectedItem})}},_normalize:function(C){if(C.length&&C[0].label&&C[0].value){return C}return B.map(C,function(D){if(typeof D==="string"){return{label:D,value:D}}return B.extend({label:D.label||D.value,value:D.value||D.label},D)})},_suggest:function(D){var C=this.menu.element.empty();this._renderMenu(C,D);this.isNewMenu=true;this.menu.refresh();C.show();this._resizeMenu();C.position(B.extend({of:this.element},this.options.position));if(this.options.autoFocus){this.menu.next()}},_resizeMenu:function(){var C=this.menu.element;C.outerWidth(Math.max(C.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(D,E){var C=this;B.each(E,function(G,F){C._renderItemData(D,F)})},_renderItemData:function(D,C){return this._renderItem(D,C).data("ui-autocomplete-item",C)},_renderItem:function(D,C){return B("<li>").append(B("<a>").text(C.label)).appendTo(D)},_move:function(D,C){if(!this.menu.element.is(":visible")){this.search(null,C);return}if(this.menu.isFirstItem()&&/^previous/.test(D)||this.menu.isLastItem()&&/^next/.test(D)){this._value(this.term);this.menu.blur();return}this.menu[D](C)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(C,D){if(!this.isMultiLine||this.menu.element.is(":visible")){this._move(C,D);D.preventDefault()}}});B.extend(B.ui.autocomplete,{escapeRegex:function(C){return C.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(C,E){var D=new RegExp(B.ui.autocomplete.escapeRegex(E),"i");return B.grep(C,function(F){return D.test(F.label||F.value||F)})}});B.widget("ui.autocomplete",B.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(C){return C+(C>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(C){var D;this._superApply(arguments);if(this.options.disabled||this.cancelSearch){return}if(C&&C.length){D=this.options.messages.results(C.length)}else{D=this.options.messages.noResults}this.liveRegion.text(D)}})}(jQuery));(function(G,C){var F,A="ui-button ui-widget ui-state-default ui-corner-all",D="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",E=function(){var H=G(this);setTimeout(function(){H.find(":ui-button").button("refresh")},1)},B=function(I){var J=I.name,H=I.form,K=G([]);if(J){J=J.replace(/'/g,"\\'");if(H){K=G(H).find("[name='"+J+"']")}else{K=G("[name='"+J+"']",I.ownerDocument).filter(function(){return !this.form})}}return K};G.widget("ui.button",{version:"1.10.4",defaultElement:"<button>",options:{disabled:null,text:true,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,E);if(typeof this.options.disabled!=="boolean"){this.options.disabled=!!this.element.prop("disabled")}else{this.element.prop("disabled",this.options.disabled)}this._determineButtonType();this.hasTitle=!!this.buttonElement.attr("title");var H=this,J=this.options,I=this.type==="checkbox"||this.type==="radio",K=!I?"ui-state-active":"";if(J.label===null){J.label=(this.type==="input"?this.buttonElement.val():this.buttonElement.html())}this._hoverable(this.buttonElement);this.buttonElement.addClass(A).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){if(J.disabled){return}if(this===F){G(this).addClass("ui-state-active")}}).bind("mouseleave"+this.eventNamespace,function(){if(J.disabled){return}G(this).removeClass(K)}).bind("click"+this.eventNamespace,function(L){if(J.disabled){L.preventDefault();L.stopImmediatePropagation()}});this._on({focus:function(){this.buttonElement.addClass("ui-state-focus")},blur:function(){this.buttonElement.removeClass("ui-state-focus")}});if(I){this.element.bind("change"+this.eventNamespace,function(){H.refresh()})}if(this.type==="checkbox"){this.buttonElement.bind("click"+this.eventNamespace,function(){if(J.disabled){return false}})}else{if(this.type==="radio"){this.buttonElement.bind("click"+this.eventNamespace,function(){if(J.disabled){return false}G(this).addClass("ui-state-active");H.buttonElement.attr("aria-pressed","true");var L=H.element[0];B(L).not(L).map(function(){return G(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")})}else{this.buttonElement.bind("mousedown"+this.eventNamespace,function(){if(J.disabled){return false}G(this).addClass("ui-state-active");F=this;H.document.one("mouseup",function(){F=null})}).bind("mouseup"+this.eventNamespace,function(){if(J.disabled){return false}G(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(L){if(J.disabled){return false}if(L.keyCode===G.ui.keyCode.SPACE||L.keyCode===G.ui.keyCode.ENTER){G(this).addClass("ui-state-active")}}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){G(this).removeClass("ui-state-active")});if(this.buttonElement.is("a")){this.buttonElement.keyup(function(L){if(L.keyCode===G.ui.keyCode.SPACE){G(this).click()}})}}}this._setOption("disabled",J.disabled);this._resetButton()},_determineButtonType:function(){var I,H,J;if(this.element.is("[type=checkbox]")){this.type="checkbox"}else{if(this.element.is("[type=radio]")){this.type="radio"}else{if(this.element.is("input")){this.type="input"}else{this.type="button"}}}if(this.type==="checkbox"||this.type==="radio"){I=this.element.parents().last();H="label[for='"+this.element.attr("id")+"']";this.buttonElement=I.find(H);if(!this.buttonElement.length){I=I.length?I.siblings():this.element.siblings();this.buttonElement=I.filter(H);if(!this.buttonElement.length){this.buttonElement=I.find(H)}}this.element.addClass("ui-helper-hidden-accessible");J=this.element.is(":checked");if(J){this.buttonElement.addClass("ui-state-active")}this.buttonElement.prop("aria-pressed",J)}else{this.buttonElement=this.element}},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible");this.buttonElement.removeClass(A+" ui-state-active "+D).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html());if(!this.hasTitle){this.buttonElement.removeAttr("title")}},_setOption:function(H,I){this._super(H,I);if(H==="disabled"){this.element.prop("disabled",!!I);if(I){this.buttonElement.removeClass("ui-state-focus")}return}this._resetButton()},refresh:function(){var H=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");if(H!==this.options.disabled){this._setOption("disabled",H)}if(this.type==="radio"){B(this.element[0]).each(function(){if(G(this).is(":checked")){G(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true")}else{G(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}})}else{if(this.type==="checkbox"){if(this.element.is(":checked")){this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true")}else{this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false")}}}},_resetButton:function(){if(this.type==="input"){if(this.options.label){this.element.val(this.options.label)}return}var L=this.buttonElement.removeClass(D),K=G("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(L.empty()).text(),H=this.options.icons,I=H.primary&&H.secondary,J=[];if(H.primary||H.secondary){if(this.options.text){J.push("ui-button-text-icon"+(I?"s":(H.primary?"-primary":"-secondary")))}if(H.primary){L.prepend("<span class='ui-button-icon-primary ui-icon "+H.primary+"'></span>")}if(H.secondary){L.append("<span class='ui-button-icon-secondary ui-icon "+H.secondary+"'></span>")}if(!this.options.text){J.push(I?"ui-button-icons-only":"ui-button-icon-only");if(!this.hasTitle){L.attr("title",G.trim(K))}}}else{J.push("ui-button-text-only")}L.addClass(J.join(" "))}});G.widget("ui.buttonset",{version:"1.10.4",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(H,I){if(H==="disabled"){this.buttons.button("option",H,I)}this._super(H,I)},refresh:function(){var H=this.element.css("direction")==="rtl";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return G(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(H?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(H?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset");this.buttons.map(function(){return G(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery));(function(G,E){G.extend(G.ui,{datepicker:{version:"1.10.4"}});var B="datepicker",D;function F(){this._curInst=null;this._keyEvent=false;this._disabledInputs=[];this._datepickerShowing=false;this._inDialog=false;this._mainDivId="ui-datepicker-div";this._inlineClass="ui-datepicker-inline";this._appendClass="ui-datepicker-append";this._triggerClass="ui-datepicker-trigger";this._dialogClass="ui-datepicker-dialog";this._disableClass="ui-datepicker-disabled";this._unselectableClass="ui-datepicker-unselectable";this._currentClass="ui-datepicker-current-day";this._dayOverClass="ui-datepicker-days-cell-over";this.regional=[];this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:false,showMonthAfterYear:false,yearSuffix:""};this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:false,hideIfNoPrevNext:false,navigationAsDateFormat:false,gotoCurrent:false,changeMonth:false,changeYear:false,yearRange:"c-10:c+10",showOtherMonths:false,selectOtherMonths:false,showWeek:false,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:true,showButtonPanel:false,autoSize:false,disabled:false};G.extend(this._defaults,this.regional[""]);this.dpDiv=C(G("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}G.extend(F.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(H){A(this._defaults,H||{});return this},_attachDatepicker:function(K,J){var L,H,I;L=K.nodeName.toLowerCase();H=(L==="div"||L==="span");if(!K.id){this.uuid+=1;K.id="dp"+this.uuid}I=this._newInst(G(K),H);I.settings=G.extend({},J||{});if(L==="input"){this._connectDatepicker(K,I)}else{if(H){this._inlineDatepicker(K,I)}}},_newInst:function(I,H){var J=I[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:J,input:I,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:H,dpDiv:(!H?this.dpDiv:C(G("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")))}},_connectDatepicker:function(J,H){var I=G(J);H.append=G([]);H.trigger=G([]);if(I.hasClass(this.markerClassName)){return}this._attachments(I,H);I.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp);this._autoSize(H);G.data(J,B,H);if(H.settings.disabled){this._disableDatepicker(J)}},_attachments:function(L,K){var H,N,M,I=this._get(K,"appendText"),J=this._get(K,"isRTL");if(K.append){K.append.remove()}if(I){K.append=G("<span class='"+this._appendClass+"'>"+I+"</span>");L[J?"before":"after"](K.append)}L.unbind("focus",this._showDatepicker);if(K.trigger){K.trigger.remove()}H=this._get(K,"showOn");if(H==="focus"||H==="both"){L.focus(this._showDatepicker)}if(H==="button"||H==="both"){N=this._get(K,"buttonText");M=this._get(K,"buttonImage");K.trigger=G(this._get(K,"buttonImageOnly")?G("<img/>").addClass(this._triggerClass).attr({src:M,alt:N,title:N}):G("<button type='button'></button>").addClass(this._triggerClass).html(!M?N:G("<img/>").attr({src:M,alt:N,title:N})));L[J?"before":"after"](K.trigger);K.trigger.click(function(){if(G.datepicker._datepickerShowing&&G.datepicker._lastInput===L[0]){G.datepicker._hideDatepicker()}else{if(G.datepicker._datepickerShowing&&G.datepicker._lastInput!==L[0]){G.datepicker._hideDatepicker();G.datepicker._showDatepicker(L[0])}else{G.datepicker._showDatepicker(L[0])}}return false})}},_autoSize:function(J){if(this._get(J,"autoSize")&&!J.inline){var H,N,L,I,M=new Date(2009,12-1,20),K=this._get(J,"dateFormat");if(K.match(/[DM]/)){H=function(O){N=0;L=0;for(I=0;I<O.length;I++){if(O[I].length>N){N=O[I].length;L=I}}return L};M.setMonth(H(this._get(J,(K.match(/MM/)?"monthNames":"monthNamesShort"))));M.setDate(H(this._get(J,(K.match(/DD/)?"dayNames":"dayNamesShort")))+20-M.getDay())}J.input.attr("size",this._formatDate(J,M).length)}},_inlineDatepicker:function(J,I){var H=G(J);if(H.hasClass(this.markerClassName)){return}H.addClass(this.markerClassName).append(I.dpDiv);G.data(J,B,I);this._setDate(I,this._getDefaultDate(I),true);this._updateDatepicker(I);this._updateAlternate(I);if(I.settings.disabled){this._disableDatepicker(J)}I.dpDiv.css("display","block")},_dialogDatepicker:function(P,R,L,H,M){var N,Q,I,J,O,K=this._dialogInst;if(!K){this.uuid+=1;N="dp"+this.uuid;this._dialogInput=G("<input type='text' id='"+N+"' style='position: absolute; top: -100px; width: 0px;'/>");this._dialogInput.keydown(this._doKeyDown);G("body").append(this._dialogInput);K=this._dialogInst=this._newInst(this._dialogInput,false);K.settings={};G.data(this._dialogInput[0],B,K)}A(K.settings,H||{});R=(R&&R.constructor===Date?this._formatDate(K,R):R);this._dialogInput.val(R);this._pos=(M?(M.length?M:[M.pageX,M.pageY]):null);if(!this._pos){Q=document.documentElement.clientWidth;I=document.documentElement.clientHeight;J=document.documentElement.scrollLeft||document.body.scrollLeft;O=document.documentElement.scrollTop||document.body.scrollTop;this._pos=[(Q/2)-100+J,(I/2)-150+O]}this._dialogInput.css("left",(this._pos[0]+20)+"px").css("top",this._pos[1]+"px");K.settings.onSelect=L;this._inDialog=true;this.dpDiv.addClass(this._dialogClass);this._showDatepicker(this._dialogInput[0]);if(G.blockUI){G.blockUI(this.dpDiv)}G.data(this._dialogInput[0],B,K);return this},_destroyDatepicker:function(J){var K,I=G(J),H=G.data(J,B);if(!I.hasClass(this.markerClassName)){return}K=J.nodeName.toLowerCase();G.removeData(J,B);if(K==="input"){H.append.remove();H.trigger.remove();I.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)}else{if(K==="div"||K==="span"){I.removeClass(this.markerClassName).empty()}}},_enableDatepicker:function(K){var L,H,J=G(K),I=G.data(K,B);if(!J.hasClass(this.markerClassName)){return}L=K.nodeName.toLowerCase();if(L==="input"){K.disabled=false;I.trigger.filter("button").each(function(){this.disabled=false}).end().filter("img").css({opacity:"1.0",cursor:""})}else{if(L==="div"||L==="span"){H=J.children("."+this._inlineClass);H.children().removeClass("ui-state-disabled");H.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",false)}}this._disabledInputs=G.map(this._disabledInputs,function(M){return(M===K?null:M)})},_disableDatepicker:function(K){var L,H,J=G(K),I=G.data(K,B);if(!J.hasClass(this.markerClassName)){return}L=K.nodeName.toLowerCase();if(L==="input"){K.disabled=true;I.trigger.filter("button").each(function(){this.disabled=true}).end().filter("img").css({opacity:"0.5",cursor:"default"})}else{if(L==="div"||L==="span"){H=J.children("."+this._inlineClass);H.children().addClass("ui-state-disabled");H.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",true)}}this._disabledInputs=G.map(this._disabledInputs,function(M){return(M===K?null:M)});this._disabledInputs[this._disabledInputs.length]=K},_isDisabledDatepicker:function(I){if(!I){return false}for(var H=0;H<this._disabledInputs.length;H++){if(this._disabledInputs[H]===I){return true}}return false},_getInst:function(I){try{return G.data(I,B)}catch(H){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(N,I,L){var H,O,K,M,J=this._getInst(N);if(arguments.length===2&&typeof I==="string"){return(I==="defaults"?G.extend({},G.datepicker._defaults):(J?(I==="all"?G.extend({},J.settings):this._get(J,I)):null))}H=I||{};if(typeof I==="string"){H={};H[I]=L}if(J){if(this._curInst===J){this._hideDatepicker()}O=this._getDateDatepicker(N,true);K=this._getMinMaxDate(J,"min");M=this._getMinMaxDate(J,"max");A(J.settings,H);if(K!==null&&H.dateFormat!==E&&H.minDate===E){J.settings.minDate=this._formatDate(J,K)}if(M!==null&&H.dateFormat!==E&&H.maxDate===E){J.settings.maxDate=this._formatDate(J,M)}if("disabled" in H){if(H.disabled){this._disableDatepicker(N)}else{this._enableDatepicker(N)}}this._attachments(G(N),J);this._autoSize(J);this._setDate(J,O);this._updateAlternate(J);this._updateDatepicker(J)}},_changeDatepicker:function(J,H,I){this._optionDatepicker(J,H,I)},_refreshDatepicker:function(I){var H=this._getInst(I);if(H){this._updateDatepicker(H)}},_setDateDatepicker:function(I,J){var H=this._getInst(I);if(H){this._setDate(H,J);this._updateDatepicker(H);this._updateAlternate(H)}},_getDateDatepicker:function(J,H){var I=this._getInst(J);if(I&&!I.inline){this._setDateFromField(I,H)}return(I?this._getDate(I):null)},_doKeyDown:function(L){var N,J,M,K=G.datepicker._getInst(L.target),H=true,I=K.dpDiv.is(".ui-datepicker-rtl");K._keyEvent=true;if(G.datepicker._datepickerShowing){switch(L.keyCode){case 9:G.datepicker._hideDatepicker();H=false;break;case 13:M=G("td."+G.datepicker._dayOverClass+":not(."+G.datepicker._currentClass+")",K.dpDiv);if(M[0]){G.datepicker._selectDay(L.target,K.selectedMonth,K.selectedYear,M[0])}N=G.datepicker._get(K,"onSelect");if(N){J=G.datepicker._formatDate(K);N.apply((K.input?K.input[0]:null),[J,K])}else{G.datepicker._hideDatepicker()}return false;case 27:G.datepicker._hideDatepicker();break;case 33:G.datepicker._adjustDate(L.target,(L.ctrlKey?-G.datepicker._get(K,"stepBigMonths"):-G.datepicker._get(K,"stepMonths")),"M");break;case 34:G.datepicker._adjustDate(L.target,(L.ctrlKey?+G.datepicker._get(K,"stepBigMonths"):+G.datepicker._get(K,"stepMonths")),"M");break;case 35:if(L.ctrlKey||L.metaKey){G.datepicker._clearDate(L.target)}H=L.ctrlKey||L.metaKey;break;case 36:if(L.ctrlKey||L.metaKey){G.datepicker._gotoToday(L.target)}H=L.ctrlKey||L.metaKey;break;case 37:if(L.ctrlKey||L.metaKey){G.datepicker._adjustDate(L.target,(I?+1:-1),"D")}H=L.ctrlKey||L.metaKey;if(L.originalEvent.altKey){G.datepicker._adjustDate(L.target,(L.ctrlKey?-G.datepicker._get(K,"stepBigMonths"):-G.datepicker._get(K,"stepMonths")),"M")}break;case 38:if(L.ctrlKey||L.metaKey){G.datepicker._adjustDate(L.target,-7,"D")}H=L.ctrlKey||L.metaKey;break;case 39:if(L.ctrlKey||L.metaKey){G.datepicker._adjustDate(L.target,(I?-1:+1),"D")}H=L.ctrlKey||L.metaKey;if(L.originalEvent.altKey){G.datepicker._adjustDate(L.target,(L.ctrlKey?+G.datepicker._get(K,"stepBigMonths"):+G.datepicker._get(K,"stepMonths")),"M")}break;case 40:if(L.ctrlKey||L.metaKey){G.datepicker._adjustDate(L.target,+7,"D")}H=L.ctrlKey||L.metaKey;break;default:H=false}}else{if(L.keyCode===36&&L.ctrlKey){G.datepicker._showDatepicker(this)}else{H=false}}if(H){L.preventDefault();L.stopPropagation()}},_doKeyPress:function(I){var K,J,H=G.datepicker._getInst(I.target);if(G.datepicker._get(H,"constrainInput")){K=G.datepicker._possibleChars(G.datepicker._get(H,"dateFormat"));J=String.fromCharCode(I.charCode==null?I.keyCode:I.charCode);return I.ctrlKey||I.metaKey||(J<" "||!K||K.indexOf(J)>-1)}},_doKeyUp:function(I){var K,H=G.datepicker._getInst(I.target);if(H.input.val()!==H.lastVal){try{K=G.datepicker.parseDate(G.datepicker._get(H,"dateFormat"),(H.input?H.input.val():null),G.datepicker._getFormatConfig(H));if(K){G.datepicker._setDateFromField(H);G.datepicker._updateAlternate(H);G.datepicker._updateDatepicker(H)}}catch(J){}}return true},_showDatepicker:function(O){O=O.target||O;if(O.nodeName.toLowerCase()!=="input"){O=G("input",O.parentNode)[0]}if(G.datepicker._isDisabledDatepicker(O)||G.datepicker._lastInput===O){return}var L,N,K,M,J,I,H;L=G.datepicker._getInst(O);if(G.datepicker._curInst&&G.datepicker._curInst!==L){G.datepicker._curInst.dpDiv.stop(true,true);if(L&&G.datepicker._datepickerShowing){G.datepicker._hideDatepicker(G.datepicker._curInst.input[0])}}N=G.datepicker._get(L,"beforeShow");K=N?N.apply(O,[O,L]):{};if(K===false){return}A(L.settings,K);L.lastVal=null;G.datepicker._lastInput=O;G.datepicker._setDateFromField(L);if(G.datepicker._inDialog){O.value=""}if(!G.datepicker._pos){G.datepicker._pos=G.datepicker._findPos(O);G.datepicker._pos[1]+=O.offsetHeight}M=false;G(O).parents().each(function(){M|=G(this).css("position")==="fixed";return !M});J={left:G.datepicker._pos[0],top:G.datepicker._pos[1]};G.datepicker._pos=null;L.dpDiv.empty();L.dpDiv.css({position:"absolute",display:"block",top:"-1000px"});G.datepicker._updateDatepicker(L);J=G.datepicker._checkOffset(L,J,M);L.dpDiv.css({position:(G.datepicker._inDialog&&G.blockUI?"static":(M?"fixed":"absolute")),display:"none",left:J.left+"px",top:J.top+"px"});if(!L.inline){I=G.datepicker._get(L,"showAnim");H=G.datepicker._get(L,"duration");L.dpDiv.zIndex(G(O).zIndex()+1);G.datepicker._datepickerShowing=true;if(G.effects&&G.effects.effect[I]){L.dpDiv.show(I,G.datepicker._get(L,"showOptions"),H)}else{L.dpDiv[I||"show"](I?H:null)}if(G.datepicker._shouldFocusInput(L)){L.input.focus()}G.datepicker._curInst=L}},_updateDatepicker:function(K){this.maxRows=4;D=K;K.dpDiv.empty().append(this._generateHTML(K));this._attachHandlers(K);K.dpDiv.find("."+this._dayOverClass+" a").mouseover();var H,J=this._getNumberOfMonths(K),I=J[1],L=17;K.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width("");if(I>1){K.dpDiv.addClass("ui-datepicker-multi-"+I).css("width",(L*I)+"em")}K.dpDiv[(J[0]!==1||J[1]!==1?"add":"remove")+"Class"]("ui-datepicker-multi");K.dpDiv[(this._get(K,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl");if(K===G.datepicker._curInst&&G.datepicker._datepickerShowing&&G.datepicker._shouldFocusInput(K)){K.input.focus()}if(K.yearshtml){H=K.yearshtml;setTimeout(function(){if(H===K.yearshtml&&K.yearshtml){K.dpDiv.find("select.ui-datepicker-year:first").replaceWith(K.yearshtml)}H=K.yearshtml=null},0)}},_shouldFocusInput:function(H){return H.input&&H.input.is(":visible")&&!H.input.is(":disabled")&&!H.input.is(":focus")},_checkOffset:function(K,J,L){var M=K.dpDiv.outerWidth(),H=K.dpDiv.outerHeight(),O=K.input?K.input.outerWidth():0,N=K.input?K.input.outerHeight():0,P=document.documentElement.clientWidth+(L?0:G(document).scrollLeft()),I=document.documentElement.clientHeight+(L?0:G(document).scrollTop());J.left-=(this._get(K,"isRTL")?(M-O):0);J.left-=(L&&J.left===K.input.offset().left)?G(document).scrollLeft():0;J.top-=(L&&J.top===(K.input.offset().top+N))?G(document).scrollTop():0;J.left-=Math.min(J.left,(J.left+M>P&&P>M)?Math.abs(J.left+M-P):0);J.top-=Math.min(J.top,(J.top+H>I&&I>H)?Math.abs(H+N):0);return J},_findPos:function(H){var J,K=this._getInst(H),I=this._get(K,"isRTL");while(H&&(H.type==="hidden"||H.nodeType!==1||G.expr.filters.hidden(H))){H=H[I?"previousSibling":"nextSibling"]}J=G(H).offset();return[J.left,J.top]},_hideDatepicker:function(K){var J,M,I,H,L=this._curInst;if(!L||(K&&L!==G.data(K,B))){return}if(this._datepickerShowing){J=this._get(L,"showAnim");M=this._get(L,"duration");I=function(){G.datepicker._tidyDialog(L)};if(G.effects&&(G.effects.effect[J]||G.effects[J])){L.dpDiv.hide(J,G.datepicker._get(L,"showOptions"),M,I)}else{L.dpDiv[(J==="slideDown"?"slideUp":(J==="fadeIn"?"fadeOut":"hide"))]((J?M:null),I)}if(!J){I()}this._datepickerShowing=false;H=this._get(L,"onClose");if(H){H.apply((L.input?L.input[0]:null),[(L.input?L.input.val():""),L])}this._lastInput=null;if(this._inDialog){this._dialogInput.css({position:"absolute",left:"0",top:"-100px"});if(G.blockUI){G.unblockUI();G("body").append(this.dpDiv)}}this._inDialog=false}},_tidyDialog:function(H){H.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(J){if(!G.datepicker._curInst){return}var H=G(J.target),I=G.datepicker._getInst(H[0]);if(((H[0].id!==G.datepicker._mainDivId&&H.parents("#"+G.datepicker._mainDivId).length===0&&!H.hasClass(G.datepicker.markerClassName)&&!H.closest("."+G.datepicker._triggerClass).length&&G.datepicker._datepickerShowing&&!(G.datepicker._inDialog&&G.blockUI)))||(H.hasClass(G.datepicker.markerClassName)&&G.datepicker._curInst!==I)){G.datepicker._hideDatepicker()}},_adjustDate:function(L,H,I){var K=G(L),J=this._getInst(K[0]);if(this._isDisabledDatepicker(K[0])){return}this._adjustInstDate(J,H+(I==="M"?this._get(J,"showCurrentAtPos"):0),I);this._updateDatepicker(J)},_gotoToday:function(K){var J,I=G(K),H=this._getInst(I[0]);if(this._get(H,"gotoCurrent")&&H.currentDay){H.selectedDay=H.currentDay;H.drawMonth=H.selectedMonth=H.currentMonth;H.drawYear=H.selectedYear=H.currentYear}else{J=new Date();H.selectedDay=J.getDate();H.drawMonth=H.selectedMonth=J.getMonth();H.drawYear=H.selectedYear=J.getFullYear()}this._notifyChange(H);this._adjustDate(I)},_selectMonthYear:function(L,J,H){var K=G(L),I=this._getInst(K[0]);I["selected"+(H==="M"?"Month":"Year")]=I["draw"+(H==="M"?"Month":"Year")]=parseInt(J.options[J.selectedIndex].value,10);this._notifyChange(I);this._adjustDate(K)},_selectDay:function(M,H,I,J){var K,L=G(M);if(G(J).hasClass(this._unselectableClass)||this._isDisabledDatepicker(L[0])){return}K=this._getInst(L[0]);K.selectedDay=K.currentDay=G("a",J).html();K.selectedMonth=K.currentMonth=H;K.selectedYear=K.currentYear=I;this._selectDate(M,this._formatDate(K,K.currentDay,K.currentMonth,K.currentYear))},_clearDate:function(I){var H=G(I);this._selectDate(H,"")},_selectDate:function(L,H){var K,J=G(L),I=this._getInst(J[0]);H=(H!=null?H:this._formatDate(I));if(I.input){I.input.val(H)}this._updateAlternate(I);K=this._get(I,"onSelect");if(K){K.apply((I.input?I.input[0]:null),[H,I])}else{if(I.input){I.input.trigger("change")}}if(I.inline){this._updateDatepicker(I)}else{this._hideDatepicker();this._lastInput=I.input[0];if(typeof(I.input[0])!=="object"){I.input.focus()}this._lastInput=null}},_updateAlternate:function(I){var J,L,H,K=this._get(I,"altField");if(K){J=this._get(I,"altFormat")||this._get(I,"dateFormat");L=this._getDate(I);H=this.formatDate(J,L,this._getFormatConfig(I));G(K).each(function(){G(this).val(H)})}},noWeekends:function(I){var H=I.getDay();return[(H>0&&H<6),""]},iso8601Week:function(I){var H,J=new Date(I.getTime());J.setDate(J.getDate()+4-(J.getDay()||7));H=J.getTime();J.setMonth(0);J.setDate(1);return Math.floor(Math.round((H-J)/86400000)/7)+1},parseDate:function(W,J,S){if(W==null||J==null){throw"Invalid arguments"}J=(typeof J==="object"?J.toString():J+"");if(J===""){return null}var O,P,M,V=0,Q=(S?S.shortYearCutoff:null)||this._defaults.shortYearCutoff,Y=(typeof Q!=="string"?Q:new Date().getFullYear()%100+parseInt(Q,10)),K=(S?S.dayNamesShort:null)||this._defaults.dayNamesShort,H=(S?S.dayNames:null)||this._defaults.dayNames,L=(S?S.monthNamesShort:null)||this._defaults.monthNamesShort,a=(S?S.monthNames:null)||this._defaults.monthNames,T=-1,d=-1,b=-1,I=-1,c=false,N,U=function(f){var e=(O+1<W.length&&W.charAt(O+1)===f);if(e){O++}return e},X=function(g){var h=U(g),e=(g==="@"?14:(g==="!"?20:(g==="y"&&h?4:(g==="o"?3:2)))),f=new RegExp("^\\d{1,"+e+"}"),i=J.substring(V).match(f);if(!i){throw"Missing number at position "+V}V+=i[0].length;return parseInt(i[0],10)},Z=function(e,g,f){var i=-1,h=G.map(U(e)?f:g,function(j,l){return[[l,j]]}).sort(function(k,j){return -(k[1].length-j[1].length)});G.each(h,function(j,l){var k=l[1];if(J.substr(V,k.length).toLowerCase()===k.toLowerCase()){i=l[0];V+=k.length;return false}});if(i!==-1){return i+1}else{throw"Unknown name at position "+V}},R=function(){if(J.charAt(V)!==W.charAt(O)){throw"Unexpected literal at position "+V}V++};for(O=0;O<W.length;O++){if(c){if(W.charAt(O)==="'"&&!U("'")){c=false}else{R()}}else{switch(W.charAt(O)){case"d":b=X("d");break;case"D":Z("D",K,H);break;case"o":I=X("o");break;case"m":d=X("m");break;case"M":d=Z("M",L,a);break;case"y":T=X("y");break;case"@":N=new Date(X("@"));T=N.getFullYear();d=N.getMonth()+1;b=N.getDate();break;case"!":N=new Date((X("!")-this._ticksTo1970)/10000);T=N.getFullYear();d=N.getMonth()+1;b=N.getDate();break;case"'":if(U("'")){R()}else{c=true}break;default:R()}}}if(V<J.length){M=J.substr(V);if(!/^\s+/.test(M)){throw"Extra/unparsed characters found in date: "+M}}if(T===-1){T=new Date().getFullYear()}else{if(T<100){T+=new Date().getFullYear()-new Date().getFullYear()%100+(T<=Y?0:-100)}}if(I>-1){d=1;b=I;do{P=this._getDaysInMonth(T,d-1);if(b<=P){break}d++;b-=P}while(true)}N=this._daylightSavingAdjust(new Date(T,d-1,b));if(N.getFullYear()!==T||N.getMonth()+1!==d||N.getDate()!==b){throw"Invalid date"}return N},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:(((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*10000000),formatDate:function(K,T,I){if(!T){return""}var H,N=(I?I.dayNamesShort:null)||this._defaults.dayNamesShort,O=(I?I.dayNames:null)||this._defaults.dayNames,Q=(I?I.monthNamesShort:null)||this._defaults.monthNamesShort,S=(I?I.monthNames:null)||this._defaults.monthNames,P=function(V){var U=(H+1<K.length&&K.charAt(H+1)===V);if(U){H++}return U},J=function(U,W,V){var X=""+W;if(P(U)){while(X.length<V){X="0"+X}}return X},M=function(V,X,U,W){return(P(V)?W[X]:U[X])},L="",R=false;if(T){for(H=0;H<K.length;H++){if(R){if(K.charAt(H)==="'"&&!P("'")){R=false}else{L+=K.charAt(H)}}else{switch(K.charAt(H)){case"d":L+=J("d",T.getDate(),2);break;case"D":L+=M("D",T.getDay(),N,O);break;case"o":L+=J("o",Math.round((new Date(T.getFullYear(),T.getMonth(),T.getDate()).getTime()-new Date(T.getFullYear(),0,0).getTime())/86400000),3);break;case"m":L+=J("m",T.getMonth()+1,2);break;case"M":L+=M("M",T.getMonth(),Q,S);break;case"y":L+=(P("y")?T.getFullYear():(T.getYear()%100<10?"0":"")+T.getYear()%100);break;case"@":L+=T.getTime();break;case"!":L+=T.getTime()*10000+this._ticksTo1970;break;case"'":if(P("'")){L+="'"}else{R=true}break;default:L+=K.charAt(H)}}}}return L},_possibleChars:function(J){var H,L="",K=false,I=function(N){var M=(H+1<J.length&&J.charAt(H+1)===N);if(M){H++}return M};for(H=0;H<J.length;H++){if(K){if(J.charAt(H)==="'"&&!I("'")){K=false}else{L+=J.charAt(H)}}else{switch(J.charAt(H)){case"d":case"m":case"y":case"@":L+="0123456789";break;case"D":case"M":return null;case"'":if(I("'")){L+="'"}else{K=true}break;default:L+=J.charAt(H)}}}return L},_get:function(H,I){return H.settings[I]!==E?H.settings[I]:this._defaults[I]},_setDateFromField:function(K,N){if(K.input.val()===K.lastVal){return}var J=this._get(K,"dateFormat"),M=K.lastVal=K.input?K.input.val():null,I=this._getDefaultDate(K),O=I,H=this._getFormatConfig(K);try{O=this.parseDate(J,M,H)||I}catch(L){M=(N?"":M)}K.selectedDay=O.getDate();K.drawMonth=K.selectedMonth=O.getMonth();K.drawYear=K.selectedYear=O.getFullYear();K.currentDay=(M?O.getDate():0);K.currentMonth=(M?O.getMonth():0);K.currentYear=(M?O.getFullYear():0);this._adjustInstDate(K)},_getDefaultDate:function(H){return this._restrictMinMax(H,this._determineDate(H,this._get(H,"defaultDate"),new Date()))},_determineDate:function(K,M,I){var L=function(N){var O=new Date();O.setDate(O.getDate()+N);return O},H=function(T){try{return G.datepicker.parseDate(G.datepicker._get(K,"dateFormat"),T,G.datepicker._getFormatConfig(K))}catch(N){}var U=(T.toLowerCase().match(/^c/)?G.datepicker._getDate(K):null)||new Date(),S=U.getFullYear(),O=U.getMonth(),Q=U.getDate(),P=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,R=P.exec(T);while(R){switch(R[2]||"d"){case"d":case"D":Q+=parseInt(R[1],10);break;case"w":case"W":Q+=parseInt(R[1],10)*7;break;case"m":case"M":O+=parseInt(R[1],10);Q=Math.min(Q,G.datepicker._getDaysInMonth(S,O));break;case"y":case"Y":S+=parseInt(R[1],10);Q=Math.min(Q,G.datepicker._getDaysInMonth(S,O));break}R=P.exec(T)}return new Date(S,O,Q)},J=(M==null||M===""?I:(typeof M==="string"?H(M):(typeof M==="number"?(isNaN(M)?I:L(M)):new Date(M.getTime()))));J=(J&&J.toString()==="Invalid Date"?I:J);if(J){J.setHours(0);J.setMinutes(0);J.setSeconds(0);J.setMilliseconds(0)}return this._daylightSavingAdjust(J)},_daylightSavingAdjust:function(H){if(!H){return null}H.setHours(H.getHours()>12?H.getHours()+2:0);return H},_setDate:function(J,N,L){var M=!N,H=J.selectedMonth,K=J.selectedYear,I=this._restrictMinMax(J,this._determineDate(J,N,new Date()));J.selectedDay=J.currentDay=I.getDate();J.drawMonth=J.selectedMonth=J.currentMonth=I.getMonth();J.drawYear=J.selectedYear=J.currentYear=I.getFullYear();if((H!==J.selectedMonth||K!==J.selectedYear)&&!L){this._notifyChange(J)}this._adjustInstDate(J);if(J.input){J.input.val(M?"":this._formatDate(J))}},_getDate:function(H){var I=(!H.currentYear||(H.input&&H.input.val()==="")?null:this._daylightSavingAdjust(new Date(H.currentYear,H.currentMonth,H.currentDay)));return I},_attachHandlers:function(I){var H=this._get(I,"stepMonths"),J="#"+I.id.replace(/\\\\/g,"\\");I.dpDiv.find("[data-handler]").map(function(){var K={prev:function(){G.datepicker._adjustDate(J,-H,"M")},next:function(){G.datepicker._adjustDate(J,+H,"M")},hide:function(){G.datepicker._hideDatepicker()},today:function(){G.datepicker._gotoToday(J)},selectDay:function(){G.datepicker._selectDay(J,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this);return false},selectMonth:function(){G.datepicker._selectMonthYear(J,this,"M");return false},selectYear:function(){G.datepicker._selectMonthYear(J,this,"Y");return false}};G(this).bind(this.getAttribute("data-event"),K[this.getAttribute("data-handler")])})},_generateHTML:function(b){var u,Ak,K,L,J,Aj,r,w,o,l,Z,Ad,V,i,Al,s,t,M,Ah,X,H,e,q,Ab,T,Ac,n,v,m,P,Y,Q,W,h,k,Aa,I,d,S,g=new Date(),c=this._daylightSavingAdjust(new Date(g.getFullYear(),g.getMonth(),g.getDate())),f=this._get(b,"isRTL"),U=this._get(b,"showButtonPanel"),p=this._get(b,"hideIfNoPrevNext"),Ag=this._get(b,"navigationAsDateFormat"),Ai=this._getNumberOfMonths(b),R=this._get(b,"showCurrentAtPos"),N=this._get(b,"stepMonths"),Af=(Ai[0]!==1||Ai[1]!==1),a=this._daylightSavingAdjust((!b.currentDay?new Date(9999,9,9):new Date(b.currentYear,b.currentMonth,b.currentDay))),z=this._getMinMaxDate(b,"min"),O=this._getMinMaxDate(b,"max"),j=b.drawMonth-R,Ae=b.drawYear;if(j<0){j+=12;Ae--}if(O){u=this._daylightSavingAdjust(new Date(O.getFullYear(),O.getMonth()-(Ai[0]*Ai[1])+1,O.getDate()));u=(z&&u<z?z:u);while(this._daylightSavingAdjust(new Date(Ae,j,1))>u){j--;if(j<0){j=11;Ae--}}}b.drawMonth=j;b.drawYear=Ae;Ak=this._get(b,"prevText");Ak=(!Ag?Ak:this.formatDate(Ak,this._daylightSavingAdjust(new Date(Ae,j-N,1)),this._getFormatConfig(b)));K=(this._canAdjustMonth(b,-1,Ae,j)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+Ak+"'><span class='ui-icon ui-icon-circle-triangle-"+(f?"e":"w")+"'>"+Ak+"</span></a>":(p?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+Ak+"'><span class='ui-icon ui-icon-circle-triangle-"+(f?"e":"w")+"'>"+Ak+"</span></a>"));L=this._get(b,"nextText");L=(!Ag?L:this.formatDate(L,this._daylightSavingAdjust(new Date(Ae,j+N,1)),this._getFormatConfig(b)));J=(this._canAdjustMonth(b,+1,Ae,j)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+L+"'><span class='ui-icon ui-icon-circle-triangle-"+(f?"w":"e")+"'>"+L+"</span></a>":(p?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+L+"'><span class='ui-icon ui-icon-circle-triangle-"+(f?"w":"e")+"'>"+L+"</span></a>"));Aj=this._get(b,"currentText");r=(this._get(b,"gotoCurrent")&&b.currentDay?a:c);Aj=(!Ag?Aj:this.formatDate(Aj,r,this._getFormatConfig(b)));w=(!b.inline?"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(b,"closeText")+"</button>":"");o=(U)?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(f?w:"")+(this._isInRange(b,r)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+Aj+"</button>":"")+(f?"":w)+"</div>":"";l=parseInt(this._get(b,"firstDay"),10);l=(isNaN(l)?0:l);Z=this._get(b,"showWeek");Ad=this._get(b,"dayNames");V=this._get(b,"dayNamesMin");i=this._get(b,"monthNames");Al=this._get(b,"monthNamesShort");s=this._get(b,"beforeShowDay");t=this._get(b,"showOtherMonths");M=this._get(b,"selectOtherMonths");Ah=this._getDefaultDate(b);X="";H;for(e=0;e<Ai[0];e++){q="";this.maxRows=4;for(Ab=0;Ab<Ai[1];Ab++){T=this._daylightSavingAdjust(new Date(Ae,j,b.selectedDay));Ac=" ui-corner-all";n="";if(Af){n+="<div class='ui-datepicker-group";if(Ai[1]>1){switch(Ab){case 0:n+=" ui-datepicker-group-first";Ac=" ui-corner-"+(f?"right":"left");break;case Ai[1]-1:n+=" ui-datepicker-group-last";Ac=" ui-corner-"+(f?"left":"right");break;default:n+=" ui-datepicker-group-middle";Ac="";break}}n+="'>"}n+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+Ac+"'>"+(/all|left/.test(Ac)&&e===0?(f?J:K):"")+(/all|right/.test(Ac)&&e===0?(f?K:J):"")+this._generateMonthYearHeader(b,j,Ae,z,O,e>0||Ab>0,i,Al)+"</div><table class='ui-datepicker-calendar'><thead><tr>";v=(Z?"<th class='ui-datepicker-week-col'>"+this._get(b,"weekHeader")+"</th>":"");for(H=0;H<7;H++){m=(H+l)%7;v+="<th"+((H+l+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+Ad[m]+"'>"+V[m]+"</span></th>"}n+=v+"</tr></thead><tbody>";P=this._getDaysInMonth(Ae,j);if(Ae===b.selectedYear&&j===b.selectedMonth){b.selectedDay=Math.min(b.selectedDay,P)}Y=(this._getFirstDayOfMonth(Ae,j)-l+7)%7;Q=Math.ceil((Y+P)/7);W=(Af?this.maxRows>Q?this.maxRows:Q:Q);this.maxRows=W;h=this._daylightSavingAdjust(new Date(Ae,j,1-Y));for(k=0;k<W;k++){n+="<tr>";Aa=(!Z?"":"<td class='ui-datepicker-week-col'>"+this._get(b,"calculateWeek")(h)+"</td>");for(H=0;H<7;H++){I=(s?s.apply((b.input?b.input[0]:null),[h]):[true,""]);d=(h.getMonth()!==j);S=(d&&!M)||!I[0]||(z&&h<z)||(O&&h>O);Aa+="<td class='"+((H+l+6)%7>=5?" ui-datepicker-week-end":"")+(d?" ui-datepicker-other-month":"")+((h.getTime()===T.getTime()&&j===b.selectedMonth&&b._keyEvent)||(Ah.getTime()===h.getTime()&&Ah.getTime()===T.getTime())?" "+this._dayOverClass:"")+(S?" "+this._unselectableClass+" ui-state-disabled":"")+(d&&!t?"":" "+I[1]+(h.getTime()===a.getTime()?" "+this._currentClass:"")+(h.getTime()===c.getTime()?" ui-datepicker-today":""))+"'"+((!d||t)&&I[2]?" title='"+I[2].replace(/'/g,"&#39;")+"'":"")+(S?"":" data-handler='selectDay' data-event='click' data-month='"+h.getMonth()+"' data-year='"+h.getFullYear()+"'")+">"+(d&&!t?"&#xa0;":(S?"<span class='ui-state-default'>"+h.getDate()+"</span>":"<a class='ui-state-default"+(h.getTime()===c.getTime()?" ui-state-highlight":"")+(h.getTime()===a.getTime()?" ui-state-active":"")+(d?" ui-priority-secondary":"")+"' href='#'>"+h.getDate()+"</a>"))+"</td>";h.setDate(h.getDate()+1);h=this._daylightSavingAdjust(h)}n+=Aa+"</tr>"}j++;if(j>11){j=0;Ae++}n+="</tbody></table>"+(Af?"</div>"+((Ai[0]>0&&Ab===Ai[1]-1)?"<div class='ui-datepicker-row-break'></div>":""):"");q+=n}X+=q}X+=o;b._keyEvent=false;return X},_generateMonthYearHeader:function(P,L,Y,Z,I,M,V,K){var Q,W,b,X,O,N,U,R,T=this._get(P,"changeMonth"),H=this._get(P,"changeYear"),J=this._get(P,"showMonthAfterYear"),S="<div class='ui-datepicker-title'>",a="";if(M||!T){a+="<span class='ui-datepicker-month'>"+V[L]+"</span>"}else{Q=(Z&&Z.getFullYear()===Y);W=(I&&I.getFullYear()===Y);a+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>";for(b=0;b<12;b++){if((!Q||b>=Z.getMonth())&&(!W||b<=I.getMonth())){a+="<option value='"+b+"'"+(b===L?" selected='selected'":"")+">"+K[b]+"</option>"}}a+="</select>"}if(!J){S+=a+(M||!(T&&H)?"&#xa0;":"")}if(!P.yearshtml){P.yearshtml="";if(M||!H){S+="<span class='ui-datepicker-year'>"+Y+"</span>"}else{X=this._get(P,"yearRange").split(":");O=new Date().getFullYear();N=function(d){var c=(d.match(/c[+\-].*/)?Y+parseInt(d.substring(1),10):(d.match(/[+\-].*/)?O+parseInt(d,10):parseInt(d,10)));return(isNaN(c)?O:c)};U=N(X[0]);R=Math.max(U,N(X[1]||""));U=(Z?Math.max(U,Z.getFullYear()):U);R=(I?Math.min(R,I.getFullYear()):R);P.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";for(;U<=R;U++){P.yearshtml+="<option value='"+U+"'"+(U===Y?" selected='selected'":"")+">"+U+"</option>"}P.yearshtml+="</select>";S+=P.yearshtml;P.yearshtml=null}}S+=this._get(P,"yearSuffix");if(J){S+=(M||!(T&&H)?"&#xa0;":"")+a}S+="</div>";return S},_adjustInstDate:function(L,H,K){var M=L.drawYear+(K==="Y"?H:0),I=L.drawMonth+(K==="M"?H:0),N=Math.min(L.selectedDay,this._getDaysInMonth(M,I))+(K==="D"?H:0),J=this._restrictMinMax(L,this._daylightSavingAdjust(new Date(M,I,N)));L.selectedDay=J.getDate();L.drawMonth=L.selectedMonth=J.getMonth();L.drawYear=L.selectedYear=J.getFullYear();if(K==="M"||K==="Y"){this._notifyChange(L)}},_restrictMinMax:function(K,L){var H=this._getMinMaxDate(K,"min"),I=this._getMinMaxDate(K,"max"),J=(H&&L<H?H:L);return(I&&J>I?I:J)},_notifyChange:function(H){var I=this._get(H,"onChangeMonthYear");if(I){I.apply((H.input?H.input[0]:null),[H.selectedYear,H.selectedMonth+1,H])}},_getNumberOfMonths:function(I){var H=this._get(I,"numberOfMonths");return(H==null?[1,1]:(typeof H==="number"?[1,H]:H))},_getMinMaxDate:function(I,H){return this._determineDate(I,this._get(I,H+"Date"),null)},_getDaysInMonth:function(I,H){return 32-this._daylightSavingAdjust(new Date(I,H,32)).getDate()},_getFirstDayOfMonth:function(I,H){return new Date(I,H,1).getDay()},_canAdjustMonth:function(K,H,I,M){var J=this._getNumberOfMonths(K),L=this._daylightSavingAdjust(new Date(I,M+(H<0?H:J[0]*J[1]),1));if(H<0){L.setDate(this._getDaysInMonth(L.getFullYear(),L.getMonth()))}return this._isInRange(K,L)},_isInRange:function(H,P){var O,I,N=this._getMinMaxDate(H,"min"),L=this._getMinMaxDate(H,"max"),K=null,M=null,J=this._get(H,"yearRange");if(J){O=J.split(":");I=new Date().getFullYear();K=parseInt(O[0],10);M=parseInt(O[1],10);if(O[0].match(/[+\-].*/)){K+=I}if(O[1].match(/[+\-].*/)){M+=I}}return((!N||P.getTime()>=N.getTime())&&(!L||P.getTime()<=L.getTime())&&(!K||P.getFullYear()>=K)&&(!M||P.getFullYear()<=M))},_getFormatConfig:function(I){var H=this._get(I,"shortYearCutoff");H=(typeof H!=="string"?H:new Date().getFullYear()%100+parseInt(H,10));return{shortYearCutoff:H,dayNamesShort:this._get(I,"dayNamesShort"),dayNames:this._get(I,"dayNames"),monthNamesShort:this._get(I,"monthNamesShort"),monthNames:this._get(I,"monthNames")}},_formatDate:function(J,I,H,K){if(!I){J.currentDay=J.selectedDay;J.currentMonth=J.selectedMonth;J.currentYear=J.selectedYear}var L=(I?(typeof I==="object"?I:this._daylightSavingAdjust(new Date(K,H,I))):this._daylightSavingAdjust(new Date(J.currentYear,J.currentMonth,J.currentDay)));return this.formatDate(this._get(J,"dateFormat"),L,this._getFormatConfig(J))}});function C(H){var I="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return H.delegate(I,"mouseout",function(){G(this).removeClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){G(this).removeClass("ui-datepicker-prev-hover")}if(this.className.indexOf("ui-datepicker-next")!==-1){G(this).removeClass("ui-datepicker-next-hover")}}).delegate(I,"mouseover",function(){if(!G.datepicker._isDisabledDatepicker(D.inline?H.parent()[0]:D.input[0])){G(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover");G(this).addClass("ui-state-hover");if(this.className.indexOf("ui-datepicker-prev")!==-1){G(this).addClass("ui-datepicker-prev-hover")}if(this.className.indexOf("ui-datepicker-next")!==-1){G(this).addClass("ui-datepicker-next-hover")}}})}function A(J,I){G.extend(J,I);for(var H in I){if(I[H]==null){J[H]=I[H]}}return J}G.fn.datepicker=function(H){if(!this.length){return this}if(!G.datepicker.initialized){G(document).mousedown(G.datepicker._checkExternalClick);G.datepicker.initialized=true}if(G("#"+G.datepicker._mainDivId).length===0){G("body").append(G.datepicker.dpDiv)}var I=Array.prototype.slice.call(arguments,1);if(typeof H==="string"&&(H==="isDisabled"||H==="getDate"||H==="widget")){return G.datepicker["_"+H+"Datepicker"].apply(G.datepicker,[this[0]].concat(I))}if(H==="option"&&arguments.length===2&&typeof arguments[1]==="string"){return G.datepicker["_"+H+"Datepicker"].apply(G.datepicker,[this[0]].concat(I))}return this.each(function(){typeof H==="string"?G.datepicker["_"+H+"Datepicker"].apply(G.datepicker,[this].concat(I)):G.datepicker._attachDatepicker(this,H)})};G.datepicker=new F();G.datepicker.initialized=false;G.datepicker.uuid=new Date().getTime();G.datepicker.version="1.10.4"})(jQuery);(function(D,B){var C={buttons:true,height:true,maxHeight:true,maxWidth:true,minHeight:true,minWidth:true,width:true},A={maxHeight:true,maxWidth:true,minHeight:true,minWidth:true};D.widget("ui.dialog",{version:"1.10.4",options:{appendTo:"body",autoOpen:true,buttons:[],closeOnEscape:true,closeText:"close",dialogClass:"",draggable:true,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:false,position:{my:"center",at:"center",of:window,collision:"fit",using:function(F){var E=D(this).css(F).offset().top;if(E<0){D(this).css("top",F.top-E)}}},resizable:true,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height};this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)};this.originalTitle=this.element.attr("title");this.options.title=this.options.title||this.originalTitle;this._createWrapper();this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog);this._createTitlebar();this._createButtonPane();if(this.options.draggable&&D.fn.draggable){this._makeDraggable()}if(this.options.resizable&&D.fn.resizable){this._makeResizable()}this._isOpen=false},_init:function(){if(this.options.autoOpen){this.open()}},_appendTo:function(){var E=this.options.appendTo;if(E&&(E.jquery||E.nodeType)){return D(E)}return this.document.find(E||"body").eq(0)},_destroy:function(){var E,F=this.originalPosition;this._destroyOverlay();this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach();this.uiDialog.stop(true,true).remove();if(this.originalTitle){this.element.attr("title",this.originalTitle)}E=F.parent.children().eq(F.index);if(E.length&&E[0]!==this.element[0]){E.before(this.element)}else{F.parent.append(this.element)}},widget:function(){return this.uiDialog},disable:D.noop,enable:D.noop,close:function(G){var F,E=this;if(!this._isOpen||this._trigger("beforeClose",G)===false){return}this._isOpen=false;this._destroyOverlay();if(!this.opener.filter(":focusable").focus().length){try{F=this.document[0].activeElement;if(F&&F.nodeName.toLowerCase()!=="body"){D(F).blur()}}catch(H){}}this._hide(this.uiDialog,this.options.hide,function(){E._trigger("close",G)})},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(E,G){var F=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;if(F&&!G){this._trigger("focus",E)}return F},open:function(){var E=this;if(this._isOpen){if(this._moveToTop()){this._focusTabbable()}return}this._isOpen=true;this.opener=D(this.document[0].activeElement);this._size();this._position();this._createOverlay();this._moveToTop(null,true);this._show(this.uiDialog,this.options.show,function(){E._focusTabbable();E._trigger("focus")});this._trigger("open")},_focusTabbable:function(){var E=this.element.find("[autofocus]");if(!E.length){E=this.element.find(":tabbable")}if(!E.length){E=this.uiDialogButtonPane.find(":tabbable")}if(!E.length){E=this.uiDialogTitlebarClose.filter(":tabbable")}if(!E.length){E=this.uiDialog}E.eq(0).focus()},_keepFocus:function(F){function E(){var H=this.document[0].activeElement,G=this.uiDialog[0]===H||D.contains(this.uiDialog[0],H);if(!G){this._focusTabbable()}}F.preventDefault();E.call(this);this._delay(E)},_createWrapper:function(){this.uiDialog=D("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo());this._on(this.uiDialog,{keydown:function(F){if(this.options.closeOnEscape&&!F.isDefaultPrevented()&&F.keyCode&&F.keyCode===D.ui.keyCode.ESCAPE){F.preventDefault();this.close(F);return}if(F.keyCode!==D.ui.keyCode.TAB){return}var G=this.uiDialog.find(":tabbable"),E=G.filter(":first"),H=G.filter(":last");if((F.target===H[0]||F.target===this.uiDialog[0])&&!F.shiftKey){E.focus(1);F.preventDefault()}else{if((F.target===E[0]||F.target===this.uiDialog[0])&&F.shiftKey){H.focus(1);F.preventDefault()}}},mousedown:function(E){if(this._moveToTop(E)){this._focusTabbable()}}});if(!this.element.find("[aria-describedby]").length){this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})}},_createTitlebar:function(){var E;this.uiDialogTitlebar=D("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog);this._on(this.uiDialogTitlebar,{mousedown:function(F){if(!D(F.target).closest(".ui-dialog-titlebar-close")){this.uiDialog.focus()}}});this.uiDialogTitlebarClose=D("<button type='button'></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:false}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar);this._on(this.uiDialogTitlebarClose,{click:function(F){F.preventDefault();this.close(F)}});E=D("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar);this._title(E);this.uiDialog.attr({"aria-labelledby":E.attr("id")})},_title:function(E){if(!this.options.title){E.html("&#160;")}E.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=D("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix");this.uiButtonSet=D("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane);this._createButtons()},_createButtons:function(){var E=this,F=this.options.buttons;this.uiDialogButtonPane.remove();this.uiButtonSet.empty();if(D.isEmptyObject(F)||(D.isArray(F)&&!F.length)){this.uiDialog.removeClass("ui-dialog-buttons");return}D.each(F,function(H,I){var J,G;I=D.isFunction(I)?{click:I,text:H}:I;I=D.extend({type:"button"},I);J=I.click;I.click=function(){J.apply(E.element[0],arguments)};G={icons:I.icons,text:I.showText};delete I.icons;delete I.showText;D("<button></button>",I).button(G).appendTo(E.uiButtonSet)});this.uiDialog.addClass("ui-dialog-buttons");this.uiDialogButtonPane.appendTo(this.uiDialog)},_makeDraggable:function(){var E=this,F=this.options;function G(H){return{position:H.position,offset:H.offset}}this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(I,H){D(this).addClass("ui-dialog-dragging");E._blockFrames();E._trigger("dragStart",I,G(H))},drag:function(I,H){E._trigger("drag",I,G(H))},stop:function(I,H){F.position=[H.position.left-E.document.scrollLeft(),H.position.top-E.document.scrollTop()];D(this).removeClass("ui-dialog-dragging");E._unblockFrames();E._trigger("dragStop",I,G(H))}})},_makeResizable:function(){var G=this,I=this.options,J=I.resizable,E=this.uiDialog.css("position"),F=typeof J==="string"?J:"n,e,s,w,se,sw,ne,nw";function H(K){return{originalPosition:K.originalPosition,originalSize:K.originalSize,position:K.position,size:K.size}}this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:I.maxWidth,maxHeight:I.maxHeight,minWidth:I.minWidth,minHeight:this._minHeight(),handles:F,start:function(L,K){D(this).addClass("ui-dialog-resizing");G._blockFrames();G._trigger("resizeStart",L,H(K))},resize:function(L,K){G._trigger("resize",L,H(K))},stop:function(L,K){I.height=D(this).height();I.width=D(this).width();D(this).removeClass("ui-dialog-resizing");G._unblockFrames();G._trigger("resizeStop",L,H(K))}}).css("position",E)},_minHeight:function(){var E=this.options;return E.height==="auto"?E.minHeight:Math.min(E.minHeight,E.height)},_position:function(){var E=this.uiDialog.is(":visible");if(!E){this.uiDialog.show()}this.uiDialog.position(this.options.position);if(!E){this.uiDialog.hide()}},_setOptions:function(G){var F=this,H=false,E={};D.each(G,function(I,J){F._setOption(I,J);if(I in C){H=true}if(I in A){E[I]=J}});if(H){this._size();this._position()}if(this.uiDialog.is(":data(ui-resizable)")){this.uiDialog.resizable("option",E)}},_setOption:function(F,H){var G,I,E=this.uiDialog;if(F==="dialogClass"){E.removeClass(this.options.dialogClass).addClass(H)}if(F==="disabled"){return}this._super(F,H);if(F==="appendTo"){this.uiDialog.appendTo(this._appendTo())}if(F==="buttons"){this._createButtons()}if(F==="closeText"){this.uiDialogTitlebarClose.button({label:""+H})}if(F==="draggable"){G=E.is(":data(ui-draggable)");if(G&&!H){E.draggable("destroy")}if(!G&&H){this._makeDraggable()}}if(F==="position"){this._position()}if(F==="resizable"){I=E.is(":data(ui-resizable)");if(I&&!H){E.resizable("destroy")}if(I&&typeof H==="string"){E.resizable("option","handles",H)}if(!I&&H!==false){this._makeResizable()}}if(F==="title"){this._title(this.uiDialogTitlebar.find(".ui-dialog-title"))}},_size:function(){var F,H,E,G=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0});if(G.minWidth>G.width){G.width=G.minWidth}F=this.uiDialog.css({height:"auto",width:G.width}).outerHeight();H=Math.max(0,G.minHeight-F);E=typeof G.maxHeight==="number"?Math.max(0,G.maxHeight-F):"none";if(G.height==="auto"){this.element.css({minHeight:H,maxHeight:E,height:"auto"})}else{this.element.height(Math.max(0,G.height-F))}if(this.uiDialog.is(":data(ui-resizable)")){this.uiDialog.resizable("option","minHeight",this._minHeight())}},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var E=D(this);return D("<div>").css({position:"absolute",width:E.outerWidth(),height:E.outerHeight()}).appendTo(E.parent()).offset(E.offset())[0]})},_unblockFrames:function(){if(this.iframeBlocks){this.iframeBlocks.remove();delete this.iframeBlocks}},_allowInteraction:function(E){if(D(E.target).closest(".ui-dialog").length){return true}return !!D(E.target).closest(".ui-datepicker").length},_createOverlay:function(){if(!this.options.modal){return}var E=this,F=this.widgetFullName;if(!D.ui.dialog.overlayInstances){this._delay(function(){if(D.ui.dialog.overlayInstances){this.document.bind("focusin.dialog",function(G){if(!E._allowInteraction(G)){G.preventDefault();D(".ui-dialog:visible:last .ui-dialog-content").data(F)._focusTabbable()}})}})}this.overlay=D("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo());this._on(this.overlay,{mousedown:"_keepFocus"});D.ui.dialog.overlayInstances++},_destroyOverlay:function(){if(!this.options.modal){return}if(this.overlay){D.ui.dialog.overlayInstances--;if(!D.ui.dialog.overlayInstances){this.document.unbind("focusin.dialog")}this.overlay.remove();this.overlay=null}}});D.ui.dialog.overlayInstances=0;if(D.uiBackCompat!==false){D.widget("ui.dialog",D.ui.dialog,{_position:function(){var G=this.options.position,H=[],E=[0,0],F;if(G){if(typeof G==="string"||(typeof G==="object"&&"0" in G)){H=G.split?G.split(" "):[G[0],G[1]];if(H.length===1){H[1]=H[0]}D.each(["left","top"],function(I,J){if(+H[I]===H[I]){E[I]=H[I];H[I]=J}});G={my:H[0]+(E[0]<0?E[0]:"+"+E[0])+" "+H[1]+(E[1]<0?E[1]:"+"+E[1]),at:H.join(" ")}}G=D.extend({},D.ui.dialog.prototype.options.position,G)}else{G=D.ui.dialog.prototype.options.position}F=this.uiDialog.is(":visible");if(!F){this.uiDialog.show()}this.uiDialog.position(G);if(!F){this.uiDialog.hide()}}})}}(jQuery));(function(B,A){B.widget("ui.menu",{version:"1.10.4",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element;this.mouseHandled=false;this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,B.proxy(function(C){if(this.options.disabled){C.preventDefault()}},this));if(this.options.disabled){this.element.addClass("ui-state-disabled").attr("aria-disabled","true")}this._on({"mousedown .ui-menu-item > a":function(C){C.preventDefault()},"click .ui-state-disabled > a":function(C){C.preventDefault()},"click .ui-menu-item:has(a)":function(C){var D=B(C.target).closest(".ui-menu-item");if(!this.mouseHandled&&D.not(".ui-state-disabled").length){this.select(C);if(!C.isPropagationStopped()){this.mouseHandled=true}if(D.has(".ui-menu").length){this.expand(C)}else{if(!this.element.is(":focus")&&B(this.document[0].activeElement).closest(".ui-menu").length){this.element.trigger("focus",[true]);if(this.active&&this.active.parents(".ui-menu").length===1){clearTimeout(this.timer)}}}}},"mouseenter .ui-menu-item":function(C){var D=B(C.currentTarget);D.siblings().children(".ui-state-active").removeClass("ui-state-active");this.focus(C,D)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(D,E){var C=this.active||this.element.children(".ui-menu-item").eq(0);if(!E){this.focus(D,C)}},blur:function(C){this._delay(function(){if(!B.contains(this.element[0],this.document[0].activeElement)){this.collapseAll(C)}})},keydown:"_keydown"});this.refresh();this._on(this.document,{click:function(C){if(!B(C.target).closest(".ui-menu").length){this.collapseAll(C)}this.mouseHandled=false}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show();this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var C=B(this);if(C.data("ui-menu-submenu-carat")){C.remove()}});this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(F){var D,H,C,E,J,I=true;function G(K){return K.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}switch(F.keyCode){case B.ui.keyCode.PAGE_UP:this.previousPage(F);break;case B.ui.keyCode.PAGE_DOWN:this.nextPage(F);break;case B.ui.keyCode.HOME:this._move("first","first",F);break;case B.ui.keyCode.END:this._move("last","last",F);break;case B.ui.keyCode.UP:this.previous(F);break;case B.ui.keyCode.DOWN:this.next(F);break;case B.ui.keyCode.LEFT:this.collapse(F);break;case B.ui.keyCode.RIGHT:if(this.active&&!this.active.is(".ui-state-disabled")){this.expand(F)}break;case B.ui.keyCode.ENTER:case B.ui.keyCode.SPACE:this._activate(F);break;case B.ui.keyCode.ESCAPE:this.collapse(F);break;default:I=false;H=this.previousFilter||"";C=String.fromCharCode(F.keyCode);E=false;clearTimeout(this.filterTimer);if(C===H){E=true}else{C=H+C}J=new RegExp("^"+G(C),"i");D=this.activeMenu.children(".ui-menu-item").filter(function(){return J.test(B(this).children("a").text())});D=E&&D.index(this.active.next())!==-1?this.active.nextAll(".ui-menu-item"):D;if(!D.length){C=String.fromCharCode(F.keyCode);J=new RegExp("^"+G(C),"i");D=this.activeMenu.children(".ui-menu-item").filter(function(){return J.test(B(this).children("a").text())})}if(D.length){this.focus(F,D);if(D.length>1){this.previousFilter=C;this.filterTimer=this._delay(function(){delete this.previousFilter},1000)}else{delete this.previousFilter}}else{delete this.previousFilter}}if(I){F.preventDefault()}},_activate:function(C){if(!this.active.is(".ui-state-disabled")){if(this.active.children("a[aria-haspopup='true']").length){this.expand(C)}else{this.select(C)}}},refresh:function(){var C,E=this.options.icons.submenu,D=this.element.find(this.options.menus);this.element.toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length);D.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var H=B(this),F=H.prev("a"),G=B("<span>").addClass("ui-menu-icon ui-icon "+E).data("ui-menu-submenu-carat",true);F.attr("aria-haspopup","true").prepend(G);H.attr("aria-labelledby",F.attr("id"))});C=D.add(this.element);C.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()});C.children(":not(.ui-menu-item)").each(function(){var F=B(this);if(!/[^\-\u2014\u2013\s]/.test(F.text())){F.addClass("ui-widget-content ui-menu-divider")}});C.children(".ui-state-disabled").attr("aria-disabled","true");if(this.active&&!B.contains(this.element[0],this.active[0])){this.blur()}},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(C,D){if(C==="icons"){this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(D.submenu)}this._super(C,D)},focus:function(D,C){var E,F;this.blur(D,D&&D.type==="focus");this._scrollIntoView(C);this.active=C.first();F=this.active.children("a").addClass("ui-state-focus");if(this.options.role){this.element.attr("aria-activedescendant",F.attr("id"))}this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active");if(D&&D.type==="keydown"){this._close()}else{this.timer=this._delay(function(){this._close()},this.delay)}E=C.children(".ui-menu");if(E.length&&D&&(/^mouse/.test(D.type))){this._startOpening(E)}this.activeMenu=C.parent();this._trigger("focus",D,{item:C})},_scrollIntoView:function(F){var E,H,D,G,C,I;if(this._hasScroll()){E=parseFloat(B.css(this.activeMenu[0],"borderTopWidth"))||0;H=parseFloat(B.css(this.activeMenu[0],"paddingTop"))||0;D=F.offset().top-this.activeMenu.offset().top-E-H;G=this.activeMenu.scrollTop();C=this.activeMenu.height();I=F.height();if(D<0){this.activeMenu.scrollTop(G+D)}else{if(D+I>C){this.activeMenu.scrollTop(G+D-C+I)}}}},blur:function(C,D){if(!D){clearTimeout(this.timer)}if(!this.active){return}this.active.children("a").removeClass("ui-state-focus");this.active=null;this._trigger("blur",C,{item:this.active})},_startOpening:function(C){clearTimeout(this.timer);if(C.attr("aria-hidden")!=="true"){return}this.timer=this._delay(function(){this._close();this._open(C)},this.delay)},_open:function(D){var C=B.extend({of:this.active},this.options.position);clearTimeout(this.timer);this.element.find(".ui-menu").not(D.parents(".ui-menu")).hide().attr("aria-hidden","true");D.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(C)},collapseAll:function(D,C){clearTimeout(this.timer);this.timer=this._delay(function(){var E=C?this.element:B(D&&D.target).closest(this.element.find(".ui-menu"));if(!E.length){E=this.element}this._close(E);this.blur(D);this.activeMenu=E},this.delay)},_close:function(C){if(!C){C=this.active?this.active.parent():this.element}C.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(D){var C=this.active&&this.active.parent().closest(".ui-menu-item",this.element);if(C&&C.length){this._close();this.focus(D,C)}},expand:function(D){var C=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();if(C&&C.length){this._open(C.parent());this._delay(function(){this.focus(D,C)})}},next:function(C){this._move("next","first",C)},previous:function(C){this._move("prev","last",C)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(E,D,F){var C;if(this.active){if(E==="first"||E==="last"){C=this.active[E==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1)}else{C=this.active[E+"All"](".ui-menu-item").eq(0)}}if(!C||!C.length||!this.active){C=this.activeMenu.children(".ui-menu-item")[D]()}this.focus(F,C)},nextPage:function(E){var D,F,C;if(!this.active){this.next(E);return}if(this.isLastItem()){return}if(this._hasScroll()){F=this.active.offset().top;C=this.element.height();this.active.nextAll(".ui-menu-item").each(function(){D=B(this);return D.offset().top-F-C<0});this.focus(E,D)}else{this.focus(E,this.activeMenu.children(".ui-menu-item")[!this.active?"first":"last"]())}},previousPage:function(E){var D,F,C;if(!this.active){this.next(E);return}if(this.isFirstItem()){return}if(this._hasScroll()){F=this.active.offset().top;C=this.element.height();this.active.prevAll(".ui-menu-item").each(function(){D=B(this);return D.offset().top-F+C>0});this.focus(E,D)}else{this.focus(E,this.activeMenu.children(".ui-menu-item").first())}},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(D){this.active=this.active||B(D.target).closest(".ui-menu-item");var C={item:this.active};if(!this.active.has(".ui-menu").length){this.collapseAll(D,true)}this._trigger("select",D,C)}})}(jQuery));(function(B,A){B.widget("ui.progressbar",{version:"1.10.4",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue();this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min});this.valueDiv=B("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element);this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.valueDiv.remove()},value:function(C){if(C===A){return this.options.value}this.options.value=this._constrainedValue(C);this._refreshValue()},_constrainedValue:function(C){if(C===A){C=this.options.value}this.indeterminate=C===false;if(typeof C!=="number"){C=0}return this.indeterminate?false:Math.min(this.options.max,Math.max(this.min,C))},_setOptions:function(C){var D=C.value;delete C.value;this._super(C);this.options.value=this._constrainedValue(D);this._refreshValue()},_setOption:function(C,D){if(C==="max"){D=Math.max(this.min,D)}this._super(C,D)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var D=this.options.value,C=this._percentage();this.valueDiv.toggle(this.indeterminate||D>this.min).toggleClass("ui-corner-right",D===this.options.max).width(C.toFixed(0)+"%");this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate);if(this.indeterminate){this.element.removeAttr("aria-valuenow");if(!this.overlayDiv){this.overlayDiv=B("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv)}}else{this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":D});if(this.overlayDiv){this.overlayDiv.remove();this.overlayDiv=null}}if(this.oldValue!==D){this.oldValue=D;this._trigger("change")}if(D===this.options.max){this._trigger("complete")}}})})(jQuery);(function(C,B){var A=5;C.widget("ui.slider",C.ui.mouse,{version:"1.10.4",widgetEventPrefix:"slide",options:{animate:false,distance:0,max:100,min:0,orientation:"horizontal",range:false,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=false;this._mouseSliding=false;this._animateOff=true;this._handleIndex=null;this._detectOrientation();this._mouseInit();this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all");this._refresh();this._setOption("disabled",this.options.disabled);this._animateOff=false},_refresh:function(){this._createRange();this._createHandles();this._setupEvents();this._refreshValue()},_createHandles:function(){var E,G,F=this.options,I=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),D="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",H=[];G=(F.values&&F.values.length)||1;if(I.length>G){I.slice(G).remove();I=I.slice(0,G)}for(E=I.length;E<G;E++){H.push(D)}this.handles=I.add(C(H.join("")).appendTo(this.element));this.handle=this.handles.eq(0);this.handles.each(function(J){C(this).data("ui-slider-handle-index",J)})},_createRange:function(){var D=this.options,E="";if(D.range){if(D.range===true){if(!D.values){D.values=[this._valueMin(),this._valueMin()]}else{if(D.values.length&&D.values.length!==2){D.values=[D.values[0],D.values[0]]}else{if(C.isArray(D.values)){D.values=D.values.slice(0)}}}}if(!this.range||!this.range.length){this.range=C("<div></div>").appendTo(this.element);E="ui-slider-range ui-widget-header ui-corner-all"}else{this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({"left":"","bottom":""})}this.range.addClass(E+((D.range==="min"||D.range==="max")?" ui-slider-range-"+D.range:""))}else{if(this.range){this.range.remove()}this.range=null}},_setupEvents:function(){var D=this.handles.add(this.range).filter("a");this._off(D);this._on(D,this._handleEvents);this._hoverable(D);this._focusable(D)},_destroy:function(){this.handles.remove();if(this.range){this.range.remove()}this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all");this._mouseDestroy()},_mouseCapture:function(H){var L,D,J,M,F,G,E,I,N=this,K=this.options;if(K.disabled){return false}this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()};this.elementOffset=this.element.offset();L={x:H.pageX,y:H.pageY};D=this._normValueFromMouse(L);J=this._valueMax()-this._valueMin()+1;this.handles.each(function(O){var P=Math.abs(D-N.values(O));if((J>P)||(J===P&&(O===N._lastChangedValue||N.values(O)===K.min))){J=P;M=C(this);F=O}});G=this._start(H,F);if(G===false){return false}this._mouseSliding=true;this._handleIndex=F;M.addClass("ui-state-active").focus();E=M.offset();I=!C(H.target).parents().addBack().is(".ui-slider-handle");this._clickOffset=I?{left:0,top:0}:{left:H.pageX-E.left-(M.width()/2),top:H.pageY-E.top-(M.height()/2)-(parseInt(M.css("borderTopWidth"),10)||0)-(parseInt(M.css("borderBottomWidth"),10)||0)+(parseInt(M.css("marginTop"),10)||0)};if(!this.handles.hasClass("ui-state-hover")){this._slide(H,F,D)}this._animateOff=true;return true},_mouseStart:function(){return true},_mouseDrag:function(E){var D={x:E.pageX,y:E.pageY},F=this._normValueFromMouse(D);this._slide(E,this._handleIndex,F);return false},_mouseStop:function(D){this.handles.removeClass("ui-state-active");this._mouseSliding=false;this._stop(D,this._handleIndex);this._change(D,this._handleIndex);this._handleIndex=null;this._clickOffset=null;this._animateOff=false;return false},_detectOrientation:function(){this.orientation=(this.options.orientation==="vertical")?"vertical":"horizontal"},_normValueFromMouse:function(G){var I,E,H,F,D;if(this.orientation==="horizontal"){I=this.elementSize.width;E=G.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)}else{I=this.elementSize.height;E=G.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)}H=(E/I);if(H>1){H=1}if(H<0){H=0}if(this.orientation==="vertical"){H=1-H}F=this._valueMax()-this._valueMin();D=this._valueMin()+H*F;return this._trimAlignValue(D)},_start:function(D,E){var F={handle:this.handles[E],value:this.value()};if(this.options.values&&this.options.values.length){F.value=this.values(E);F.values=this.values()}return this._trigger("start",D,F)},_slide:function(G,H,F){var D,I,E;if(this.options.values&&this.options.values.length){D=this.values(H?0:1);if((this.options.values.length===2&&this.options.range===true)&&((H===0&&F>D)||(H===1&&F<D))){F=D}if(F!==this.values(H)){I=this.values();I[H]=F;E=this._trigger("slide",G,{handle:this.handles[H],value:F,values:I});D=this.values(H?0:1);if(E!==false){this.values(H,F)}}}else{if(F!==this.value()){E=this._trigger("slide",G,{handle:this.handles[H],value:F});if(E!==false){this.value(F)}}}},_stop:function(D,E){var F={handle:this.handles[E],value:this.value()};if(this.options.values&&this.options.values.length){F.value=this.values(E);F.values=this.values()}this._trigger("stop",D,F)},_change:function(D,E){if(!this._keySliding&&!this._mouseSliding){var F={handle:this.handles[E],value:this.value()};if(this.options.values&&this.options.values.length){F.value=this.values(E);F.values=this.values()}this._lastChangedValue=E;this._trigger("change",D,F)}},value:function(D){if(arguments.length){this.options.value=this._trimAlignValue(D);this._refreshValue();this._change(null,0);return}return this._value()},values:function(F,H){var G,D,E;if(arguments.length>1){this.options.values[F]=this._trimAlignValue(H);this._refreshValue();this._change(null,F);return}if(arguments.length){if(C.isArray(arguments[0])){G=this.options.values;D=arguments[0];for(E=0;E<G.length;E+=1){G[E]=this._trimAlignValue(D[E]);this._change(null,E)}this._refreshValue()}else{if(this.options.values&&this.options.values.length){return this._values(F)}else{return this.value()}}}else{return this._values()}},_setOption:function(D,G){var E,F=0;if(D==="range"&&this.options.range===true){if(G==="min"){this.options.value=this._values(0);this.options.values=null}else{if(G==="max"){this.options.value=this._values(this.options.values.length-1);this.options.values=null}}}if(C.isArray(this.options.values)){F=this.options.values.length}C.Widget.prototype._setOption.apply(this,arguments);switch(D){case"orientation":this._detectOrientation();this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation);this._refreshValue();break;case"value":this._animateOff=true;this._refreshValue();this._change(null,0);this._animateOff=false;break;case"values":this._animateOff=true;this._refreshValue();for(E=0;E<F;E+=1){this._change(null,E)}this._animateOff=false;break;case"min":case"max":this._animateOff=true;this._refreshValue();this._animateOff=false;break;case"range":this._animateOff=true;this._refresh();this._animateOff=false;break}},_value:function(){var D=this.options.value;D=this._trimAlignValue(D);return D},_values:function(E){var F,G,D;if(arguments.length){F=this.options.values[E];F=this._trimAlignValue(F);return F}else{if(this.options.values&&this.options.values.length){G=this.options.values.slice();for(D=0;D<G.length;D+=1){G[D]=this._trimAlignValue(G[D])}return G}else{return[]}}},_trimAlignValue:function(G){if(G<=this._valueMin()){return this._valueMin()}if(G>=this._valueMax()){return this._valueMax()}var D=(this.options.step>0)?this.options.step:1,E=(G-this._valueMin())%D,F=G-E;if(Math.abs(E)*2>=D){F+=(E>0)?D:(-D)}return parseFloat(F.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var D,F,J,I,G,H=this.options.range,L=this.options,K=this,M=(!this._animateOff)?L.animate:false,E={};if(this.options.values&&this.options.values.length){this.handles.each(function(N){F=(K.values(N)-K._valueMin())/(K._valueMax()-K._valueMin())*100;E[K.orientation==="horizontal"?"left":"bottom"]=F+"%";C(this).stop(1,1)[M?"animate":"css"](E,L.animate);if(K.options.range===true){if(K.orientation==="horizontal"){if(N===0){K.range.stop(1,1)[M?"animate":"css"]({left:F+"%"},L.animate)}if(N===1){K.range[M?"animate":"css"]({width:(F-D)+"%"},{queue:false,duration:L.animate})}}else{if(N===0){K.range.stop(1,1)[M?"animate":"css"]({bottom:(F)+"%"},L.animate)}if(N===1){K.range[M?"animate":"css"]({height:(F-D)+"%"},{queue:false,duration:L.animate})}}}D=F})}else{J=this.value();I=this._valueMin();G=this._valueMax();F=(G!==I)?(J-I)/(G-I)*100:0;E[this.orientation==="horizontal"?"left":"bottom"]=F+"%";this.handle.stop(1,1)[M?"animate":"css"](E,L.animate);if(H==="min"&&this.orientation==="horizontal"){this.range.stop(1,1)[M?"animate":"css"]({width:F+"%"},L.animate)}if(H==="max"&&this.orientation==="horizontal"){this.range[M?"animate":"css"]({width:(100-F)+"%"},{queue:false,duration:L.animate})}if(H==="min"&&this.orientation==="vertical"){this.range.stop(1,1)[M?"animate":"css"]({height:F+"%"},L.animate)}if(H==="max"&&this.orientation==="vertical"){this.range[M?"animate":"css"]({height:(100-F)+"%"},{queue:false,duration:L.animate})}}},_handleEvents:{keydown:function(H){var F,G,E,D,I=C(H.target).data("ui-slider-handle-index");switch(H.keyCode){case C.ui.keyCode.HOME:case C.ui.keyCode.END:case C.ui.keyCode.PAGE_UP:case C.ui.keyCode.PAGE_DOWN:case C.ui.keyCode.UP:case C.ui.keyCode.RIGHT:case C.ui.keyCode.DOWN:case C.ui.keyCode.LEFT:H.preventDefault();if(!this._keySliding){this._keySliding=true;C(H.target).addClass("ui-state-active");F=this._start(H,I);if(F===false){return}}break}D=this.options.step;if(this.options.values&&this.options.values.length){G=E=this.values(I)}else{G=E=this.value()}switch(H.keyCode){case C.ui.keyCode.HOME:E=this._valueMin();break;case C.ui.keyCode.END:E=this._valueMax();break;case C.ui.keyCode.PAGE_UP:E=this._trimAlignValue(G+((this._valueMax()-this._valueMin())/A));break;case C.ui.keyCode.PAGE_DOWN:E=this._trimAlignValue(G-((this._valueMax()-this._valueMin())/A));break;case C.ui.keyCode.UP:case C.ui.keyCode.RIGHT:if(G===this._valueMax()){return}E=this._trimAlignValue(G+D);break;case C.ui.keyCode.DOWN:case C.ui.keyCode.LEFT:if(G===this._valueMin()){return}E=this._trimAlignValue(G-D);break}this._slide(H,I,E)},click:function(D){D.preventDefault()},keyup:function(D){var E=C(D.target).data("ui-slider-handle-index");if(this._keySliding){this._keySliding=false;this._stop(D,E);this._change(D,E);C(D.target).removeClass("ui-state-active")}}}})}(jQuery));(function(B){function A(C){return function(){var D=this.element.val();C.apply(this,arguments);this._refresh();if(D!==this.element.val()){this._trigger("change")}}}B.widget("ui.spinner",{version:"1.10.4",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:true,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max);this._setOption("min",this.options.min);this._setOption("step",this.options.step);if(this.value()!==""){this._value(this.element.val(),true)}this._draw();this._on(this._events);this._refresh();this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var C={},D=this.element;B.each(["min","max","step"],function(E,F){var G=D.attr(F);if(G!==undefined&&G.length){C[F]=G}});return C},_events:{keydown:function(C){if(this._start(C)&&this._keydown(C)){C.preventDefault()}},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(C){if(this.cancelBlur){delete this.cancelBlur;return}this._stop();this._refresh();if(this.previous!==this.element.val()){this._trigger("change",C)}},mousewheel:function(D,C){if(!C){return}if(!this.spinning&&!this._start(D)){return false}this._spin((C>0?1:-1)*this.options.step,D);clearTimeout(this.mousewheelTimer);this.mousewheelTimer=this._delay(function(){if(this.spinning){this._stop(D)}},100);D.preventDefault()},"mousedown .ui-spinner-button":function(D){var E;E=this.element[0]===this.document[0].activeElement?this.previous:this.element.val();function C(){var F=this.element[0]===this.document[0].activeElement;if(!F){this.element.focus();this.previous=E;this._delay(function(){this.previous=E})}}D.preventDefault();C.call(this);this.cancelBlur=true;this._delay(function(){delete this.cancelBlur;C.call(this)});if(this._start(D)===false){return}this._repeat(null,B(D.currentTarget).hasClass("ui-spinner-up")?1:-1,D)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(C){if(!B(C.currentTarget).hasClass("ui-state-active")){return}if(this._start(C)===false){return false}this._repeat(null,B(C.currentTarget).hasClass("ui-spinner-up")?1:-1,C)},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var C=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton");this.buttons=C.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all");if(this.buttons.height()>Math.ceil(C.height()*0.5)&&C.height()>0){C.height(C.height())}if(this.options.disabled){this.disable()}},_keydown:function(D){var C=this.options,E=B.ui.keyCode;switch(D.keyCode){case E.UP:this._repeat(null,1,D);return true;case E.DOWN:this._repeat(null,-1,D);return true;case E.PAGE_UP:this._repeat(null,C.page,D);return true;case E.PAGE_DOWN:this._repeat(null,-C.page,D);return true}return false},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(C){if(!this.spinning&&this._trigger("start",C)===false){return false}if(!this.counter){this.counter=1}this.spinning=true;return true},_repeat:function(C,D,E){C=C||500;clearTimeout(this.timer);this.timer=this._delay(function(){this._repeat(40,D,E)},C);this._spin(D*this.options.step,E)},_spin:function(C,D){var E=this.value()||0;if(!this.counter){this.counter=1}E=this._adjustValue(E+C*this._increment(this.counter));if(!this.spinning||this._trigger("spin",D,{value:E})!==false){this._value(E);this.counter++}},_increment:function(C){var D=this.options.incremental;if(D){return B.isFunction(D)?D(C):Math.floor(C*C*C/50000-C*C/500+17*C/200+1)}return 1},_precision:function(){var C=this._precisionOf(this.options.step);if(this.options.min!==null){C=Math.max(C,this._precisionOf(this.options.min))}return C},_precisionOf:function(D){var C=D.toString(),E=C.indexOf(".");return E===-1?0:C.length-E-1},_adjustValue:function(E){var F,D,C=this.options;F=C.min!==null?C.min:0;D=E-F;D=Math.round(D/C.step)*C.step;E=F+D;E=parseFloat(E.toFixed(this._precision()));if(C.max!==null&&E>C.max){return C.max}if(C.min!==null&&E<C.min){return C.min}return E},_stop:function(C){if(!this.spinning){return}clearTimeout(this.timer);clearTimeout(this.mousewheelTimer);this.counter=0;this.spinning=false;this._trigger("stop",C)},_setOption:function(D,E){if(D==="culture"||D==="numberFormat"){var C=this._parse(this.element.val());this.options[D]=E;this.element.val(this._format(C));return}if(D==="max"||D==="min"||D==="step"){if(typeof E==="string"){E=this._parse(E)}}if(D==="icons"){this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(E.up);this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(E.down)}this._super(D,E);if(D==="disabled"){if(E){this.element.prop("disabled",true);this.buttons.button("disable")}else{this.element.prop("disabled",false);this.buttons.button("enable")}}},_setOptions:A(function(C){this._super(C);this._value(this.element.val())}),_parse:function(C){if(typeof C==="string"&&C!==""){C=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(C,10,this.options.culture):+C}return C===""||isNaN(C)?null:C},_format:function(C){if(C===""){return""}return window.Globalize&&this.options.numberFormat?Globalize.format(C,this.options.numberFormat,this.options.culture):C},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(D,E){var C;if(D!==""){C=this._parse(D);if(C!==null){if(!E){C=this._adjustValue(C)}D=this._format(C)}}this.element.val(D);this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",false).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow");this.uiSpinner.replaceWith(this.element)},stepUp:A(function(C){this._stepUp(C)}),_stepUp:function(C){if(this._start()){this._spin((C||1)*this.options.step);this._stop()}},stepDown:A(function(C){this._stepDown(C)}),_stepDown:function(C){if(this._start()){this._spin((C||1)*-this.options.step);this._stop()}},pageUp:A(function(C){this._stepUp((C||1)*this.options.page)}),pageDown:A(function(C){this._stepDown((C||1)*this.options.page)}),value:function(C){if(!arguments.length){return this._parse(this.element.val())}A(this._value).call(this,C)},widget:function(){return this.uiSpinner}})}(jQuery));(function(F,D){var E=0,B=/#.*$/;function C(){return ++E}function A(G){G=G.cloneNode(false);return G.hash.length>1&&decodeURIComponent(G.href.replace(B,""))===decodeURIComponent(location.href.replace(B,""))}F.widget("ui.tabs",{version:"1.10.4",delay:300,options:{active:null,collapsible:false,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var G=this,H=this.options;this.running=false;this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",H.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(I){if(F(this).is(".ui-state-disabled")){I.preventDefault()}}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){if(F(this).closest("li").is(".ui-state-disabled")){this.blur()}});this._processTabs();H.active=this._initialActive();if(F.isArray(H.disabled)){H.disabled=F.unique(H.disabled.concat(F.map(this.tabs.filter(".ui-state-disabled"),function(I){return G.tabs.index(I)}))).sort()}if(this.options.active!==false&&this.anchors.length){this.active=this._findActive(H.active)}else{this.active=F()}this._refresh();if(this.active.length){this.load(H.active)}},_initialActive:function(){var H=this.options.active,G=this.options.collapsible,I=location.hash.substring(1);if(H===null){if(I){this.tabs.each(function(J,K){if(F(K).attr("aria-controls")===I){H=J;return false}})}if(H===null){H=this.tabs.index(this.tabs.filter(".ui-tabs-active"))}if(H===null||H===-1){H=this.tabs.length?0:false}}if(H!==false){H=this.tabs.index(this.tabs.eq(H));if(H===-1){H=G?false:0}}if(!G&&H===false&&this.anchors.length){H=0}return H},_getCreateEventData:function(){return{tab:this.active,panel:!this.active.length?F():this._getPanelForTab(this.active)}},_tabKeydown:function(I){var J=F(this.document[0].activeElement).closest("li"),H=this.tabs.index(J),G=true;if(this._handlePageNav(I)){return}switch(I.keyCode){case F.ui.keyCode.RIGHT:case F.ui.keyCode.DOWN:H++;break;case F.ui.keyCode.UP:case F.ui.keyCode.LEFT:G=false;H--;break;case F.ui.keyCode.END:H=this.anchors.length-1;break;case F.ui.keyCode.HOME:H=0;break;case F.ui.keyCode.SPACE:I.preventDefault();clearTimeout(this.activating);this._activate(H);return;case F.ui.keyCode.ENTER:I.preventDefault();clearTimeout(this.activating);this._activate(H===this.options.active?false:H);return;default:return}I.preventDefault();clearTimeout(this.activating);H=this._focusNextTab(H,G);if(!I.ctrlKey){J.attr("aria-selected","false");this.tabs.eq(H).attr("aria-selected","true");this.activating=this._delay(function(){this.option("active",H)},this.delay)}},_panelKeydown:function(G){if(this._handlePageNav(G)){return}if(G.ctrlKey&&G.keyCode===F.ui.keyCode.UP){G.preventDefault();this.active.focus()}},_handlePageNav:function(G){if(G.altKey&&G.keyCode===F.ui.keyCode.PAGE_UP){this._activate(this._focusNextTab(this.options.active-1,false));return true}if(G.altKey&&G.keyCode===F.ui.keyCode.PAGE_DOWN){this._activate(this._focusNextTab(this.options.active+1,true));return true}},_findNextTab:function(H,G){var I=this.tabs.length-1;function J(){if(H>I){H=0}if(H<0){H=I}return H}while(F.inArray(J(),this.options.disabled)!==-1){H=G?H+1:H-1}return H},_focusNextTab:function(H,G){H=this._findNextTab(H,G);this.tabs.eq(H).focus();return H},_setOption:function(G,H){if(G==="active"){this._activate(H);return}if(G==="disabled"){this._setupDisabled(H);return}this._super(G,H);if(G==="collapsible"){this.element.toggleClass("ui-tabs-collapsible",H);if(!H&&this.options.active===false){this._activate(0)}}if(G==="event"){this._setupEvents(H)}if(G==="heightStyle"){this._setupHeightStyle(H)}},_tabId:function(G){return G.attr("aria-controls")||"ui-tabs-"+C()},_sanitizeSelector:function(G){return G?G.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var H=this.options,G=this.tablist.children(":has(a[href])");H.disabled=F.map(G.filter(".ui-state-disabled"),function(I){return G.index(I)});this._processTabs();if(H.active===false||!this.anchors.length){H.active=false;this.active=F()}else{if(this.active.length&&!F.contains(this.tablist[0],this.active[0])){if(this.tabs.length===H.disabled.length){H.active=false;this.active=F()}else{this._activate(this._findNextTab(Math.max(0,H.active-1),false))}}else{H.active=this.tabs.index(this.active)}}this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled);this._setupEvents(this.options.event);this._setupHeightStyle(this.options.heightStyle);this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1});this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"});if(!this.active.length){this.tabs.eq(0).attr("tabIndex",0)}else{this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0});this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})}},_processTabs:function(){var G=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist");this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1});this.anchors=this.tabs.map(function(){return F("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1});this.panels=F();this.anchors.each(function(M,H){var N,O,K,J=F(H).uniqueId().attr("id"),L=F(H).closest("li"),I=L.attr("aria-controls");if(A(H)){N=H.hash;O=G.element.find(G._sanitizeSelector(N))}else{K=G._tabId(L);N="#"+K;O=G.element.find(N);if(!O.length){O=G._createPanel(K);O.insertAfter(G.panels[M-1]||G.tablist)}O.attr("aria-live","polite")}if(O.length){G.panels=G.panels.add(O)}if(I){L.data("ui-tabs-aria-controls",I)}L.attr({"aria-controls":N.substring(1),"aria-labelledby":J});O.attr("aria-labelledby",J)});this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.tablist||this.element.find("ol,ul").eq(0)},_createPanel:function(G){return F("<div>").attr("id",G).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",true)},_setupDisabled:function(I){if(F.isArray(I)){if(!I.length){I=false}else{if(I.length===this.anchors.length){I=true}}}for(var G=0,H;(H=this.tabs[G]);G++){if(I===true||F.inArray(G,I)!==-1){F(H).addClass("ui-state-disabled").attr("aria-disabled","true")}else{F(H).removeClass("ui-state-disabled").removeAttr("aria-disabled")}}this.options.disabled=I},_setupEvents:function(G){var H={click:function(I){I.preventDefault()}};if(G){F.each(G.split(" "),function(J,I){H[I]="_eventHandler"})}this._off(this.anchors.add(this.tabs).add(this.panels));this._on(this.anchors,H);this._on(this.tabs,{keydown:"_tabKeydown"});this._on(this.panels,{keydown:"_panelKeydown"});this._focusable(this.tabs);this._hoverable(this.tabs)},_setupHeightStyle:function(I){var H,G=this.element.parent();if(I==="fill"){H=G.height();H-=this.element.outerHeight()-this.element.height();this.element.siblings(":visible").each(function(){var K=F(this),J=K.css("position");if(J==="absolute"||J==="fixed"){return}H-=K.outerHeight(true)});this.element.children().not(this.panels).each(function(){H-=F(this).outerHeight(true)});this.panels.each(function(){F(this).height(Math.max(0,H-F(this).innerHeight()+F(this).height()))}).css("overflow","auto")}else{if(I==="auto"){H=0;this.panels.each(function(){H=Math.max(H,F(this).height("").height())}).height(H)}}},_eventHandler:function(P){var L=this.options,M=this.active,G=F(P.currentTarget),O=G.closest("li"),J=O[0]===M[0],I=J&&L.collapsible,N=I?F():this._getPanelForTab(O),H=!M.length?F():this._getPanelForTab(M),K={oldTab:M,oldPanel:H,newTab:I?F():O,newPanel:N};P.preventDefault();if(O.hasClass("ui-state-disabled")||O.hasClass("ui-tabs-loading")||this.running||(J&&!L.collapsible)||(this._trigger("beforeActivate",P,K)===false)){return}L.active=I?false:this.tabs.index(O);this.active=J?F():O;if(this.xhr){this.xhr.abort()}if(!H.length&&!N.length){F.error("jQuery UI Tabs: Mismatching fragment identifier.")}if(N.length){this.load(this.tabs.index(O),P)}this._toggle(P,K)},_toggle:function(K,M){var I=this,H=M.newPanel,J=M.oldPanel;this.running=true;function G(){I.running=false;I._trigger("activate",K,M)}function L(){M.newTab.closest("li").addClass("ui-tabs-active ui-state-active");if(H.length&&I.options.show){I._show(H,I.options.show,G)}else{H.show();G()}}if(J.length&&this.options.hide){this._hide(J,this.options.hide,function(){M.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");L()})}else{M.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active");J.hide();L()}J.attr({"aria-expanded":"false","aria-hidden":"true"});M.oldTab.attr("aria-selected","false");if(H.length&&J.length){M.oldTab.attr("tabIndex",-1)}else{if(H.length){this.tabs.filter(function(){return F(this).attr("tabIndex")===0}).attr("tabIndex",-1)}}H.attr({"aria-expanded":"true","aria-hidden":"false"});M.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(H){var I,G=this._findActive(H);if(G[0]===this.active[0]){return}if(!G.length){G=this.active}I=G.find(".ui-tabs-anchor")[0];this._eventHandler({target:I,currentTarget:I,preventDefault:F.noop})},_findActive:function(G){return G===false?F():this.tabs.eq(G)},_getIndex:function(G){if(typeof G==="string"){G=this.anchors.index(this.anchors.filter("[href$='"+G+"']"))}return G},_destroy:function(){if(this.xhr){this.xhr.abort()}this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible");this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role");this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId();this.tabs.add(this.panels).each(function(){if(F.data(this,"ui-tabs-destroy")){F(this).remove()}else{F(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}});this.tabs.each(function(){var G=F(this),H=G.data("ui-tabs-aria-controls");if(H){G.attr("aria-controls",H).removeData("ui-tabs-aria-controls")}else{G.removeAttr("aria-controls")}});this.panels.show();if(this.options.heightStyle!=="content"){this.panels.css("height","")}},enable:function(G){var H=this.options.disabled;if(H===false){return}if(G===D){H=false}else{G=this._getIndex(G);if(F.isArray(H)){H=F.map(H,function(I){return I!==G?I:null})}else{H=F.map(this.tabs,function(J,I){return I!==G?I:null})}}this._setupDisabled(H)},disable:function(G){var H=this.options.disabled;if(H===true){return}if(G===D){H=true}else{G=this._getIndex(G);if(F.inArray(G,H)!==-1){return}if(F.isArray(H)){H=F.merge([G],H).sort()}else{H=[G]}}this._setupDisabled(H)},load:function(K,J){K=this._getIndex(K);var H=this,I=this.tabs.eq(K),L=I.find(".ui-tabs-anchor"),G=this._getPanelForTab(I),M={tab:I,panel:G};if(A(L[0])){return}this.xhr=F.ajax(this._ajaxSettings(L,J,M));if(this.xhr&&this.xhr.statusText!=="canceled"){I.addClass("ui-tabs-loading");G.attr("aria-busy","true");this.xhr.success(function(N){setTimeout(function(){G.html(N);H._trigger("load",J,M)},1)}).complete(function(N,O){setTimeout(function(){if(O==="abort"){H.panels.stop(false,true)}I.removeClass("ui-tabs-loading");G.removeAttr("aria-busy");if(N===H.xhr){delete H.xhr}},1)})}},_ajaxSettings:function(I,H,J){var G=this;return{url:I.attr("href"),beforeSend:function(K,L){return G._trigger("beforeLoad",H,F.extend({jqXHR:K,ajaxSettings:L},J))}}},_getPanelForTab:function(G){var H=F(G).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+H))}})})(jQuery);(function(D){var B=0;function A(E,G){var F=(E.attr("aria-describedby")||"").split(/\s+/);F.push(G);E.data("ui-tooltip-id",G).attr("aria-describedby",D.trim(F.join(" ")))}function C(E){var H=E.data("ui-tooltip-id"),G=(E.attr("aria-describedby")||"").split(/\s+/),F=D.inArray(H,G);if(F!==-1){G.splice(F,1)}E.removeData("ui-tooltip-id");G=D.trim(G.join(" "));if(G){E.attr("aria-describedby",G)}else{E.removeAttr("aria-describedby")}}D.widget("ui.tooltip",{version:"1.10.4",options:{content:function(){var E=D(this).attr("title")||"";return D("<a>").text(E).html()},hide:true,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:true,tooltipClass:null,track:false,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"});this.tooltips={};this.parents={};if(this.options.disabled){this._disable()}},_setOption:function(E,G){var F=this;if(E==="disabled"){this[G?"_disable":"_enable"]();this.options[E]=G;return}this._super(E,G);if(E==="content"){D.each(this.tooltips,function(I,H){F._updateContent(H)})}},_disable:function(){var E=this;D.each(this.tooltips,function(H,G){var F=D.Event("blur");F.target=F.currentTarget=G[0];E.close(F,true)});this.element.find(this.options.items).addBack().each(function(){var F=D(this);if(F.is("[title]")){F.data("ui-tooltip-title",F.attr("title")).attr("title","")}})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var E=D(this);if(E.data("ui-tooltip-title")){E.attr("title",E.data("ui-tooltip-title"))}})},open:function(F){var E=this,G=D(F?F.target:this.element).closest(this.options.items);if(!G.length||G.data("ui-tooltip-id")){return}if(G.attr("title")){G.data("ui-tooltip-title",G.attr("title"))}G.data("ui-tooltip-open",true);if(F&&F.type==="mouseover"){G.parents().each(function(){var H=D(this),I;if(H.data("ui-tooltip-open")){I=D.Event("blur");I.target=I.currentTarget=this;E.close(I,true)}if(H.attr("title")){H.uniqueId();E.parents[this.id]={element:this,title:H.attr("title")};H.attr("title","")}})}this._updateContent(G,F)},_updateContent:function(I,H){var F,J=this.options.content,G=this,E=H?H.type:null;if(typeof J==="string"){return this._open(H,I,J)}F=J.call(I[0],function(K){if(!I.data("ui-tooltip-open")){return}G._delay(function(){if(H){H.type=E}this._open(H,I,K)})});if(F){this._open(H,I,F)}},_open:function(G,I,K){var E,J,F,L=D.extend({},this.options.position);if(!K){return}E=this._find(I);if(E.length){E.find(".ui-tooltip-content").html(K);return}if(I.is("[title]")){if(G&&G.type==="mouseover"){I.attr("title","")}else{I.removeAttr("title")}}E=this._tooltip(I);A(I,E.attr("id"));E.find(".ui-tooltip-content").html(K);function H(M){L.of=M;if(E.is(":hidden")){return}E.position(L)}if(this.options.track&&G&&/^mouse/.test(G.type)){this._on(this.document,{mousemove:H});H(G)}else{E.position(D.extend({of:I},this.options.position))}E.hide();this._show(E,this.options.show);if(this.options.show&&this.options.show.delay){F=this.delayedShow=setInterval(function(){if(E.is(":visible")){H(L.of);clearInterval(F)}},D.fx.interval)}this._trigger("open",G,{tooltip:E});J={keyup:function(N){if(N.keyCode===D.ui.keyCode.ESCAPE){var M=D.Event(N);M.currentTarget=I[0];this.close(M,true)}},remove:function(){this._removeTooltip(E)}};if(!G||G.type==="mouseover"){J.mouseleave="close"}if(!G||G.type==="focusin"){J.focusout="close"}this._on(true,I,J)},close:function(F){var E=this,H=D(F?F.currentTarget:this.element),G=this._find(H);if(this.closing){return}clearInterval(this.delayedShow);if(H.data("ui-tooltip-title")){H.attr("title",H.data("ui-tooltip-title"))}C(H);G.stop(true);this._hide(G,this.options.hide,function(){E._removeTooltip(D(this))});H.removeData("ui-tooltip-open");this._off(H,"mouseleave focusout keyup");if(H[0]!==this.element[0]){this._off(H,"remove")}this._off(this.document,"mousemove");if(F&&F.type==="mouseleave"){D.each(this.parents,function(J,I){D(I.element).attr("title",I.title);delete E.parents[J]})}this.closing=true;this._trigger("close",F,{tooltip:G});this.closing=false},_tooltip:function(F){var G="ui-tooltip-"+B++,E=D("<div>").attr({id:G,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));D("<div>").addClass("ui-tooltip-content").appendTo(E);E.appendTo(this.document[0].body);this.tooltips[G]=F;return E},_find:function(E){var F=E.data("ui-tooltip-id");return F?D("#"+F):D()},_removeTooltip:function(E){E.remove();delete this.tooltips[E.attr("id")]},_destroy:function(){var E=this;D.each(this.tooltips,function(H,G){var F=D.Event("blur");F.target=F.currentTarget=G[0];E.close(F,true);D("#"+H).remove();if(G.data("ui-tooltip-title")){G.attr("title",G.data("ui-tooltip-title"));G.removeData("ui-tooltip-title")}})}})}(jQuery));(function(C,B){var A="ui-effects-";C.effects={effect:{}};
/*
 * jQuery Color Animations v2.1.2
 * https://github.com/jquery/jquery-color
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * Date: Wed Jan 16 08:47:09 2013 -0600
 */
(function(Q,D){var K="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",L=/^([\-+])=\s*(\d+\.?\d*)/,H=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(S){return[S[1],S[2],S[3],S[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(S){return[S[1]*2.55,S[2]*2.55,S[3]*2.55,S[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(S){return[parseInt(S[1],16),parseInt(S[2],16),parseInt(S[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(S){return[parseInt(S[1]+S[1],16),parseInt(S[2]+S[2],16),parseInt(S[3]+S[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(S){return[S[1],S[2]/100,S[3]/100,S[4]]}}],I=Q.Color=function(V,T,S,U){return new Q.Color.fn.parse(V,T,S,U)},J={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},N={"byte":{floor:true,max:255},"percent":{max:1},"degrees":{mod:360,floor:true}},F=I.support={},G=Q("<p>")[0],O,R=Q.each;G.style.cssText="background-color:rgba(1,1,1,.5)";F.rgba=G.style.backgroundColor.indexOf("rgba")>-1;R(J,function(S,T){T.cache="_"+S;T.props.alpha={idx:3,type:"percent",def:1}});function P(V,T,U){var S=N[T.type]||{};if(V==null){return(U||!T.def)?null:T.def}V=S.floor?~~V:parseFloat(V);if(isNaN(V)){return T.def}if(S.mod){return(V+S.mod)%S.mod}return 0>V?0:S.max<V?S.max:V}function E(T){var S=I(),U=S._rgba=[];T=T.toLowerCase();R(H,function(V,a){var Y,W=a.re.exec(T),Z=W&&a.parse(W),X=a.space||"rgba";if(Z){Y=S[X](Z);S[J[X].cache]=Y[J[X].cache];U=S._rgba=Y._rgba;return false}});if(U.length){if(U.join()==="0,0,0,0"){Q.extend(U,O.transparent)}return S}return O[T]}I.fn=Q.extend(I.prototype,{parse:function(T,V,U,X){if(T===D){this._rgba=[null,null,null,null];return this}if(T.jquery||T.nodeType){T=Q(T).css(V);V=D}var W=this,S=Q.type(T),Y=this._rgba=[];if(V!==D){T=[T,V,U,X];S="array"}if(S==="string"){return this.parse(E(T)||O._default)}if(S==="array"){R(J.rgba.props,function(Z,a){Y[a.idx]=P(T[a.idx],a)});return this}if(S==="object"){if(T instanceof I){R(J,function(Z,a){if(T[a.cache]){W[a.cache]=T[a.cache].slice()}})}else{R(J,function(Z,a){var b=a.cache;R(a.props,function(c,d){if(!W[b]&&a.to){if(c==="alpha"||T[c]==null){return}W[b]=a.to(W._rgba)}W[b][d.idx]=P(T[c],d,true)});if(W[b]&&Q.inArray(null,W[b].slice(0,3))<0){W[b][3]=1;if(a.from){W._rgba=a.from(W[b])}}})}return this}},is:function(T){var S=I(T),V=true,U=this;R(J,function(Z,X){var W,Y=S[X.cache];if(Y){W=U[X.cache]||X.to&&X.to(U._rgba)||[];R(X.props,function(b,a){if(Y[a.idx]!=null){V=(Y[a.idx]===W[a.idx]);return V}})}return V});return V},_space:function(){var T=[],S=this;R(J,function(U,V){if(S[V.cache]){T.push(U)}});return T.pop()},transition:function(Y,X){var V=I(Y),Z=V._space(),U=J[Z],W=this.alpha()===0?I("transparent"):this,T=W[U.cache]||U.to(W._rgba),S=T.slice();V=V[U.cache];R(U.props,function(b,e){var f=e.idx,d=T[f],c=V[f],a=N[e.type]||{};if(c===null){return}if(d===null){S[f]=c}else{if(a.mod){if(c-d>a.mod/2){d+=a.mod}else{if(d-c>a.mod/2){d-=a.mod}}}S[f]=P((c-d)*X+d,e)}});return this[Z](S)},blend:function(U){if(this._rgba[3]===1){return this}var T=this._rgba.slice(),V=T.pop(),S=I(U)._rgba;return I(Q.map(T,function(X,W){return(1-V)*S[W]+V*X}))},toRgbaString:function(){var S="rgba(",T=Q.map(this._rgba,function(V,U){return V==null?(U>2?1:0):V});if(T[3]===1){T.pop();S="rgb("}return S+T.join()+")"},toHslaString:function(){var S="hsla(",T=Q.map(this.hsla(),function(V,U){if(V==null){V=U>2?1:0}if(U&&U<3){V=Math.round(V*100)+"%"}return V});if(T[3]===1){T.pop();S="hsl("}return S+T.join()+")"},toHexString:function(S){var U=this._rgba.slice(),T=U.pop();if(S){U.push(~~(T*255))}return"#"+Q.map(U,function(V){V=(V||0).toString(16);return V.length===1?"0"+V:V}).join("")},toString:function(){return this._rgba[3]===0?"transparent":this.toRgbaString()}});I.fn.parse.prototype=I.fn;function M(T,U,S){S=(S+1)%1;if(S*6<1){return T+(U-T)*S*6}if(S*2<1){return U}if(S*3<2){return T+(U-T)*((2/3)-S)*6}return T}J.hsla.to=function(c){if(c[0]==null||c[1]==null||c[2]==null){return[null,null,null,c[3]]}var S=c[0]/255,e=c[1]/255,f=c[2]/255,d=c[3],V=Math.max(S,e,f),U=Math.min(S,e,f),W=V-U,Z=V+U,Y=Z*0.5,X,T;if(U===V){X=0}else{if(S===V){X=(60*(e-f)/W)+360}else{if(e===V){X=(60*(f-S)/W)+120}else{X=(60*(S-e)/W)+240}}}if(W===0){T=0}else{if(Y<=0.5){T=W/Z}else{T=W/(2-Z)}}return[Math.round(X)%360,T,Y,d==null?1:d]};J.hsla.from=function(Y){if(Y[0]==null||Y[1]==null||Y[2]==null){return[null,null,null,Y[3]]}var S=Y[0]/360,T=Y[1],V=Y[2],X=Y[3],W=V<=0.5?V*(1+T):V+T-V*T,U=2*V-W;return[Math.round(M(U,W,S+(1/3))*255),Math.round(M(U,W,S)*255),Math.round(M(U,W,S-(1/3))*255),X]};R(J,function(S,W){var X=W.props,T=W.cache,U=W.to,V=W.from;I.fn[S]=function(b){if(U&&!this[T]){this[T]=U(this._rgba)}if(b===D){return this[T].slice()}var a,Y=Q.type(b),Z=(Y==="array"||Y==="object")?b:arguments,c=this[T].slice();R(X,function(d,e){var f=Z[Y==="object"?d:e.idx];if(f==null){f=c[e.idx]}c[e.idx]=P(f,e)});if(V){a=I(V(c));a[T]=c;return a}else{return I(c)}};R(X,function(Y,Z){if(I.fn[Y]){return}I.fn[Y]=function(e){var c=Q.type(e),d=(Y==="alpha"?(this._hsla?"hsla":"rgba"):S),f=this[d](),a=f[Z.idx],b;if(c==="undefined"){return a}if(c==="function"){e=e.call(this,a);c=Q.type(e)}if(e==null&&Z.empty){return this}if(c==="string"){b=L.exec(e);if(b){e=a+parseFloat(b[2])*(b[1]==="+"?1:-1)}}f[Z.idx]=e;return this[d](f)}})});I.hook=function(T){var S=T.split(" ");R(S,function(U,V){Q.cssHooks[V]={set:function(Y,a){var Z,b,W="";if(a!=="transparent"&&(Q.type(a)!=="string"||(Z=E(a)))){a=I(Z||a);if(!F.rgba&&a._rgba[3]!==1){b=V==="backgroundColor"?Y.parentNode:Y;while((W===""||W==="transparent")&&b&&b.style){try{W=Q.css(b,"backgroundColor");b=b.parentNode}catch(X){}}a=a.blend(W&&W!=="transparent"?W:"_default")}a=a.toRgbaString()}try{Y.style[V]=a}catch(X){}}};Q.fx.step[V]=function(W){if(!W.colorInit){W.start=I(W.elem,V);W.end=I(W.end);W.colorInit=true}Q.cssHooks[V].set(W.elem,W.start.transition(W.end,W.pos))}})};I.hook(K);Q.cssHooks.borderColor={expand:function(S){var T={};R(["Top","Right","Bottom","Left"],function(U,V){T["border"+V+"Color"]=S});return T}};O=Q.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}})(jQuery);(function(){var G=["add","remove","toggle"],E={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};C.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(I,H){C.fx.step[H]=function(J){if(J.end!=="none"&&!J.setAttr||J.pos===1&&!J.setAttr){jQuery.style(J.elem,H,J.end);J.setAttr=true}}});function D(I){var H,J,K=I.ownerDocument.defaultView?I.ownerDocument.defaultView.getComputedStyle(I,null):I.currentStyle,L={};if(K&&K.length&&K[0]&&K[K[0]]){J=K.length;while(J--){H=K[J];if(typeof K[H]==="string"){L[C.camelCase(H)]=K[H]}}}else{for(H in K){if(typeof K[H]==="string"){L[H]=K[H]}}}return L}function F(H,K){var L={},I,J;for(I in K){J=K[I];if(H[I]!==J){if(!E[I]){if(C.fx.step[I]||!isNaN(parseFloat(J))){L[I]=J}}}}return L}if(!C.fn.addBack){C.fn.addBack=function(H){return this.add(H==null?this.prevObject:this.prevObject.filter(H))}}C.effects.animateClass=function(L,K,J,H){var I=C.speed(K,J,H);return this.queue(function(){var O=C(this),N=O.attr("class")||"",P,M=I.children?O.find("*").addBack():O;M=M.map(function(){var Q=C(this);return{el:Q,start:D(this)}});P=function(){C.each(G,function(R,Q){if(L[Q]){O[Q+"Class"](L[Q])}})};P();M=M.map(function(){this.end=D(this.el[0]);this.diff=F(this.start,this.end);return this});O.attr("class",N);M=M.map(function(){var S=this,R=C.Deferred(),Q=C.extend({},I,{queue:false,complete:function(){R.resolve(S)}});this.el.animate(this.diff,Q);return R.promise()});C.when.apply(C,M.get()).done(function(){P();C.each(arguments,function(){var Q=this.el;C.each(this.diff,function(R){Q.css(R,"")})});I.complete.call(O[0])})})};C.fn.extend({addClass:(function(H){return function(L,J,K,I){return J?C.effects.animateClass.call(this,{add:L},J,K,I):H.apply(this,arguments)}})(C.fn.addClass),removeClass:(function(H){return function(L,J,K,I){return arguments.length>1?C.effects.animateClass.call(this,{remove:L},J,K,I):H.apply(this,arguments)}})(C.fn.removeClass),toggleClass:(function(H){return function(L,M,J,K,I){if(typeof M==="boolean"||M===B){if(!J){return H.apply(this,arguments)}else{return C.effects.animateClass.call(this,(M?{add:L}:{remove:L}),J,K,I)}}else{return C.effects.animateClass.call(this,{toggle:L},M,J,K)}}})(C.fn.toggleClass),switchClass:function(H,L,I,J,K){return C.effects.animateClass.call(this,{add:L,remove:H},I,J,K)}})})();(function(){C.extend(C.effects,{version:"1.10.4",save:function(G,H){for(var F=0;F<H.length;F++){if(H[F]!==null){G.data(A+H[F],G[0].style[H[F]])}}},restore:function(H,I){var G,F;for(F=0;F<I.length;F++){if(I[F]!==null){G=H.data(A+I[F]);if(G===B){G=""}H.css(I[F],G)}}},setMode:function(F,G){if(G==="toggle"){G=F.is(":hidden")?"show":"hide"}return G},getBaseline:function(I,F){var H,G;switch(I[0]){case"top":H=0;break;case"middle":H=0.5;break;case"bottom":H=1;break;default:H=I[0]/F.height}switch(I[1]){case"left":G=0;break;case"center":G=0.5;break;case"right":G=1;break;default:G=I[1]/F.width}return{x:G,y:H}},createWrapper:function(K){if(K.parent().is(".ui-effects-wrapper")){return K.parent()}var J={width:K.outerWidth(true),height:K.outerHeight(true),"float":K.css("float")},G=C("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),F={width:K.width(),height:K.height()},H=document.activeElement;try{H.id}catch(I){H=document.body}K.wrap(G);if(K[0]===H||C.contains(K[0],H)){C(H).focus()}G=K.parent();if(K.css("position")==="static"){G.css({position:"relative"});K.css({position:"relative"})}else{C.extend(J,{position:K.css("position"),zIndex:K.css("z-index")});C.each(["top","left","bottom","right"],function(L,M){J[M]=K.css(M);if(isNaN(parseInt(J[M],10))){J[M]="auto"}});K.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})}K.css(F);return G.css(J).show()},removeWrapper:function(G){var F=document.activeElement;if(G.parent().is(".ui-effects-wrapper")){G.parent().replaceWith(G);if(G[0]===F||C.contains(G[0],F)){C(F).focus()}}return G},setTransition:function(I,G,F,H){H=H||{};C.each(G,function(J,L){var K=I.cssUnit(L);if(K[0]>0){H[L]=K[0]*F+K[1]}});return H}});function D(F,H,G,I){if(C.isPlainObject(F)){H=F;F=F.effect}F={effect:F};if(H==null){H={}}if(C.isFunction(H)){I=H;G=null;H={}}if(typeof H==="number"||C.fx.speeds[H]){I=G;G=H;H={}}if(C.isFunction(G)){I=G;G=null}if(H){C.extend(F,H)}G=G||H.duration;F.duration=C.fx.off?0:typeof G==="number"?G:G in C.fx.speeds?C.fx.speeds[G]:C.fx.speeds._default;F.complete=I||H.complete;return F}function E(F){if(!F||typeof F==="number"||C.fx.speeds[F]){return true}if(typeof F==="string"&&!C.effects.effect[F]){return true}if(C.isFunction(F)){return true}if(typeof F==="object"&&!F.effect){return true}return false}C.fn.extend({effect:function(){var J=D.apply(this,arguments),F=J.mode,H=J.queue,G=C.effects.effect[J.effect];if(C.fx.off||!G){if(F){return this[F](J.duration,J.complete)}else{return this.each(function(){if(J.complete){J.complete.call(this)}})}}function I(N){var O=C(this),K=J.complete,M=J.mode;function L(){if(C.isFunction(K)){K.call(O[0])}if(C.isFunction(N)){N()}}if(O.is(":hidden")?M==="hide":M==="show"){O[M]();L()}else{G.call(O[0],J,L)}}return H===false?this.each(I):this.queue(H||"fx",I)},show:(function(F){return function(G){if(E(G)){return F.apply(this,arguments)}else{var H=D.apply(this,arguments);H.mode="show";return this.effect.call(this,H)}}})(C.fn.show),hide:(function(F){return function(G){if(E(G)){return F.apply(this,arguments)}else{var H=D.apply(this,arguments);H.mode="hide";return this.effect.call(this,H)}}})(C.fn.hide),toggle:(function(F){return function(G){if(E(G)||typeof G==="boolean"){return F.apply(this,arguments)}else{var H=D.apply(this,arguments);H.mode="toggle";return this.effect.call(this,H)}}})(C.fn.toggle),cssUnit:function(F){var G=this.css(F),H=[];C.each(["em","px","%","pt"],function(I,J){if(G.indexOf(J)>0){H=[parseFloat(G),J]}});return H}})})();(function(){var D={};C.each(["Quad","Cubic","Quart","Quint","Expo"],function(E,F){D[F]=function(G){return Math.pow(G,E+2)}});C.extend(D,{Sine:function(E){return 1-Math.cos(E*Math.PI/2)},Circ:function(E){return 1-Math.sqrt(1-E*E)},Elastic:function(E){return E===0||E===1?E:-Math.pow(2,8*(E-1))*Math.sin(((E-1)*80-7.5)*Math.PI/15)},Back:function(E){return E*E*(3*E-2)},Bounce:function(F){var G,E=4;while(F<((G=Math.pow(2,--E))-1)/11){}return 1/Math.pow(4,3-E)-7.5625*Math.pow((G*3-2)/22-F,2)}});C.each(D,function(F,E){C.easing["easeIn"+F]=E;C.easing["easeOut"+F]=function(G){return 1-E(1-G)};C.easing["easeInOut"+F]=function(G){return G<0.5?E(G*2)/2:1-E(G*-2+2)/2}})})()})(jQuery);(function(D,A){var C=/up|down|vertical/,B=/up|left|vertical|horizontal/;D.effects.effect.blind=function(N,P){var K=D(this),J=["position","top","bottom","left","right","height","width"],O=D.effects.setMode(K,N.mode||"hide"),F=N.direction||"up",H=C.test(F),I=H?"height":"width",S=H?"top":"left",Q=B.test(F),R={},L=O==="show",G,M,E;if(K.parent().is(".ui-effects-wrapper")){D.effects.save(K.parent(),J)}else{D.effects.save(K,J)}K.show();G=D.effects.createWrapper(K).css({overflow:"hidden"});M=G[I]();E=parseFloat(G.css(S))||0;R[I]=L?M:0;if(!Q){K.css(H?"bottom":"right",0).css(H?"top":"left","auto").css({position:"absolute"});R[S]=L?E:M+E}if(L){G.css(I,0);if(!Q){G.css(S,E+M)}}G.animate(R,{duration:N.duration,easing:N.easing,queue:false,complete:function(){if(O==="hide"){K.hide()}D.effects.restore(K,J);D.effects.removeWrapper(K);P()}})}})(jQuery);(function(B,A){B.effects.effect.bounce=function(K,G){var T=B(this),D=["position","top","bottom","left","right","height","width"],H=B.effects.setMode(T,K.mode||"effect"),L=H==="hide",Q=H==="show",J=K.direction||"up",U=K.distance,O=K.times||5,C=O*2+(Q||L?1:0),E=K.duration/C,F=K.easing,P=(J==="up"||J==="down")?"top":"left",R=(J==="up"||J==="left"),I,V,M,N=T.queue(),S=N.length;if(Q||L){D.push("opacity")}B.effects.save(T,D);T.show();B.effects.createWrapper(T);if(!U){U=T[P==="top"?"outerHeight":"outerWidth"]()/3}if(Q){M={opacity:1};M[P]=0;T.css("opacity",0).css(P,R?-U*2:U*2).animate(M,E,F)}if(L){U=U/Math.pow(2,O-1)}M={};M[P]=0;for(I=0;I<O;I++){V={};V[P]=(R?"-=":"+=")+U;T.animate(V,E,F).animate(M,E,F);U=L?U*2:U/2}if(L){V={opacity:0};V[P]=(R?"-=":"+=")+U;T.animate(V,E,F)}T.queue(function(){if(L){T.hide()}B.effects.restore(T,D);B.effects.removeWrapper(T);G()});if(S>1){N.splice.apply(N,[1,0].concat(N.splice(S,C+1)))}T.dequeue()}})(jQuery);(function(B,A){B.effects.effect.clip=function(J,M){var H=B(this),G=["position","top","bottom","left","right","height","width"],L=B.effects.setMode(H,J.mode||"hide"),P=L==="show",C=J.direction||"vertical",O=C==="vertical",E=O?"height":"width",K=O?"top":"left",D={},N,F,I;B.effects.save(H,G);H.show();N=B.effects.createWrapper(H).css({overflow:"hidden"});F=(H[0].tagName==="IMG")?N:H;I=F[E]();if(P){F.css(E,0);F.css(K,I/2)}D[E]=P?I:0;D[K]=P?0:I/2;F.animate(D,{queue:false,duration:J.duration,easing:J.easing,complete:function(){if(!P){H.hide()}B.effects.restore(H,G);B.effects.removeWrapper(H);M()}})}})(jQuery);(function(B,A){B.effects.effect.drop=function(H,J){var F=B(this),E=["position","top","bottom","left","right","opacity","height","width"],I=B.effects.setMode(F,H.mode||"hide"),M=I==="show",C=H.direction||"left",D=(C==="up"||C==="down")?"top":"left",K=(C==="up"||C==="left")?"pos":"neg",L={opacity:M?1:0},G;B.effects.save(F,E);F.show();B.effects.createWrapper(F);G=H.distance||F[D==="top"?"outerHeight":"outerWidth"](true)/2;if(M){F.css("opacity",0).css(D,K==="pos"?-G:G)}L[D]=(M?(K==="pos"?"+=":"-="):(K==="pos"?"-=":"+="))+G;F.animate(L,{queue:false,duration:H.duration,easing:H.easing,complete:function(){if(I==="hide"){F.hide()}B.effects.restore(F,E);B.effects.removeWrapper(F);J()}})}})(jQuery);(function(B,A){B.effects.effect.explode=function(H,G){var S=H.pieces?Math.round(Math.sqrt(H.pieces)):3,O=S,T=B(this),E=B.effects.setMode(T,H.mode||"hide"),P=E==="show",J=T.show().css("visibility","hidden").offset(),N=Math.ceil(T.outerWidth()/O),U=Math.ceil(T.outerHeight()/S),I=[],F,D,R,K,C,M;function L(){I.push(this);if(I.length===S*O){Q()}}for(F=0;F<S;F++){K=J.top+F*U;M=F-(S-1)/2;for(D=0;D<O;D++){R=J.left+D*N;C=D-(O-1)/2;T.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-D*N,top:-F*U}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:N,height:U,left:R+(P?C*N:0),top:K+(P?M*U:0),opacity:P?0:1}).animate({left:R+(P?0:C*N),top:K+(P?0:M*U),opacity:P?1:0},H.duration||500,H.easing,L)}}function Q(){T.css({visibility:"visible"});B(I).remove();if(!P){T.hide()}G()}}})(jQuery);(function(B,A){B.effects.effect.fade=function(F,D){var C=B(this),E=B.effects.setMode(C,F.mode||"toggle");C.animate({opacity:E},{queue:false,duration:F.duration,easing:F.easing,complete:D})}})(jQuery);(function(B,A){B.effects.effect.fold=function(I,E){var P=B(this),D=["position","top","bottom","left","right","height","width"],F=B.effects.setMode(P,I.mode||"hide"),O=F==="show",K=F==="hide",H=I.size||15,G=/([0-9]+)%/.exec(H),S=!!I.horizFirst,L=O!==S,M=L?["width","height"]:["height","width"],J=I.duration/2,C,R,Q={},N={};B.effects.save(P,D);P.show();C=B.effects.createWrapper(P).css({overflow:"hidden"});R=L?[C.width(),C.height()]:[C.height(),C.width()];if(G){H=parseInt(G[1],10)/100*R[K?0:1]}if(O){C.css(S?{height:0,width:H}:{height:H,width:0})}Q[M[0]]=O?R[0]:H;N[M[1]]=O?R[1]:0;C.animate(Q,J,I.easing).animate(N,J,I.easing,function(){if(K){P.hide()}B.effects.restore(P,D);B.effects.removeWrapper(P);E()})}})(jQuery);(function(B,A){B.effects.effect.highlight=function(E,C){var F=B(this),G=["backgroundImage","backgroundColor","opacity"],D=B.effects.setMode(F,E.mode||"show"),H={backgroundColor:F.css("backgroundColor")};if(D==="hide"){H.opacity=0}B.effects.save(F,G);F.show().css({backgroundImage:"none",backgroundColor:E.color||"#ffff99"}).animate(H,{queue:false,duration:E.duration,easing:E.easing,complete:function(){if(D==="hide"){F.hide()}B.effects.restore(F,G);C()}})}})(jQuery);(function(B,A){B.effects.effect.pulsate=function(K,C){var D=B(this),L=B.effects.setMode(D,K.mode||"show"),O=L==="show",I=L==="hide",M=(O||L==="hide"),E=((K.times||5)*2)+(M?1:0),H=K.duration/E,N=0,G=D.queue(),F=G.length,J;if(O||!D.is(":visible")){D.css("opacity",0).show();N=1}for(J=1;J<E;J++){D.animate({opacity:N},H,K.easing);N=1-N}D.animate({opacity:N},H,K.easing);D.queue(function(){if(I){D.hide()}C()});if(F>1){G.splice.apply(G,[1,0].concat(G.splice(F,E+1)))}D.dequeue()}})(jQuery);(function(B,A){B.effects.effect.puff=function(I,D){var E=B(this),J=B.effects.setMode(E,I.mode||"hide"),G=J==="hide",F=parseInt(I.percent,10)||150,H=F/100,C={height:E.height(),width:E.width(),outerHeight:E.outerHeight(),outerWidth:E.outerWidth()};B.extend(I,{effect:"scale",queue:false,fade:true,mode:J,complete:D,percent:G?F:100,from:G?C:{height:C.height*H,width:C.width*H,outerHeight:C.outerHeight*H,outerWidth:C.outerWidth*H}});E.effect(I)};B.effects.effect.scale=function(K,F){var G=B(this),I=B.extend(true,{},K),L=B.effects.setMode(G,K.mode||"effect"),J=parseInt(K.percent,10)||(parseInt(K.percent,10)===0?0:(L==="hide"?0:100)),D=K.direction||"both",H=K.origin,C={height:G.height(),width:G.width(),outerHeight:G.outerHeight(),outerWidth:G.outerWidth()},E={y:D!=="horizontal"?(J/100):1,x:D!=="vertical"?(J/100):1};I.effect="size";I.queue=false;I.complete=F;if(L!=="effect"){I.origin=H||["middle","center"];I.restore=true}I.from=K.from||(L==="show"?{height:0,width:0,outerHeight:0,outerWidth:0}:C);I.to={height:C.height*E.y,width:C.width*E.x,outerHeight:C.outerHeight*E.y,outerWidth:C.outerWidth*E.x};if(I.fade){if(L==="show"){I.from.opacity=0;I.to.opacity=1}if(L==="hide"){I.from.opacity=1;I.to.opacity=0}}G.effect(I)};B.effects.effect.size=function(J,G){var D,O,R,S=B(this),U=["position","top","bottom","left","right","width","height","overflow","opacity"],M=["position","top","bottom","left","right","overflow","opacity"],L=["width","height","overflow"],P=["fontSize"],I=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],N=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],H=B.effects.setMode(S,J.mode||"effect"),C=J.restore||H!=="effect",K=J.scale||"both",F=J.origin||["middle","center"],Q=S.css("position"),E=C?U:M,T={height:0,width:0,outerHeight:0,outerWidth:0};if(H==="show"){S.show()}D={height:S.height(),width:S.width(),outerHeight:S.outerHeight(),outerWidth:S.outerWidth()};if(J.mode==="toggle"&&H==="show"){S.from=J.to||T;S.to=J.from||D}else{S.from=J.from||(H==="show"?T:D);S.to=J.to||(H==="hide"?T:D)}R={from:{y:S.from.height/D.height,x:S.from.width/D.width},to:{y:S.to.height/D.height,x:S.to.width/D.width}};if(K==="box"||K==="both"){if(R.from.y!==R.to.y){E=E.concat(I);S.from=B.effects.setTransition(S,I,R.from.y,S.from);S.to=B.effects.setTransition(S,I,R.to.y,S.to)}if(R.from.x!==R.to.x){E=E.concat(N);S.from=B.effects.setTransition(S,N,R.from.x,S.from);S.to=B.effects.setTransition(S,N,R.to.x,S.to)}}if(K==="content"||K==="both"){if(R.from.y!==R.to.y){E=E.concat(P).concat(L);S.from=B.effects.setTransition(S,P,R.from.y,S.from);S.to=B.effects.setTransition(S,P,R.to.y,S.to)}}B.effects.save(S,E);S.show();B.effects.createWrapper(S);S.css("overflow","hidden").css(S.from);if(F){O=B.effects.getBaseline(F,D);S.from.top=(D.outerHeight-S.outerHeight())*O.y;S.from.left=(D.outerWidth-S.outerWidth())*O.x;S.to.top=(D.outerHeight-S.to.outerHeight)*O.y;S.to.left=(D.outerWidth-S.to.outerWidth)*O.x}S.css(S.from);if(K==="content"||K==="both"){I=I.concat(["marginTop","marginBottom"]).concat(P);N=N.concat(["marginLeft","marginRight"]);L=U.concat(I).concat(N);S.find("*[width]").each(function(){var W=B(this),V={height:W.height(),width:W.width(),outerHeight:W.outerHeight(),outerWidth:W.outerWidth()};if(C){B.effects.save(W,L)}W.from={height:V.height*R.from.y,width:V.width*R.from.x,outerHeight:V.outerHeight*R.from.y,outerWidth:V.outerWidth*R.from.x};W.to={height:V.height*R.to.y,width:V.width*R.to.x,outerHeight:V.height*R.to.y,outerWidth:V.width*R.to.x};if(R.from.y!==R.to.y){W.from=B.effects.setTransition(W,I,R.from.y,W.from);W.to=B.effects.setTransition(W,I,R.to.y,W.to)}if(R.from.x!==R.to.x){W.from=B.effects.setTransition(W,N,R.from.x,W.from);W.to=B.effects.setTransition(W,N,R.to.x,W.to)}W.css(W.from);W.animate(W.to,J.duration,J.easing,function(){if(C){B.effects.restore(W,L)}})})}S.animate(S.to,{queue:false,duration:J.duration,easing:J.easing,complete:function(){if(S.to.opacity===0){S.css("opacity",S.from.opacity)}if(H==="hide"){S.hide()}B.effects.restore(S,E);if(!C){if(Q==="static"){S.css({position:"relative",top:S.to.top,left:S.to.left})}else{B.each(["top","left"],function(W,V){S.css(V,function(a,X){var Z=parseInt(X,10),Y=W?S.to.left:S.to.top;if(X==="auto"){return Y+"px"}return Z+Y+"px"})})}}B.effects.removeWrapper(S);G()}})}})(jQuery);(function(B,A){B.effects.effect.shake=function(J,I){var S=B(this),D=["position","top","bottom","left","right","height","width"],G=B.effects.setMode(S,J.mode||"effect"),F=J.direction||"left",T=J.distance||20,M=J.times||3,C=M*2+1,E=Math.round(J.duration/C),N=(F==="up"||F==="down")?"top":"left",L=(F==="up"||F==="left"),P={},K={},O={},H,Q=S.queue(),R=Q.length;B.effects.save(S,D);S.show();B.effects.createWrapper(S);P[N]=(L?"-=":"+=")+T;K[N]=(L?"+=":"-=")+T*2;O[N]=(L?"-=":"+=")+T*2;S.animate(P,E,J.easing);for(H=1;H<M;H++){S.animate(K,E,J.easing).animate(O,E,J.easing)}S.animate(K,E,J.easing).animate(P,E/2,J.easing).queue(function(){if(G==="hide"){S.hide()}B.effects.restore(S,D);B.effects.removeWrapper(S);I()});if(R>1){Q.splice.apply(Q,[1,0].concat(Q.splice(R,C+1)))}S.dequeue()}})(jQuery);(function(B,A){B.effects.effect.slide=function(I,K){var G=B(this),F=["position","top","bottom","left","right","width","height"],J=B.effects.setMode(G,I.mode||"show"),M=J==="show",C=I.direction||"left",E=(C==="up"||C==="down")?"top":"left",L=(C==="up"||C==="left"),H,D={};B.effects.save(G,F);G.show();H=I.distance||G[E==="top"?"outerHeight":"outerWidth"](true);B.effects.createWrapper(G).css({overflow:"hidden"});if(M){G.css(E,L?(isNaN(H)?"-"+H:-H):H)}D[E]=(M?(L?"+=":"-="):(L?"-=":"+="))+H;G.animate(D,{queue:false,duration:I.duration,easing:I.easing,complete:function(){if(J==="hide"){G.hide()}B.effects.restore(G,F);B.effects.removeWrapper(G);K()}})}})(jQuery);(function(B,A){B.effects.effect.transfer=function(I,C){var E=B(this),K=B(I.to),N=K.css("position")==="fixed",J=B("body"),H=N?J.scrollTop():0,D=N?J.scrollLeft():0,L=K.offset(),M={top:L.top-H,left:L.left-D,height:K.innerHeight(),width:K.innerWidth()},F=E.offset(),G=B("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(I.className).css({top:F.top-H,left:F.left-D,height:E.innerHeight(),width:E.innerWidth(),position:N?"fixed":"absolute"}).animate(M,I.duration,I.easing,function(){G.remove();C()})}})(jQuery);(function(B){var A=B(document).data("func",{});B.smartMenu=B.noop;B.fn.smartMenu=function(I,E){var F=B("body"),C={name:"",offsetX:15,offsetY:15,textLimit:20,beforeShow:B.noop,afterShow:B.noop};var H=B.extend(C,E||{});var G=function(O){var N=O||I,K=O?Math.random().toString():H.name,J="",M="",L="smart_menu_";if(B.isArray(N)&&N.length){J='<div id="smartMenu_'+K+'" class="'+L+'box"><div class="'+L+'body"><ul class="'+L+'ul">';B.each(N,function(P,Q){if(P){J=J+'<li class="'+L+'li_separate">&nbsp;</li>'}if(B.isArray(Q)){B.each(Q,function(X,S){var U=S.text,T="",W="",R=Math.random().toString().replace(".","");if(U){if(U.length>H.textLimit){U=U.slice(0,H.textLimit)+"...";W=' title="'+S.text+'"'}if(B.isArray(S.data)&&S.data.length){T='<li class="'+L+'li" data-hover="true">'+G(S.data)+'<a href="javascript:" class="'+L+'a"'+W+' data-key="'+R+'"><i class="'+L+'triangle"></i>'+U+"</a></li>"}else{T='<li class="'+L+'li"><a href="javascript:" class="'+L+'a"'+W+' data-key="'+R+'">'+U+"</a></li>"}J+=T;var V=A.data("func");V[R]=S.func;A.data("func",V)}})}});J=J+"</ul></div></div>"}return J},D=function(){var L="#smartMenu_",J="smart_menu_",K=B(L+H.name);if(!K.size()){B("body").append(G());B(L+H.name+" a").bind("click",function(N){var M=B(this).attr("data-key");callback=A.data("func")[M];if(B.isFunction(callback)){callback.call(A.data("trigger"),N)}B.smartMenu.hide();return false});B(L+H.name+" li").each(function(){var M=B(this).attr("data-hover"),N=J+"li_hover";B(this).hover(function(){var O=B(this).siblings("."+N);O.removeClass(N).children("."+J+"box").hide();O.children("."+J+"a").removeClass(J+"a_hover");if(M){B(this).addClass(N).children("."+J+"box").show();B(this).children("."+J+"a").addClass(J+"a_hover")}})});return B(L+H.name)}return K};B(this).each(function(){this.oncontextmenu=function(J){if(B.isFunction(H.beforeShow)){H.beforeShow.call(this)}J=J||window.event;J.cancelBubble=true;if(J.stopPropagation){J.stopPropagation()}B.smartMenu.hide();var K=A.scrollTop();var L=D();if(L){L.css({display:"block",left:J.clientX+H.offsetX,top:J.clientY+K+H.offsetY});A.data("target",L);A.data("trigger",this);if(B.isFunction(H.afterShow)){H.afterShow.call(this)}return false}}});if(!F.data("bind")){F.bind("click",B.smartMenu.hide).data("bind",true)}};B.extend(B.smartMenu,{hide:function(){var C=A.data("target");if(C&&C.css("display")==="block"){C.hide()}},remove:function(){var C=A.data("target");if(C){C.remove()}}})})(jQuery);jQuery.extend({createXHR:function(){if(typeof XMLHttpRequest!="undefined"){return new XMLHttpRequest()}else{if(typeof ActiveXObject!="undefined"){if(typeof arguments.callee.activeXString!="string"){var B=["MSXML2.XMLHttp.6.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp"];for(var A=0,D=B.length;A<D;A++){try{var E=new ActiveXObject(B[A]);arguments.callee.activeXString=B[A];return E}catch(C){}}}return new ActiveXObject(arguments.callee.activeXString)}else{throw new Error("No XHR object available.")}}},ajaxFileUpload:function(D){D=jQuery.extend({},jQuery.ajaxSettings,D);var H=new Date().getTime();var B=new FormData();B.append("FileToUpload",document.getElementById("FileToUpload").files[0]);if(D.global&&!jQuery.active++){jQuery.event.trigger("ajaxStart")}var G=false;var E=jQuery.createXHR();if(D.progress){E.upload.onprogress=function(J){D.progress(J)}}var A=[];if(D.global){jQuery.event.trigger("ajaxSend",[A,D])}var C=function(K){A=E;if(A||K=="timeout"){G=true;var L;try{L=K!="timeout"?"success":"error";if(L!="error"){var M=jQuery.uploadHttpData(A,D.dataType);if(D.success){D.success(M,L)}if(D.global){jQuery.event.trigger("ajaxSuccess",[A,D])}}else{jQuery.handleError(D,A,L)}}catch(J){L="error";jQuery.handleError(D,A,L,J)}if(D.global){jQuery.event.trigger("ajaxComplete",[A,D])}if(D.global&&!--jQuery.active){jQuery.event.trigger("ajaxStop")}if(D.complete){D.complete(A,L)}A=null}};if(D.timeout>0){setTimeout(function(){if(!G){C("timeout")}},D.timeout)}try{var I=D.method?D.method:"POST";E.open(I,D.url);E.send(B)}catch(F){jQuery.handleError(D,A,null,F)}E.onreadystatechange=function(J){if(E.readyState==4){C()}};return{abort:function(){}}},uploadHttpData:function(r,type){var data=!type;data=type=="xml"||data?r.responseXML:r.responseText;if(type=="script"){jQuery.globalEval(data)}if(type=="json"){data=r.responseText;var start=data.indexOf(">");if(start!=-1){var end=data.indexOf("<",start+1);if(end!=-1){data=data.substring(start+1,end)}}eval('data = " '+data+' " ')}if(type=="html"){jQuery("<div>").html(data).evalScripts()}return data},handleError:function(A,D,C,B){if(A.error){A.error.call(A.context||A,D,C,B)}if(A.global){(A.context?jQuery(A.context):jQuery.event).trigger("ajaxError",[D,A,B])}}});var FileDocument=Class.create();FileDocument.prototype={initialize:function(A){this.SetOptions(A);this.Index=this.options.Index;this.Name=this.options.Name;this.ViewerPageIndex=this.options.ViewerPageIndex;this.Viewers=this.options.Viewers;this.ViewerChars=this.options.ViewerChars;this.ViewerSvgContent=this.options.ViewerSvgContent},SetOptions:function(A){this.options={Index:0,Name:"",ViewerPageIndex:new Array(),Viewers:new Array(),ViewerChars:new Array(),ViewerSvgContent:new Array(),};Extend(this.options,A||{})},GetShowIndex:function(B){for(var A=0;A<this.ViewerPageIndex.length;A++){if(this.ViewerPageIndex[A]==B){return A}}return null},GetPageIndex:function(A){if(this.ViewerPageIndex.length==0){return null}else{return this.ViewerPageIndex[A]}},DeletePage:function(C){var B=this.GetPageIndex(C);this.Viewers[B]=null;for(var A=0;A<this.Viewers.length;A++){if(this.Viewers[A]==null||this.Viewers[A].ShowIndex==null){continue}if(this.Viewers[A].ShowIndex>C){this.Viewers[A].ShowIndex--;$("#thumbPgId_"+this.Viewers[A].PageIndex).text((parseInt(this.Viewers[A].ShowIndex)+1))}}},AddPage:function(D){for(var A=0;A<this.Viewers.length;A++){if(this.Viewers[A]==null||this.Viewers[A].ShowIndex==null){continue}if(this.Viewers[A].ShowIndex>=D){this.Viewers[A].ShowIndex++;$("#thumbPgId_"+this.Viewers[A].PageIndex).text((parseInt(this.Viewers[A].ShowIndex)+1))}}var C=_totalPageCount++;var B=new Viewer({PageIndex:C,IsNewPage:true});B.ShowIndex=D;this.Viewers[C]=B;this.ViewerPageIndex.insertAt(D,C)},SortPage:function(B){for(var A=0;A<this.Viewers.length;A++){if(this.Viewers[A]==null||this.Viewers[A].ShowIndex==null){continue}this.Viewers[A].ShowIndex=B[this.Viewers[A].PageIndex];$("#thumbPgId_"+this.Viewers[A].PageIndex).text(parseInt(this.Viewers[A].ShowIndex)+1)}},BurnAnnos:function(){for(var A=0;A<this.Viewers.length;A++){if(this.Viewers[A]==null||this.Viewers[A].ShowIndex==null){continue}this.Viewers[A].BurnAnnos()}},IsAnnos:function(){for(var A=0;A<this.Viewers.length;A++){if(this.Viewers[A]==null||this.Viewers[A].ShowIndex==null){continue}if(this.Viewers[A].IsAnnos()){_IsAnnos=true;return}}_IsAnnos=false},DeleteBurnedAnnos:function(){for(var A=0;A<this.Viewers.length;A++){if(this.Viewers[A]==null||this.Viewers[A].ShowIndex==null){continue}this.Viewers[A].DeleteBurnedAnnos()}},DeleteAnno:function(B){for(var A=0;A<this.Viewers.length;A++){if(this.Viewers[A]==null||this.Viewers[A].ShowIndex==null){continue}if(this.Viewers[A].DeleteAnno(B)){return false}}},DeleteBurnedAnnotations:function(){for(var A=0;A<this.Viewers.length;A++){if(this.Viewers[A]==null||this.Viewers[A].ShowIndex==null){continue}this.Viewers[A].DeleteBurnedAnnotations()}},IsAnnoBurned:function(B){for(var A=0;A<this.Viewers.length;A++){if(this.Viewers[A]==null||this.Viewers[A].ShowIndex==null){continue}if(this.Viewers[A].IsAnnoBurned(B)){return true}}return false},ChangeState:function(){for(var A=0;A<this.Viewers.length;A++){if(this.Viewers[A]==null||this.Viewers[A].ShowIndex==null){continue}this.Viewers[A].isChange=true}},};var TextAnnoStyle=new AnnoStyle({FillColor:"White",ShowedText:"double click to edit",TextColor:"Black",TextFont:"Arial",TextSize:12,TextStyle:new Array()});var FreehandAnnoStyle=new AnnoStyle({OutLineColor:"Red",OutLineWidth:5});var HighlightAnnoStyle=new AnnoStyle({FillColor:"Yellow"});var RectangleAnnoStyle=new AnnoStyle({OutLineColor:"Black",OutLineWidth:3});var FilledRectangleAnnoStyle=new AnnoStyle({OutLineColor:"Black",OutLineWidth:3,FillColor:"Black",Transparency:1});var EllipseAnnoStyle=new AnnoStyle({FillColor:"Orange"});var RubberStampAnnoStyle=new AnnoStyle({OutLineWidth:3,FillColor:"Red",ShowedText:"Good",TextFont:"Arial",TextSize:12,TextStyle:new Array("bold")});var PolygonLinesAnnoStyle=new AnnoStyle({OutLineColor:"Red",OutLineWidth:5});var PolygonAnnoStyle=new AnnoStyle({OutLineColor:"OrangeRed",OutLineWidth:3,FillColor:"OrangeRed"});var LineAnnoStyle=new AnnoStyle({OutLineColor:"Red",OutLineWidth:5});var ArrowAnnoStyle=new AnnoStyle({OutLineWidth:5,FillColor:"Red",Transparency:1});var fhSignature=new AnnoStyle({OutLineWidth:3,OutLineColor:"black",Transparency:1});var txtSignature=new AnnoStyle({TextColor:"black",TextSize:48,Transparency:1});var dateSignature=new AnnoStyle({TextFont:"Arial",TextStyle:new Array("bold"),TextColor:"black",TextSize:48,Transparency:1});var FilledRectRedact=new AnnoStyle({FillColor:"#000000",Transparency:1});var TextRedact=new AnnoStyle({FillColor:"#000000",Transparency:1});var selectDiv=new Array();var num=0;var selectTextId=null;var x_points=new Array();var x_singlePoints=new Array();var x_multiPoints=new Array();var y_points=new Array();var y_singlePoints=new Array();var y_multiPoints=new Array();var point_index=0;var showIds=new Array();var drawShowIndex;var drawActualIndex;var showFlag=true;var draggableNumArray=new Array();var _zoomRatio=0.1;var _zoomIndex=10;var _defaultZoonIndex=10;var _defaultPageSizeType=1;var _pageSizeType=_defaultPageSizeType;var _totalPageCount=0;var _maxTotalPageCount=0;Array.prototype.max=function(){return Math.max.apply({},this)};Array.prototype.min=function(){return Math.min.apply({},this)};Array.prototype.S=String.fromCharCode(2);Array.prototype.in_array=function(B){var A=new RegExp(this.S+B+this.S);return(A.test(this.S+this.join(this.S)+this.S))};Array.prototype.insertAt=function(B,A){this.splice(B,0,A)};var objDelete={text:"Delete",func:function(){deleteAnno()}};var annoMenuData=[[objDelete]];var annoPro_flag="";function deleteAnno(){for(var A=0;A<1;A++){$("#div_"+selectDiv[A]).remove();$("#thumbImg_"+selectDiv[A]).remove();_fileDocument[curFileId].DeleteAnno(selectDiv[A]);$("#smartMenu_"+selectDiv[A]).remove();if(isLoadOrSave&&!isUnSaveAnnos){isUnSaveAnnos=true}}selectDiv=new Array();noSelectAnno();isHaveAnnos();return}function AnnoIsChanged(){if(isLoadOrSave&&!isUnSaveAnnos){isUnSaveAnnos=true}}function burnAnno(){pageIndex=parseInt(_curCorrectPageId);pageIndex=_fileDocument[curFileId].GetPageIndex(pageIndex);for(var A=0;A<selectDiv.length;A++){_fileDocument[curFileId].Viewers[pageIndex].BurnAnno(selectDiv[A]);$("#div_"+selectDiv[A]).remove();drawImageViewerBurnAnnotation(pageIndex);$("#smartMenu_"+selectDiv[A]).remove()}selectDiv=new Array()}var appearanceIdArray=new Array("OutLine_Icon","OutLine_text","Fill_Icon","Fill_text","Text_Icon","Text_text","_outLineColor","_fillColor","_textColor");var annoListTextArray=new Array();$(function(){var A=function(C){C=C||window.event;selectId=(C.target.id);if(appearanceIdArray.in_array(selectId)&&selectDiv.length==1){}else{if(!_isInDocViewer){if(selectId==""){if(_isInToolbar){HideAllPropanel()}}}else{noSelectAnno()}}if(_isInDocViewer){if(annoListTextArray.in_array(selectId)){return}if(selectId=="draw_canvas"||selectId.indexOf("svg")==0){selectDiv=new Array();noSelectAnno();return}idPosition=selectId.indexOf("_");if(idPosition==-1){}else{showResizeId=selectId.substring(idPosition+1);if(isCtrlDown==false){showIds=new Array()}showIds.push(showResizeId);if(!canDelete){enableDelete();canDelete=true}if(showIds.length==1){selectOneAnno()}for(var B=0;B<showIds.length;B++){if(showIds[B].indexOf("_")!=-1){showIds[B]=showIds[B].substring(0,showIds[B].indexOf("_"))}if(selectDiv.length==0){selectDiv.push(showIds[B])}$("#rRightDown_"+showIds[B]+"").css("visibility","visible");$("#rLeftDown_"+showIds[B]+"").css("visibility","visible");$("#rLeftUp_"+showIds[B]+"").css("visibility","visible");$("#rRightUp_"+showIds[B]+"").css("visibility","visible");$("#rRight_"+showIds[B]+"").css("visibility","visible");$("#rLeft_"+showIds[B]+"").css("visibility","visible");$("#rUp_"+showIds[B]+"").css("visibility","visible");$("#rDown_"+showIds[B]+"").css("visibility","visible");$("#top_"+showIds[B]+"").css("visibility","visible");$("#bottom_"+showIds[B]+"").css("visibility","visible")}if(C.button==2&&showFlag){$("#annotation_"+showResizeId).smartMenu(annoMenuData,{name:showResizeId});if(showResizeId.indexOf("_")!=-1){showResizeId=showResizeId.substring(0,showResizeId.indexOf("_"));$("#annotation_"+showResizeId).smartMenu(annoMenuData,{name:showResizeId})}}}}else{if(selectId==""){if(C.target!="javascript:"){}}}};$("body").bind("mouseup",A)});var _isInToolbar=false;$(function(){var A=function(C){C=C||window.event;selectId=(C.target.id);if(appearanceIdArray.in_array(selectId)&&selectDiv.length==1){}else{if(!_isInDocViewer){if(selectId==""){if(_isInToolbar){HideAllPropanel()}}}else{noSelectAnno()}}if(_isInDocViewer){if(selectId=="draw_canvas"||selectId.indexOf("svg")==0){selectDiv=new Array();noSelectAnno();return}idPosition=selectId.indexOf("_");if(idPosition==-1){selectDiv=new Array()}else{showResizeId=selectId.substring(idPosition+1);if(isCtrlDown==false){showIds=new Array()}showIds.push(showResizeId);if(!canDelete){enableDelete();canDelete=true}if(showIds.length==1){selectOneAnno()}for(var B=0;B<showIds.length;B++){if(showIds[B].indexOf("_")!=-1){showIds[B]=showIds[B].substring(0,showIds[B].indexOf("_"))}if(selectDiv.length==0){selectDiv.push(showIds[B])}$("#rRightDown_"+showIds[B]+"").css("visibility","visible");$("#rLeftDown_"+showIds[B]+"").css("visibility","visible");$("#rLeftUp_"+showIds[B]+"").css("visibility","visible");$("#rRightUp_"+showIds[B]+"").css("visibility","visible");$("#rRight_"+showIds[B]+"").css("visibility","visible");$("#rLeft_"+showIds[B]+"").css("visibility","visible");$("#rUp_"+showIds[B]+"").css("visibility","visible");$("#rDown_"+showIds[B]+"").css("visibility","visible");$("#top_"+showIds[B]+"").css("visibility","visible");$("#bottom_"+showIds[B]+"").css("visibility","visible")}}}ChangeTextShowed(selectId)};$("body").bind("click",A)});function ChangeTextShowed(A){currentTextDiv="text_"+selectTextId;if(A!=currentTextDiv){$(".text_edit").css("visibility","hidden");if(curHideTextAnnoId!=""){$("#"+curHideTextAnnoId).show();curHideTextAnnoId=""}if(selectTextId!=null){text_shown_original=$("#text_"+selectTextId+"").val();text_shown=escape(text_shown_original).replace(/\+/g,"%2B").replace(/\'/g,"%22").replace(/\'/g,"%27").replace(/\//g,"%2F");var D=parseInt(_curCorrectPageId);var C=_fileDocument[curFileId].GetPageIndex(D);_fileDocument[curFileId].Viewers[C].Annotations[selectTextId].Text=unescape(text_shown);var G=_fileDocument[curFileId].Viewers[C].Annotations[selectTextId];$("#svg_"+selectTextId).remove();var F=drawAnnotationWithSVG(G,"annotation",C,false);$("#div_"+selectTextId).append(F);var E=document.getElementById("annotation_"+selectTextId+"");if(_isIpad){var B=new Hammer.Manager(E);B.add(new Hammer.Tap({event:"doubletap",taps:2}));B.on("doubletap",function(H){EditText(E)})}else{E.ondblclick=function(){EditText(E)}}selectTextId=null}}}function noSelectAnno(){HideAllPropanel();$(".rRightDown").css("visibility","hidden");$(".rLeftDown").css("visibility","hidden");$(".rLeftUp").css("visibility","hidden");$(".rRightUp").css("visibility","hidden");$(".rRight").css("visibility","hidden");$(".rLeft").css("visibility","hidden");$(".rUp").css("visibility","hidden");$(".rDown").css("visibility","hidden");$(".top").css("visibility","hidden");$(".bottom").css("visibility","hidden");$(".leftRedact").css("visibility","hidden");$(".rightRedact").css("visibility","hidden");annoPro_flag="";for(var A=0;A<showArray.length;A++){$("#"+showArray[A]).css("opacity","0.25");TargetHover("#"+showArray[A],false);$("#"+showArray[A]).unbind("click")}hideArray=new Array("OutLine","Fill","Text");if(canDelete){disableDelete();canDelete=false}HideCommentsPanel()}function selectOneAnno(){var F=selectDiv[0];var D=null;var A=_fileDocument[curFileId];for(var E=0;E<A.ViewerPageIndex.length;E++){var H=A.ViewerPageIndex[E];var C=_fileDocument[curFileId].Viewers[H];if(C.Annotations[F]!=null){D=H;break}}if(D==null){return}var G=_fileDocument[curFileId].Viewers[D].Annotations[F];if(G==null){return}var B="re_func_"+G.Type.toLowerCase();if(B=="re_func_filledrectredaction"||B=="re_func_textredacts"){return}annoPro_flag=D+";"+selectDiv[0]+";"+B;HideAllPropanel();ShowCommentsPanel(B)}var isDragIn=false;var divScrollLeft=0;var divScrollTop=0;var divScrollWidht=0;var divScrollHeight=0;var xDown=0,yDown=0;var dragImageMouseDown=function(A){isDragIn=true;divScrollLeft=$("#_plcBigImg")[0].scrollLeft;divScrollTop=$("#_plcBigImg")[0].scrollTop;divScrollWidht=$("#_plcBigImg")[0].scrollWidth;divScrollHeight=$("#_plcBigImg")[0].scrollHeight;A=A||window.event;xDown=A.pageX;yDown=A.pageY;return false};var dragImageMouseMove=function(A){if(isDragIn){A=A||window.event;xMove=A.pageX;yMove=A.pageY;move_x=xMove-xDown;move_y=yMove-yDown;moveLeft=divScrollLeft-(move_x);moveTop=divScrollTop-(move_y);if(moveLeft>0&&moveLeft<divScrollWidht){$("#_plcBigImg")[0].scrollLeft=moveLeft}if(moveTop>0&&moveTop<divScrollHeight){}$("#_plcBigImg")[0].scrollTop=moveTop}return false};var dragImageMouseUp=function(A){isDragIn=false;return false};var _clickNum=0;var _annotationLastType;var hammerAnno;function draw_annotation(A){if(_isIpad){drawAnnotation_Pad(A)}else{drawAnnotation_Web(A)}}function drawAnnotation_Pad(A){if(_clickNum!=0){if(_annotationLastType=="PolygonLines"||_annotationLastType=="Polygon"){hammerAnno.off("singletap");hammerAnno.off("doubletap");$("#draw_canvas").unbind("touchstart",preventDefault)}else{hammerAnno.off("panstart");hammerAnno.off("panmove");hammerAnno.off("panend");$("#draw_canvas").unbind("touchstart",preventDefault)}_clickNum=0}_clickNum++;_annotationLastType=A;if(_clickNum==1){$(".showByDrag").unbind("mousedown",dragImageMouseDown);$(".showByDrag").unbind("mousemove",dragImageMouseMove);$(".showByDrag").unbind("mouseup",dragImageMouseUp);$(".showByDrag").removeClass("mouseStyleMove");$(".showByDrag").addClass("mouseStyleAnnotation");if(_annotationLastType=="PolygonLines"||_annotationLastType=="Polygon"){draw_PolygonPad()}else{if(_annotationLastType=="Line"||_annotationLastType=="Arrow"){draw_LinePad()}else{draw_rectPad()}}}}function drawRectRedact(A){if(selectTextIcon){$(".showByDrag").removeClass("mouseStyleSelect");$(".showByDrag").addClass("mouseStyleMove");$("#draw_canvas").unbind("mousedown",selectDown);$("#draw_canvas").unbind("mousemove",selectMove);$("#draw_canvas").unbind("mouseup",selectUp);$("#re_func_selectText").removeClass("iconBorder");selectTextIcon=false}drawAnnotation_Web(A)}function drawAnnotation_Web(A){if(_clickNum!=0){if(_annotationLastType=="Line"||_annotationLastType=="Arrow"){$("#draw_canvas").unbind("mousedown",MouseDown);$("#draw_canvas").unbind("mousemove",MouseMove)}else{$("#draw_canvas").unbind("mousedown",MouseDown);$("#draw_canvas").unbind("mousemove",MouseMove);$("#draw_canvas").unbind("mouseup",MouseUp)}_clickNum=0}_clickNum++;_annotationLastType=A;if(_clickNum==1){$(".showByDrag").unbind("mousedown",dragImageMouseDown);$(".showByDrag").unbind("mousemove",dragImageMouseMove);$(".showByDrag").unbind("mouseup",dragImageMouseUp);$(".showByDrag").removeClass("mouseStyleMove");$(".showByDrag").addClass("mouseStyleAnnotation");if(_annotationLastType=="PolygonLines"||_annotationLastType=="Polygon"){draw_Polygon()}else{if(_annotationLastType=="Line"||_annotationLastType=="Arrow"){draw_Line()}else{draw_rect()}}}}var MouseDown;var MouseUp;var MouseMove;function draw_LinePad(){var A=0;var C=0;var B=0;var F=0;var J=parseInt(_curCorrectPageId);var D=_fileDocument[curFileId].Viewers[J];drawPageIndex=J;var H=0,I=0;var G=false;MouseDown=function(K){A=$("#_plcBigImg").offset().left;C=$("#_plcBigImg").offset().top;B=$("#_plcBigImg")[0].scrollLeft-5;F=$("#_plcBigImg")[0].scrollTop-5;H=K.pointers[0].clientX-A+B;I=K.pointers[0].clientY-C+F;if(_viewerMode=="multi"){drawPageIndex=PrePageCount(I)}else{drawPageIndex=parseInt(_curCorrectPageId)}drawActualIndex=_fileDocument[curFileId].GetPageIndex(drawPageIndex);D=_fileDocument[curFileId].Viewers[drawActualIndex];var U="";x_points[point_index]=H;y_points[point_index]=I;point_index++;var M=x_points.min();var P=y_points.min();var S=x_points.max();var L=y_points.max();var T=S-M;var Q=L-P;strPoints="";for(var R=0;R<x_points.length;R++){strPoints+=x_points[R]+","+y_points[R]+";"}strPoints=strPoints.substring(0,strPoints.length-1);D.GetViewerLeftTop();var O=new Annotation({OnPageIndex:drawActualIndex,Type:_annotationLastType,Index:num,ShowLeft:M,ShowTop:P,ShowPoints:strPoints,ViewerLeft:D.Left,ViewerTop:D.Top,ViewerWidth:D.ActualWidth,ViewerHeight:D.ActualHeight,ViewerScaleX:D.ScaleX,ViewerScaleY:D.ScaleY,ThumbViewerScaleX:D.ThumbScaleX,ThumbViewerScaleY:D.ThumbScaleY,ViewerOne2OneWidth:D.OneToOne_Width,ViewerOne2OneHeight:D.OneToOne_Height});$("#div_"+num).remove();var N=O.OutLineWidth/2*_zoomRatio*_zoomIndex;var U="<div class='new_rect' id='div_"+num+"' style='left:"+(M-N)+"px;top:"+(P-N)+"px;width:"+(T+2*N)+"px;height:"+(Q+2*N)+"px'>";U+=drawAnnotationWithSVG(O,"annotation",drawActualIndex,false);U+="</div>";$("#draw_canvas").append(U);G=true};MouseMove=function(K){if(G){$("#div_"+num).remove();H=K.pointers[0].clientX-A+B;I=K.pointers[0].clientY-C+F;var U="";x_points[point_index]=H;y_points[point_index]=I;if(_annotationLastType=="Arrow"){var S=new Array();S=getArrowKeypoints(x_points[0],y_points[0],x_points[1],y_points[1]);x_points[point_index+1]=S[0];y_points[point_index+1]=S[1];x_points[point_index+2]=S[2];y_points[point_index+2]=S[3];x_points[point_index+3]=S[4];y_points[point_index+3]=S[5]}var L=x_points.min();var O=y_points.min();var R=x_points.max();var T=y_points.max();var V=R-L;var P=T-O;strPoints="";for(var Q=0;Q<x_points.length;Q++){strPoints+=x_points[Q]+","+y_points[Q]+";"}strPoints=strPoints.substring(0,strPoints.length-1);var N=new Annotation({OnPageIndex:drawActualIndex,Type:_annotationLastType,Index:num,ShowLeft:L,ShowTop:O,ShowPoints:strPoints,ViewerLeft:D.Left,ViewerTop:D.Top,ViewerWidth:D.ActualWidth,ViewerHeight:D.ActualHeight,ViewerScaleX:D.ScaleX,ViewerScaleY:D.ScaleY,ThumbViewerScaleX:D.ThumbScaleX,ThumbViewerScaleY:D.ThumbScaleY,ViewerOne2OneWidth:D.OneToOne_Width,ViewerOne2OneHeight:D.OneToOne_Height});var M=N.OutLineWidth/2*_zoomRatio*_zoomIndex;var U="<div class='new_rect' id='div_"+num+"' style='left:"+(L-M)+"px;top:"+(O-M)+"px;width:"+(V+2*M)+"px;height:"+(P+2*M)+"px'>";U+=drawAnnotationWithSVG(N,"annotation",drawActualIndex,false);U+="</div>";$("#draw_canvas").append(U)}};MouseUp=function(K){$("#div_"+num).remove();addImageViewerAnnotation(drawActualIndex,num,0,0,0,0,_annotationLastType,B,F);x_points=new Array();y_points=new Array();point_index=0;addThumbViewerAnnotation(_fileDocument[curFileId].Viewers[drawActualIndex].Annotations[num],drawActualIndex);$("#div_"+num).draggable({containment:"parent",scroll:false,handle:"svg .annotation",stop:function(){AnnoIsChanged()}});if(!draggableNumArray.in_array(num)){draggableNumArray.push(num)}num++;hammerAnno.off("panstart");hammerAnno.off("panmove");hammerAnno.off("panend");$("#draw_canvas").unbind("touchstart",preventDefault);_clickNum=0;$(".showByDrag").bind("mousedown",dragImageMouseDown);$(".showByDrag").bind("mousemove",dragImageMouseMove);$(".showByDrag").bind("mouseup",dragImageMouseUp);$(".showByDrag").removeClass("mouseStyleAnnotation");$(".showByDrag").addClass("mouseStyleMove");CompleteDraw(drawActualIndex,_annotationLastType);G=false};var E=document.getElementById("draw_canvas");hammerAnno=new Hammer(E);hammerAnno.off("panstart");hammerAnno.off("panmove");hammerAnno.off("panend");$("#draw_canvas").unbind("touchstart",preventDefault);hammerAnno.on("panstart",MouseDown);hammerAnno.on("panmove",MouseMove);hammerAnno.on("panend",MouseUp);$("#draw_canvas").bind("touchstart",preventDefault)}function draw_Line(){var A=0;var C=0;var B=0;var E=0;var I=parseInt(_curCorrectPageId);var D=_fileDocument[curFileId].Viewers[I];drawPageIndex=I;var G=0,H=0;var F=false;MouseDown=function(J){A=$("#_plcBigImg").offset().left;C=$("#_plcBigImg").offset().top;B=$("#_plcBigImg")[0].scrollLeft-5;E=$("#_plcBigImg")[0].scrollTop-5;J=J||window.event;G=J.pageX-A+B;H=J.pageY-C+E;if(_viewerMode=="multi"){drawPageIndex=PrePageCount(H)}else{drawPageIndex=parseInt(_curCorrectPageId)}drawActualIndex=_fileDocument[curFileId].GetPageIndex(drawPageIndex);D=_fileDocument[curFileId].Viewers[drawActualIndex];var T="";x_points[point_index]=G;y_points[point_index]=H;point_index++;var L=x_points.min();var O=y_points.min();var R=x_points.max();var K=y_points.max();var S=R-L;var P=K-O;strPoints="";for(var Q=0;Q<x_points.length;Q++){strPoints+=x_points[Q]+","+y_points[Q]+";"}strPoints=strPoints.substring(0,strPoints.length-1);D.GetViewerLeftTop();var N=new Annotation({OnPageIndex:drawActualIndex,Type:_annotationLastType,Index:num,ShowLeft:L,ShowTop:O,ShowPoints:strPoints,ViewerLeft:D.Left,ViewerTop:D.Top,ViewerWidth:D.ActualWidth,ViewerHeight:D.ActualHeight,ViewerScaleX:D.ScaleX,ViewerScaleY:D.ScaleY,ThumbViewerScaleX:D.ThumbScaleX,ThumbViewerScaleY:D.ThumbScaleY,ViewerOne2OneWidth:D.OneToOne_Width,ViewerOne2OneHeight:D.OneToOne_Height});$("#div_"+num).remove();var M=N.OutLineWidth/2*_zoomRatio*_zoomIndex;var T="<div class='new_rect' id='div_"+num+"' style='left:"+(L-M)+"px;top:"+(O-M)+"px;width:"+(S+2*M)+"px;height:"+(P+2*M)+"px'>";T+=drawAnnotationWithSVG(N,"annotation",drawActualIndex,false);T+="</div>";$("#draw_canvas").append(T);F=true};MouseUp=function(J){$("#div_"+num).remove();addImageViewerAnnotation(drawActualIndex,num,0,0,0,0,_annotationLastType,B,E);x_points=new Array();y_points=new Array();point_index=0;addThumbViewerAnnotation(_fileDocument[curFileId].Viewers[drawActualIndex].Annotations[num],drawActualIndex);$("#div_"+num).draggable({containment:"parent",scroll:false,handle:"svg .annotation",stop:function(){AnnoIsChanged()}});if(!draggableNumArray.in_array(num)){draggableNumArray.push(num)}num++;$("#draw_canvas").unbind("mousedown",MouseDown);$("#draw_canvas").unbind("mousemove",MouseMove);$("#draw_canvas").unbind("mouseup",MouseUp);_clickNum=0;$(".showByDrag").bind("mousedown",dragImageMouseDown);$(".showByDrag").bind("mousemove",dragImageMouseMove);$(".showByDrag").bind("mouseup",dragImageMouseUp);$(".showByDrag").removeClass("mouseStyleAnnotation");$(".showByDrag").addClass("mouseStyleMove");CompleteDraw(drawActualIndex,_annotationLastType);F=false};MouseMove=function(J){if(F){J=J||window.event;$("#div_"+num).remove();G=J.pageX-A+B;H=J.pageY-C+E;var T="";x_points[point_index]=G;y_points[point_index]=H;if(_annotationLastType=="Arrow"){var R=new Array();R=getArrowKeypoints(x_points[0],y_points[0],x_points[1],y_points[1]);x_points[point_index+1]=R[0];y_points[point_index+1]=R[1];x_points[point_index+2]=R[2];y_points[point_index+2]=R[3];x_points[point_index+3]=R[4];y_points[point_index+3]=R[5]}var K=x_points.min();var N=y_points.min();var Q=x_points.max();var S=y_points.max();var U=Q-K;var O=S-N;strPoints="";for(var P=0;P<x_points.length;P++){strPoints+=x_points[P]+","+y_points[P]+";"}strPoints=strPoints.substring(0,strPoints.length-1);var M=new Annotation({OnPageIndex:drawActualIndex,Type:_annotationLastType,Index:num,ShowLeft:K,ShowTop:N,ShowPoints:strPoints,ViewerLeft:D.Left,ViewerTop:D.Top,ViewerWidth:D.ActualWidth,ViewerHeight:D.ActualHeight,ViewerScaleX:D.ScaleX,ViewerScaleY:D.ScaleY,ThumbViewerScaleX:D.ThumbScaleX,ThumbViewerScaleY:D.ThumbScaleY,ViewerOne2OneWidth:D.OneToOne_Width,ViewerOne2OneHeight:D.OneToOne_Height});var L=M.OutLineWidth/2*_zoomRatio*_zoomIndex;var T="<div class='new_rect' id='div_"+num+"' style='left:"+(K-L)+"px;top:"+(N-L)+"px;width:"+(U+2*L)+"px;height:"+(O+2*L)+"px'>";T+=drawAnnotationWithSVG(M,"annotation",drawActualIndex,false);T+="</div>";$("#draw_canvas").append(T)}};$("#draw_canvas").bind("mousedown",MouseDown);$("#draw_canvas").bind("mousemove",MouseMove);$("#draw_canvas").bind("mouseup",MouseUp)}function getArrowKeypoints(B,N,L,J){var K=50*_zoomRatio*_zoomIndex;var E=[0,0,0,0,0,0,0,0];var G=L-B;var P=N-J;var H=Math.atan2(P,G)*(180/Math.PI);var Q=L;var R=J;var O=L+K*Math.cos(H*(Math.PI/180));var I=J-K*Math.sin(H*(Math.PI/180));var F=Math.tan(25*(Math.PI/180))*K;var C=Q+F*Math.cos((H+120)*(Math.PI/180));var D=R-F*Math.sin((H+120)*(Math.PI/180));var M=Q+F*Math.cos((H+240)*(Math.PI/180));var A=R-F*Math.sin((H+240)*(Math.PI/180));E[0]=C;E[1]=D;E[2]=M;E[3]=A;E[4]=O;E[5]=I;return E}function addImageViewerAnnotation(V,E,T,R,P,W,H,O,F){zoomId=_zoomIndex;pageSizeType=_pageSizeType;rotateId=_fileDocument[curFileId].Viewers[V].Rotate;var L=_fileDocument[curFileId].Viewers[V];var N="";var I="";var Q="";if(H=="Freehand"||H=="PolygonLines"||H=="Polygon"||H=="Line"||H=="Arrow"){var K=x_points.min();var X=y_points.min();var D=x_points.max();var S=y_points.max();var A=D-K;var B=S-X;if(A==0||B==0||x_points.length==0||x_points.length==1){return}for(var U=0;U<x_points.length;U++){N+=x_points[U]+","+y_points[U]+";"}N=N.substring(0,N.length-1);T=K;R=X;P=A;W=B}L.GetViewerLeftTop();var Y=new Annotation({OnPageIndex:V,Type:H,Index:E,ShowLeft:T,ShowTop:R,ShowWidth:P,ShowHeight:W,Rotate:rotateId,PageSizeType:pageSizeType,ZoomIndex:zoomId,ShowPoints:N,ViewerLeft:L.Left,ViewerTop:L.Top,ViewerWidth:L.ActualWidth,ViewerHeight:L.ActualHeight,ViewerScaleX:L.ScaleX,ViewerScaleY:L.ScaleY,ThumbViewerScaleX:L.ThumbScaleX,ThumbViewerScaleY:L.ThumbScaleY,ViewerOne2OneWidth:L.OneToOne_Width,ViewerOne2OneHeight:L.OneToOne_Height});var J=Y.OutLineWidth/2*_zoomRatio*_zoomIndex;var C;C="<div class='new_rect' id='div_"+E+"' style='left:"+(T-J)+"px;top:"+(R-J)+"px;width:"+(P+2*J)+"px;height:"+(W+2*J)+"px'>";if(H=="Line"||H=="Arrow"){C+=addLineOrArrowHandler(H,x_points,y_points,E,J)}else{C+="<div class='rRightDown' id='rRightDown_"+E+"'></div><div class='rLeftDown' id='rLeftDown_"+E+"'></div><div class='rRightUp' id='rRightUp_"+E+"'></div><div class='rLeftUp' id='rLeftUp_"+E+"'></div><div class='rRight' id='rRight_"+E+"'></div><div class='rLeft' id='rLeft_"+E+"'></div><div class='rUp' id='rUp_"+E+"'></div><div class='rDown' id='rDown_"+E+"'></div>"}C+=drawAnnotationWithSVG(Y,"annotation",V,false);C+="</div>";$("#draw_canvas").append(C);if(H=="Text"){text_shown=$("#text_"+E+"").val();if(text_shown!=null){Y.Text=text_shown}var G=document.getElementById("annotation_"+E+"");if(_isIpad){var M=new Hammer.Manager(G);M.add(new Hammer.Tap({event:"doubletap",taps:2}));M.on("doubletap",function(Z){EditText_Pad(G)})}else{G.ondblclick=function(){EditText(G)}}}_fileDocument[curFileId].Viewers[V].Annotations[E]=Y;selectDiv=new Array();selectDiv.push(E);BindImageViewerAnnotationClick(E);BindResize(E,H)}function addLineOrArrowHandler(O,H,A,C,F){var D;var E;var M;var N;var I;var Q;var J;var R;if(O=="Line"){D=H[0];E=A[0];M=H[1];N=A[1]}else{if(O=="Arrow"){D=H[0];E=A[0];M=H[4];N=A[4]}}var G=H.min();var P=A.min();var B=H.max();var L=A.max();offsetFirstX=D-G;offsetFirstY=E-P;offsetSecondX=M-G;offsetSecondY=N-P;var K="";K="<div id='rRightDown_"+C+"'></div><div id='rLeftDown_"+C+"'></div><div class='top' id='top_"+C+"' style='left:"+offsetFirstX+"px;top:"+offsetFirstY+"px;'></div><div id='rRightUp_"+C+"'></div><div class='bottom' id='bottom_"+C+"' style='left:"+offsetSecondX+"px;top:"+offsetSecondY+"px;'></div><div id='rLeftUp_"+C+"'></div><div id='rRight_"+C+"'></div><div id='rLeft_"+C+"'></div><div id='rUp_"+C+"'></div><div id='rDown_"+C+"'></div>";return K}function addThumbViewerAnnotation(B,A){if(B==null){return}if(B.Index==null){return}append_string="<div class='thumb_rect' id='thumbImg_"+B.Index+"' style='left:"+B.ThumbShowLeft+"px;top:"+B.ThumbShowTop+"px;width:"+B.ThumbShowWidth+"px;height:"+B.ThumbShowHeight+"px'>";append_string+=drawAnnotationWithSVG(B,"thumbAnnotation",A,true);append_string+="</div>";$("#thumbDiv_"+A).append(append_string)}function drawAnnotationWithSVG(F,I,P,L){var B="<svg id='svg_"+F.Index+"' class='svg' width='100%' height='100%' version='1.1' xmlns='http://www.w3.org/2000/svg'>";var N=F.OutLineWidth/2*_zoomRatio*_zoomIndex;if(F.Type=="Highlight"){if(L){B+="<rect class='"+I+"' id='"+I+"_"+F.Index+"' width='"+F.ThumbShowWidth+"' height='"+F.ThumbShowHeight+"' style='fill:"+F.FillColor+";stroke:"+F.OutLineColor+";stroke-width:"+F.OutLineWidth/3+";opacity:"+F.Transparency+"'/>"}else{B+="<rect class='"+I+"' id='"+I+"_"+F.Index+"' x='"+N+"' y='"+N+"' width='"+F.ShowWidth+"' height='"+F.ShowHeight+"' style='fill:"+F.FillColor+";stroke:"+F.OutLineColor+";stroke-width:"+F.OutLineWidth+";opacity:"+F.Transparency+"'/>"}}else{if(F.Type=="Rectangle"){if(L){B+="<rect class='"+I+"' id='"+I+"_"+F.Index+"' width='"+F.ThumbShowWidth+"' height='"+F.ThumbShowHeight+"' style='fill:none;stroke:"+F.OutLineColor+";stroke-width:"+F.OutLineWidth/3+";opacity:"+F.Transparency+"'/>"}else{B+="<rect class='"+I+"' id='"+I+"_"+F.Index+"'x='"+N+"' y='"+N+"' width='"+F.ShowWidth+"' height='"+F.ShowHeight+"' style='fill:none;stroke:"+F.OutLineColor+";stroke-width:"+F.OutLineWidth+";opacity:"+F.Transparency+"'/>"}}else{if(F.Type=="FilledRectangle"){if(L){B+="<rect class='"+I+"' id='"+I+"_"+F.Index+"' width='"+F.ThumbShowWidth+"' height='"+F.ThumbShowHeight+"' style='fill:"+F.FillColor+";stroke:"+F.OutLineColor+";stroke-width:"+F.OutLineWidth/3+";opacity:"+F.Transparency+"'/>"}else{B+="<rect class='"+I+"' id='"+I+"_"+F.Index+"' x='"+N+"' y='"+N+"' width='"+F.ShowWidth+"' height='"+F.ShowHeight+"' style='fill:"+F.FillColor+";stroke:"+F.OutLineColor+";stroke-width:"+F.OutLineWidth+";opacity:"+F.Transparency+"'/>"}}else{if(F.Type=="FilledRectRedaction"){if(!L){B+="<rect class='anno_redact annotation' id='"+I+"_"+F.Index+"' x='"+N+"' y='"+N+"' width='"+F.ShowWidth+"' height='"+F.ShowHeight+"' style='fill:"+F.FillColor+";'/>"}}else{if(F.Type=="Ellipse"){if(L){B+="<ellipse class='"+I+"' id='"+I+"_"+F.Index+"' cx='"+F.ThumbShowWidth/2+"' cy='"+F.ThumbShowHeight/2+"' rx='"+F.ThumbShowWidth/2+"' ry='"+F.ThumbShowHeight/2+"' style='fill:"+F.FillColor+";stroke:"+F.OutLineColor+";stroke-width:"+F.OutLineWidth/3+";opacity:"+F.Transparency+"'/>"}else{B+="<ellipse class='"+I+"' id='"+I+"_"+F.Index+"' cx='"+parseInt(F.ShowWidth/2+N)+"' cy='"+parseInt(F.ShowHeight/2+N)+"' rx='"+F.ShowWidth/2+"' ry='"+F.ShowHeight/2+"' style='fill:"+F.FillColor+";stroke:"+F.OutLineColor+";stroke-width:"+F.OutLineWidth+";opacity:"+F.Transparency+"'/>"}}else{if(F.Type=="Line"){strPoints="";if(L){strPoints=F.ThumbRelativePoints;B+="<polyline class='"+I+"' id='"+I+"_"+F.Index+"' points='"+strPoints+"' style='fill:none;stroke:"+F.OutLineColor+";stroke-width:"+F.OutLineWidth/3+";opacity:"+F.Transparency+"' />"}else{strPoints=F.RelativePoints;var O=_zoomRatio*_zoomIndex*F.OutLineWidth;B+="<polyline class='"+I+"' id='"+I+"_"+F.Index+"' points='"+strPoints+"' style='fill:none;stroke:"+F.OutLineColor+";stroke-width:"+O+";opacity:"+F.Transparency+"'/>"}}else{if(F.Type=="Arrow"){strPoints="";if(L){strPoints=F.ThumbRelativePoints.split(" ");var E=strPoints[0]+" "+strPoints[1];B+="<polyline class='"+I+"' id='"+I+"_"+F.Index+"' points='"+E+"' style='fill:none;stroke:"+F.OutLineColor+";stroke-width:"+F.OutLineWidth/3+";opacity:"+F.Transparency+"' />";var Q=strPoints[2]+" "+strPoints[3]+" "+strPoints[4];B+="<polygon class='"+I+"' id='"+I+"_"+F.Index+"_arrow' points='"+Q+"' style='fill:"+F.FillColor+";stroke:"+F.OutLineColor+";stroke-width:"+1+";'/>"}else{strPoints=F.RelativePoints.split(" ");var O=_zoomRatio*_zoomIndex*F.OutLineWidth;var E=strPoints[0]+" "+strPoints[1];B+="<polyline class='"+I+"' id='"+I+"_"+F.Index+"' points='"+E+"' style='fill:none;stroke:"+F.OutLineColor+";stroke-width:"+O+";opacity:"+F.Transparency+"'  />";var Q=strPoints[2]+" "+strPoints[3]+" "+strPoints[4];B+="<polygon class='"+I+"'  id='"+I+"_"+F.Index+"_arrow' points='"+Q+"' style='fill:"+F.FillColor+";stroke:"+F.OutLineColor+";stroke-width:"+1+";opacity:"+F.Transparency+"''/>"}}else{if(F.Type=="PolygonLines"||F.Type=="Freehand"){strPoints="";if(L){strPoints=F.ThumbRelativePoints;B+="<polyline class='"+I+"' id='"+I+"_"+F.Index+"' points='"+strPoints+"' style='fill:none;stroke:"+F.OutLineColor+";stroke-width:"+F.OutLineWidth/3+";opacity:"+F.Transparency+"' />"}else{strPoints=F.RelativePoints;var O=_zoomRatio*_zoomIndex*F.OutLineWidth;B+="<polyline class='"+I+"' id='"+I+"_"+F.Index+"' points='"+strPoints+"' style='fill:none;stroke:"+F.OutLineColor+";stroke-width:"+O+";opacity:"+F.Transparency+"' />"}}else{if(F.Type=="fhSignature"){strPoints="";if(L){strPoints=F.ThumbRelativePoints.split(";");B+="<g transform='translate(0,0)' class='"+I+"' id='"+I+"_"+F.Index+"' width='"+F.ShowWidth+"' height='"+F.ShowHeight+"'>";for(var C=0;C<strPoints.length;C++){B+="<polyline class='"+I+"' id='"+I+"_"+F.Index+"_"+C+"' points='"+strPoints+"' style='fill:none;stroke:"+F.OutLineColor+";stroke-width:"+F.OutLineWidth/3+";opacity:"+F.Transparency+"' />"}B+="</g>"}else{strPoints=F.RelativePoints.split(";");B+="<g transform='translate(0,0)' class='"+I+"' id='"+I+"_"+F.Index+"' width='"+F.ShowWidth+"' height='"+F.ShowHeight+"'>";B+="<rect id='"+I+"_"+F.Index+"_rect' width='100%' height='100%' style='fill:#none;opacity:0'/>";for(var C=0;C<strPoints.length;C++){var O=_zoomRatio*_zoomIndex*F.OutLineWidth;B+="<polyline id='"+I+"_"+F.Index+"_"+C+"' points='"+strPoints[C]+"' style='fill:none;stroke:"+F.OutLineColor+";stroke-width:"+O+";opacity:"+F.Transparency+"' />"}B+="</g>"}}else{if(F.Type=="Polygon"){strPoints="";if(L){strPoints=F.ThumbRelativePoints;B+="<polygon  class='"+I+"' id='"+I+"_"+F.Index+"' points='"+strPoints+"' style='fill:"+F.FillColor+";stroke:"+F.OutLineColor+";stroke-width:"+F.OutLineWidth/3+";opacity:"+F.Transparency+"'/>"}else{strPoints=F.RelativePoints;var O=_zoomRatio*_zoomIndex*F.OutLineWidth;B+="<polygon  class='"+I+"' id='"+I+"_"+F.Index+"' points='"+strPoints+"' style='fill:"+F.FillColor+";stroke:"+F.OutLineColor+";stroke-width:"+O+";opacity:"+F.Transparency+"'/>"}}else{if(F.Type=="Text"){if(L){var G=_fileDocument[curFileId].Viewers[P];var D=G.thumbShowWidth/_docWidth*F.TextSize;B="<textarea class='text_edit' id='text_"+F.Index+"' style='font-family:"+F.TextFont+";width:"+(F.ThumbShowWidth)+"px;height:"+(F.ThumbShowHeight)+"px;font-size:"+D+"px'>"+F.Text+"</textarea>";src=createTextAnnoWidthCanvas(F.Text,{fontStyle:F.TextStyle,fontName:F.TextFont,fontSize:D,fillColor:F.FillColor,textColor:F.TextColor,outLineWidth:F.OutLineWidth,outLineColor:F.OutLineColor,width:F.ThumbShowWidth,height:F.ThumbShowHeight,transparency:F.Transparency});B="<img  class='"+I+"' id='"+I+"_"+F.Index+"' src='"+src+"' style='z-index:1;' />"}else{var H=_zoomRatio*_zoomIndex*F.TextSize;var K="";var M="<textarea class='text_edit' id='text_"+F.Index+"' style='font-family:"+F.TextFont+";margin-left:"+F.OutLineWidth+"px;margin-top:"+F.OutLineWidth+"px;width:"+(F.ShowWidth-16)+"px;height:"+(F.ShowHeight-16)+"px;font-size:"+H+"px;";for(var C=0;C<F.TextStyle.length;C++){if(F.TextStyle[C]=="bold"){M+="font-weight:bold;"}else{if(F.TextStyle[C]=="italic"){M+="font-style:italic;"}else{if(F.TextStyle[C].toLowerCase()=="underline"||F.TextStyle[C].toLowerCase()=="line-through"){if(K==""){K=F.TextStyle[C]}else{K+=" "+F.TextStyle[C]}}}}}if(K!=""){M+="text-decoration:"+K}M+="'>"+F.Text+"</textarea>";B=M+B;B+="<g transform='translate(0,0)' class='"+I+"' id='"+I+"_"+F.Index+"' width='"+F.ShowWidth+"' height='"+F.ShowHeight+"' title='double click to edit'><rect id='"+I+"_"+F.Index+"_rect' width='100%' height='100%' style='stroke-width:"+F.OutLineWidth*2+";stroke:"+F.OutLineColor+";fill:"+F.FillColor+";opacity:"+F.Transparency+"'/>";var J="";if(F.Rotate==0||F.Rotate==2){if(F.Rotate==0){J="matrix(1,0,0,1,"+F.OutLineWidth+","+F.OutLineWidth+")"}else{J="matrix(-1,0,0,-1,"+F.OutLineWidth+","+(F.ShowHeight+F.OutLineWidth)+")"}}else{if(F.Rotate==1||F.Rotate==3){if(F.Rotate==1){J="matrix(0,1,-1,0,"+(F.ShowWidth+F.OutLineWidth)+","+F.OutLineWidth+")"}else{J="matrix(0,-1,1,0,"+(F.ShowWidth+F.OutLineWidth)+","+(F.ShowHeight+F.OutLineWidth)+")"}}}B+="<text id='"+I+"_"+F.Index+"_text' transform='"+J+"' fill='"+F.TextColor+"' font-family='"+F.TextFont+"' font-size='"+H+"'";K="";for(var C=0;C<F.TextStyle.length;C++){if(F.TextStyle[C].toLowerCase()=="bold"){B+="font-weight='bold'"}else{if(F.TextStyle[C].toLowerCase()=="italic"){B+="font-style='italic'"}else{if(F.TextStyle[C].toLowerCase()=="underline"||F.TextStyle[C].toLowerCase()=="line-through"){if(K==""){K=F.TextStyle[C]}else{K+=" "+F.TextStyle[C]}}}}}if(K!=""){B+="text-decoration='"+K+"'"}B+=">"+GetTspanSvg(F)+"</text></g>"}}else{if(F.Type=="RubberStamp"){if(L){var G=_fileDocument[curFileId].Viewers[P];var D=G.thumbShowWidth/_docWidth*F.TextSize;src=createStampAnnoWidthCanvas(F.Text,{fontStyle:F.TextStyle,fontName:F.TextFont,fontSize:D,fillColor:F.FillColor,outLineColor:F.OutLineColor,textColor:F.TextColor,outLineWidth:F.OutLineWidth,width:F.ThumbShowWidth,height:F.ThumbShowHeight,transparency:F.Transparency,rotate:F.Rotate});B="<img  class='"+I+"' id='"+I+"_"+F.Index+"' src='"+src+"' style='z-index:1;' />";return B}else{B+="<g transform='translate(0,0)' class='"+I+"' id='"+I+"_"+F.Index+"' width='"+F.ShowWidth+"' height='"+F.ShowHeight+"'><rect width='100%' height='100%' style='stroke-width:"+F.OutLineWidth*2+";stroke:"+F.OutLineColor+";fill:none;opacity:"+F.Transparency+"'/><rect id='"+I+"_"+F.Index+"_rect' width='100%' height='100%' style='fill:#ffffff;opacity:0'/>";var A=document.createElement("canvas");context=A.getContext("2d");var H;var J="";if(F.Rotate==0||F.Rotate==2){H=F.ShowWidth/F.Text.length;if(H>F.ShowHeight){H=F.ShowHeight}if(H<15){H=15}font="bold "+H+"px "+F.TextFont;context.font=font;metrics=context.measureText(F.Text);tempWidth=context.measureText("A").width;if(F.Rotate==0){offWidth=(F.ShowWidth+F.OutLineWidth-metrics.width)/2;offHeight=(F.ShowHeight+F.OutLineWidth+tempWidth)/2;J="matrix(1,0,0,1,"+offWidth+","+offHeight+")"}else{offWidth=(F.ShowWidth+F.OutLineWidth+metrics.width)/2;offHeight=(F.ShowHeight+F.OutLineWidth)/2;J="matrix(-1,0,0,-1,"+offWidth+","+offHeight+")"}}else{if(F.Rotate==1||F.Rotate==3){H=F.ShowHeight/F.Text.length;if(H>F.ShowWidth){H=F.ShowWidth}if(H<15){H=15}font="bold "+H+"px "+F.TextFont;context.font=font;metrics=context.measureText(F.Text);tempWidth=context.measureText("A").width;if(F.Rotate==1){offWidth=(F.ShowWidth-F.OutLineWidth+tempWidth)/2;offHeight=(F.ShowHeight+F.OutLineWidth-metrics.width)/2;J="matrix(0,1,-1,0,"+offWidth+","+offHeight+")"}else{offWidth=(F.ShowWidth+F.OutLineWidth+tempWidth)/2;offHeight=(F.ShowHeight+F.OutLineWidth+metrics.width)/2;J="matrix(0,-1,1,0,"+offWidth+","+offHeight+")"}}}F.TextSize=H/(_zoomRatio*_zoomIndex);RubberStampAnnoStyle.TextSize=F.TextSize;B+="<text id='"+I+"_"+F.Index+"_text' transform='"+J+"' fill='"+F.TextColor+"' font-family='"+F.TextFont+"' font-size='"+H+"' opacity='"+F.Transparency+"'";var K="";for(var C=0;C<F.TextStyle.length;C++){if(F.TextStyle[C].toLowerCase()=="bold"){B+="font-weight='bold'"}else{if(F.TextStyle[C].toLowerCase()=="italic"){B+="font-style='italic'"}else{if(F.TextStyle[C].toLowerCase()=="underline"||F.TextStyle[C].toLowerCase()=="line-through"){if(K==""){K=F.TextStyle[C]}else{K+=" "+F.TextStyle[C]}}}}}if(K!=""){B+="text-decoration='"+K+"'"}B+=">"+F.Text+"</text></g>"}}else{if(F.Type=="txtSignature"||F.Type=="dateSignature"){if(L){var G=_fileDocument[curFileId].Viewers[P];var D=G.thumbShowWidth/_docWidth*F.TextSize;src=createStampAnnoWidthCanvas(F.Text,{fontStyle:F.TextStyle,fontName:F.TextFont,fontSize:D,fillColor:"none",outLineColor:"none",textColor:F.TextColor,outLineWidth:"none",width:F.ThumbShowWidth,height:F.ThumbShowHeight,transparency:F.Transparency,rotate:F.Rotate});B="<img  class='"+I+"' id='"+I+"_"+F.Index+"' src='"+src+"' style='z-index:1;' />";return B}else{B+="<g transform='translate(0,0)' class='"+I+"' id='"+I+"_"+F.Index+"' width='"+F.ShowWidth+"' height='"+F.ShowHeight+"'><rect width='100%' height='100%' style='fill:none;opacity:0'/><rect id='"+I+"_"+F.Index+"_rect' width='100%' height='100%' style='fill:#ffffff;opacity:0'/>";var A=document.createElement("canvas");context=A.getContext("2d");var H=F.TextSize*_zoomRatio*_zoomIndex;if(F.Type=="dateSignature"){font="bold "+H+"px "+F.TextFont}else{font=H+"px "+F.TextFont}context.font=font;metrics=context.measureText(F.Text);tempWidth=context.measureText("g").width+5;var J="";if(F.Rotate==0||F.Rotate==2){if(F.Rotate==0){offWidth=(F.ShowWidth+F.OutLineWidth-metrics.width)/2;offHeight=(F.ShowHeight+F.OutLineWidth+tempWidth)/2;J="matrix(1,0,0,1,"+offWidth+","+offHeight+")"}else{offWidth=(F.ShowWidth+F.OutLineWidth+metrics.width)/2;offHeight=(F.ShowHeight-tempWidth)/2;J="matrix(-1,0,0,-1,"+offWidth+","+offHeight+")"}}else{if(F.Rotate==1||F.Rotate==3){if(F.Rotate==1){offWidth=(F.ShowWidth-tempWidth)/2;offHeight=(F.ShowHeight+F.OutLineWidth-metrics.width)/2;J="matrix(0,1,-1,0,"+offWidth+","+offHeight+")"}else{offWidth=(F.ShowWidth+F.OutLineWidth+tempWidth)/2;offHeight=(F.ShowHeight+F.OutLineWidth+metrics.width)/2;J="matrix(0,-1,1,0,"+offWidth+","+offHeight+")"}}}B+="<text id='"+I+"_"+F.Index+"_text' transform='"+J+"' fill='"+F.TextColor+"' font-family='"+F.TextFont+"' font-size='"+H+"' opacity='"+F.Transparency+"'";var K="";for(var C=0;C<F.TextStyle.length;C++){if(F.TextStyle[C].toLowerCase()=="bold"){B+="font-weight='bold'"}else{if(F.TextStyle[C].toLowerCase()=="italic"){B+="font-style='italic'"}else{if(F.TextStyle[C].toLowerCase()=="underline"||F.TextStyle[C].toLowerCase()=="line-through"){if(K==""){K=F.TextStyle[C]}else{K+=" "+F.TextStyle[C]}}}}}if(K!=""){B+="text-decoration='"+K+"'"}B+=">"+F.Text+"</text></g>"}}}}}}}}}}}}}}B+="</svg>";return B}function GetTspanSvg(Q){var I=_zoomRatio*_zoomIndex*Q.TextSize;var M=Q.Text;var T="";var P=M.split("\n");var B=1;var D=document.createElement("canvas");context=D.getContext("2d");var N="";if(Q.TextStyle.in_array("bold")){N="bold"}else{if(Q.TextStyle.in_array("italic")){N="italic"}else{N="normal"}}var K=N+" "+I+"px "+Q.TextFont;context.font=K;var W=context.measureText("A").width;var A=Q.TextPadding;var L=4;var U=context.measureText(" ").width;var Y=Q.ShowWidth-A*2;var X=Q.ShowHeight;if(Y<0||X<0){return}var C="annotation_"+Q.Index+"_tspan";for(var F=0;F<P.length;F++){var S=P[F];var G=0;var R="";var Z=context.measureText(S).width;for(var E=0;E<S.length;E++){if(S.charCodeAt(E)==32){if(G+U>Y){T+="<tspan id='"+C+"' x='"+A+"' y='"+(parseInt(B*I)+L)+"'>"+R+"</tspan>";R="";G=0;E--;B++}else{R+=" ";G+=U;var H=S.substring(E+1);var J=0;var V=H.indexOf(" ");if(V==-1){J=context.measureText(H).width}else{J=context.measureText(H.substring(0,V)).width}if(G+J>Y){T+="<tspan id='"+C+"' x='"+A+"' y='"+(parseInt(B*I)+L)+"'>"+R+"</tspan>";R="";G=0;B++}}}else{var O=context.measureText(S[E]).width;G+=O;if(G>Y){T+="<tspan id='"+C+"' x='"+A+"' y='"+(parseInt(B*I)+L)+"'>"+R+"</tspan>";R="";G=0;E--;B++}else{R+=S[E]}}}if(R!=""){T+="<tspan id='"+C+"' x='"+A+"' y='"+(parseInt(B*I)+L)+"'>"+R+"</tspan>"}B++}return T}function draw_PolygonPad(){var A=0;var D=0;var B=0;var G=0;var K=parseInt(_curCorrectPageId);var E=_fileDocument[curFileId].Viewers[K];drawPageIndex=K;var I=0,J=0;var C=true;var H=false;MouseDown=function(L){A=$("#_plcBigImg").offset().left;D=$("#_plcBigImg").offset().top;B=$("#_plcBigImg")[0].scrollLeft-10;G=$("#_plcBigImg")[0].scrollTop-5;if(L.pointers.length==1){var T=L.pointers[0];I=T.clientX-A+B;J=T.clientY-D+G;if(C){if(_viewerMode=="multi"){drawPageIndex=PrePageCount(J)}else{drawPageIndex=parseInt(_curCorrectPageId)}drawActualIndex=_fileDocument[curFileId].GetPageIndex(drawPageIndex);E=_fileDocument[curFileId].Viewers[drawActualIndex];C=false}var V="";x_points[point_index]=I;y_points[point_index]=J;point_index++;var M=x_points.min();var P=y_points.min();var S=x_points.max();var U=y_points.max();var W=S-M;var Q=U-P;strPoints="";for(var R=0;R<x_points.length;R++){strPoints+=x_points[R]+","+y_points[R]+";"}strPoints=strPoints.substring(0,strPoints.length-1);E.GetViewerLeftTop();var O=new Annotation({OnPageIndex:drawActualIndex,Type:_annotationLastType,Index:num,ShowLeft:M,ShowTop:P,ShowPoints:strPoints,ViewerLeft:E.Left,ViewerTop:E.Top,ViewerWidth:E.ActualWidth,ViewerHeight:E.ActualHeight,ViewerScaleX:E.ScaleX,ViewerScaleY:E.ScaleY,ThumbViewerScaleX:E.ThumbScaleX,ThumbViewerScaleY:E.ThumbScaleY,ViewerOne2OneWidth:E.OneToOne_Width,ViewerOne2OneHeight:E.OneToOne_Height});$("#div_"+num).remove();var N=O.OutLineWidth/2*_zoomRatio*_zoomIndex;var V="<div class='new_rect' id='div_"+num+"' style='left:"+(M-N)+"px;top:"+(P-N)+"px;width:"+(W+2*N)+"px;height:"+(Q+2*N)+"px'>";V+=drawAnnotationWithSVG(O,"annotation",drawActualIndex,false);V+="</div>";$("#draw_canvas").append(V);H=true}};MouseMove=function(L){if(H){$("#div_"+num).remove();var T=L.pointers[0];I=T.clientX-A+B;J=T.clientY-D+G;var V="";x_points[point_index]=I;y_points[point_index]=J;var M=x_points.min();var P=y_points.min();var S=x_points.max();var U=y_points.max();var W=S-M;var Q=U-P;strPoints="";for(var R=0;R<x_points.length;R++){strPoints+=x_points[R]+","+y_points[R]+";"}strPoints=strPoints.substring(0,strPoints.length-1);var O=new Annotation({OnPageIndex:drawActualIndex,Type:_annotationLastType,Index:num,ShowLeft:M,ShowTop:P,ShowPoints:strPoints,ViewerLeft:E.Left,ViewerTop:E.Top,ViewerWidth:E.ActualWidth,ViewerHeight:E.ActualHeight,ViewerScaleX:E.ScaleX,ViewerScaleY:E.ScaleY,ThumbViewerScaleX:E.ThumbScaleX,ThumbViewerScaleY:E.ThumbScaleY,ViewerOne2OneWidth:E.OneToOne_Width,ViewerOne2OneHeight:E.OneToOne_Height});var N=O.OutLineWidth/2*_zoomRatio*_zoomIndex;var V="<div class='new_rect' id='div_"+num+"' style='left:"+(M-N)+"px;top:"+(P-N)+"px;width:"+(W+2*N)+"px;height:"+(Q+2*N)+"px'>";V+=drawAnnotationWithSVG(O,"annotation",drawActualIndex,false);V+="</div>";$("#draw_canvas").append(V)}};MouseUp=function(L){$("#div_"+num).remove();addImageViewerAnnotation(drawActualIndex,num,0,0,0,0,_annotationLastType,B,G);x_points=new Array();y_points=new Array();point_index=0;addThumbViewerAnnotation(_fileDocument[curFileId].Viewers[drawActualIndex].Annotations[num],drawActualIndex);$("#div_"+num).draggable({containment:"parent",scroll:false,handle:"svg .annotation",stop:function(){AnnoIsChanged()}});if(!draggableNumArray.in_array(num)){draggableNumArray.push(num)}num++;hammerAnno.off("singletap");hammerAnno.off("doubletap");$("#draw_canvas").unbind("touchstart",preventDefault);_clickNum=0;$(".showByDrag").bind("mousedown",dragImageMouseDown);$(".showByDrag").bind("mousemove",dragImageMouseMove);$(".showByDrag").bind("mouseup",dragImageMouseUp);$(".showByDrag").removeClass("mouseStyleAnnotation");$(".showByDrag").addClass("mouseStyleMove");CompleteDraw(drawActualIndex,_annotationLastType);H=false};var F=document.getElementById("draw_canvas");hammerAnno=new Hammer.Manager(F);hammerAnno.add(new Hammer.Tap({event:"doubletap",taps:2}));hammerAnno.add(new Hammer.Tap({event:"singletap"}));hammerAnno.get("doubletap").recognizeWith("singletap");hammerAnno.get("singletap").requireFailure("doubletap");$("#draw_canvas").unbind("touchstart",preventDefault);hammerAnno.on("singletap",MouseDown);hammerAnno.on("doubletap",MouseUp);$("#draw_canvas").bind("touchstart",preventDefault)}function draw_Polygon(){var A=0;var D=0;var B=0;var F=0;var J=parseInt(_curCorrectPageId);var E=_fileDocument[curFileId].Viewers[J];drawPageIndex=J;var H=0,I=0;var C=true;var G=false;MouseDown=function(K){A=$("#_plcBigImg").offset().left;D=$("#_plcBigImg").offset().top;B=$("#_plcBigImg")[0].scrollLeft-10;F=$("#_plcBigImg")[0].scrollTop-5;K=K||window.event;H=K.pageX-A+B;I=K.pageY-D+F;if(C){if(_viewerMode=="multi"){drawPageIndex=PrePageCount(I)}else{drawPageIndex=parseInt(_curCorrectPageId)}drawActualIndex=_fileDocument[curFileId].GetPageIndex(drawPageIndex);E=_fileDocument[curFileId].Viewers[drawActualIndex];C=false}var U="";x_points[point_index]=H;y_points[point_index]=I;point_index++;var M=x_points.min();var P=y_points.min();var S=x_points.max();var L=y_points.max();var T=S-M;var Q=L-P;strPoints="";for(var R=0;R<x_points.length;R++){strPoints+=x_points[R]+","+y_points[R]+";"}strPoints=strPoints.substring(0,strPoints.length-1);E.GetViewerLeftTop();var O=new Annotation({OnPageIndex:drawActualIndex,Type:_annotationLastType,Index:num,ShowLeft:M,ShowTop:P,ShowPoints:strPoints,ViewerLeft:E.Left,ViewerTop:E.Top,ViewerWidth:E.ActualWidth,ViewerHeight:E.ActualHeight,ViewerScaleX:E.ScaleX,ViewerScaleY:E.ScaleY,ThumbViewerScaleX:E.ThumbScaleX,ThumbViewerScaleY:E.ThumbScaleY,ViewerOne2OneWidth:E.OneToOne_Width,ViewerOne2OneHeight:E.OneToOne_Height});$("#div_"+num).remove();var N=O.OutLineWidth/2*_zoomRatio*_zoomIndex;var U="<div class='new_rect' id='div_"+num+"' style='left:"+(M-N)+"px;top:"+(P-N)+"px;width:"+(T+2*N)+"px;height:"+(Q+2*N)+"px'>";U+=drawAnnotationWithSVG(O,"annotation",drawActualIndex,false);U+="</div>";$("#draw_canvas").append(U);G=true};MouseMove=function(K){if(G){K=K||window.event;$("#div_"+num).remove();H=K.pageX-A+B;I=K.pageY-D+F;var U="";x_points[point_index]=H;y_points[point_index]=I;var M=x_points.min();var P=y_points.min();var S=x_points.max();var L=y_points.max();var T=S-M;var Q=L-P;strPoints="";for(var R=0;R<x_points.length;R++){strPoints+=x_points[R]+","+y_points[R]+";"}strPoints=strPoints.substring(0,strPoints.length-1);var O=new Annotation({OnPageIndex:drawActualIndex,Type:_annotationLastType,Index:num,ShowLeft:M,ShowTop:P,ShowPoints:strPoints,ViewerLeft:E.Left,ViewerTop:E.Top,ViewerWidth:E.ActualWidth,ViewerHeight:E.ActualHeight,ViewerScaleX:E.ScaleX,ViewerScaleY:E.ScaleY,ThumbViewerScaleX:E.ThumbScaleX,ThumbViewerScaleY:E.ThumbScaleY,ViewerOne2OneWidth:E.OneToOne_Width,ViewerOne2OneHeight:E.OneToOne_Height});var N=O.OutLineWidth/2*_zoomRatio*_zoomIndex;var U="<div class='new_rect' id='div_"+num+"' style='left:"+(M-N)+"px;top:"+(P-N)+"px;width:"+(T+2*N)+"px;height:"+(Q+2*N)+"px'>";U+=drawAnnotationWithSVG(O,"annotation",drawActualIndex,false);U+="</div>";$("#draw_canvas").append(U)}};MouseUp=function(K){K=K||window.event;if(K.button==2){$("#div_"+num).remove();addImageViewerAnnotation(drawActualIndex,num,0,0,0,0,_annotationLastType,B,F);x_points=new Array();y_points=new Array();point_index=0;addThumbViewerAnnotation(_fileDocument[curFileId].Viewers[drawActualIndex].Annotations[num],drawActualIndex);$("#div_"+num).draggable({containment:"parent",scroll:false,handle:"svg .annotation",stop:function(){AnnoIsChanged()}});if(!draggableNumArray.in_array(num)){draggableNumArray.push(num)}num++;$("#draw_canvas").unbind("mousedown",MouseDown);$("#draw_canvas").unbind("mousemove",MouseMove);$("#draw_canvas").unbind("mouseup",MouseUp);_clickNum=0;$(".showByDrag").bind("mousedown",dragImageMouseDown);$(".showByDrag").bind("mousemove",dragImageMouseMove);$(".showByDrag").bind("mouseup",dragImageMouseUp);$(".showByDrag").removeClass("mouseStyleAnnotation");$(".showByDrag").addClass("mouseStyleMove");CompleteDraw(drawActualIndex,_annotationLastType);G=false}};$("#draw_canvas").bind("mousedown",MouseDown);$("#draw_canvas").bind("mousemove",MouseMove);$("#draw_canvas").bind("mouseup",MouseUp)}function draw_rectPad(){var K=0;var O=0;var L=0;var E=0;var H=parseInt(_curCorrectPageId);var A=_fileDocument[curFileId].Viewers[H];drawPageIndex=H;var M=0,Q=0;var C=0,G=0;var B=0,R=0;var J=true,F=false;var I=0,P=0;var D;var F=false;MouseDown=function(S){K=$("#_plcBigImg").offset().left;O=$("#_plcBigImg").offset().top;L=$("#_plcBigImg")[0].scrollLeft-5;E=$("#_plcBigImg")[0].scrollTop-5;if(S.pointers.length==1){var T=S.pointers[0];F=true;M=T.clientX;Q=T.clientY;if(J){B=T.clientX-K+L;R=T.clientY-O+E;if(_viewerMode=="multi"){drawPageIndex=PrePageCount(R)}else{drawPageIndex=parseInt(_curCorrectPageId)}drawActualIndex=_fileDocument[curFileId].GetPageIndex(drawPageIndex);A=_fileDocument[curFileId].Viewers[drawActualIndex];J=false;F=true}}return false};MouseMove=function(S){if(F){var c=S.pointers[0];M=c.clientX-K+L;Q=c.clientY-O+E;I=B;P=R;C=M-B;if(C<0){C=-C;I=M}G=Q-R;if(G<0){G=-G;P=Q}if(_annotationLastType=="Freehand"){$("#div_"+num).remove();var a=c.clientX-K+L;var b=c.clientY-O+E;x_points[point_index]=a;y_points[point_index]=b;point_index++;var T=x_points.min();var W=y_points.min();var Z=x_points.max();var d=y_points.max();var g=Z-T;var X=d-W;strPoints="";for(var Y=0;Y<x_points.length;Y++){strPoints+=x_points[Y]+","+y_points[Y]+";"}strPoints=strPoints.substring(0,strPoints.length-1);A.GetViewerLeftTop();var V=new Annotation({OnPageIndex:drawActualIndex,Type:_annotationLastType,Index:num,ShowLeft:T,ShowTop:W,ShowPoints:strPoints,ViewerLeft:A.Left,ViewerTop:A.Top,ViewerWidth:A.ActualWidth,ViewerHeight:A.ActualHeight,ViewerScaleX:A.ScaleX,ViewerScaleY:A.ScaleY,ThumbViewerScaleX:A.ThumbScaleX,ThumbViewerScaleY:A.ThumbScaleY,ViewerOne2OneWidth:A.OneToOne_Width,ViewerOne2OneHeight:A.OneToOne_Height});var U=V.OutLineWidth/2*_zoomRatio*_zoomIndex;var f="<div class='new_rect' id='div_"+num+"' style='left:"+(T-U)+"px;top:"+(W-U)+"px;width:"+(g+2*U)+"px;height:"+(X+2*U)+"px'>";f+=drawAnnotationWithSVG(V,"annotation",drawActualIndex,false);f+="</div>";$("#draw_canvas").append(f)}else{_fileDocument[curFileId].Viewers[drawActualIndex].Annotations.splice(num,1);$("#div_"+num).remove();addImageViewerAnnotation(drawActualIndex,num,I,P,C,G,_annotationLastType,L,E)}}return false};MouseUp=function(S){F=false;J=true;if(_annotationLastType=="Freehand"){$("#div_"+num).remove();addImageViewerAnnotation(drawActualIndex,num,I,P,C,G,_annotationLastType,L,E);x_points=new Array();y_points=new Array();point_index=0}else{_fileDocument[curFileId].Viewers[drawActualIndex].Annotations.splice(num,1);$("#div_"+num).remove();addImageViewerAnnotation(drawActualIndex,num,I,P,C,G,_annotationLastType,L,E)}addThumbViewerAnnotation(_fileDocument[curFileId].Viewers[drawActualIndex].Annotations[num],drawActualIndex);$("#div_"+num).draggable({containment:"parent",scroll:false,handle:"svg .annotation",stop:function(){AnnoIsChanged()}});if(!draggableNumArray.in_array(num)){draggableNumArray.push(num)}hammerAnno.off("panstart");hammerAnno.off("panmove");hammerAnno.off("panend");$("#draw_canvas").unbind("touchstart",preventDefault);num++;_clickNum=0;$(".showByDrag").removeClass("mouseStyleAnnotation");$(".showByDrag").addClass("mouseStyleMove");CompleteDraw(drawActualIndex,_annotationLastType);return false};var N=document.getElementById("draw_canvas");hammerAnno=new Hammer(N);hammerAnno.off("panstart");hammerAnno.off("panmove");hammerAnno.off("panend");$("#draw_canvas").unbind("touchstart",preventDefault);hammerAnno.on("panstart",MouseDown);hammerAnno.on("panmove",MouseMove);hammerAnno.on("panend",MouseUp);$("#draw_canvas").bind("touchstart",preventDefault)}function draw_rect(){var K=0;var N=0;var L=0;var E=0;var H=parseInt(_curCorrectPageId);var A=_fileDocument[curFileId].Viewers[H];drawPageIndex=H;var M=0,P=0;var C=0,G=0;var B=0,Q=0;var J=true,F=false;var I=0,O=0;var D;var F=false;MouseDown=function(R){K=$("#_plcBigImg").offset().left;N=$("#_plcBigImg").offset().top;L=$("#_plcBigImg")[0].scrollLeft-5;E=$("#_plcBigImg")[0].scrollTop-5;F=true;R=R||window.event;M=R.pageX;P=R.pageY;if(J){B=R.pageX-K+L;Q=R.pageY-N+E;if(_viewerMode=="multi"){drawPageIndex=PrePageCount(Q)}else{drawPageIndex=parseInt(_curCorrectPageId)}drawActualIndex=_fileDocument[curFileId].GetPageIndex(drawPageIndex);A=_fileDocument[curFileId].Viewers[drawActualIndex];J=false;F=true}return false};MouseMove=function(R){if(F){M=R.pageX-K+L;P=R.pageY-N+E;I=B;O=Q;C=M-B;if(C<0){C=-C;I=M}G=P-Q;if(G<0){G=-G;O=P}if(_annotationLastType=="Freehand"){$("#div_"+num).remove();R=R||window.event;var Z=R.pageX-K+L;var a=R.pageY-N+E;x_points[point_index]=Z;y_points[point_index]=a;point_index++;var S=x_points.min();var V=y_points.min();var Y=x_points.max();var b=y_points.max();var d=Y-S;var W=b-V;strPoints="";for(var X=0;X<x_points.length;X++){strPoints+=x_points[X]+","+y_points[X]+";"}strPoints=strPoints.substring(0,strPoints.length-1);A.GetViewerLeftTop();var U=new Annotation({OnPageIndex:drawActualIndex,Type:_annotationLastType,Index:num,ShowLeft:S,ShowTop:V,ShowPoints:strPoints,ViewerLeft:A.Left,ViewerTop:A.Top,ViewerWidth:A.ActualWidth,ViewerHeight:A.ActualHeight,ViewerScaleX:A.ScaleX,ViewerScaleY:A.ScaleY,ThumbViewerScaleX:A.ThumbScaleX,ThumbViewerScaleY:A.ThumbScaleY,ViewerOne2OneWidth:A.OneToOne_Width,ViewerOne2OneHeight:A.OneToOne_Height});var T=U.OutLineWidth/2*_zoomRatio*_zoomIndex;var c="<div class='new_rect' id='div_"+num+"' style='left:"+(S-T)+"px;top:"+(V-T)+"px;width:"+(d+2*T)+"px;height:"+(W+2*T)+"px'>";c+=drawAnnotationWithSVG(U,"annotation",drawActualIndex,false);c+="</div>";$("#draw_canvas").append(c)}else{_fileDocument[curFileId].Viewers[drawActualIndex].Annotations.splice(num,1);$("#div_"+num).remove();addImageViewerAnnotation(drawActualIndex,num,I,O,C,G,_annotationLastType,L,E)}}return false};MouseUp=function(R){F=false;J=true;if(_annotationLastType=="Freehand"){$("#div_"+num).remove();addImageViewerAnnotation(drawActualIndex,num,I,O,C,G,_annotationLastType,L,E);x_points=new Array();y_points=new Array();point_index=0}else{_fileDocument[curFileId].Viewers[drawActualIndex].Annotations.splice(num,1);$("#div_"+num).remove();addImageViewerAnnotation(drawActualIndex,num,I,O,C,G,_annotationLastType,L,E);if(_annotationLastType=="Text"){$("#annotation_"+num).trigger("ondblclick")}}addThumbViewerAnnotation(_fileDocument[curFileId].Viewers[drawActualIndex].Annotations[num],drawActualIndex);$("#div_"+num).draggable({containment:"parent",scroll:false,handle:"svg .annotation",stop:function(){AnnoIsChanged()}});if(!draggableNumArray.in_array(num)){draggableNumArray.push(num)}num++;$("#draw_canvas").unbind("mousedown",MouseDown);$("#draw_canvas").unbind("mousemove",MouseMove);$("#draw_canvas").unbind("mouseup",MouseUp);_clickNum=0;$(".showByDrag").bind("mousedown",dragImageMouseDown);$(".showByDrag").bind("mousemove",dragImageMouseMove);$(".showByDrag").bind("mouseup",dragImageMouseUp);$(".showByDrag").removeClass("mouseStyleAnnotation");$(".showByDrag").addClass("mouseStyleMove");CompleteDraw(drawActualIndex,_annotationLastType);return false};$("#draw_canvas").bind("mousedown",MouseDown);$("#draw_canvas").bind("mousemove",MouseMove);$("#draw_canvas").bind("mouseup",MouseUp)}function preventDefault(A){A.preventDefault()}function CompleteDraw(E,F){var D=new Array();for(var B=0;B<draggableNumArray.length;B++){var C=draggableNumArray[B];if(document.getElementById("div_"+C)==null){D.push(C)}else{$("#div_"+draggableNumArray[B]).draggable("enable")}}for(var B=0;B<D.length;B++){draggableNumArray.remove(D[B])}$("#"+currentAnnoStyleId).removeClass("annoSelect");currentAnnoStyleId="";if(!canSaveAnnos){enableSaveAnnos();canSaveAnnos=true}if(!canDelete){enableDelete();canDelete=true}HideAllPropanel();if(F!=""&&F!=null){var A="re_func_"+F.toLowerCase();annoPro_flag=E+";"+selectDiv[0]+";"+A;if(selectDiv.length==0){ShowCommentsPanel(F)}}}var curHideTextAnnoId="";function EditText(D){selectId=(D.id);idPosition=selectId.indexOf("_");selectTextId=selectId.substring(idPosition+1);oText=document.getElementById("text_"+selectTextId+"");oText.style.visibility="visible";$(".rRightDown").css("visibility","hidden");$(".rLeftDown").css("visibility","hidden");$(".rLeftUp").css("visibility","hidden");$(".rRightUp").css("visibility","hidden");$(".rRight").css("visibility","hidden");$(".rLeft").css("visibility","hidden");$(".rUp").css("visibility","hidden");$(".rDown").css("visibility","hidden");$(".top").css("visibility","hidden");$(".bottom").css("visibility","hidden");oText.focus();var B=oText.value.length;if(document.selection){var F=oText.createTextRange();F.moveStart("character",B);F.collapse();F.select()}else{if(typeof oText.selectionStart=="number"&&typeof oText.selectionEnd=="number"){oText.selectionStart=oText.selectionEnd=B}}for(var A=0;A<_fileDocument[curFileId].Viewers.length;A++){var E=_fileDocument[curFileId].Viewers[A];if(E==null||E.ShowIndex==null){continue}if(E.Annotations[selectTextId]!=null){pageId=A;break}}if(pageId==null){return}var C=_fileDocument[curFileId].Viewers[pageId].Annotations[selectTextId];$("#text_"+selectTextId+"").css("margin-top",C.OutLineWidth+"px");$("#text_"+selectTextId+"").css("margin-left",C.OutLineWidth+"px");$("#text_"+selectTextId+"").css("width",C.ShowWidth-16-C.OutLineWidth/2);$("#text_"+selectTextId+"").css("height",C.ShowHeight-16-C.OutLineWidth/2);curHideTextAnnoId=selectId}function EditText_Pad(B){var C=(document.all)?true:false;selectId=(B.id);idPosition=selectId.indexOf("_");selectTextId=selectId.substring(idPosition+1);oText=document.getElementById("text_"+selectTextId+"");oText.style.visibility="visible";if(C){var A=oText.createTextRange();A.moveStart("character",oText.value.length);A.collapse(true);A.select()}else{oText.selectionStart=0;oText.selectionEnd=oText.value.length}$("#"+selectId).hide();curHideTextAnnoId=selectId}function createTextAnnoWidthCanvas(K,H){var D={fontStyle:"normal",fontName:"Arial",fontSize:12,fillColor:"darkblue",textColor:"white",padding:0,width:100,height:80,outLineWidth:3,outLineColor:"dark",transparency:0.5,rotate:0,};function I(T,R){var U=T.length,V=U,S=0;for(var W=0;W<U;W++){if(T.charCodeAt(W)>128){if(S+options.fontSize<R){S+=options.fontSize}else{V=W;break}}else{if(S+options.fontSize/2<R){S+=options.fontSize/2}else{V=W;break}}}return V}options=$.extend(D,H);var A=document.createElement("canvas"),L=A.getContext("2d");var J="bold "+options.fontSize+"px "+options.fontName;var O=options.width;if(O<options.fontSize){O=2*options.fontSize}var F=options.height;if(F<options.fontSize){F=2*options.fontSize}A.width=O;A.height=F;L.beginPath();L.rect(0,0,O,F);L.globalAlpha=options.transparency;L.fillStyle=options.fillColor;L.fill();L.lineWidth=options.outLineWidth*2;L.strokeStyle=options.outLineColor;L.stroke();L.globalAlpha=1;L.rotate(options.rotate*90*Math.PI/180);L.textAlign="left";L.fillStyle=options.textColor;L.font=J;var C=K.split("\n");var N=1;var Q=L.measureText("A").width;for(var P=0;P<C.length;P++){var G=C[P];var B=parseInt(O/Q);if(B==0){B=1}var M="";for(var E=1;E<=G.length;E++){if(E%B==0&&M!=""){L.fillText(M,0,parseInt(N*options.fontSize)+5);N++;M=""}else{M+=G[E-1]}}if(M!=""){L.fillText(M,0,parseInt(N*options.fontSize)+5)}N++}return A.toDataURL()}function createStampAnnoWidthCanvas(H,B){CanvasRenderingContext2D.prototype.roundRect=function(P,Q,R,M,N,O,S){if(R<2*N){N=R/2}if(M<2*N){N=M/2}this.beginPath();this.moveTo(P+N,Q);this.arcTo(P+R,Q,P+R,Q+M,N);this.arcTo(P+R,Q+M,P,Q+M,N);this.arcTo(P,Q+M,P,Q,N);this.arcTo(P,Q,P+R,Q,N);this.globalAlpha=O;this.fillStyle=S;this.closePath();return this};var D={fontStyle:"normal",fontName:"Arial",fontSize:12,fillColor:"Red",textColor:"Black",padding:0,width:100,height:80,outLineWidth:5,outLineColor:"Red",transparency:0.5,rotate:0,};options=$.extend(D,B);var A=document.createElement("canvas"),E=A.getContext("2d");var C=options.width;var F=options.height;var I=options.fontStyle+" "+options.fontSize+"px "+options.fontName;A.width=C;A.height=F;E.beginPath();E.rect(0,0,C,F);E.globalAlpha=options.transparency;E.lineWidth=options.outLineWidth;E.strokeStyle=options.outLineColor;E.stroke();E.rotate(options.rotate*90*Math.PI/180);E.textAlign="center";E.fillStyle=options.textColor;E.font=I;var J=E.measureText(H);var G=E.measureText("G");var K;if(C-J.width>=0){K=J.width/2+(C-J.width)/2}else{K=J.width/2}var L=F/2+G.width/2;E.fillText(H,K,L);return A.toDataURL()}function drawImageViewerAnnotations(V){if(_viewerMode=="single"){$(".new_rect").remove()}for(var D=0;D<_fileDocument[curFileId].Viewers[V].Annotations.length;D++){var P=_fileDocument[curFileId].Viewers[V].Annotations[D];if(P!=null&&P.Index!=null){if(P.Type!="TextRedacts"){_fileDocument[curFileId].Viewers[V].Annotations[D].ReSetByZoom();P=_fileDocument[curFileId].Viewers[V].Annotations[D];drawLeft=P.ShowLeft;drawTop=P.ShowTop;drawWidth=P.ShowWidth;drawHeight=P.ShowHeight;var K=P.OutLineWidth/2*_zoomRatio*_zoomIndex;append_string="<div class='new_rect' id='div_"+P.Index+"' style='left:"+(drawLeft-K)+"px;top:"+(drawTop-K)+"px;width:"+(drawWidth+2*K)+"px;height:"+(drawHeight+2*K)+"px'>";if(P.Type=="Line"||P.Type=="Arrow"){var N=P.ShowPoints.split(";");for(var U=0;U<N.length;U++){var B=N[U].split(",");if(typeof(B)!="undefined"){x_points[U]=parseInt(B[0]);y_points[U]=parseInt(B[1])}}append_string+=addLineOrArrowHandler(P.Type,x_points,y_points,P.Index,K)}else{append_string+="<div class='rRightDown' id='rRightDown_"+P.Index+"'></div><div class='rLeftDown' id='rLeftDown_"+P.Index+"'></div><div class='rRightUp' id='rRightUp_"+P.Index+"'></div><div class='rLeftUp' id='rLeftUp_"+P.Index+"'></div><div class='rRight' id='rRight_"+P.Index+"'></div><div class='rLeft' id='rLeft_"+P.Index+"'></div><div class='rUp' id='rUp_"+P.Index+"'></div><div class='rDown' id='rDown_"+P.Index+"'></div>"}append_string+=drawAnnotationWithSVG(P,"annotation",V,false);append_string+="</div>";$("#draw_canvas").append(append_string);if(P.Type=="Text"){(function(Y){var Z=document.getElementById("annotation_"+P.Index+"");if(_isIpad){var X=new Hammer.Manager(Z);X.add(new Hammer.Tap({event:"doubletap",taps:2}));X.on("doubletap",function(a){EditText(Z)})}else{Z.ondblclick=function(){EditText(Z)}}})(P.Index)}$("#div_"+P.Index).draggable({containment:"parent",scroll:false,handle:"svg .annotation",stop:function(){AnnoIsChanged()}});if(!draggableNumArray.in_array(P.Index)){draggableNumArray.push(P.Index)}BindImageViewerAnnotationClick(P.Index);BindResize(P.Index,P.Type)}else{var F=P.RedactRects.relativePages;var W;var A;var R=new Array();var C=new Array();var T=new Array();var M=new Array();if(_viewerMode=="single"){var P=_fileDocument[curFileId].Viewers[V].Annotations[D];M=P.RedactRects.curPageRectRedacts;for(var U=0;U<M.length;U++){M[U].ReSetByZoom();R.push(M[U].ShowLeft);C.push(M[U].ShowTop);T.push(M[U].ShowWidth)}W=M[0];A=M[M.length-1]}else{if(V==F[0]){for(var U=0;U<F.length;U++){var P=_fileDocument[curFileId].Viewers[F[U]].Annotations[D];var L=P.RedactRects.curPageRectRedacts;for(var E=0;E<L.length;E++){L[E].ReSetByZoom();R.push(L[E].ShowLeft);C.push(L[E].ShowTop);T.push(L[E].ShowWidth);M.push(L[E])}}var S=_fileDocument[curFileId].Viewers[F[0]].Annotations[D];W=S.RedactRects.curPageRectRedacts[0];var O=_fileDocument[curFileId].Viewers[F[F.length-1]].Annotations[D];var J=O.RedactRects.curPageRectRedacts;A=J[J.length-1]}else{continue}}var H=R.min();var I=C.min();var G=T.max();var Q=A.ShowTop-W.ShowTop+A.ShowHeight;append_string="<div class='new_rect' id='div_"+P.Index+"' style='left:"+H+"px;top:"+I+"px;width:"+G+"px;height:"+Q+"px'>";append_string+="<div class='rightRedact' style='left:"+(A.ShowLeft-H+A.ShowWidth-3)+"px;' id='rRightDown_"+P.Index+"'></div><div class='leftRedact' style='left:"+(W.ShowLeft-H-3)+"px;' id='rLeftUp_"+P.Index+"'></div>";append_string+="<svg class='svg' id='svg_"+P.Index+"' width='100%' height='100%' version='1.1' xmlns='http://www.w3.org/2000/svg'>";for(var U=0;U<M.length;U++){var J=M[U];append_string+="<rect class='anno_redact' id='annotation_"+P.Index+"_"+U+"' x='"+(J.ShowLeft-H)+"' y='"+(J.ShowTop-I)+"' width='"+J.ShowWidth+"' height='"+J.ShowHeight+"' style='fill:"+J.FillColor+";'/>"}append_string+="</svg></div>";$("#draw_canvas").append(append_string);$(".leftRedact").bind("mousedown",function(){selectXDown=A.ShowLeft+A.ShowWidth;selectYDown=A.ShowTop+A.ShowHeight;$("#div_"+P.Index).remove();redactId=this.id.substring(this.id.indexOf("_")+1);ContinueTextRedaction()});$(".rightRedact").bind("mousedown",function(){selectXDown=W.ShowLeft;selectYDown=W.ShowTop;$("#div_"+P.Index).remove();redactId=this.id.substring(this.id.indexOf("_")+1);ContinueTextRedaction()})}noSelectAnno();HideAllPropanel()}}}function drawRedactAnno(){var C="<div class='new_rect' id='div_"+annoIndex+"' style='left:"+docAnno.ShowLeft+"px;top:"+docAnno.ShowTop+"px;width:"+docAnno.ShowWidth+"px;height:"+docAnno.ShowHeight+"px'>";C+="<div class='rightRedact' style='left:"+(lastRectRedact.ShowLeft-docAnno.ShowLeft+lastRectRedact.ShowWidth-3)+"px;' id='rRightDown_"+annoIndex+"'></div><div class='leftRedact' style='left:"+(selectRedactRects[0].ShowLeft-docAnno.ShowLeft-3)+"px;' id='rLeftUp_"+annoIndex+"'></div>";C+="<svg class='svg' id='svg_"+annoIndex+"' width='100%' height='100%' version='1.1' xmlns='http://www.w3.org/2000/svg'>";for(var A=0;A<selectRedactRects.length;A++){var B=selectRedactRects[A];C+="<rect class='anno_redact' id='annotation_"+annoIndex+"_"+A+"' x='"+(B.ShowLeft-docAnno.ShowLeft)+"' y='"+(B.ShowTop-docAnno.ShowTop)+"' width='"+B.ShowWidth+"' height='"+B.ShowHeight+"' style='fill:"+B.FillColor+";'/>"}C+="</svg></div>"}function drawContinuesAnnotations(){$(".new_rect").remove();$(".burn_rect").remove();var B=_fileDocument[curFileId];for(var A=0;A<B.ViewerPageIndex.length;A++){drawImageViewerAnnotations(B.ViewerPageIndex[A])}}function SinglePageAnnotation(A){drawImageViewerAnnotations(A)}function MultiPageAnnotation(){drawContinuesAnnotations()}var temp=0;function BindImageViewerAnnotationClick(D){var C=$("#_plcBigImg").offset().left;var A=$("#_plcBigImg").offset().top;var E=false;var F=function(G){G=G||window.event;selectId=(G.target.id);if(selectId.indexOf("r")==0){E=true}E=true;if(isCtrlDown==false){selectDiv=new Array()}selectDiv.push(D)};var B=function(G){if(E){var H=$("#_plcBigImg")[0].scrollLeft-5;var K=$("#_plcBigImg")[0].scrollTop-5;for(var L=0;L<_fileDocument[curFileId].Viewers.length;L++){var J=_fileDocument[curFileId].Viewers[L];if(J==null||J.ShowIndex==null){continue}if(J.Annotations[D]!=null){pageId=L;break}}var N=_zoomRatio*_zoomIndex;pageSizeType=_pageSizeType;selectId=D;if(isNaN(selectId)){return false}var M=_fileDocument[curFileId].Viewers[pageId].Annotations[selectId];if(M==null){return false}var I=M.OutLineWidth/2*_zoomRatio*_zoomIndex;reDrawDiv=$("#div_"+selectId);reDraw_left=reDrawDiv.offset().left-C+H+I;reDraw_top=reDrawDiv.offset().top-A+K+I;if(reDrawDiv.width()==0||reDrawDiv.height()==0){reDraw_width=1;reDraw_height=1}else{reDraw_width=reDrawDiv.width()-2*I;reDraw_height=reDrawDiv.height()-2*I}_fileDocument[curFileId].Viewers[pageId].Annotations[selectId].ReSetSize(reDraw_left,reDraw_top,reDraw_width,reDraw_height);resizeAnnotationWithSVG("#annotation_",_fileDocument[curFileId].Viewers[pageId].Annotations[selectId],pageId,false);resizeAnnotationWithSVG("#thumbAnnotation_",_fileDocument[curFileId].Viewers[pageId].Annotations[selectId],pageId,true);$("#thumbImg_"+selectId).css("top",_fileDocument[curFileId].Viewers[pageId].Annotations[selectId].ThumbShowTop);$("#thumbImg_"+selectId).css("left",_fileDocument[curFileId].Viewers[pageId].Annotations[selectId].ThumbShowLeft);$("#thumbImg_"+selectId).width(_fileDocument[curFileId].Viewers[pageId].Annotations[selectId].ThumbShowWidth).height(_fileDocument[curFileId].Viewers[pageId].Annotations[selectId].ThumbShowHeight)}};$("#div_"+D).bind("mousedown",F);$("#rRightDown_"+D).bind("mousedown",F);$("#rLeftDown_"+D).bind("mousedown",F);$("#rRightUp_"+D).bind("mousedown",F);$("#rLeftUp_"+D).bind("mousedown",F);$("#rRight_"+D).bind("mousedown",F);$("#rLeft_"+D).bind("mousedown",F);$("#rUp_"+D).bind("mousedown",F);$("#rDown_"+D).bind("mousedown",F);$("#div_"+D).bind("mousemove",B)}function resizeAnnotationWithSVG(N,E,O,K){if(E.Type=="Highlight"||E.Type=="Rectangle"||E.Type=="FilledRectangle"||E.Type=="FilledRectRedaction"){if(K){$(N+E.Index).attr("width",E.ThumbShowWidth);$(N+E.Index).attr("height",E.ThumbShowHeight)}else{$(N+E.Index).attr("width",E.ShowWidth);$(N+E.Index).attr("height",E.ShowHeight)}}else{if(E.Type=="Ellipse"){var M=E.OutLineWidth/2*_zoomRatio*_zoomIndex;if(K){$(N+E.Index).attr("cx",E.ThumbShowWidth/2);$(N+E.Index).attr("cy",E.ThumbShowHeight/2);$(N+E.Index).attr("rx",E.ThumbShowWidth/2);$(N+E.Index).attr("ry",E.ThumbShowHeight/2)}else{$(N+E.Index).attr("cx",parseInt(E.ShowWidth/2+M));$(N+E.Index).attr("cy",parseInt(E.ShowHeight/2+M));$(N+E.Index).attr("rx",E.ShowWidth/2);$(N+E.Index).attr("ry",E.ShowHeight/2)}}else{if(E.Type=="Line"){if(K){$(N+E.Index).attr("points",E.ThumbRelativePoints)}else{$(N+E.Index).attr("points",E.RelativePoints)}}else{if(E.Type=="Arrow"){if(K){strPoints=E.ThumbRelativePoints.split(" ");var D=strPoints[0]+" "+strPoints[1];var P=strPoints[2]+" "+strPoints[3]+" "+strPoints[4];$(N+E.Index).attr("points",D);$(N+E.Index+"_arrow").attr("points",P)}else{strPoints=E.RelativePoints.split(" ");var D=strPoints[0]+" "+strPoints[1];var P=strPoints[2]+" "+strPoints[3]+" "+strPoints[4];$(N+E.Index).attr("points",D);$(N+E.Index+"_arrow").attr("points",P)}}else{if(E.Type=="Freehand"||E.Type=="PolygonLines"||E.Type=="Polygon"){if(K){$(N+E.Index).attr("points",E.ThumbRelativePoints)}else{$(N+E.Index).attr("points",E.RelativePoints)}}else{if(E.Type=="fhSignature"){strPoints="";if(K){strPoints=E.ThumbRelativePoints.split(";");for(var B=0;B<strPoints.length;B++){$("#thumbAnnotation_"+E.Index+"_"+B).attr("points",strPoints[B])}}else{strPoints=E.RelativePoints.split(";");for(var B=0;B<strPoints.length;B++){$("#annotation_"+E.Index+"_"+B).attr("points",strPoints[B])}}}else{if(E.Type=="Text"){if(K){var F=_fileDocument[curFileId].Viewers[O];var C=F.thumbShowWidth/_docWidth*E.TextSize;src=createTextAnnoWidthCanvas(E.Text,{fontStyle:E.TextStyle,fontName:E.TextFont,fontSize:C,fillColor:E.FillColor,outLineWidth:E.OutLineWidth,outLineColor:E.OutLineColor,textColor:E.TextColor,width:E.ThumbShowWidth,height:E.ThumbShowHeight,transparency:E.Transparency,rotate:E.Rotate});$(N+E.Index).attr("src",src)}else{var H=_zoomRatio*_zoomIndex*E.TextSize;document.getElementById("text_"+E.Index).style.width=(E.ShowWidth-16-E.OutLineWidth/2)+"px";document.getElementById("text_"+E.Index).style.height=(E.ShowHeight-16-E.OutLineWidth/2)+"px";$(N+E.Index).css({"width":E.ShowWidth,"height":E.ShowHeight});$("#svg_"+E.Index).remove();var I=drawAnnotationWithSVG(E,"annotation",E.OnPageIndex,false);$("#div_"+E.Index).append(I);var J=document.getElementById("annotation_"+E.Index+"");if(_isIpad){var G=new Hammer.Manager(J);G.add(new Hammer.Tap({event:"doubletap",taps:2}));G.on("doubletap",function(R){EditText(J)})}else{J.ondblclick=function(){EditText(J)}}}}else{if(E.Type=="RubberStamp"){if(K){var F=_fileDocument[curFileId].Viewers[O];var C=F.thumbShowWidth/_docWidth*E.TextSize;src=createStampAnnoWidthCanvas(E.Text,{fontStyle:E.TextStyle,fontName:E.TextFont,fontSize:C,fillColor:E.FillColor,textColor:E.FillColor,outLineWidth:E.OutLineWidth,outLineColor:E.OutLineColor,width:E.ThumbShowWidth,height:E.ThumbShowHeight,transparency:E.Transparency,rotate:E.Rotate});$(N+E.Index).attr("src",src)}else{$(N+E.Index).css({"width":E.ShowWidth,"height":E.ShowHeight});var A=document.createElement("canvas");context=A.getContext("2d");var H;var Q="";if(E.Rotate==0||E.Rotate==2){H=E.ShowWidth/E.Text.length;if(H>E.ShowHeight){H=E.ShowHeight}if(H<15){H=15}font="bold "+H+"px "+E.TextFont;context.font=font;metrics=context.measureText(E.Text);tempWidth=context.measureText("G").width;if(E.Rotate==0){offWidth=(E.ShowWidth+E.OutLineWidth+-metrics.width)/2;offHeight=(E.ShowHeight+E.OutLineWidth+tempWidth)/2;Q="matrix(1,0,0,1,"+offWidth+","+offHeight+")"}else{offWidth=(E.ShowWidth+E.OutLineWidth+metrics.width)/2;offHeight=(E.ShowHeight+E.OutLineWidth)/2;Q="matrix(-1,0,0,-1,"+offWidth+","+offHeight+")"}}else{if(E.Rotate==1||E.Rotate==3){H=E.ShowHeight/E.Text.length;if(H>E.ShowWidth){H=E.ShowWidth}if(H<15){H=15}font="bold "+H+"px "+E.TextFont;context.font=font;metrics=context.measureText(E.Text);tempWidth=context.measureText("A").width;if(E.Rotate==1){offWidth=(E.ShowWidth-E.OutLineWidth+tempWidth)/2;offHeight=(E.ShowHeight+E.OutLineWidth-metrics.width)/2;Q="matrix(0,1,-1,0,"+offWidth+","+offHeight+")"}else{offWidth=(E.ShowWidth+E.OutLineWidth+tempWidth)/2;offHeight=(E.ShowHeight+E.OutLineWidth+metrics.width)/2;Q="matrix(0,-1,1,0,"+offWidth+","+offHeight+")"}}}E.TextSize=H/(_zoomRatio*_zoomIndex);RubberStampAnnoStyle.TextSize=E.TextSize;$(N+E.Index+"_text").attr("transform",Q);$(N+E.Index+"_text").attr("font-size",H)}}else{if(E.Type=="txtSignature"||E.Type=="dateSignature"){if(K){var F=_fileDocument[curFileId].Viewers[O];var C=F.thumbShowWidth/_docWidth*E.TextSize;src=createStampAnnoWidthCanvas(E.Text,{fontStyle:E.TextStyle,fontName:E.TextFont,fontSize:C,fillColor:E.FillColor,textColor:E.FillColor,outLineWidth:E.OutLineWidth,outLineColor:E.OutLineColor,width:E.ThumbShowWidth,height:E.ThumbShowHeight,transparency:E.Transparency,rotate:E.Rotate});$(N+E.Index).attr("src",src)}else{$(N+E.Index).css({"width":E.ShowWidth,"height":E.ShowHeight});var L="normal";if(E.Type=="dateSignature"){L="bold"}var A=document.createElement("canvas");context=A.getContext("2d");var H;var Q="";if(E.Rotate==0||E.Rotate==2){H=E.ShowWidth/E.Text.length;if(H<E.ShowHeight){font=L+" "+H+"px "+E.TextFont;context.font=font;metrics=context.measureText(E.Text);while(metrics.width<E.ShowWidth){H++;font=L+" "+H+"px "+E.TextFont;context.font=font;metrics=context.measureText(E.Text)}if(H>E.ShowHeight){H=E.ShowHeight}}else{H=E.ShowHeight}font=L+" "+H+"px "+E.TextFont;context.font=font;metrics=context.measureText(E.Text);tempWidth=context.measureText("g").width+5;if(E.Rotate==0){offWidth=(E.ShowWidth+E.OutLineWidth+-metrics.width)/2;offHeight=(E.ShowHeight+E.OutLineWidth+tempWidth)/2;Q="matrix(1,0,0,1,"+offWidth+","+offHeight+")"}else{offWidth=(E.ShowWidth+E.OutLineWidth+metrics.width)/2;offHeight=(E.ShowHeight-tempWidth)/2;Q="matrix(-1,0,0,-1,"+offWidth+","+offHeight+")"}}else{if(E.Rotate==1||E.Rotate==3){H=E.ShowHeight/E.Text.length;if(H<E.ShowWidth){font=L+" "+H+"px "+E.TextFont;context.font=font;metrics=context.measureText(E.Text);while(metrics.width<E.ShowHeight){H++;font=L+" "+H+"px "+E.TextFont;context.font=font;metrics=context.measureText(E.Text)}if(H>E.ShowWidth){H=E.ShowWidth}}else{H=E.ShowWidth}font=L+" "+H+"px "+E.TextFont;context.font=font;metrics=context.measureText(E.Text);tempWidth=context.measureText("g").width+5;if(E.Rotate==1){offWidth=(E.ShowWidth-tempWidth)/2;offHeight=(E.ShowHeight+E.OutLineWidth-metrics.width)/2;Q="matrix(0,1,-1,0,"+offWidth+","+offHeight+")"}else{offWidth=(E.ShowWidth+E.OutLineWidth+tempWidth)/2;offHeight=(E.ShowHeight+E.OutLineWidth+metrics.width)/2;Q="matrix(0,-1,1,0,"+offWidth+","+offHeight+")"}}}E.TextSize=H/(_zoomRatio*_zoomIndex);$(N+E.Index+"_text").attr("transform",Q);$(N+E.Index+"_text").attr("font-size",H)}}}}}}}}}}}var ImageContinueDown;var ImageContinueMove;var ImageContinueUp;var resizeAnnoIndex;var resizePg;var resizeId;var resizeDown=false;function BindResize(E,D){if(D=="Line"||D=="Arrow"){var C=_fileDocument[curFileId];var B=function(H){resizeId=this.id;resizeAnnoIndex=resizeId.substring(resizeId.indexOf("_")+1);for(var G=0;G<C.ViewerPageIndex.length;G++){var M=C.ViewerPageIndex[G];var J=_fileDocument[curFileId].Viewers[M];if(J.Annotations[resizeAnnoIndex]!=null){resizePg=M;break}}if(resizePg==null){return}var L=_fileDocument[curFileId].Viewers[resizePg].Annotations[resizeAnnoIndex];var K=L.ShowPoints.split(";");for(var G=0;G<K.length;G++){var I=K[G].split(",");if(typeof(I)!="undefined"){x_points[G]=parseInt(I[0]);y_points[G]=parseInt(I[1])}}parent_left=$("#_plcBigImg").offset().left;parent_top=$("#_plcBigImg").offset().top;nScrollLeft=$("#_plcBigImg")[0].scrollLeft-5;nScrollTop=$("#_plcBigImg")[0].scrollTop-5;$(".showByDrag").unbind("mousedown",dragImageMouseDown);$(".showByDrag").unbind("mousemove",dragImageMouseMove);$(".showByDrag").unbind("mouseup",dragImageMouseUp);$("#draw_canvas").bind("mousemove",F);$("#draw_canvas").bind("mouseup",ImageContinueUp);resizeDown=true};var F=function(G){if(resizeDown){G=G||window.event;$("#div_"+resizeAnnoIndex).remove();x=G.pageX-parent_left+nScrollLeft;y=G.pageY-parent_top+nScrollTop;var J=_fileDocument[curFileId].Viewers[resizePg];var Q=J.Annotations[resizeAnnoIndex];if(resizeId.substring(0,resizeId.indexOf("_"))=="top"){x_points[0]=x;y_points[0]=y}else{x_points[1]=x;y_points[1]=y}var S="";if(Q.Type=="Arrow"){var P=new Array();P=getArrowKeypoints(x_points[0],y_points[0],x_points[1],y_points[1]);x_points[2]=P[0];y_points[2]=P[1];x_points[3]=P[2];y_points[3]=P[3];x_points[4]=P[4];y_points[4]=P[5]}var H=x_points.min();var K=y_points.min();var O=x_points.max();var R=y_points.max();var T=O-H;var L=R-K;strPoints="";for(var N=0;N<x_points.length;N++){strPoints+=x_points[N]+","+y_points[N]+";"}strPoints=strPoints.substring(0,strPoints.length-1);var M=new Annotation({OnPageIndex:resizePg,Type:Q.Type,Index:resizeAnnoIndex,ShowLeft:H,ShowTop:K,ShowPoints:strPoints,ViewerLeft:J.Left,ViewerTop:J.Top,ViewerWidth:J.ActualWidth,ViewerHeight:J.ActualHeight,ViewerScaleX:J.ScaleX,ViewerScaleY:J.ScaleY,ThumbViewerScaleX:J.ThumbScaleX,ThumbViewerScaleY:J.ThumbScaleY,ViewerOne2OneWidth:J.OneToOne_Width,ViewerOne2OneHeight:J.OneToOne_Height});var I=M.OutLineWidth/2*_zoomRatio*_zoomIndex;var S="<div class='new_rect' id='div_"+resizeAnnoIndex+"' style='left:"+(H-I)+"px;top:"+(K-I)+"px;width:"+(T+2*I)+"px;height:"+(L+2*I)+"px'>";S+=drawAnnotationWithSVG(M,"annotation",resizePg,false);S+="</div>";$("#draw_canvas").append(S)}};ImageContinueUp=function(G){var H=_fileDocument[curFileId].Viewers[resizePg].Annotations[resizeAnnoIndex];$("#draw_canvas").unbind("mousemove",F);$("#draw_canvas").unbind("mouseup",ImageContinueUp);$(".showByDrag").bind("mousedown",dragImageMouseDown);$(".showByDrag").bind("mousemove",dragImageMouseMove);$(".showByDrag").bind("mouseup",dragImageMouseUp);$("#div_"+resizeAnnoIndex).remove();$("#thumbImg_"+resizeAnnoIndex).remove();addImageViewerAnnotation(resizePg,resizeAnnoIndex,0,0,0,0,H.Type,nScrollLeft,nScrollTop);x_points=new Array();y_points=new Array();point_index=0;addThumbViewerAnnotation(_fileDocument[curFileId].Viewers[resizePg].Annotations[resizeAnnoIndex],resizePg);$("#div_"+resizeAnnoIndex).draggable({containment:"parent",scroll:false,handle:"svg .annotation",stop:function(){AnnoIsChanged()}});if(!draggableNumArray.in_array(resizeAnnoIndex)){draggableNumArray.push(resizeAnnoIndex)}resizeDown=false};$("#top_"+E).bind("mousedown",B);$("#bottom_"+E).bind("mousedown",B)}else{var A=new Resize("div_"+E+"",{Max:true,mxContainer:"_plcBigImg"});A.Set("rRightDown_"+E+"","right-down");A.Set("rLeftDown_"+E+"","left-down");A.Set("rRightUp_"+E+"","right-up");A.Set("rLeftUp_"+E+"","left-up");A.Set("rRight_"+E+"","right");A.Set("rLeft_"+E+"","left");A.Set("rUp_"+E+"","up");A.Set("rDown_"+E+"","down")}}function RotateAnnotations(D,B){thumbViewerWidth=_fileDocument[curFileId].Viewers[D].ThumbWidth;thumbViewerHeight=_fileDocument[curFileId].Viewers[D].ThumbHeight;if(B==1||B==3){$("#thumbDiv_"+D).width(thumbViewerHeight).height(thumbViewerWidth)}else{$("#thumbDiv_"+D).width(thumbViewerWidth).height(thumbViewerHeight)}var C=new Array();for(index in _fileDocument[curFileId].Viewers[D].Annotations){C[index]=_fileDocument[curFileId].Viewers[D].Annotations[index];if(C[index]!=null&&C[index].Index!=null){C[index].ReSetRotate(B);var E=C[index];resizeAnnotationWithSVG("#annotation_",E,D,false);var A=E.OutLineWidth/2*_zoomRatio*_zoomIndex;$("#div_"+E.Index).css("top",E.ShowTop-A);$("#div_"+E.Index).css("left",E.ShowLeft-A);$("#div_"+E.Index).width(E.ShowWidth+2*A).height(E.ShowHeight+2*A);resizeAnnotationWithSVG("#thumbAnnotation_",E,D,true);$("#thumbImg_"+E.Index).css("top",E.ThumbShowTop);$("#thumbImg_"+E.Index).css("left",E.ThumbShowLeft);$("#thumbImg_"+E.Index).width(E.ThumbShowWidth).height(E.ThumbShowHeight)}}}function HidePageAnnotations(C,A){var B=new Array();for(index in _fileDocument[curFileId].Viewers[C].Annotations){B[index]=_fileDocument[curFileId].Viewers[C].Annotations[index]}if(A){for(index in B){if(B[index].Index!=null){var D=B[index];$("#thumbImg_"+D.Index).hide()}}}else{for(index in B){if(B[index].Index!=null){var D=B[index];$("#div_"+D.Index).hide()}}}}function ShowPageAnnotations(C,A){var B=new Array();for(index in _fileDocument[curFileId].Viewers[C].Annotations){B[index]=_fileDocument[curFileId].Viewers[C].Annotations[index]}if(A){for(index in B){if(B[index].Index!=null){var D=B[index];$("#thumbImg_"+D.Index).show()}}}else{for(index in B){if(B[index].Index!=null){var D=B[index];$("#div_"+D.Index).show()}}}}var Viewer=Class.create();Viewer.prototype={initialize:function(A){this.SetOptions(A);this.PageIndex=this.options.PageIndex;this.ShowIndex=this.options.PageIndex;this.TempExIndex=this.options.TempExIndex;this.Width=this.options.Width;this.Height=this.options.Height;this.ThumbWidth=this.options.ThumbWidth;this.ThumbHeight=this.options.ThumbHeight;this.ActualWidth=this.options.ActualWidth;this.ActualHeight=this.options.ActualHeight;this.BigWidth=this.options.BigWidth;this.BigHeight=this.options.BigHeight;this.Left=this.options.Left;this.Top=this.options.Top;this.ZoomIndex=this.options.ZoomIndex;this.Rotate=this.options.Rotate;this.PageSizeType=this.options.PageSizeType;this.Annotations=this.options.Annotations;this.FirstLeft=this.options.FirstLeft;this.FirstTop=this.options.FirstTop;this.FirstActualWidth=this.options.FirstActualWidth;this.FirstActualHeight=this.options.FirstActualHeight;this.Init=false;this.isChange=this.options.isChange;this.Currentzoom=this.options.Currentzoom;this.thumbShowWidth=this.options.thumbShowWidth;this.thumbShowHeight=this.options.thumbShowHeight;this.DocImageIsExist=this.options.DocImageIsExist;this.ThumbImageIsExist=this.options.ThumbImageIsExist;this.svgAjaxRequest=this.options.svgAjaxRequest;this.charRectsAjaxRequest=this.options.charRectsAjaxRequest},SetOptions:function(A){this.options={PageIndex:0,ShowIndex:0,TempExIndex:0,Width:_docWidth,Height:_docHeight,ThumbWidth:_thumbWidth,ThumbHeight:_thumbHeight,ActualWidth:0,ActualHeight:0,BigWidth:0,BigHeight:0,Left:0,Top:0,ZoomIndex:_defaultZoonIndex,Rotate:0,PageSizeType:_defaultPageSizeType,Annotations:new Array(),FirstLeft:0,FirstTop:0,FirstActualWidth:0,FirstActualHeight:0,isChange:true,Currentzoom:8,thumbShowWidth:0,thumbShowHeight:0,DocImageIsExist:false,ThumbImageIsExist:false,svgAjaxRequest:"",charRectsAjaxRequest:"",};Extend(this.options,A||{})},GetInitialSize:function(){this.OneToOne_Width=WidthArray[this.PageIndex]+addWidth;this.OneToOne_Height=HeightArray[this.PageIndex]+addHeight;this.FitWidth_Width=_docWidth;this.FitWidth_Height=this.FitWidth_Width/this.OneToOne_Width*this.OneToOne_Height;this.BestFit_Height=_docHeight;this.BestFit_Width=this.BestFit_Height/this.OneToOne_Height*this.OneToOne_Width;this.isChange=false;this.GetFirstViewerLeftTop()},GetFirstViewerLeftTop:function(){this.FirstLeft=0;this.FirstTop=0;this.ChangeDocWidthOrHeight();if(_pageSizeType==0){this.FirstActualWidth=this.FitWidth_Width-addWidth;this.FirstActualHeight=this.FirstActualWidth/(this.OneToOne_Width-addWidth)*(this.OneToOne_Height-addHeight)}else{if(_pageSizeType==1){this.FirstActualHeight=this.BestFit_Height-addWidth;this.FirstActualWidth=this.FirstActualHeight/(this.OneToOne_Height-addHeight)*(this.OneToOne_Width-addWidth)}else{if(_pageSizeType==2){this.FirstActualWidth=this.OneToOne_Width-addWidth;this.FirstActualHeight=this.OneToOne_Height-addHeight}}}this.FirstLeft=(_docWidth-this.FirstActualWidth)/2;this.FirstTop=(_docHeight-this.FirstActualHeight)/2},ChangeDocWidthOrHeight:function(){if(this.isChange){this.FitWidth_Width=_docWidth;this.FitWidth_Height=this.FitWidth_Width/this.OneToOne_Width*this.OneToOne_Height;this.BestFit_Height=_docHeight;this.BestFit_Width=this.BestFit_Height/this.OneToOne_Height*this.OneToOne_Width;this.isChange=false}},GetViewerLeftTop:function(){if(!this.Init){this.GetInitialSize();this.Init=true}this.ChangeDocWidthOrHeight();var A=_zoomRatio*_zoomIndex;this.Left=boxWidth*A;this.Top=boxWidth*A;if(_pageSizeType==0){this.ActualWidth=this.FitWidth_Width*A;this.ActualHeight=this.FitWidth_Height*A;if(this.Rotate==1||this.Rotate==3){this.ActualWidth=this.FitWidth_Height*A;this.ActualHeight=this.FitWidth_Width*A}this.ScaleX=this.OneToOne_Width/this.FitWidth_Width;this.ScaleY=this.OneToOne_Height/this.FitWidth_Height}else{if(_pageSizeType==1){this.ActualWidth=this.BestFit_Width*A;this.ActualHeight=this.BestFit_Height*A;if(this.Rotate==1||this.Rotate==3){this.ActualWidth=this.BestFit_Height*A;this.ActualHeight=this.BestFit_Width*A}this.ScaleX=this.OneToOne_Width/this.BestFit_Width;this.ScaleY=this.OneToOne_Height/this.BestFit_Height}else{if(_pageSizeType==2){this.ActualWidth=this.OneToOne_Width*A;this.ActualHeight=this.OneToOne_Height*A;if(this.Rotate==1||this.Rotate==3){this.ActualWidth=this.OneToOne_Height*A;this.ActualHeight=this.OneToOne_Width*A}this.ScaleX=1;this.ScaleY=1}}}if(this.Rotate==1||this.Rotate==3){this.BigWidth=this.ActualWidth-addHeight*A;this.BigHeight=this.ActualHeight-addWidth*A}else{this.BigWidth=this.ActualWidth-addWidth*A;this.BigHeight=this.ActualHeight-addHeight*A}if(this.BigWidth<_docWidth){this.Left+=(_docWidth-this.BigWidth)/2;if(parseInt(this.ActualWidth)!=_docWidth){this.BigWidth=_docWidth}}if(this.BigHeight<_docHeight){if(_viewerMode=="single"){this.Top+=(_docHeight-this.BigHeight)/2}if(parseInt(this.ActualHeight)!=_docHeight){this.BigHeight=_docHeight}}_pageHeight=this.ActualHeight;this.RefreshCurrentMaxPageHeight();this.RefreshViewerInfoToAnnotation()},RefreshCurrentMaxPageHeight:function(){if(HeightArray[this.PageIndex]!=_maxHeight){var A=HeightArray.indexOf(_maxHeight);_fileDocument[curFileId].Viewers[A].GetViewerLeftTop();_pageHeight=_fileDocument[curFileId].Viewers[A].ActualHeight}},RefreshViewerInfoToAnnotation:function(){for(var A=0;A<this.Annotations.length;A++){if(this.Annotations[A]==null||this.Annotations[A].Index==null){continue}this.Annotations[A].ViewerLeft=this.Left;this.Annotations[A].ViewerTop=this.Top;this.Annotations[A].ViewerWidth=this.ActualWidth;this.Annotations[A].ViewerHeight=this.ActualHeight;this.Annotations[A].ViewerScaleX=this.ScaleX;this.Annotations[A].ViewerScaleY=this.ScaleY;this.Annotations[A].ThumbViewerScaleX=this.ThumbScaleX;this.Annotations[A].ThumbViewerScaleY=this.ThumbScaleY;this.Annotations[A].ViewerOne2OneWidth=this.OneToOne_Width;this.Annotations[A].ViewerOne2OneHeight=this.OneToOne_Height;if(this.Annotations[A].Type=="TextRedacts"){var C=this.Annotations[A].RedactRects.curPageRectRedacts;for(var B=0;B<C.length;B++){C[B].ViewerLeft=this.Left;C[B].ViewerTop=this.Top;C[B].ViewerWidth=this.ActualWidth;C[B].ViewerHeight=this.ActualHeight;C[B].ViewerScaleX=this.ScaleX;C[B].ViewerScaleY=this.ScaleY;C[B].ThumbViewerScaleX=this.ThumbScaleX;C[B].ThumbViewerScaleY=this.ThumbScaleY;C[B].ViewerOne2OneWidth=this.OneToOne_Width;C[B].ViewerOne2OneHeight=this.OneToOne_Height}}}},GetSrc:function(){var A=getServerHandlerUrl();A+="?View=REImageViewer";A+="&fid="+_fid;A+="&type="+_imageFormat;A+="&IsThumb=false";A+="&PageIndex="+this.PageIndex;A+="&Width="+this.OneToOne_Width;A+="&Height="+this.OneToOne_Height;A+="&ZoomValue="+_zoomRatio*_actualZoom;A+="&fileName="+_fileName;A+="&password="+curDocPassWord;A+="&pageCount="+_totalPageCount;A+="&Rnd1="+this.random;return A},GetThumbSrc:function(){var A=getServerHandlerUrl();A+="?View=REImageViewer";A+="&Fid="+_fid;A+="&type="+_imageFormat;A+="&IsThumb=true";A+="&PageIndex="+this.PageIndex;A+="&ThumbWidth="+this.ThumbWidth;A+="&ThumbHeight="+this.ThumbHeight;A+="&Width="+this.OneToOne_Width;A+="&Height="+this.OneToOne_Height;A+="&ZoomValue=1";A+="&fileName="+_fileName;A+="&password="+curDocPassWord;A+="&pageCount="+_totalPageCount;A+="&Rnd1="+this.random;return A},ChangeRotate:function(A){if(A=="1"){this.Rotate++;this.Rotate=this.Rotate%4}else{if(A=="2"){this.Rotate=this.Rotate+2;this.Rotate=this.Rotate%4}else{if(A=="-1"){this.Rotate--;if(this.Rotate<0){this.Rotate=3}}}}},ChangeZoom:function(A){if(A=="1"){this.ZoomIndex++}else{if(A=="-1"){this.ZoomIndex--;if(this.ZoomIndex<1){this.ZoomIndex=1}}}},IsAnnos:function(){for(index in this.Annotations){if(this.Annotations[index]==null||this.Annotations[index].Index==null){continue}return true}return false},DeleteAnno:function(C){for(index in this.Annotations){if(this.Annotations[index]==null||this.Annotations[index].Index==null){continue}if(this.Annotations[index].Index==C){if(this.Annotations[index].Type=="TextRedacts"){var B=this.Annotations[index].RedactRects.relativePages;for(var A=1;A<B.length;A++){var D=_fileDocument[curFileId].Viewers[B[A]];if(D.Annotations[C]!=null){D.Annotations[C]=null}}}this.Annotations[index]=null;return true}}return false},};var Annotation=Class.create();Annotation.prototype={initialize:function(A){this.SetOptions(A);this.OnPageIndex=this.options.OnPageIndex;this.ShowPageIndex=this.options.ShowPageIndex;this.Type=this.options.Type;this.Index=this.options.Index;this.ShowLeft=this.options.ShowLeft;this.ShowTop=this.options.ShowTop;this.ShowWidth=this.options.ShowWidth;this.ShowHeight=this.options.ShowHeight;this.Left=this.options.Left;this.Top=this.options.Top;this.Width=this.options.Width;this.Height=this.options.Height;this.ThumbShowLeft=this.options.ThumbShowLeft;this.ThumbShowTop=this.options.ThumbShowTop;this.ThumbShowWidth=this.options.ThumbShowWidth;this.ThumbShowHeight=this.options.ThumbShowHeight;this.Rotate=this.options.Rotate;this.PageSizeType=this.options.PageSizeType;this.ZoomIndex=this.options.ZoomIndex;this.Text=this.options.Text;this.Points=this.options.Points;this.ShowPoints=this.options.ShowPoints;this.RedactRects=this.options.RedactRects;this.ThumbShowPoints=this.options.ThumbShowPoints;this.RelativePoints=this.options.RelativePoints;this.ThumbRelativePoints=this.options.ThumbRelativePoints;this.ViewerLeft=this.options.ViewerLeft;this.ViewerTop=this.options.ViewerTop;this.ViewerWidth=this.options.ViewerWidth;this.ViewerHeight=this.options.ViewerHeight;this.ViewerScaleX=this.options.ViewerScaleX;this.ViewerScaleY=this.options.ViewerScaleY;this.ThumbViewerScaleX=this.options.ThumbViewerScaleX;this.ThumbViewerScaleY=this.options.ThumbViewerScaleY;this.ViewerOne2OneWidth=this.options.ViewerOne2OneWidth;this.ViewerOne2OneHeight=this.options.ViewerOne2OneHeight;this.actualTop=this.options.actualTop;this.CreateTime=this.options.CreateTime;this.Modified=this.options.Modified;this.User=this.options.User;if(this.Type=="Text"){this.AddAnnoStyle(TextAnnoStyle)}else{if(this.Type=="Freehand"){this.AddAnnoStyle(FreehandAnnoStyle)}else{if(this.Type=="Highlight"){this.AddAnnoStyle(HighlightAnnoStyle)}else{if(this.Type=="Rectangle"){this.AddAnnoStyle(RectangleAnnoStyle)}else{if(this.Type=="FilledRectangle"){this.AddAnnoStyle(FilledRectangleAnnoStyle)}else{if(this.Type=="Ellipse"){this.AddAnnoStyle(EllipseAnnoStyle)}else{if(this.Type=="RubberStamp"){RubberStampAnnoStyle.TextColor=RubberStampAnnoStyle.FillColor;RubberStampAnnoStyle.OutLineColor=RubberStampAnnoStyle.FillColor;this.AddAnnoStyle(RubberStampAnnoStyle)}else{if(this.Type=="PolygonLines"){this.AddAnnoStyle(PolygonLinesAnnoStyle)}else{if(this.Type=="Polygon"){this.AddAnnoStyle(PolygonAnnoStyle)}else{if(this.Type=="Line"){this.AddAnnoStyle(LineAnnoStyle)}else{if(this.Type=="Arrow"){ArrowAnnoStyle.OutLineColor=ArrowAnnoStyle.FillColor;this.AddAnnoStyle(ArrowAnnoStyle)}else{if(this.Type=="fhSignature"){this.AddAnnoStyle(fhSignature)}else{if(this.Type=="txtSignature"){this.AddAnnoStyle(txtSignature)}else{if(this.Type=="dateSignature"){this.AddAnnoStyle(dateSignature)}else{if(this.Type=="FilledRectRedaction"){this.AddAnnoStyle(FilledRectRedact)}}}}}}}}}}}}}}}if(this.ShowLeft!=""){this.GetActualPosition();this.CalculateOnRotate()}},SetOptions:function(A){this.options={OnPageIndex:0,ShowPageIndex:0,Type:"",Index:0,ShowLeft:0,ShowTop:0,ShowWidth:0,ShowHeight:0,Left:0,Top:0,Width:0,Height:0,ThumbShowLeft:0,ThumbShowTop:0,ThumbShowWidth:0,ThumbShowHeight:0,Rotate:0,PageSizeType:_defaultPageSizeType,ZoomIndex:0,Text:"",ShowPoints:"",RedactRects:new PageTextRedacts(),Points:"",ThumbShowPoints:"",RelativePoints:"",ThumbRelativePoints:"",resizeScaleX:1,resizeScaleY:1,ViewerLeft:0,ViewerTop:0,ViewerWidth:0,ViewerHeight:0,ViewerScaleX:1,ViewerScaleY:1,ThumbViewerScaleX:1,ThumbViewerScaleY:1,ViewerOne2OneWidth:0,ViewerOne2OneHeight:0,actualTop:0,CreateTime:"",Modified:"",User:"",};Extend(this.options,A||{})},AddAnnoStyle:function(A){this.OutLineColor=A.OutLineColor;this.OutLineWidth=A.OutLineWidth;this.FillColor=A.FillColor;this.ShowedText=A.ShowedText;this.Text=this.ShowedText;this.TextColor=A.TextColor;this.TextFont=A.TextFont;this.TextSize=A.TextSize;this.TextStyle=A.TextStyle;this.TextPadding=A.TextPadding;this.Transparency=A.Transparency},GetActualPosition:function(){var K=this.ViewerScaleX;var L=this.ViewerScaleY;var J=_zoomRatio*_zoomIndex;var M=this.ThumbViewerScaleX;var N=this.ThumbViewerScaleY;var O=this.ViewerWidth;var F=this.ViewerHeight;if(O<_docWidth){O=_docWidth}if(F<_docHeight){F=_docHeight}if(_viewerMode=="single"){this.actualTop=this.ShowTop}else{this.ShowPageIndex=_fileDocument[curFileId].GetShowIndex(this.OnPageIndex);var P=PreCountHeight(this.ShowPageIndex);this.actualTop=this.ShowTop-P;this.ViewerTop=boxWidth*J}this.RelativePoints="";this.Points="";this.ThumbPoints="";this.ThumbRelativePoints="";var H=this.OnPageIndex;var E=_fileDocument[curFileId].Viewers[H];var G=parseFloat(this.OutLineWidth/2*_zoomRatio*_zoomIndex);if(this.Rotate==0){this.Left=(this.ShowLeft-this.ViewerLeft)*K/J;this.Top=(this.actualTop-this.ViewerTop)*L/J;this.Width=(this.ShowWidth)*K/J;this.Height=(this.ShowHeight)*L/J;this.ThumbShowLeft=this.Left*M;this.ThumbShowTop=this.Top*N;this.ThumbShowWidth=this.Width*M;this.ThumbShowHeight=this.Height*N;if(this.Type!="fhSignature"){var B=this.ShowPoints.split(";");for(var A=0;A<B.length;A++){var D=B[A].split(",");if(typeof(D)!="undefined"){x_point=D[0]-this.ShowLeft;y_point=D[1]-this.ShowTop;resizeX=(x_point)*K/J;resizeY=(y_point)*L/J;thumb_x_point=resizeX*M;thumb_y_point=resizeY*N;this.Points+=resizeX+","+resizeY+";";this.RelativePoints+=(x_point+G)+","+(y_point+G)+" ";this.ThumbPoints+=thumb_x_point+","+thumb_y_point+";";this.ThumbRelativePoints+=thumb_x_point+","+thumb_y_point+" "}}}else{var I=this.ShowPoints.split("|");for(var C=0;C<I.length;C++){var B=I[C].split(";");for(var A=0;A<B.length;A++){var D=B[A].split(",");if(typeof(D)!="undefined"){x_point=D[0]-this.ShowLeft;y_point=D[1]-this.ShowTop;resizeX=(x_point)*K/J;resizeY=(y_point)*L/J;thumb_x_point=resizeX*M;thumb_y_point=resizeY*N;this.RelativePoints+=(x_point+G)+","+(y_point+G)+" ";this.Points+=resizeX+","+resizeY+";";this.ThumbPoints+=thumb_x_point+","+thumb_y_point+";";this.ThumbRelativePoints+=thumb_x_point+","+thumb_y_point+" "}}this.RelativePoints+=";";this.ThumbRelativePoints+=";";this.Points+="|"}}}else{if(this.Rotate==1){this.Left=(this.ShowTop-this.ViewerTop)*L/J;this.Top=($("#draw_canvas").outerWidth()-this.ShowLeft-this.ViewerLeft-this.ShowWidth)*K/J;this.Width=(this.ShowHeight)*L/J;this.Height=(this.ShowWidth)*K/J;this.ThumbShowLeft=E.thumbShowHeight-(this.Top+this.Height)*N;this.ThumbShowTop=this.Left*M;this.ThumbShowWidth=this.Height*N;this.ThumbShowHeight=this.Width*M;if(this.Type!="fhSignature"){var B=this.ShowPoints.split(";");for(var A=0;A<B.length;A++){var D=B[A].split(",");if(typeof(D)!="undefined"){x_point=D[0]-this.ShowLeft;y_point=D[1]-this.ShowTop;resizeX=(y_point)*L/J;resizeY=(this.ShowWidth-x_point)*K/J;thumb_x_point=this.ThumbWidth-resizeY*N;thumb_y_point=resizeX*M;this.RelativePoints+=(x_point+G)+","+(y_point+G)+" ";this.Points+=resizeX+","+resizeY+";";this.ThumbPoints+=thumb_x_point+","+thumb_y_point+";";this.ThumbRelativePoints+=thumb_x_point+","+thumb_y_point+" "}}}else{var I=this.ShowPoints.split("|");for(var C=0;C<I.length;C++){var B=I[C].split(";");for(var A=0;A<B.length;A++){var D=B[A].split(",");if(typeof(D)!="undefined"){x_point=D[0]-this.ShowLeft;y_point=D[1]-this.ShowTop;resizeX=(y_point)*L/J;resizeY=(this.ShowWidth-x_point)*K/J;thumb_x_point=this.ThumbWidth-resizeY*N;thumb_y_point=resizeX*M;this.RelativePoints+=(x_point+G)+","+(y_point+G)+" ";this.Points+=resizeX+","+resizeY+";";this.ThumbPoints+=thumb_x_point+","+thumb_y_point+";";this.ThumbRelativePoints+=thumb_x_point+","+thumb_y_point+" "}}this.RelativePoints+=";";this.ThumbRelativePoints+=";";this.Points+="|"}}}else{if(this.Rotate==2){this.Left=(this.ViewerLeft+this.ViewerWidth-(shadowWidth+2*boxWidth)*J-this.ShowLeft-this.ShowWidth)*K/J;this.Top=($("#draw_canvas").outerHeight()-this.ShowTop-this.ShowHeight-this.ViewerTop)*L/J;this.Width=this.ShowWidth*K/J;this.Height=this.ShowHeight*L/J;this.ThumbShowLeft=E.thumbShowWidth-(this.Left+this.Width)*M;this.ThumbShowTop=E.thumbShowHeight-(this.Top+this.Height)*N;this.ThumbShowWidth=this.Width*M;this.ThumbShowHeight=this.Height*N;if(this.Type!="fhSignature"){var B=this.ShowPoints.split(";");for(var A=0;A<B.length;A++){var D=B[A].split(",");if(typeof(D)!="undefined"){x_point=D[0]-this.ShowLeft;y_point=D[1]-this.ShowTop;resizeX=(this.ShowWidth-x_point)*K/J;resizeY=(this.ShowHeight-y_point)*L/J;thumb_x_point=this.ThumbWidth-resizeX*M;thumb_y_point=this.ThumbHeight-resizeY*N;this.RelativePoints+=(x_point+G)+","+(y_point+G)+" ";this.Points+=resizeX+","+resizeY+";";this.ThumbPoints+=thumb_x_point+","+thumb_y_point+";";this.ThumbRelativePoints+=thumb_x_point+","+thumb_y_point+" "}}}else{var I=this.ShowPoints.split("|");for(var C=0;C<I.length;C++){var B=I[C].split(";");for(var A=0;A<B.length;A++){var D=B[A].split(",");if(typeof(D)!="undefined"){x_point=D[0]-this.ShowLeft;y_point=D[1]-this.ShowTop;resizeX=(this.ShowWidth-x_point)*K/J;resizeY=(this.ShowHeight-y_point)*L/J;thumb_x_point=this.ThumbWidth-resizeX*M;thumb_y_point=this.ThumbHeight-resizeY*N;this.RelativePoints+=(x_point+G)+","+(y_point+G)+" ";this.Points+=resizeX+","+resizeY+";";this.ThumbPoints+=thumb_x_point+","+thumb_y_point+";";this.ThumbRelativePoints+=thumb_x_point+","+thumb_y_point+" "}}this.RelativePoints+=";";this.ThumbRelativePoints+=";";this.Points+="|"}}}else{if(this.Rotate==3){this.Left=($("#draw_canvas").outerHeight()-this.ShowTop-this.ViewerTop-this.ShowHeight)*L/J;this.Top=(this.ShowLeft-this.ViewerLeft)*K/J;this.Width=(this.ShowHeight)*L/J;this.Height=(this.ShowWidth)*K/J;this.ThumbShowLeft=this.Top*N;this.ThumbShowTop=E.thumbShowWidth-(this.Left+this.Width)*M;this.ThumbShowWidth=this.Height*N;this.ThumbShowHeight=this.Width*M;if(this.Type!="fhSignature"){var B=this.ShowPoints.split(";");for(var A=0;A<B.length;A++){var D=B[A].split(",");if(typeof(D)!="undefined"){x_point=D[0]-this.ShowLeft;y_point=D[1]-this.ShowTop;resizeX=(this.ShowHeight-y_point)*L/J;resizeY=(x_point)*K/J;thumb_x_point=resizeY*N;thumb_y_point=this.ThumbHeight-resizeX*M;this.RelativePoints+=(x_point+G)+","+(y_point+G)+" ";this.Points+=resizeX+","+resizeY+";";this.ThumbPoints+=thumb_x_point+","+thumb_y_point+";";this.ThumbRelativePoints+=thumb_x_point+","+thumb_y_point+" "}}}else{var I=this.ShowPoints.split("|");for(var C=0;C<I.length;C++){var B=I[C].split(";");for(var A=0;A<B.length;A++){var D=B[A].split(",");if(typeof(D)!="undefined"){x_point=D[0]-this.ShowLeft;y_point=D[1]-this.ShowTop;resizeX=(this.ShowHeight-y_point)*L/J;resizeY=(x_point)*K/J;thumb_x_point=resizeY*N;thumb_y_point=this.ThumbHeight-resizeX*M;this.RelativePoints+=(x_point+G)+","+(y_point+G)+" ";this.Points+=resizeX+","+resizeY+";";this.ThumbPoints+=thumb_x_point+","+thumb_y_point+";";this.ThumbRelativePoints+=thumb_x_point+","+thumb_y_point+" "}}this.RelativePoints+=";";this.ThumbRelativePoints+=";";this.Points+="|"}}}}}}this.RelativePoints=this.RelativePoints.substring(0,this.RelativePoints.length-1);this.Points=this.Points.substring(0,this.Points.length-1);this.ThumbPoints=this.ThumbPoints.substring(0,this.ThumbPoints.length-1);this.ThumbRelativePoints=this.ThumbRelativePoints.substring(0,this.ThumbRelativePoints.length-1);this.ThumbShowPoints=this.ThumbPoints},GetShowPosition:function(){var K=this.ViewerScaleX;var L=this.ViewerScaleY;var J=_zoomRatio*_zoomIndex;var M=this.ThumbViewerScaleX;var N=this.ThumbViewerScaleY;var O=this.ViewerWidth;var G=this.ViewerHeight;if(O<_docWidth){O=_docWidth}if(G<_docHeight){G=_docHeight}if(_viewerMode=="single"){this.actualTop=this.ViewerTop}else{this.ViewerTop=boxWidth*J;this.ShowPageIndex=_fileDocument[curFileId].GetShowIndex(this.OnPageIndex);var P=PreCountHeight(this.ShowPageIndex);this.actualTop=P+this.ViewerTop}this.RelativePoints="";this.ShowPoints="";this.ThumbPoints="";this.ThumbRelativePoints="";var I=this.OnPageIndex;var F=_fileDocument[curFileId].Viewers[I];var H=this.OutLineWidth/2*_zoomRatio*_zoomIndex;if(this.Rotate==0){this.ShowLeft=this.Left*J/K+this.ViewerLeft;this.ShowTop=this.Top*J/K+this.actualTop;this.ShowWidth=this.Width*J/K;this.ShowHeight=this.Height*J/K;this.ThumbShowLeft=this.Left*M;this.ThumbShowTop=this.Top*N;this.ThumbShowWidth=this.Width*M;this.ThumbShowHeight=this.Height*N;if(this.Type!="fhSignature"){var C=this.Points.split(";");for(var A=0;A<C.length;A++){var E=C[A].split(",");if(typeof(E)!="undefined"){x_point=E[0]*J/K;y_point=E[1]*J/L;showX=x_point+this.ShowLeft;showY=y_point+this.ShowTop;thumb_x_point=E[0]*M;thumb_y_point=E[1]*N;this.RelativePoints+=(x_point+H)+","+(y_point+H)+" ";this.ShowPoints+=showX+","+showY+";";this.ThumbPoints+=thumb_x_point+","+thumb_y_point+";";this.ThumbRelativePoints+=thumb_x_point+","+thumb_y_point+" "}}}else{var B=this.Points.split("|");for(var D=0;D<B.length;D++){var C=B[D].split(";");for(var A=0;A<C.length;A++){var E=C[A].split(",");if(typeof(E)!="undefined"){x_point=E[0]*J/K;y_point=E[1]*J/L;showX=x_point+this.ShowLeft;showY=y_point+this.ShowTop;thumb_x_point=E[0]*M;thumb_y_point=E[1]*N;this.RelativePoints+=(x_point+H)+","+(y_point+H)+" ";this.ShowPoints+=showX+","+showY+";";this.ThumbPoints+=thumb_x_point+","+thumb_y_point+";";this.ThumbRelativePoints+=thumb_x_point+","+thumb_y_point+" "}}this.RelativePoints=this.RelativePoints.substring(0,this.RelativePoints.length-1);this.ShowPoints=this.ShowPoints.substring(0,this.ShowPoints.length-1);this.ThumbPoints=this.ThumbPoints.substring(0,this.ThumbPoints.length-1);this.ThumbRelativePoints=this.ThumbRelativePoints.substring(0,this.ThumbRelativePoints.length-1);this.RelativePoints+="|";this.ShowPoints+="|";this.ThumbPoints+="|";this.ThumbRelativePoints+="|"}}}else{if(this.Rotate==1){this.ShowWidth=this.Height*J/K;this.ShowHeight=this.Width*J/L;this.ShowTop=this.Left*J/L+this.actualTop;this.ShowLeft=$("#draw_canvas").outerWidth()-this.ViewerLeft-this.ShowWidth-this.Top*J/K;this.ThumbShowLeft=F.thumbShowHeight-(this.Top+this.Height)*N;this.ThumbShowTop=this.Left*M;this.ThumbShowWidth=this.Height*N;this.ThumbShowHeight=this.Width*M;if(this.Type!="fhSignature"){var C=this.Points.split(";");for(var A=0;A<C.length;A++){var E=C[A].split(",");if(typeof(E)!="undefined"){x_point=this.ShowWidth-E[1]*J/K;y_point=E[0]*J/L;showX=x_point+this.ShowLeft;showY=y_point+this.ShowTop;thumb_x_point=this.ThumbWidth-E[1]*N;thumb_y_point=E[0]*M;this.RelativePoints+=(x_point+H)+","+(y_point+H)+" ";this.ShowPoints+=showX+","+showY+";";this.ThumbPoints+=thumb_x_point+","+thumb_y_point+";";this.ThumbRelativePoints+=thumb_x_point+","+thumb_y_point+" "}}}else{var B=this.Points.split("|");for(var D=0;D<B.length;D++){var C=B[D].split(";");for(var A=0;A<C.length;A++){var E=C[A].split(",");if(typeof(E)!="undefined"){x_point=this.ShowWidth-E[1]*J/K;y_point=E[0]*J/L;showX=x_point+this.ShowLeft;showY=y_point+this.ShowTop;thumb_x_point=this.ThumbWidth-E[1]*N;thumb_y_point=E[0]*M;this.RelativePoints+=(x_point+H)+","+(y_point+H)+" ";this.ShowPoints+=showX+","+showY+";";this.ThumbPoints+=thumb_x_point+","+thumb_y_point+";";this.ThumbRelativePoints+=thumb_x_point+","+thumb_y_point+" "}}this.RelativePoints=this.RelativePoints.substring(0,this.RelativePoints.length-1);this.ShowPoints=this.ShowPoints.substring(0,this.ShowPoints.length-1);this.ThumbPoints=this.ThumbPoints.substring(0,this.ThumbPoints.length-1);this.ThumbRelativePoints=this.ThumbRelativePoints.substring(0,this.ThumbRelativePoints.length-1);this.RelativePoints+="|";this.ShowPoints+="|";this.ThumbPoints+="|";this.ThumbRelativePoints+="|"}}}else{if(this.Rotate==2){this.ShowWidth=this.Width*J/K;this.ShowHeight=this.Height*J/L;this.ShowLeft=this.ViewerLeft+this.ViewerWidth-(shadowWidth+2*boxWidth)*J-this.ShowWidth-this.Left*J/K;this.ShowTop=$("#draw_canvas").outerHeight()-this.ShowHeight-this.actualTop-this.Top*J/L;this.ThumbShowLeft=F.thumbShowWidth-(this.Left+this.Width)*M;this.ThumbShowTop=F.thumbShowHeight-(this.Top+this.Height)*N;this.ThumbShowWidth=this.Width*M;this.ThumbShowHeight=this.Height*N;if(this.Type!="fhSignature"){var C=this.Points.split(";");for(var A=0;A<C.length;A++){var E=C[A].split(",");if(typeof(E)!="undefined"){x_point=this.ShowWidth-E[0]*J/K;y_point=this.ShowHeight-E[1]*J/L;showX=x_point+this.ShowLeft;showY=y_point+this.ShowTop;thumb_x_point=this.ThumbWidth-E[0]*M;thumb_y_point=this.ThumbHeight-E[1]*N;this.RelativePoints+=(x_point+H)+","+(y_point+H)+" ";this.ShowPoints+=showX+","+showY+";";this.ThumbPoints+=thumb_x_point+","+thumb_y_point+";";this.ThumbRelativePoints+=thumb_x_point+","+thumb_y_point+" "}}}else{var B=this.Points.split("|");for(var D=0;D<B.length;D++){var C=B[D].split(";");for(var A=0;A<C.length;A++){var E=C[A].split(",");if(typeof(E)!="undefined"){x_point=this.ShowWidth-E[0]*J/K;y_point=this.ShowHeight-E[1]*J/L;showX=x_point+this.ShowLeft;showY=y_point+this.ShowTop;thumb_x_point=this.ThumbWidth-E[0]*M;thumb_y_point=this.ThumbHeight-E[1]*N;this.RelativePoints+=(x_point+H)+","+(y_point+H)+" ";this.ShowPoints+=showX+","+showY+";";this.ThumbPoints+=thumb_x_point+","+thumb_y_point+";";this.ThumbRelativePoints+=thumb_x_point+","+thumb_y_point+" "}}this.RelativePoints=this.RelativePoints.substring(0,this.RelativePoints.length-1);this.ShowPoints=this.ShowPoints.substring(0,this.ShowPoints.length-1);this.ThumbPoints=this.ThumbPoints.substring(0,this.ThumbPoints.length-1);this.ThumbRelativePoints=this.ThumbRelativePoints.substring(0,this.ThumbRelativePoints.length-1);this.RelativePoints+="|";this.ShowPoints+="|";this.ThumbPoints+="|";this.ThumbRelativePoints+="|"}}}else{if(this.Rotate==3){this.ShowWidth=this.Height*J/K;this.ShowHeight=this.Width*J/L;this.ShowLeft=this.Top*J/K+this.ViewerLeft;this.ShowTop=$("#draw_canvas").outerHeight()-this.actualTop-this.ShowHeight-this.Left*J/L;this.ThumbShowLeft=this.Top*N;this.ThumbShowTop=F.thumbShowWidth-(this.Left+this.Width)*M;this.ThumbShowWidth=this.Height*N;this.ThumbShowHeight=this.Width*M;if(this.Type!="fhSignature"){var C=this.Points.split(";");for(var A=0;A<C.length;A++){var E=C[A].split(",");if(typeof(E)!="undefined"){x_point=E[1]*J/K;y_point=this.ShowHeight-E[0]*J/L;showX=x_point+this.ShowLeft;showY=y_point+this.ShowTop;thumb_x_point=E[1]*N;thumb_y_point=this.ThumbHeight-E[0]*M;this.RelativePoints+=(x_point+H)+","+(y_point+H)+" ";this.ShowPoints+=showX+","+showY+";";this.ThumbPoints+=thumb_x_point+","+thumb_y_point+";";this.ThumbRelativePoints+=thumb_x_point+","+thumb_y_point+" "}}}else{var B=this.Points.split("|");for(var D=0;D<B.length;D++){var C=B[D].split(";");for(var A=0;A<C.length;A++){var E=C[A].split(",");if(typeof(E)!="undefined"){x_point=E[1]*J/K;y_point=this.ShowHeight-E[0]*J/L;showX=x_point+this.ShowLeft;showY=y_point+this.ShowTop;thumb_x_point=E[1]*N;thumb_y_point=this.ThumbHeight-E[0]*M;this.RelativePoints+=(x_point+H)+","+(y_point+H)+" ";this.ShowPoints+=showX+","+showY+";";this.ThumbPoints+=thumb_x_point+","+thumb_y_point+";";this.ThumbRelativePoints+=thumb_x_point+","+thumb_y_point+" "}}this.RelativePoints=this.RelativePoints.substring(0,this.RelativePoints.length-1);this.ShowPoints=this.ShowPoints.substring(0,this.ShowPoints.length-1);this.ThumbPoints=this.ThumbPoints.substring(0,this.ThumbPoints.length-1);this.ThumbRelativePoints=this.ThumbRelativePoints.substring(0,this.ThumbRelativePoints.length-1);this.RelativePoints+="|";this.ShowPoints+="|";this.ThumbPoints+="|";this.ThumbRelativePoints+="|"}}}}}}this.ShowPoints=this.ShowPoints.substring(0,this.ShowPoints.length-1);this.RelativePoints=this.RelativePoints.substring(0,this.RelativePoints.length-1);this.ThumbPoints=this.ThumbPoints.substring(0,this.ThumbPoints.length-1);this.ThumbRelativePoints=this.ThumbRelativePoints.substring(0,this.ThumbRelativePoints.length-1);this.ThumbShowPoints=this.ThumbPoints},ReSetRotate:function(A){this.Rotate=A;if(this.Rotate==0){this.ShowLeft=this.ShowLeft_0;this.ShowTop=this.ShowTop_0;this.ShowWidth=this.ShowWidth_0;this.ShowHeight=this.ShowHeight_0;this.RelativePoints=this.RelativePoints_0;this.ShowPoints=this.ShowPoints_0;this.ThumbShowLeft=this.ThumbShowLeft_0;this.ThumbShowTop=this.ThumbShowTop_0;this.ThumbShowWidth=this.ThumbShowWidth_0;this.ThumbShowHeight=this.ThumbShowHeight_0;this.ThumbShowPoints=this.ThumbShowPoints_0;this.ThumbRelativePoints=this.ThumbRelativePoints_0}else{if(this.Rotate==1){this.ShowLeft=this.ShowLeft_90;this.ShowTop=this.ShowTop_90;this.ShowWidth=this.ShowWidth_90;this.ShowHeight=this.ShowHeight_90;this.RelativePoints=this.RelativePoints_90;this.ShowPoints=this.ShowPoints_90;this.ThumbShowLeft=this.ThumbShowLeft_90;this.ThumbShowTop=this.ThumbShowTop_90;this.ThumbShowWidth=this.ThumbShowWidth_90;this.ThumbShowHeight=this.ThumbShowHeight_90;this.ThumbShowPoints=this.ThumbShowPoints_90;this.ThumbRelativePoints=this.ThumbRelativePoints_90}else{if(this.Rotate==2){this.ShowLeft=this.ShowLeft_180;this.ShowTop=this.ShowTop_180;this.ShowWidth=this.ShowWidth_180;this.ShowHeight=this.ShowHeight_180;this.RelativePoints=this.RelativePoints_180;this.ShowPoints=this.ShowPoints_180;this.ThumbShowLeft=this.ThumbShowLeft_180;this.ThumbShowTop=this.ThumbShowTop_180;this.ThumbShowWidth=this.ThumbShowWidth_180;this.ThumbShowHeight=this.ThumbShowHeight_180;this.ThumbShowPoints=this.ThumbShowPoints_180;this.ThumbRelativePoints=this.ThumbRelativePoints_180}else{if(this.Rotate==3){this.ShowLeft=this.ShowLeft_270;this.ShowTop=this.ShowTop_270;this.ShowWidth=this.ShowWidth_270;this.ShowHeight=this.ShowHeight_270;this.RelativePoints=this.RelativePoints_270;this.ShowPoints=this.ShowPoints_270;this.ThumbShowLeft=this.ThumbShowLeft_270;this.ThumbShowTop=this.ThumbShowTop_270;this.ThumbShowWidth=this.ThumbShowWidth_270;this.ThumbShowHeight=this.ThumbShowHeight_270;this.ThumbShowPoints=this.ThumbShowPoints_270;this.ThumbRelativePoints=this.ThumbRelativePoints_270}}}}},ReSetSize:function(B,D,F,A){var E=this.ShowWidth;var C=this.ShowHeight;this.resizeScaleX=(F)/E;this.resizeScaleY=(A)/C;this.previousLeft=this.ShowLeft;this.previousTop=this.ShowTop;this.ShowLeft=B;this.ShowTop=D;this.ShowWidth=F;this.ShowHeight=A;if(this.Type=="Freehand"||this.Type=="PolygonLines"||this.Type=="Polygon"||this.Type=="Line"||this.Type=="Arrow"||this.Type=="fhSignature"){this.ReSetPoints()}this.GetActualPosition();this.CalculateOnRotate()},ReSetPoints:function(){if(this.Type!="fhSignature"){var D=this.ShowPoints.split(";");var B="";for(var A=0;A<D.length;A++){var F=D[A].split(",");if(typeof(F)!="undefined"){resizeX=(F[0]-this.previousLeft)*this.resizeScaleX+this.ShowLeft;resizeY=(F[1]-this.previousTop)*this.resizeScaleY+this.ShowTop;B+=resizeX+","+resizeY+";"}}B=B.substring(0,B.length-1);this.ShowPoints=B}else{var C=this.ShowPoints.split("|");var E="";for(var A=0;A<C.length;A++){var D=C[A].split(";");var B="";for(var G=0;G<D.length;G++){var F=D[G].split(",");if(typeof(F)!="undefined"){resizeX=(F[0]-this.previousLeft)*this.resizeScaleX+this.ShowLeft;resizeY=(F[1]-this.previousTop)*this.resizeScaleY+this.ShowTop;B+=resizeX+","+resizeY+";"}}B=B.substring(0,B.length-1);E+=B+"|"}E=E.substring(0,E.length-1);this.ShowPoints=E}},ReSetByZoom:function(){var E=this.ViewerScaleX;var C=this.ViewerScaleY;var D=_zoomRatio*_zoomIndex;var F=this.ShowWidth;var B=this.ShowHeight;this.previousLeft=this.ShowLeft;this.previousTop=this.ShowTop;if(this.Rotate==0){this.ShowLeft=(this.Left)/E*D+this.ViewerLeft;if(_viewerMode=="single"){this.ShowTop=(this.Top)/C*D+this.ViewerTop;this.actualTop=this.ShowTop}else{this.ViewerTop=boxWidth*D;this.ShowPageIndex=_fileDocument[curFileId].GetShowIndex(this.OnPageIndex);var A=PreCountHeight(this.ShowPageIndex);this.ShowTop=(this.Top)/C*D+A+this.ViewerTop;this.actualTop=(this.Top)/C*D+this.ViewerTop}this.ShowWidth=(this.Width)/E*D;this.ShowHeight=(this.Height)/C*D}else{if(this.Rotate==1){this.ShowLeft=(this.ViewerOne2OneHeight-addHeight-this.Height-this.Top)/C*D+this.ViewerLeft+marHeight*D;this.ShowTop=(this.Left)/E*D+this.ViewerTop;this.ShowWidth=this.Height/C*D;this.ShowHeight=(this.Width)/E*D}else{if(this.Rotate==2){this.ShowLeft=(this.ViewerOne2OneWidth-addWidth-this.Width-this.Left)/E*D+this.ViewerLeft;this.ShowTop=(this.ViewerOne2OneHeight-addHeight-this.Height-this.Top)/C*D+this.ViewerTop+marHeight*D;this.ShowWidth=(this.Width)/E*D;this.ShowHeight=this.Height/C*D}else{if(this.Rotate==3){this.ShowLeft=(this.Top)/C*D+this.ViewerLeft;this.ShowTop=(this.ViewerOne2OneWidth-addWidth-this.Width-this.Left)/E*D+this.ViewerTop+shadowWidth*D;this.ShowWidth=this.Height/C*D;this.ShowHeight=(this.Width)/E*D}}}}this.resizeScaleX=this.ShowWidth/F;this.resizeScaleY=this.ShowHeight/B;this.ReSetPoints();this.GetActualPosition();this.CalculateOnRotate()},CalculateOnRotate:function(){var F=this.OnPageIndex;var D=_fileDocument[curFileId].Viewers[F];var G=_zoomRatio*_zoomIndex;allWidth=$("#draw_canvas").outerWidth();allHeight=$("#draw_canvas").outerHeight();rotateLeft=0;rotateTop=0;if(this.ViewerHeight<_docWidth){rotateLeft=(_docWidth-this.ViewerHeight)/2}if(this.ViewerWidth<_docHeight){rotateTop=(_docHeight-this.ViewerWidth)/2}var C=this.OutLineWidth/2*G;if(this.Rotate==0){this.ShowLeft_0=this.ShowLeft;this.ShowTop_0=this.ShowTop;this.ShowWidth_0=this.ShowWidth;this.ShowHeight_0=this.ShowHeight;this.ShowLeft_90=allHeight+rotateLeft-(this.ViewerTop+this.ShowTop_0+this.ShowHeight_0);this.ShowTop_90=rotateTop+this.ShowLeft_0-this.ViewerLeft;this.ShowWidth_90=this.ShowHeight_0;this.ShowHeight_90=this.ShowWidth_0;this.ShowLeft_180=allWidth-(this.ShowLeft_0+this.ShowWidth_0);this.ShowTop_180=allHeight-(this.ShowTop_0+this.ShowHeight_0);this.ShowWidth_180=this.ShowWidth_0;this.ShowHeight_180=this.ShowHeight_0;this.ShowLeft_270=rotateLeft+this.ShowTop_0-this.ViewerTop;this.ShowTop_270=rotateTop+allWidth-(this.ViewerLeft+this.ShowLeft_0+this.ShowWidth_0);this.ShowWidth_270=this.ShowHeight_0;this.ShowHeight_270=this.ShowWidth_0;this.ShowPoints_0=this.ShowPoints;this.ShowPoints_90="";this.ShowPoints_180="";this.ShowPoints_270="";this.RelativePoints_0=this.RelativePoints;this.RelativePoints_90="";this.RelativePoints_180="";this.RelativePoints_270="";if(this.Type!="fhSignature"){var A=this.ShowPoints.split(";");for(var I=0;I<A.length;I++){var B=A[I].split(",");if(typeof(B)!="undefined"){this.ShowPoints_90+=(this.ShowHeight-(B[1]-this.ShowTop)+this.ShowLeft_90)+","+(B[0]-this.ShowLeft+this.ShowTop_90)+";";this.RelativePoints_90+=(this.ShowHeight-(B[1]-this.ShowTop)+C)+","+(B[0]-this.ShowLeft+C)+" ";this.ShowPoints_180+=(this.ShowWidth-(B[0]-this.ShowLeft)+this.ShowLeft_180)+","+(this.ShowHeight-(B[1]-this.ShowTop)+this.ShowTop_180)+";";this.RelativePoints_180+=(this.ShowWidth-(B[0]-this.ShowLeft)+C)+","+(this.ShowHeight-(B[1]-this.ShowTop)+C)+" ";this.ShowPoints_270+=(B[1]-this.ShowTop+this.ShowLeft_270)+","+(this.ShowWidth-(B[0]-this.ShowLeft)+this.ShowTop_270)+";";this.RelativePoints_270+=(B[1]-this.ShowTop+C)+","+(this.ShowWidth-(B[0]-this.ShowLeft)+C)+" "}}}else{var H=this.ShowPoints.split("|");for(var E=0;E<H.length;E++){var A=H[E].split(";");for(var I=0;I<A.length;I++){var B=A[I].split(",");if(typeof(B)!="undefined"){this.ShowPoints_90+=(this.ShowHeight-(B[1]-this.ShowTop)+this.ShowLeft_90)+","+(B[0]-this.ShowLeft+this.ShowTop_90)+";";this.RelativePoints_90+=(this.ShowHeight-(B[1]-this.ShowTop)+C)+","+(B[0]-this.ShowLeft+C)+" ";this.ShowPoints_180+=(this.ShowWidth-(B[0]-this.ShowLeft)+this.ShowLeft_180)+","+(this.ShowHeight-(B[1]-this.ShowTop)+this.ShowTop_180)+";";this.RelativePoints_180+=(this.ShowWidth-(B[0]-this.ShowLeft)+C)+","+(this.ShowHeight-(B[1]-this.ShowTop)+C)+" ";this.ShowPoints_270+=(B[1]-this.ShowTop+this.ShowLeft_270)+","+(this.ShowWidth-(B[0]-this.ShowLeft)+this.ShowTop_270)+";";this.RelativePoints_270+=(B[1]-this.ShowTop+C)+","+(this.ShowWidth-(B[0]-this.ShowLeft)+C)+" "}}this.ShowPoints_90=this.ShowPoints_90.substring(0,this.ShowPoints_90.length-1);this.ShowPoints_180=this.ShowPoints_180.substring(0,this.ShowPoints_180.length-1);this.ShowPoints_270=this.ShowPoints_270.substring(0,this.ShowPoints_270.length-1);this.ShowPoints_90+="|";this.ShowPoints_180+="|";this.ShowPoints_270+="|";this.RelativePoints_90=this.RelativePoints_90.substring(0,this.RelativePoints_90.length-1);this.RelativePoints_180=this.RelativePoints_180.substring(0,this.RelativePoints_180.length-1);this.RelativePoints_270=this.RelativePoints_270.substring(0,this.RelativePoints_270.length-1);this.RelativePoints_90+=";";this.RelativePoints_180+=";";this.RelativePoints_270+=";"}}this.ShowPoints_90=this.ShowPoints_90.substring(0,this.ShowPoints_90.length-1);this.ShowPoints_180=this.ShowPoints_180.substring(0,this.ShowPoints_180.length-1);this.ShowPoints_270=this.ShowPoints_270.substring(0,this.ShowPoints_270.length-1);this.RelativePoints_90=this.RelativePoints_90.substring(0,this.RelativePoints_90.length-1);this.RelativePoints_180=this.RelativePoints_180.substring(0,this.RelativePoints_180.length-1);this.RelativePoints_270=this.RelativePoints_270.substring(0,this.RelativePoints_270.length-1)}else{if(this.Rotate==1){this.ShowLeft_90=this.ShowLeft;this.ShowTop_90=this.ShowTop;this.ShowWidth_90=this.ShowWidth;this.ShowHeight_90=this.ShowHeight;this.ShowLeft_0=rotateLeft+this.ShowTop_90-this.ViewerTop;this.ShowTop_0=rotateTop+allWidth-(this.ViewerLeft+this.ShowLeft_90+this.ShowWidth_90);this.ShowWidth_0=this.ShowHeight_90;this.ShowHeight_0=this.ShowWidth_90;this.ShowLeft_180=rotateLeft+allHeight-this.ShowTop-this.ShowHeight-this.ViewerTop;this.ShowTop_180=rotateTop+this.ShowLeft-this.ViewerLeft;this.ShowWidth_180=this.ShowWidth_0;this.ShowHeight_180=this.ShowHeight_0;this.ShowLeft_270=allWidth-this.ShowLeft-this.ShowWidth;this.ShowTop_270=allHeight-this.ShowTop-this.ShowHeight;this.ShowWidth_270=this.ShowHeight_0;this.ShowHeight_270=this.ShowWidth_0;this.ShowPoints_0="";this.ShowPoints_90=this.ShowPoints;this.ShowPoints_180="";this.ShowPoints_270="";this.RelativePoints_0="";this.RelativePoints_90=this.RelativePoints;this.RelativePoints_180="";this.RelativePoints_270="";if(this.Type!="fhSignature"){var A=this.ShowPoints.split(";");for(var I=0;I<A.length;I++){var B=A[I].split(",");if(typeof(B)!="undefined"){this.ShowPoints_0+=(B[1]-this.ShowTop+this.ShowLeft_0)+","+(this.ShowWidth-(B[0]-this.ShowLeft)+this.ShowTop_0)+";";this.RelativePoints_0+=(B[1]-this.ShowTop+C)+","+(this.ShowWidth-(B[0]-this.ShowLeft)+C)+" ";this.ShowPoints_180+=(this.ShowHeight-(B[1]-this.ShowTop)+this.ShowLeft_180)+","+(B[0]-this.ShowLeft+this.ShowTop_180)+";";this.RelativePoints_180+=(this.ShowHeight-(B[1]-this.ShowTop)+C)+","+(B[0]-this.ShowLeft+C)+" ";this.ShowPoints_270+=(this.ShowWidth-(B[0]-this.ShowLeft)+this.ShowLeft_270)+","+(this.ShowHeight-(B[1]-this.ShowTop)+this.ShowTop_270)+";";this.RelativePoints_270+=(this.ShowWidth-(B[0]-this.ShowLeft)+C)+","+(this.ShowHeight-(B[1]-this.ShowTop)+C)+" "}}}else{var H=this.ShowPoints.split("|");for(var E=0;E<H.length;E++){var A=H[E].split(";");for(var I=0;I<A.length;I++){var B=A[I].split(",");if(typeof(B)!="undefined"){this.ShowPoints_0+=(B[1]-this.ShowTop+this.ShowLeft_0)+","+(this.ShowWidth-(B[0]-this.ShowLeft)+this.ShowTop_0)+";";this.RelativePoints_0+=(B[1]-this.ShowTop+C)+","+(this.ShowWidth-(B[0]-this.ShowLeft)+C)+" ";this.ShowPoints_180+=(this.ShowHeight-(B[1]-this.ShowTop)+this.ShowLeft_180)+","+(B[0]-this.ShowLeft+this.ShowTop_180)+";";this.RelativePoints_180+=(this.ShowHeight-(B[1]-this.ShowTop)+C)+","+(B[0]-this.ShowLeft+C)+" ";this.ShowPoints_270+=(this.ShowWidth-(B[0]-this.ShowLeft)+this.ShowLeft_270)+","+(this.ShowHeight-(B[1]-this.ShowTop)+this.ShowTop_270)+";";this.RelativePoints_270+=(this.ShowWidth-(B[0]-this.ShowLeft)+C)+","+(this.ShowHeight-(B[1]-this.ShowTop)+C)+" "}}this.ShowPoints_0=this.ShowPoints_0.substring(0,this.ShowPoints_90.length-1);this.ShowPoints_180=this.ShowPoints_180.substring(0,this.ShowPoints_180.length-1);this.ShowPoints_270=this.ShowPoints_270.substring(0,this.ShowPoints_270.length-1);this.ShowPoints_0+="|";this.ShowPoints_180+="|";this.ShowPoints_270+="|";this.RelativePoints_0=this.RelativePoints_0.substring(0,this.RelativePoints_90.length-1);this.RelativePoints_180=this.RelativePoints_180.substring(0,this.RelativePoints_180.length-1);this.RelativePoints_270=this.RelativePoints_270.substring(0,this.RelativePoints_270.length-1);this.RelativePoints_0+=";";this.RelativePoints_180+=";";this.RelativePoints_270+=";"}}this.ShowPoints_0=this.ShowPoints_0.substring(0,this.ShowPoints_90.length-1);this.ShowPoints_180=this.ShowPoints_180.substring(0,this.ShowPoints_180.length-1);this.ShowPoints_270=this.ShowPoints_270.substring(0,this.ShowPoints_270.length-1);this.RelativePoints_0=this.RelativePoints_0.substring(0,this.RelativePoints_90.length-1);this.RelativePoints_180=this.RelativePoints_180.substring(0,this.RelativePoints_180.length-1);this.RelativePoints_270=this.RelativePoints_270.substring(0,this.RelativePoints_270.length-1)}else{if(this.Rotate==2){this.ShowLeft_180=this.ShowLeft;this.ShowTop_180=this.ShowTop;this.ShowWidth_180=this.ShowWidth;this.ShowHeight_180=this.ShowHeight;this.ShowLeft_0=allWidth-this.ShowLeft_180-this.ShowWidth_180;this.ShowTop_0=allHeight-this.ShowTop_180-this.ShowHeight_180;this.ShowWidth_0=this.ShowWidth_180;this.ShowHeight_0=this.ShowHeight_180;this.ShowLeft_90=allHeight+rotateLeft-(this.ViewerTop+this.ShowTop_0+this.ShowHeight_0);this.ShowTop_90=rotateTop+this.ShowLeft_0-this.ViewerLeft;this.ShowWidth_90=this.ShowHeight_0;this.ShowHeight_90=this.ShowWidth_0;this.ShowLeft_270=rotateLeft+this.ShowTop_0-this.ViewerTop;this.ShowTop_270=rotateTop+allWidth-(this.ViewerLeft+this.ShowLeft_0+this.ShowWidth_0);this.ShowWidth_270=this.ShowHeight_0;this.ShowHeight_270=this.ShowWidth_0;this.ShowPoints_0="";this.ShowPoints_90="";this.ShowPoints_180=this.ShowPoints;this.ShowPoints_270="";this.RelativePoints_0="";this.RelativePoints_90="";this.RelativePoints_180=this.RelativePoints;this.RelativePoints_270="";if(this.Type!="fhSignature"){var A=this.ShowPoints.split(";");for(var I=0;I<A.length;I++){var B=A[I].split(",");if(typeof(B)!="undefined"){this.ShowPoints_0+=(this.ShowWidth-(B[0]-this.ShowLeft)+this.ShowLeft_0)+","+(this.ShowHeight-(B[1]-this.ShowTop)+this.ShowTop_0)+";";this.RelativePoints_0+=(this.ShowWidth-(B[0]-this.ShowLeft)+C)+","+(this.ShowHeight-(B[1]-this.ShowTop)+C)+" ";this.ShowPoints_90+=(B[1]-this.ShowTop+this.ShowLeft_90)+","+(this.ShowWidth-(B[0]-this.ShowLeft)+this.ShowTop_90)+";";this.RelativePoints_90+=(B[1]-this.ShowTop+C)+","+(this.ShowWidth-(B[0]-this.ShowLeft)+C)+" ";this.ShowPoints_270+=(this.ShowHeight-(B[1]-this.ShowTop)+this.ShowLeft_270)+","+(B[0]-this.ShowLeft+this.ShowTop_270)+";";this.RelativePoints_270+=(this.ShowHeight-(B[1]-this.ShowTop)+C)+","+(B[0]-this.ShowLeft+C)+" "}}}else{var H=this.ShowPoints.split("|");for(var E=0;E<H.length;E++){var A=H[E].split(";");for(var I=0;I<A.length;I++){var B=A[I].split(",");if(typeof(B)!="undefined"){this.ShowPoints_0+=(this.ShowWidth-(B[0]-this.ShowLeft)+this.ShowLeft_0)+","+(this.ShowHeight-(B[1]-this.ShowTop)+this.ShowTop_0)+";";this.RelativePoints_0+=(this.ShowWidth-(B[0]-this.ShowLeft)+C)+","+(this.ShowHeight-(B[1]-this.ShowTop)+C)+" ";this.ShowPoints_90+=(B[1]-this.ShowTop+this.ShowLeft_90)+","+(this.ShowWidth-(B[0]-this.ShowLeft)+this.ShowTop_90)+";";this.RelativePoints_90+=(B[1]-this.ShowTop+C)+","+(this.ShowWidth-(B[0]-this.ShowLeft)+C)+" ";this.ShowPoints_270+=(this.ShowHeight-(B[1]-this.ShowTop)+this.ShowLeft_270)+","+(B[0]-this.ShowLeft+this.ShowTop_270)+";";this.RelativePoints_270+=(this.ShowHeight-(B[1]-this.ShowTop)+C)+","+(B[0]-this.ShowLeft+C)+" "}}this.ShowPoints_0=this.ShowPoints_0.substring(0,this.ShowPoints_90.length-1);this.ShowPoints_90=this.ShowPoints_90.substring(0,this.ShowPoints_180.length-1);this.ShowPoints_270=this.ShowPoints_270.substring(0,this.ShowPoints_270.length-1);this.ShowPoints_0+="|";this.ShowPoints_90+="|";this.ShowPoints_270+="|";this.RelativePoints_0=this.RelativePoints_0.substring(0,this.RelativePoints_90.length-1);this.RelativePoints_90=this.RelativePoints_90.substring(0,this.RelativePoints_180.length-1);this.RelativePoints_270=this.RelativePoints_270.substring(0,this.RelativePoints_270.length-1);this.RelativePoints_0+=";";this.RelativePoints_90+=";";this.RelativePoints_270+=";"}}this.ShowPoints_0=this.ShowPoints_0.substring(0,this.ShowPoints_0.length-1);this.RelativePoints_0=this.RelativePoints_0.substring(0,this.RelativePoints_0.length-1);this.ShowPoints_90=this.ShowPoints_90.substring(0,this.ShowPoints_90.length-1);this.RelativePoints_90=this.RelativePoints_90.substring(0,this.RelativePoints_90.length-1);this.ShowPoints_270=this.ShowPoints_270.substring(0,this.ShowPoints_270.length-1);this.RelativePoints_270=this.RelativePoints_270.substring(0,this.RelativePoints_270.length-1)}else{if(this.Rotate==3){this.ShowLeft_270=this.ShowLeft;this.ShowTop_270=this.ShowTop;this.ShowWidth_270=this.ShowWidth;this.ShowHeight_270=this.ShowHeight;this.ShowLeft_0=rotateLeft+allHeight-(this.ShowTop_270+this.ShowHeight_270+this.ViewerTop);this.ShowTop_0=rotateTop+this.ShowLeft_270-this.ViewerLeft;this.ShowWidth_0=this.ShowHeight_270;this.ShowHeight_0=this.ShowWidth_270;this.ShowLeft_90=allWidth-this.ShowLeft-this.ShowWidth;this.ShowTop_90=allHeight-this.ShowTop-this.ShowHeight;this.ShowWidth_90=this.ShowHeight_0;this.ShowHeight_90=this.ShowWidth_0;this.ShowLeft_180=rotateLeft+this.ShowTop-this.ViewerTop;this.ShowTop_180=rotateTop+allWidth-this.ShowLeft-this.ShowWidth-this.ViewerLeft;this.ShowWidth_180=this.ShowWidth_0;this.ShowHeight_180=this.ShowHeight_0;this.ShowPoints_0="";this.ShowPoints_90="";this.ShowPoints_180="";this.ShowPoints_270=this.ShowPoints;this.RelativePoints_0="";this.RelativePoints_90="";this.RelativePoints_180="";this.RelativePoints_270=this.RelativePoints;if(this.Type!="fhSignature"){var A=this.ShowPoints.split(";");for(var I=0;I<A.length;I++){var B=A[I].split(",");if(typeof(B)!="undefined"){this.ShowPoints_0+=(this.ShowHeight-(B[1]-this.ShowTop)+this.ShowLeft_0)+","+(B[0]-this.ShowLeft+this.ShowTop_0)+";";this.RelativePoints_0+=(this.ShowHeight-(B[1]-this.ShowTop)+C)+","+(B[0]-this.ShowLeft+C)+" ";this.ShowPoints_90+=(this.ShowWidth-(B[0]-this.ShowLeft)+this.ShowLeft_90)+","+(this.ShowHeight-(B[1]-this.ShowTop)+this.ShowTop_90)+";";this.RelativePoints_90+=(this.ShowWidth-(B[0]-this.ShowLeft)+C)+","+(this.ShowHeight-(B[1]-this.ShowTop)+C)+" ";this.ShowPoints_180+=(B[1]-this.ShowTop+this.ShowLeft_180)+","+(this.ShowWidth-(B[0]-this.ShowLeft)+this.ShowTop_180)+";";this.RelativePoints_180+=(B[1]-this.ShowTop+C)+","+(this.ShowWidth-(B[0]-this.ShowLeft)+C)+" "}}}else{var H=this.ShowPoints.split("|");for(var E=0;E<H.length;E++){var A=H[E].split(";");for(var I=0;I<A.length;I++){var B=A[I].split(",");if(typeof(B)!="undefined"){this.ShowPoints_0+=(this.ShowHeight-(B[1]-this.ShowTop)+this.ShowLeft_0)+","+(B[0]-this.ShowLeft+this.ShowTop_0)+";";this.RelativePoints_0+=(this.ShowHeight-(B[1]-this.ShowTop)+C)+","+(B[0]-this.ShowLeft+C)+" ";this.ShowPoints_90+=(this.ShowWidth-(B[0]-this.ShowLeft)+this.ShowLeft_90)+","+(this.ShowHeight-(B[1]-this.ShowTop)+this.ShowTop_90)+";";this.RelativePoints_90+=(this.ShowWidth-(B[0]-this.ShowLeft)+C)+","+(this.ShowHeight-(B[1]-this.ShowTop)+C)+" ";this.ShowPoints_180+=(B[1]-this.ShowTop+this.ShowLeft_180)+","+(this.ShowWidth-(B[0]-this.ShowLeft)+this.ShowTop_180)+";";this.RelativePoints_180+=(B[1]-this.ShowTop+C)+","+(this.ShowWidth-(B[0]-this.ShowLeft)+C)+" "}}this.ShowPoints_0=this.ShowPoints_0.substring(0,this.ShowPoints_90.length-1);this.ShowPoints_90=this.ShowPoints_90.substring(0,this.ShowPoints_180.length-1);this.ShowPoints_180=this.ShowPoints_180.substring(0,this.ShowPoints_270.length-1);this.ShowPoints_0+="|";this.ShowPoints_90+="|";this.ShowPoints_180+="|";this.RelativePoints_0=this.RelativePoints_0.substring(0,this.RelativePoints_90.length-1);this.RelativePoints_90=this.RelativePoints_90.substring(0,this.RelativePoints_180.length-1);this.RelativePoints_180=this.RelativePoints_180.substring(0,this.RelativePoints_270.length-1);this.RelativePoints_0+=";";this.RelativePoints_90+=";";this.RelativePoints_180+=";"}}this.ShowPoints_0=this.ShowPoints_0.substring(0,this.ShowPoints_0.length-1);this.RelativePoints_0=this.RelativePoints_0.substring(0,this.RelativePoints_0.length-1);this.ShowPoints_90=this.ShowPoints_90.substring(0,this.ShowPoints_90.length-1);this.RelativePoints_90=this.RelativePoints_90.substring(0,this.RelativePoints_90.length-1);this.ShowPoints_180=this.ShowPoints_180.substring(0,this.ShowPoints_180.length-1);this.RelativePoints_180=this.RelativePoints_180.substring(0,this.RelativePoints_180.length-1)}}}}if(this.Rotate==0){this.ThumbShowLeft_0=this.ThumbShowLeft;this.ThumbShowTop_0=this.ThumbShowTop;this.ThumbShowWidth_0=this.ThumbShowWidth;this.ThumbShowHeight_0=this.ThumbShowHeight;this.ThumbShowLeft_90=D.thumbShowHeight-(this.ThumbShowTop_0+this.ThumbShowHeight_0);this.ThumbShowTop_90=this.ThumbShowLeft_0;this.ThumbShowWidth_90=this.ThumbShowHeight_0;this.ThumbShowHeight_90=this.ThumbShowWidth_0;this.ThumbShowLeft_180=D.thumbShowWidth-(this.ThumbShowLeft_0+this.ThumbShowWidth_0);this.ThumbShowTop_180=D.thumbShowHeight-(this.ThumbShowTop_0+this.ThumbShowHeight_0);this.ThumbShowWidth_180=this.ThumbShowWidth_0;this.ThumbShowHeight_180=this.ThumbShowHeight_0;this.ThumbShowLeft_270=this.ThumbShowTop_0;this.ThumbShowTop_270=D.thumbShowWidth-(this.ThumbShowLeft_0+this.ThumbShowWidth_0);this.ThumbShowWidth_270=this.ThumbShowHeight_0;this.ThumbShowHeight_270=this.ThumbShowWidth_0;var A=this.ThumbPoints.split(";");this.ThumbShowPoints_0=this.ThumbShowPoints;this.ThumbShowPoints_90="";this.ThumbShowPoints_180="";this.ThumbShowPoints_270="";this.ThumbRelativePoints_0=this.ThumbRelativePoints;this.ThumbRelativePoints_90="";this.ThumbRelativePoints_180="";this.ThumbRelativePoints_270="";for(var I=0;I<A.length;I++){var B=A[I].split(",");if(typeof(B)!="undefined"){this.ThumbShowPoints_90+=(this.ThumbShowHeight-B[1])+","+B[0]+";";this.ThumbRelativePoints_90+=(this.ThumbShowHeight-B[1])+","+B[0]+" ";this.ThumbShowPoints_180+=(this.ThumbShowWidth-B[0])+","+(this.ThumbShowHeight-B[1])+";";this.ThumbRelativePoints_180+=(this.ThumbShowWidth-B[0])+","+(this.ThumbShowHeight-B[1])+" ";this.ThumbShowPoints_270+=B[1]+","+(this.ThumbShowWidth-B[0])+";";this.ThumbRelativePoints_270+=B[1]+","+(this.ThumbShowWidth-B[0])+" "}}this.ThumbShowPoints_90=this.ThumbShowPoints_90.substring(0,this.ThumbShowPoints_90.length-1);this.ThumbRelativePoints_90=this.ThumbRelativePoints_90.substring(0,this.ThumbRelativePoints_90.length-1);this.ThumbShowPoints_180=this.ThumbShowPoints_180.substring(0,this.ThumbShowPoints_180.length-1);this.ThumbRelativePoints_180=this.ThumbRelativePoints_180.substring(0,this.ThumbRelativePoints_180.length-1);this.ThumbShowPoints_270=this.ThumbShowPoints_270.substring(0,this.ThumbShowPoints_270.length-1);this.ThumbRelativePoints_270=this.ThumbRelativePoints_270.substring(0,this.ThumbRelativePoints_270.length-1)}else{if(this.Rotate==1){this.ThumbShowLeft_90=this.ThumbShowLeft;this.ThumbShowTop_90=this.ThumbShowTop;this.ThumbShowWidth_90=this.ThumbShowWidth;this.ThumbShowHeight_90=this.ThumbShowHeight;this.ThumbShowLeft_0=this.ThumbShowTop_90;this.ThumbShowTop_0=D.thumbShowHeight-(this.ThumbShowLeft_90+this.ThumbShowWidth_90);this.ThumbShowWidth_0=this.ThumbShowHeight_90;this.ThumbShowHeight_0=this.ThumbShowWidth_90;this.ThumbShowLeft_180=D.thumbShowWidth-this.ThumbShowTop_90-this.ThumbShowHeight_90;this.ThumbShowTop_180=this.ThumbShowLeft_90;this.ThumbShowWidth_180=this.ThumbShowWidth_0;this.ThumbShowHeight_180=this.ThumbShowHeight_0;this.ThumbShowLeft_270=D.thumbShowHeight-this.ThumbShowLeft_90-this.ThumbShowWidth_90;this.ThumbShowTop_270=D.thumbShowWidth-this.ThumbShowTop_90-this.ThumbShowHeight_90;this.ThumbShowWidth_270=this.ThumbShowHeight_0;this.ThumbShowHeight_270=this.ThumbShowWidth_0;var A=this.ThumbPoints.split(";");this.ThumbShowPoints_0="";this.ThumbShowPoints_90=this.ThumbShowPoints;this.ThumbShowPoints_180="";this.ThumbShowPoints_270="";this.ThumbRelativePoints_0="";this.ThumbRelativePoints_90=this.ThumbRelativePoints;this.ThumbRelativePoints_180="";this.ThumbRelativePoints_270="";for(var I=0;I<A.length;I++){var B=A[I].split(",");if(typeof(B)!="undefined"){this.ThumbShowPoints_0+=(B[1])+","+(this.ThumbShowWidth-(B[0]))+";";this.ThumbRelativePoints_0+=(B[1])+","+(this.ThumbShowWidth-(B[0]))+" ";this.ThumbShowPoints_180+=(this.ThumbShowHeight-(B[1]))+","+(B[0])+";";this.ThumbRelativePoints_180+=(this.ThumbShowHeight-(B[1]))+","+(B[0])+" ";this.ThumbShowPoints_270+=(this.ThumbShowWidth-(B[0]))+","+(this.ThumbShowHeight-(B[1]))+";";this.ThumbRelativePoints_270+=(this.ThumbShowWidth-(B[0]))+","+(this.ThumbShowHeight-(B[1]))+" "}}this.ThumbShowPoints_0=this.ThumbShowPoints_0.substring(0,this.ThumbShowPoints_0.length-1);this.ThumbRelativePoints_0=this.ThumbRelativePoints_0.substring(0,this.ThumbRelativePoints_0.length-1);this.ThumbShowPoints_180=this.ThumbShowPoints_180.substring(0,this.ThumbShowPoints_180.length-1);this.ThumbRelativePoints_180=this.ThumbRelativePoints_180.substring(0,this.ThumbRelativePoints_180.length-1);this.ThumbShowPoints_270=this.ThumbShowPoints_270.substring(0,this.ThumbShowPoints_270.length-1);this.ThumbRelativePoints_270=this.ThumbRelativePoints_270.substring(0,this.ThumbRelativePoints_270.length-1)}else{if(this.Rotate==2){this.ThumbShowLeft_180=this.ThumbShowLeft;this.ThumbShowTop_180=this.ThumbShowTop;this.ThumbShowWidth_180=this.ThumbShowWidth;this.ThumbShowHeight_180=this.ThumbShowHeight;this.ThumbShowLeft_0=D.thumbShowWidth-this.ThumbShowLeft_180-this.ThumbShowWidth_180;this.ThumbShowTop_0=D.thumbShowHeight-this.ThumbShowTop_180-this.ThumbShowHeight_180;this.ThumbShowWidth_0=this.ThumbShowWidth_180;this.ThumbShowHeight_0=this.ThumbShowHeight_180;this.ThumbShowLeft_90=D.thumbShowHeight-(this.ThumbShowTop_0+this.ThumbShowHeight_0);this.ThumbShowTop_90=this.ThumbShowLeft_0;this.ThumbShowWidth_90=this.ThumbShowHeight_0;this.ThumbShowHeight_90=this.ThumbShowWidth_0;this.ThumbShowLeft_270=this.ThumbShowTop_0;this.ThumbShowTop_270=D.thumbShowWidth-(this.ThumbShowLeft_0+this.ThumbShowWidth_0);this.ThumbShowWidth_270=this.ThumbShowHeight_0;this.ThumbShowHeight_270=this.ThumbShowWidth_0;var A=this.ThumbPoints.split(";");this.ThumbShowPoints_0="";this.ThumbShowPoints_90="";this.ThumbShowPoints_180=this.ThumbShowPoints;this.ThumbShowPoints_270="";this.ThumbRelativePoints_0="";this.ThumbRelativePoints_90="";this.ThumbRelativePoints_180=this.ThumbRelativePoints;this.ThumbRelativePoints_270="";for(var I=0;I<A.length;I++){var B=A[I].split(",");if(typeof(B)!="undefined"){this.ThumbShowPoints_0+=(this.ThumbShowWidth-(B[0]))+","+(this.ThumbShowHeight-(B[1]))+";";this.ThumbRelativePoints_0+=(this.ThumbShowWidth-(B[0]))+","+(this.ThumbShowHeight-(B[1]))+" ";this.ThumbShowPoints_90+=(B[1])+","+(this.ThumbShowWidth-(B[0]))+";";this.ThumbRelativePoints_90+=(B[1])+","+(this.ThumbShowWidth-(B[0]))+" ";this.ThumbShowPoints_270+=(this.ThumbShowHeight-(B[1]))+","+(B[0])+";";this.ThumbRelativePoints_270+=(this.ThumbShowHeight-(B[1]))+","+(B[0])+" "}}this.ThumbShowPoints_0=this.ThumbShowPoints_0.substring(0,this.ThumbShowPoints_0.length-1);this.ThumbRelativePoints_0=this.ThumbRelativePoints_0.substring(0,this.ThumbRelativePoints_0.length-1);this.ThumbShowPoints_90=this.ThumbShowPoints_90.substring(0,this.ThumbShowPoints_90.length-1);this.ThumbRelativePoints_90=this.ThumbRelativePoints_90.substring(0,this.ThumbRelativePoints_90.length-1);this.ThumbShowPoints_270=this.ThumbShowPoints_270.substring(0,this.ThumbShowPoints_270.length-1);this.ThumbRelativePoints_270=this.ThumbRelativePoints_270.substring(0,this.ThumbRelativePoints_270.length-1)}else{if(this.Rotate==3){this.ThumbShowLeft_270=this.ThumbShowLeft;this.ThumbShowTop_270=this.ThumbShowTop;this.ThumbShowWidth_270=this.ThumbShowWidth;this.ThumbShowHeight_270=this.ThumbShowHeight;this.ThumbShowLeft_0=D.thumbShowWidth-(this.ThumbShowTop_270+this.ThumbShowHeight_270);this.ThumbShowTop_0=this.ThumbShowLeft_270;this.ThumbShowWidth_0=this.ThumbShowHeight_270;this.ThumbShowHeight_0=this.ThumbShowWidth_270;this.ThumbShowLeft_90=D.thumbShowHeight-this.ThumbShowLeft_270-this.ThumbShowWidth_270;this.ThumbShowTop_90=D.thumbShowWidth-this.ThumbShowTop_270-this.ThumbShowHeight_270;this.ThumbShowWidth_90=this.ThumbShowHeight_0;this.ThumbShowHeight_90=this.ThumbShowWidth_0;this.ThumbShowLeft_180=this.ThumbShowTop_270;this.ThumbShowTop_180=D.thumbShowHeight-this.ThumbShowLeft_270-this.ThumbShowWidth_270;this.ThumbShowWidth_180=this.ThumbShowWidth_0;this.ThumbShowHeight_180=this.ThumbShowHeight_0;var A=this.ThumbPoints.split(";");this.ThumbShowPoints_0="";this.ThumbShowPoints_90="";this.ThumbShowPoints_180="";this.ThumbShowPoints_270=this.ThumbShowPoints;this.ThumbRelativePoints_0="";this.ThumbRelativePoints_90="";this.ThumbRelativePoints_180="";this.ThumbRelativePoints_270=this.ThumbRelativePoints;for(var I=0;I<A.length;I++){var B=A[I].split(",");if(typeof(B)!="undefined"){this.ThumbShowPoints_0+=(this.ThumbShowHeight-(B[1]))+","+(B[0])+";";this.ThumbRelativePoints_0+=(this.ThumbShowHeight-(B[1]))+","+(B[0])+" ";this.ThumbShowPoints_90+=(this.ThumbShowWidth-(B[0]))+","+(this.ThumbShowHeight-(B[1]))+";";this.ThumbRelativePoints_90+=(this.ThumbShowWidth-(B[0]))+","+(this.ThumbShowHeight-(B[1]))+" ";this.ThumbShowPoints_180+=(B[1])+","+(this.ThumbShowWidth-(B[0]))+";";this.ThumbRelativePoints_180+=(B[1])+","+(this.ThumbShowWidth-(B[0]))+" "}}this.ThumbShowPoints_0=this.ThumbShowPoints_0.substring(0,this.ThumbShowPoints_0.length-1);this.ThumbRelativePoints_0=this.ThumbRelativePoints_0.substring(0,this.ThumbRelativePoints_0.length-1);this.ThumbShowPoints_90=this.ThumbShowPoints_90.substring(0,this.ThumbShowPoints_90.length-1);this.ThumbRelativePoints_90=this.ThumbRelativePoints_90.substring(0,this.ThumbRelativePoints_90.length-1);this.ThumbShowPoints_180=this.ThumbShowPoints_180.substring(0,this.ThumbShowPoints_180.length-1);this.ThumbRelativePoints_180=this.ThumbRelativePoints_180.substring(0,this.ThumbRelativePoints_180.length-1)}}}}},};(function(C){if(typeof exports==="object"){module.exports=C()}else{if(typeof define==="function"&&define.amd){define(C)}else{var B;try{B=window}catch(A){B=self}B.SparkMD5=C()}}}(function(P){var N=function(S,R){return(S+R)&4294967295},K=function(S,W,T,U,R,V){W=N(N(W,S),N(U,V));return N((W<<R)|(W>>>(32-R)),T)},M=function(W,T,U,R,V,S,X){return K((T&U)|((~T)&R),W,T,V,S,X)},A=function(W,T,U,R,V,S,X){return K((T&R)|(U&(~R)),W,T,V,S,X)},I=function(W,T,U,R,V,S,X){return K(T^U^R,W,T,V,S,X)},G=function(W,T,U,R,V,S,X){return K(U^(T|(~R)),W,T,V,S,X)},H=function(T,W){var V=T[0],U=T[1],R=T[2],S=T[3];V=M(V,U,R,S,W[0],7,-680876936);S=M(S,V,U,R,W[1],12,-389564586);R=M(R,S,V,U,W[2],17,606105819);U=M(U,R,S,V,W[3],22,-1044525330);V=M(V,U,R,S,W[4],7,-176418897);S=M(S,V,U,R,W[5],12,1200080426);R=M(R,S,V,U,W[6],17,-1473231341);U=M(U,R,S,V,W[7],22,-45705983);V=M(V,U,R,S,W[8],7,1770035416);S=M(S,V,U,R,W[9],12,-1958414417);R=M(R,S,V,U,W[10],17,-42063);U=M(U,R,S,V,W[11],22,-1990404162);V=M(V,U,R,S,W[12],7,1804603682);S=M(S,V,U,R,W[13],12,-40341101);R=M(R,S,V,U,W[14],17,-1502002290);U=M(U,R,S,V,W[15],22,1236535329);V=A(V,U,R,S,W[1],5,-165796510);S=A(S,V,U,R,W[6],9,-1069501632);R=A(R,S,V,U,W[11],14,643717713);U=A(U,R,S,V,W[0],20,-373897302);V=A(V,U,R,S,W[5],5,-701558691);S=A(S,V,U,R,W[10],9,38016083);R=A(R,S,V,U,W[15],14,-660478335);U=A(U,R,S,V,W[4],20,-405537848);V=A(V,U,R,S,W[9],5,568446438);S=A(S,V,U,R,W[14],9,-1019803690);R=A(R,S,V,U,W[3],14,-187363961);U=A(U,R,S,V,W[8],20,1163531501);V=A(V,U,R,S,W[13],5,-1444681467);S=A(S,V,U,R,W[2],9,-51403784);R=A(R,S,V,U,W[7],14,1735328473);U=A(U,R,S,V,W[12],20,-1926607734);V=I(V,U,R,S,W[5],4,-378558);S=I(S,V,U,R,W[8],11,-2022574463);R=I(R,S,V,U,W[11],16,1839030562);U=I(U,R,S,V,W[14],23,-35309556);V=I(V,U,R,S,W[1],4,-1530992060);S=I(S,V,U,R,W[4],11,1272893353);R=I(R,S,V,U,W[7],16,-155497632);U=I(U,R,S,V,W[10],23,-1094730640);V=I(V,U,R,S,W[13],4,681279174);S=I(S,V,U,R,W[0],11,-358537222);R=I(R,S,V,U,W[3],16,-722521979);U=I(U,R,S,V,W[6],23,76029189);V=I(V,U,R,S,W[9],4,-640364487);S=I(S,V,U,R,W[12],11,-421815835);R=I(R,S,V,U,W[15],16,530742520);U=I(U,R,S,V,W[2],23,-995338651);V=G(V,U,R,S,W[0],6,-198630844);S=G(S,V,U,R,W[7],10,1126891415);R=G(R,S,V,U,W[14],15,-1416354905);U=G(U,R,S,V,W[5],21,-57434055);V=G(V,U,R,S,W[12],6,1700485571);S=G(S,V,U,R,W[3],10,-1894986606);R=G(R,S,V,U,W[10],15,-1051523);U=G(U,R,S,V,W[1],21,-2054922799);V=G(V,U,R,S,W[8],6,1873313359);S=G(S,V,U,R,W[15],10,-30611744);R=G(R,S,V,U,W[6],15,-1560198380);U=G(U,R,S,V,W[13],21,1309151649);V=G(V,U,R,S,W[4],6,-145523070);S=G(S,V,U,R,W[11],10,-1120210379);R=G(R,S,V,U,W[2],15,718787259);U=G(U,R,S,V,W[9],21,-343485551);T[0]=N(V,T[0]);T[1]=N(U,T[1]);T[2]=N(R,T[2]);T[3]=N(S,T[3])},L=function(S){var R=[],T;for(T=0;T<64;T+=4){R[T>>2]=S.charCodeAt(T)+(S.charCodeAt(T+1)<<8)+(S.charCodeAt(T+2)<<16)+(S.charCodeAt(T+3)<<24)}return R},Q=function(T){var R=[],S;for(S=0;S<64;S+=4){R[S>>2]=T[S]+(T[S+1]<<8)+(T[S+2]<<16)+(T[S+3]<<24)}return R},F=function(R){var X=R.length,W=[1732584193,-271733879,-1732584194,271733878],Y,V,Z,U,S,T;for(Y=64;Y<=X;Y+=64){H(W,L(R.substring(Y-64,Y)))}R=R.substring(Y-64);V=R.length;Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(Y=0;Y<V;Y+=1){Z[Y>>2]|=R.charCodeAt(Y)<<((Y%4)<<3)}Z[Y>>2]|=128<<((Y%4)<<3);if(Y>55){H(W,Z);for(Y=0;Y<16;Y+=1){Z[Y]=0}}U=X*8;U=U.toString(16).match(/(.*?)(.{0,8})$/);S=parseInt(U[2],16);T=parseInt(U[1],16)||0;Z[14]=S;Z[15]=T;H(W,Z);return W},E=function(Y){var W=Y.length,V=[1732584193,-271733879,-1732584194,271733878],X,U,Z,T,R,S;for(X=64;X<=W;X+=64){H(V,Q(Y.subarray(X-64,X)))}Y=(X-64)<W?Y.subarray(X-64):new Uint8Array(0);U=Y.length;Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(X=0;X<U;X+=1){Z[X>>2]|=Y[X]<<((X%4)<<3)}Z[X>>2]|=128<<((X%4)<<3);if(X>55){H(V,Z);for(X=0;X<16;X+=1){Z[X]=0}}T=W*8;T=T.toString(16).match(/(.*?)(.{0,8})$/);R=parseInt(T[2],16);S=parseInt(T[1],16)||0;Z[14]=R;Z[15]=S;H(V,Z);return V},J=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],O=function(R){var S="",T;for(T=0;T<4;T+=1){S+=J[(R>>(T*8+4))&15]+J[(R>>(T*8))&15]}return S},B=function(S){var R;for(R=0;R<S.length;R+=1){S[R]=O(S[R])}return S.join("")},C=function(R){return B(F(R))},D=function(){this.reset()};if(C("hello")!=="5d41402abc4b2a76b9719d911017c592"){N=function(S,T){var R=(S&65535)+(T&65535),U=(S>>16)+(T>>16)+(R>>16);return(U<<16)|(R&65535)}}D.prototype.append=function(R){if(/[\u0080-\uFFFF]/.test(R)){R=unescape(encodeURIComponent(R))}this.appendBinary(R);return this};D.prototype.appendBinary=function(T){this._buff+=T;this._length+=T.length;var R=this._buff.length,S;for(S=64;S<=R;S+=64){H(this._state,L(this._buff.substring(S-64,S)))}this._buff=this._buff.substr(S-64);return this};D.prototype.end=function(W){var U=this._buff,R=U.length,S,T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],V;for(S=0;S<R;S+=1){T[S>>2]|=U.charCodeAt(S)<<((S%4)<<3)}this._finish(T,R);V=!!W?this._state:B(this._state);this.reset();return V};D.prototype._finish=function(V,S){var T=S,R,W,U;V[T>>2]|=128<<((T%4)<<3);if(T>55){H(this._state,V);for(T=0;T<16;T+=1){V[T]=0}}R=this._length*8;R=R.toString(16).match(/(.*?)(.{0,8})$/);W=parseInt(R[2],16);U=parseInt(R[1],16)||0;V[14]=W;V[15]=U;H(this._state,V)};D.prototype.reset=function(){this._buff="";this._length=0;this._state=[1732584193,-271733879,-1732584194,271733878];return this};D.prototype.destroy=function(){delete this._state;delete this._buff;delete this._length};D.hash=function(S,T){if(/[\u0080-\uFFFF]/.test(S)){S=unescape(encodeURIComponent(S))}var R=F(S);return !!T?R:B(R)};D.hashBinary=function(S,T){var R=F(S);return !!T?R:B(R)};D.ArrayBuffer=function(){this.reset()};D.ArrayBuffer.prototype.append=function(T){var U=this._concatArrayBuffer(this._buff,T),R=U.length,S;this._length+=T.byteLength;for(S=64;S<=R;S+=64){H(this._state,Q(U.subarray(S-64,S)))}this._buff=(S-64)<R?U.subarray(S-64):new Uint8Array(0);return this};D.ArrayBuffer.prototype.end=function(W){var U=this._buff,R=U.length,T=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],S,V;for(S=0;S<R;S+=1){T[S>>2]|=U[S]<<((S%4)<<3)}this._finish(T,R);V=!!W?this._state:B(this._state);this.reset();return V};D.ArrayBuffer.prototype._finish=D.prototype._finish;D.ArrayBuffer.prototype.reset=function(){this._buff=new Uint8Array(0);this._length=0;this._state=[1732584193,-271733879,-1732584194,271733878];return this};D.ArrayBuffer.prototype.destroy=D.prototype.destroy;D.ArrayBuffer.prototype._concatArrayBuffer=function(U,R){var T=U.length,S=new Uint8Array(T+R.byteLength);S.set(U);S.set(new Uint8Array(R),T);return S};D.ArrayBuffer.hash=function(S,T){var R=E(new Uint8Array(S));return !!T?R:B(R)};return D}));var _fileFormat=new Array(".pdf",".doc",".docx",".docm",".dotx",".dotm",".xls",".xlsx",".xlsm",".xltx",".tif",".tiff",".png",".bmp",".RLE",".DIB",".gif",".jpg",".jpeg",".jfif",".jpe",".dcm",".dic",".jbig2",".jbg",".xbm",".xpm",".pbm",".pgm",".ppm",".dng",".jp2",".j2k",".wbm",".ppt",".pptx",".ppsx",".pptm",".potm",".potx",".ppsm");var _svgFormat=new Array(".pdf",".doc",".docx",".docm",".dotx",".dotm",".xls",".xlsx",".xlsm",".xltx",".ppt",".pptx",".ppsx",".pptm",".potm",".potx",".ppsm");var _wordFormat=new Array(".doc",".docx",".docm",".dotx",".dotm");var _excelFormat=new Array(".xls",".xlsx",".xlsm",".xltx");var _pptFormat=new Array(".ppt",".pptx",".ppsx",".pptm",".potm",".potx",".ppsm");var _dcmFormat=new Array(".dic",".dcm");var _tifFormat=new Array(".tif",".tiff");var _cacheFolder="";var _fileIdName="";var _isHasPassword="";var _fileName="RasterEdge WebViewer";var _fid;var _imageFormat;var _viewerMode="single";var _showPageIds=new Array();var _recieveSvg=new Array();var _showDocSrc=new Array();var _DocSrcRequest=new Array();var _fileDocument=new Array();var _size=new Array();var outLine=new Array();var _isHaveDocument=false;var _isDisabled=false;var _isInDocViewer=false;var timeout=false;var curFileId=0;var _curCorrectPageId=0;var _totalPageCount=1;var _isImage=false;var mark=1;var sign=1;var signRotate=0;var sym;var _zoomItems=new Array("1200%","1000%","900%","800%","400%","200%","150%","125%","100%","80%","75%","66.67%","50%","33.33%","25%","18.5%","----------","Actual Size","Fit Page","Fit Width");var _zoomListIndex=18;var _actualZoomIndex=8;var _actualZoom=10;var minIndex=4;var maxIndex=7;var _isStretch=true;var _isFull=false;var _width;var _height;var tempWidth;var tempHeight;var isExist=false;var _pageHeight;var _suffix;var _preSuffix;var _IsAnnos=false;var OnceShow=false;var isInitOpen=true;var _isIpad=false;var currentCreateIndex=0;var thumbCreateIndex=0;var svgContentInterval;var showDocIdsInterval;$(document).ready(function(){$.ajaxSetup({async:false});PageLoadReady();ParameterDocumentLoad(_msgToClient);BindZoomEvent();$("#re_canvas").hover(function(){_isInDocViewer=true},function(){_isInDocViewer=false;isDragIn=false});$(".re_func_toolbar").hover(function(){_isInToolbar=true},function(){_isInToolbar=false})});function OnLoadReady(){if(dialogOpen){$("#dialog").dialog("close");dialogOpen=false}if(ocrDialog){$("#dialogOCR").remove();ocrDialog=false}if(!GetFileBaseInfo()){return}enableLoadAnnoFiles();ChangeFooterStyle();CreateDocImageControl("imgBig");ChangeThumbnailSize();CreateThumbImageControl("_thumbImg");CreateOutLineControl("_thumbOutLine");ChangeThumbScrollBar(_curCorrectPageId,false);if(!_viewer._leftPanelDefaultShow){thumbHidden()}else{$("#tabs").tabs("option","active",1)}$("#pageImg"+_curCorrectPageId).remove();SetViewerMode();ChangePg(parseInt(_curCorrectPageId));map();$(".re_content").bind("contextmenu",function(C){return false});$("#_thumbImg").sortable({stop:function(D,C){SortPage(C.item)}});if(_suffix!=".pdf"&&!_tifFormat.in_array(_suffix)){$("#_thumbImg").sortable("disable")}else{$("#_thumbImg").sortable("enable")}$("#_thumbImg").disableSelection();if(_imageFormat=="Svg"){svgContentInterval=setInterval(GetDocumentSvgs,1000*5)}setTimeout(ajaxCreateSearchFile,1000*15);setTimeout(function(){if(_imageFormat=="Bitmap"){CreateDocImages()}else{if(_imageFormat=="Svg"){CreateSvgFile()}}},1000*20);var A=0.7;var B=0;$("#_plcBigImg").scroll(function(C){if(_viewerMode=="multi"){setTimeout(function(){var E=_pageHeight;var O=$(".thumbnail").outerHeight(true);var H=$("#_plcImgsThumbs").height();var P=$("#_plcBigImg").scrollTop()-5;var G=PrePageCount(P);var F=P-PreCountHeight(G);var K=_fileDocument[curFileId].GetPageIndex(G);if(K==null){return}_fileDocument[curFileId].Viewers[K].GetViewerLeftTop();var M=G+F/(_fileDocument[curFileId].Viewers[K].ActualHeight);var J=M;var D=parseInt(M);var I;var L;if($("#_plcBigImg").scrollTop()>B){L=parseFloat(D+A);if(parseFloat(M)>=L){J=D+1;var Q=_totalPageCount-1;J=J<=Q?J:Q}if(parseInt(J)!=_curCorrectPageId){$("#pageIdList").val(parseInt(J+1));ChangeThumbScrollBar(parseInt(J),false);_curCorrectPageId=parseInt(J);var N=_fileDocument[curFileId].GetPageIndex(_curCorrectPageId);ChangeDivCssClass(N);if(_totalPageCount!=1){ChangeBtnStyle()}}}else{if($("#_plcBigImg").scrollTop()<B){L=parseFloat(D+A);if(parseFloat(M)>L){return}else{(parseFloat(M)<=L)}J=D;if(parseInt(J)!=_curCorrectPageId){$("#pageIdList").val(parseInt(J+1));ChangeThumbScrollBar(parseInt(J),true);_curCorrectPageId=parseInt(J);var N=_fileDocument[curFileId].GetPageIndex(_curCorrectPageId);ChangeDivCssClass(N);if(_totalPageCount!=1){ChangeBtnStyle()}}}}B=$("#_plcBigImg").scrollTop()},1000)}});if(_viewerMode=="multi"){showDocIdsInterval=setInterval(function(){if(isAddShowDocIDs==_curCorrectPageId){if(plcImgHeight==$("#_plcBigImg").scrollTop()){addShowDocIds(true)}else{plcImgHeight=$("#_plcBigImg").scrollTop();addShowDocIds(false)}var C=_fileDocument[curFileId];if(_showDocSrc.length!=_totalPageCount){return}clearInterval(showDocIdsInterval)}else{isAddShowDocIDs=_curCorrectPageId}},1000*1.5)}$("#_plcImgsThumbs").scroll(function(){if(timeout){clearTimeout(timeout)}timeout=setTimeout(function(){addShowPageIds()},1000)});if(canSaveAnnos){disableSaveAnnos();canSaveAnnos=false}if(canDelete){disableDelete();canDelete=false}}var isAddShowDocIDs=0;var plcImgHeight=0;var WidthArray=new Array();var otherWidths=new Array();var HeightArray=new Array();var otherHeights=new Array();var _maxWidth=0;var _maxHeight=0;function GetFileBaseInfo(){var clientWidth=viewer_clientWidth-tabWidth;var clientHeight=viewer_clientHeight-_toolbarHeight-_footerHeight;var _isGetInfo=false;$.post(getServerHandlerUrl(),{"action":"GetFileBaseInfo","fid":newFid,"fileName":newFileName,"password":curDocPassWord,"ClientWidth":clientWidth,"ClientHeight":clientHeight},function(result,status){result=eval("("+result+")");if(result.state=="success"){var arr=result.msg;if(arr.pageCount==0||arr.pageSize==null){alert("Information error, please re-open this file");window.document.title=_fileName;LoadErrorHandle();return}_totalPageCount=parseFloat(arr.pageCount);_maxTotalPageCount=parseFloat(arr.pageCount);$("#totalPageIndex").text(_totalPageCount);InitializeVariables();InitViewers();clearSearch();_preSuffix=_suffix;_suffix=arr.suffix;InitFileType();_size=arr.pageSize.split(";");for(var i=0;i<_size.length-1;i++){var position=_size[i].indexOf("|");var width=_size[i].substring(0,position);var height=_size[i].substring(position+1);var regEx=new RegExp(/[^0-9]/);if(regEx.exec(width)!=null&&regEx.exec(width)!="."){WidthArray[i]=Math.round(width.replace(regEx.exec(width),"."))}else{WidthArray[i]=Math.round(width)}if(regEx.exec(height)!=null&&regEx.exec(height)!="."){HeightArray[i]=Math.round(height.replace(regEx.exec(height),"."))}else{HeightArray[i]=Math.round(height)}}_maxWidth=WidthArray.max();_maxHeight=HeightArray.max();if(_wordFormat.in_array(_suffix)||_suffix==".pdf"||_excelFormat.in_array(_suffix)||_pptFormat.in_array(_suffix)){outLine=arr.outLine.Entry}for(var i=0;i<_totalPageCount;i++){if(WidthArray[i]!=_maxWidth){otherWidths.push(i)}if(HeightArray[i]!=_maxHeight){otherHeights.push(i)}}_isGetInfo=true;_fid=newFid;_fileName=newFileName}else{alert(result.msg);window.document.title=_fileName;LoadErrorHandle();_isGetInfo=false}});return _isGetInfo}function ChangeThumbnailSize(){for(var A=0;A<_fileDocument[curFileId].Viewers.length;A++){var E=_fileDocument[curFileId].Viewers[A];var D=E.OneToOne_Width;var C=E.OneToOne_Height;var B=D/C;if(D>C){if(C<_thumbHeight){E.thumbShowHeight=C}else{E.thumbShowHeight=_thumbHeight}E.thumbShowWidth=E.thumbShowHeight*B;if(E.thumbShowWidth>=_thumbnailWidth){E.thumbShowWidth=_thumbnailWidth;E.thumbShowHeight=E.thumbShowWidth/B}}else{if(D<_thumbWidth){E.thumbShowWidth=D}else{E.thumbShowWidth=_thumbWidth}E.thumbShowHeight=E.thumbShowWidth/B}E.ThumbScaleX=E.thumbShowWidth/D;E.ThumbScaleY=E.thumbShowHeight/C;E.ThumbWidth=E.thumbShowWidth;E.ThumbHeight=E.thumbShowHeight}}function ajaxCreateSearchFile(){if(_svgFormat.in_array(_suffix)){var B={action:"CreateSearchFile",fid:_fid,fileName:_fileName,"password":curDocPassWord};var A={type:"POST",url:getServerHandlerUrl(),async:true,data:B,success:function(C){},error:function(C){}};$.ajax(A)}}function CreateDocImages(){var C=currentCreateIndex+20;while(C>=_totalPageCount){C--}var B={action:"CreateDocImages",fid:_fid,fileName:_fileName,password:curDocPassWord,startIndex:currentCreateIndex,endIndex:C};var A={type:"POST",url:getServerHandlerUrl(),async:true,data:B,success:function(F){for(var D=currentCreateIndex;D<=C;D++){var E=_fileDocument[curFileId].Viewers[D];if(E==null||E.ShowIndex==null){continue}_fileDocument[curFileId].Viewers[D].DocImageIsExist=true}if(C!=_totalPageCount-1){currentCreateIndex=C+1;setTimeout(function(){CreateDocImages()},1000*10)}else{CreateThumbImages()}},error:function(D){}};$.ajax(A)}function CreateThumbImages(){var C=thumbCreateIndex+30;while(C>=_totalPageCount){C--}var B={action:"CreateThumbImages",fid:_fid,"type":_imageFormat,fileName:_fileName,password:curDocPassWord,startIndex:thumbCreateIndex,endIndex:C,jsonDoc:GetJsonDoc()};var A={type:"POST",url:getServerHandlerUrl(),async:true,data:B,success:function(F){for(var D=thumbCreateIndex;D<=C;D++){var E=_fileDocument[curFileId].Viewers[D];if(E==null||E.ShowIndex==null){continue}_fileDocument[curFileId].Viewers[D].ThumbImageIsExist=true}if(C!=_totalPageCount-1){thumbCreateIndex=C+1;setTimeout(function(){CreateThumbImage()},1000*10)}},error:function(D){}};$.ajax(A)}function CreateSvgFile(){var C=currentCreateIndex+20;while(C>=_totalPageCount){C--}var B={action:"CreateDocSvg",fid:_fid,fileName:_fileName,password:curDocPassWord,startIndex:currentCreateIndex,endIndex:C};var A={type:"POST",url:getServerHandlerUrl(),async:true,data:B,success:function(F){for(var D=currentCreateIndex;D<=C;D++){var E=_fileDocument[curFileId].Viewers[D];if(E==null||E.ShowIndex==null){continue}_fileDocument[curFileId].Viewers[D].DocImageIsExist=true}if(C!=_totalPageCount-1){currentCreateIndex=C+1;setTimeout(function(){CreateSvgFile()},1000*10)}else{CreateThumbImages()}},error:function(D){}};$.ajax(A)}function ChangeProcessStyle(){var B=getProjectName();if(_isImage&&mark==1){var A=B+"/"+_resourceFolder+"/images/RE_wt_iconsC1.png";$("#re_func_addPage").css("background","url('"+A+"') no-repeat -137px 0px");$("#re_func_addPage").hover(function(){$(this).css("background","url('"+A+"') no-repeat -137px 0px")},function(){$(this).css("background","url('"+A+"') no-repeat -137px 0px")});$("#re_func_deletePage").css("background","url('"+A+"') no-repeat -167px 0px");$("#re_func_deletePage").hover(function(){$(this).css("background","url('"+A+"') no-repeat -167px 0px")},function(){$(this).css("background","url('"+A+"') no-repeat -167px 0px")});if(sign==1){$("#re_func_addPage").removeAttr("onclick");$("#re_func_deletePage").removeAttr("onclick");sign=0}else{$("#re_func_addPage").unbind("click");$("#re_func_deletePage").unbind("click")}mark=-1}else{if(!_isImage&&mark==-1){var A=B+"/"+_resourceFolder+"/images/RE_wt_iconsB1.png";$("#re_func_addPage").css("background","url('"+A+"') no-repeat -137px 0px");$("#re_func_addPage").hover(function(){$(this).css("background","url('"+A+"') no-repeat -137px 0px")},function(){$(this).css("background","url('"+A+"') no-repeat -137px 0px")});$("#re_func_addPage").bind("click",AddPage);$("#re_func_deletePage").css("background","url('"+A+"') no-repeat -167px 0px");$("#re_func_deletePage").hover(function(){$(this).css("background","url('"+A+"') no-repeat -167px 0px")},function(){$(this).css("background","url('"+A+"') no-repeat -167px 0px")});$("#re_func_deletePage").bind("click",DeletePage);mark=1}}}function InitViewers(){_fileDocument[curFileId]=null;_fileDocument=new Array();var B=new FileDocument({Index:curFileId});_fileDocument[curFileId]=B;for(var A=0;A<_totalPageCount;A++){var C=new Viewer({PageIndex:A});_fileDocument[curFileId].Viewers[A]=C;B.ViewerPageIndex.push(A)}}var flagIndex=null;var startPageIndex="";var endPageIndex="";function GetDocumentSvgs(){if(_recieveSvg.length==_totalPageCount){clearInterval(svgContentInterval)}if(flagIndex!=_curCorrectPageId){flagIndex=_curCorrectPageId;startPageIndex=_curCorrectPageId-5>=0?(_curCorrectPageId-5):0;endPageIndex=_curCorrectPageId+20<_totalPageCount?(_curCorrectPageId+20):(_totalPageCount-1)}JudgePageSvgContent()}function JudgePageSvgContent(){if(curImportantRequest.length!=0||startPageIndex>endPageIndex){return}while(_showDocSrc.in_array(startPageIndex)||_fileDocument[curFileId].ViewerSvgContent[startPageIndex]!=null){startPageIndex++;if(startPageIndex>endPageIndex){return}}if(!_DocSrcRequest.in_array(startPageIndex)){addSvgContent(startPageIndex,false)}}function addSvgContent(B,A){GetPageCharsRects(B);FileIsExist(B,false);_DocSrcRequest.push(B);if(isExist){PointFile(B,A)}else{GetSvgStream(B,A)}}function GetPageCharsRects(pageIndex){var asynFlag=true;if(pageIndex==0){asynFlag=false}if((_wordFormat.in_array(_suffix)||_pptFormat.in_array(_suffix)||_excelFormat.in_array(_suffix)||_suffix==".pdf")&&_imageFormat=="Svg"){if(_fileDocument[curFileId].ViewerChars[pageIndex]!=null){return}var str={action:"GetPageCharRecs",pageIndex:pageIndex,fid:_fid,fileName:_fileName,password:curDocPassWord};var options={type:"POST",url:getServerHandlerUrl(),async:asynFlag,data:str,success:function(result){result=eval("("+result+")");if(result.state=="success"){var arr=result.msg;if(_excelFormat.in_array(_suffix)){_fileDocument[curFileId].ViewerChars[pageIndex]=unpackCell(arr.Result)}else{_fileDocument[curFileId].ViewerChars[pageIndex]=unpack(arr.Result)}}else{_fileDocument[curFileId].ViewerChars[pageIndex]="Error:"+result.msg}},error:function(err){}};_fileDocument[curFileId].Viewers[pageIndex].charRectsAjaxRequest=$.ajax(options)}}function PointFile(pageIndex,curFlag){var SVGXmlContent="";var str={action:"GetSvgFileContent",fid:_fid,PageIndex:pageIndex};var options={type:"POST",url:getServerHandlerUrl(),async:true,data:str,dataType:"html",success:function(response){if(response.indexOf("<?xml version")!=-1){SVGXmlContent=response;svgCallback(pageIndex,SVGXmlContent,curFlag)}else{result=eval("("+response+")");if(result.state=="error"){if(pageIndex!=_curCorrectPageId){svgCallback(pageIndex,"Error:"+result.msg,curFlag)}else{FileNotFound()}}}},error:function(err){}};_fileDocument[curFileId].Viewers[pageIndex].svgAjaxRequest=$.ajax(options)}function GetSvgStream(pageIndex,curFlag){var SVGXmlContent="";var str={PageIndex:pageIndex,type:_imageFormat,IsThumb:false,Fid:_fid,fileName:_fileName,password:curDocPassWord};var options={type:"POST",url:getServerHandlerUrl(),async:true,data:str,dataType:"html",success:function(response){if(response.indexOf("<?xml version")!=-1){SVGXmlContent=response;svgCallback(pageIndex,SVGXmlContent,curFlag)}else{result=eval("("+response+")");if(result.state=="error"){if(pageIndex!=_curCorrectPageId){svgCallback(pageIndex,"Error:"+result.msg,curFlag)}else{FileNotFound()}}}},error:function(err){}};_fileDocument[curFileId].Viewers[pageIndex].svgAjaxRequest=$.ajax(options)}function svgCallback(C,A,B){_DocSrcRequest.remove(C);if(curImportantRequest.in_array(C)){curImportantRequest.remove(C)}_fileDocument[curFileId].ViewerSvgContent[C]=A;if(!_recieveSvg.in_array(C)){_recieveSvg.push(C)}if(B){svgContentToDiv(C)}else{setTimeout(JudgePageSvgContent,1000)}}function svgContentToDiv(C){var A=_fileDocument[curFileId].ViewerSvgContent[C];if(A.indexOf("Error:")!=-1){if(C==parseInt(_curCorrectPageId)){FileNotFound()}}else{$("#pageImg"+C).remove();$("#page"+C).empty();$("#page"+C).append(A);_fileDocument[curFileId].ViewerSvgContent[C]=null;_showDocSrc.push(C);if(svgPageResult[C]!=""){$("#page"+C+" svg").append(svgPageResult[C]);var B=$("#page"+C).html();$("#page"+C).html(B)}}}function ChangePg(B){if(_totalPageCount!=1){ChangeBtnStyle()}var C=_fileDocument[curFileId].GetPageIndex(_curCorrectPageId);var A=parseInt(B);if(A==C){if(_showDocSrc.in_array(A)){drawImageViewerAnnotations(A);hideLoading();return}}showIndex=_fileDocument[curFileId].GetShowIndex(A);if(_viewerMode=="single"){drawImageViewerAnnotations(A);CreateSingleDocImage(C,A)}else{ChangeDocScrollBar(showIndex,_pageHeight);addShowDocIds(false)}$("#pageIdList").val(showIndex+1);_curCorrectPageId=showIndex;addShowPageIds();ChangeDivCssClass(A);changePageNavigationStyle();hideLoading()}function CreateSingleDocImage(A,B){if(_showDocSrc.in_array(A)){$("#page"+A).hide()}ChangeViewerPosition(B);resizeDocViewerByCSS3("imgBig",B);if(_imageFormat=="Svg"){$("#page"+B).show();if(!_showDocSrc.in_array(B)){if(_fileDocument[curFileId].ViewerSvgContent[B]!=null){svgContentToDiv(B)}else{if(!_DocSrcRequest.in_array(B)){addSvgContent(B,true)}}}}else{$("#page"+B).show();if(!_showDocSrc.in_array(B)){AddImage(B)}}$("#_plcBigImg").scrollTop(0)}_pageErrorArray=new Array();function BubbleSort(B){if(B=="undefined"||B==null||B==""){return}var C=B.length;var A,D;while(C--){A=B.length;while(A--){if(B[A].MinHeight>B[C].MinHeight&&A<C){D=B[C];B[C]=B[A];B[A]=D}}}return B}function RectifyZoom(){if(_zoomListIndex<minIndex){_actualZoomIndex=minIndex}else{_actualZoomIndex=_zoomListIndex}}function AddImage(B){var A=_fileDocument[curFileId].Viewers[B];if(_showDocSrc.in_array(B)){if(_zoomListIndex<=maxIndex){RectifyZoom();if(A.Currentzoom>_actualZoomIndex){CreateNewImage(B)}}}else{if(_zoomListIndex<=maxIndex){RectifyZoom();if(A.Currentzoom>_actualZoomIndex){if(_suffix!=".pdf"&&!_wordFormat.in_array(_suffix)&&!_excelFormat.in_array(_suffix)&&!_pptFormat.in_array(_suffix)&&!_dcmFormat.in_array(_suffix)&&!_tifFormat.in_array(_suffix)){ImgSrc(B)}else{CreateNewImage(B)}}}else{ImgSrc(B)}_showDocSrc.push(B)}}var _pageErrorArray=new Array();function ImgSrc(D){FileIsExist(D,false);var A="page"+D;var C="";if(isExist){C=getFolder("page")+"/"+D+".png"}else{C=_fileDocument[curFileId].Viewers[D].GetSrc()}var B=new Image();B.src=C;B.value=D;B.onload=function(){document.getElementById(A).src=this.src;$("#pageImg"+D).remove()};B.onerror=function(){var H=this.value;if(_pageErrorArray[H]==null){_pageErrorArray[H]=0}var E=_pageErrorArray[H]+1;if(E>2){_pageErrorArray[H]=0;var G=getProjectName();var I=G+"/"+_resourceFolder+"/images/RE_navi_refresh.png";var F="<div id='button_"+D+"' style='width:32px;height:30px;float:right' onclick='RefreshCurrentPage("+D+")'></div>";$("#page"+D).before(F);$("#button_"+D).css("background","url('"+I+"') no-repeat 0px 0px");$("#button_"+D).addClass("defaultCursor")}else{_pageErrorArray[H]=E;ImgSrc(H)}}}function RefreshCurrentPage(B){$("#button_"+B).remove();var A=_fileDocument[curFileId].Viewers[B];if(A==null||A.PageIndex==null){return}ImgSrc(B)}function CreateNewImage(E){if(_suffix==".pdf"||_wordFormat.in_array(_suffix)||_excelFormat.in_array(_suffix)||_pptFormat.in_array(_suffix)||_dcmFormat.in_array(_suffix)||_tifFormat.in_array(_suffix)){var B=_zoomItems[_actualZoomIndex].length;var A=_zoomItems[_actualZoomIndex].substring(0,B-1);_actualZoom=parseFloat(A)/10;var D=_fileDocument[curFileId].Viewers[E];var C=new Image();C.src=D.GetSrc();C.value=E;C.onload=function(){document.getElementById("page"+E).src=this.src;D.Currentzoom=_actualZoomIndex;$("#pageImg"+E).remove()};C.onerror=function(){var I=this.value;if(_pageErrorArray[I]==null){_pageErrorArray[I]=0}var F=_pageErrorArray[I]+1;if(F>2){_pageErrorArray[I]=0;var H=getProjectName();var J=H+"/"+_resourceFolder+"/images/RE_navi_refresh.png";var G="<div id='button_"+E+"' style='width:32px;height:30px;float:right' onclick='RefreshCurrentPage("+E+")'></div>";$("#page"+E).before(G);$("#button_"+E).css("background","url('"+J+"') no-repeat 0px 0px");$("#button_"+E).addClass("defaultCursor")}else{_pageErrorArray[I]=F;CreateNewImage(I)}}}}function FileIsExist(C,B){var A=_fileDocument[curFileId].Viewers[C];if(B){isExist=A.ThumbImageIsExist}else{isExist=A.DocImageIsExist}return isExist}function ChangeViewerPosition(C){_fileDocument[curFileId].Viewers[C].GetViewerLeftTop();var B=0;var A=0;if(_fileDocument[curFileId].Viewers[C].Rotate==1||_fileDocument[curFileId].Viewers[C].Rotate==3){B=_fileDocument[curFileId].Viewers[C].BigWidth+addHeight*_zoomRatio*_zoomIndex;A=_fileDocument[curFileId].Viewers[C].BigHeight+addWidth*_zoomRatio*_zoomIndex}else{B=_fileDocument[curFileId].Viewers[C].BigWidth+addWidth*_zoomRatio*_zoomIndex;A=_fileDocument[curFileId].Viewers[C].BigHeight+addHeight*_zoomRatio*_zoomIndex}$("#re_canvas").css({"width":(B+5)+"px","height":A+"px"});$("#draw_canvas").css({"width":B+"px","height":A+"px"})}function resizeDocViewerByCSS3(N,O){var M;var E;if(_viewerMode=="single"){_fileDocument[curFileId].Viewers[O].GetFirstViewerLeftTop();$("#"+N).css({"width":_fileDocument[curFileId].Viewers[O].FirstActualWidth+"px","height":_fileDocument[curFileId].Viewers[O].FirstActualHeight+"px"});$("#"+N).css({"top":_fileDocument[curFileId].Viewers[O].FirstTop+"px","left":_fileDocument[curFileId].Viewers[O].FirstLeft+"px","position":"absolute"});$(".docImages").css({"width":_fileDocument[curFileId].Viewers[O].FirstActualWidth+"px","height":_fileDocument[curFileId].Viewers[O].FirstActualHeight+"px"});$("#page"+O).css({"left":0+"px","top":0+"px"})}else{M=WidthArray.indexOf(_maxWidth);E=HeightArray.indexOf(_maxHeight);var C=0;var L=0;var J=0;var I=0;if(M==E){_fileDocument[curFileId].Viewers[M].GetFirstViewerLeftTop();C=_fileDocument[curFileId].Viewers[M].FirstActualWidth;L=_fileDocument[curFileId].Viewers[M].FirstActualHeight;J=_fileDocument[curFileId].Viewers[M].FirstLeft;I=_fileDocument[curFileId].Viewers[M].FirstTop}else{_fileDocument[curFileId].Viewers[M].GetFirstViewerLeftTop();_fileDocument[curFileId].Viewers[E].GetFirstViewerLeftTop();C=_fileDocument[curFileId].Viewers[M].FirstActualWidth;L=_fileDocument[curFileId].Viewers[E].FirstActualHeight;J=_fileDocument[curFileId].Viewers[M].FirstLeft;I=_fileDocument[curFileId].Viewers[E].FirstTop}$("#"+N).css({"width":C+"px","height":L+"px"});$("#"+N).css({"top":I+"px","left":J+"px"});$(".docImages").css({"width":C+"px","height":L+"px"});var P=_fileDocument[curFileId];for(var D=0;D<P.ViewerPageIndex.length;D++){var G=P.ViewerPageIndex[D];if(WidthArray[G]!=_maxWidth){_fileDocument[curFileId].Viewers[G].GetFirstViewerLeftTop();$("#page"+G).css({"width":_fileDocument[curFileId].Viewers[G].FirstActualWidth+"px"});$("#page"+G).css({"left":(_fileDocument[curFileId].Viewers[G].FirstLeft-J)+"px"})}if(HeightArray[G]!=_maxHeight){$("#page"+G).css({"height":_fileDocument[curFileId].Viewers[G].FirstActualHeight+"px"})}}}N=document.getElementById(N);var A=_zoomRatio*_zoomIndex;var F=0;var Q=0;var K=0;if(_viewerMode=="single"){Q=(_fileDocument[curFileId].Viewers[O].BigHeight-_docHeight)/(2*A);F=(_fileDocument[curFileId].Viewers[O].BigWidth-_docWidth)/(2*A);K=_fileDocument[curFileId].Viewers[O].Rotate*90}else{if(E!=O){_fileDocument[curFileId].Viewers[E].GetViewerLeftTop()}if(M!=O){_fileDocument[curFileId].Viewers[M].GetViewerLeftTop()}F=(_fileDocument[curFileId].Viewers[M].BigWidth-_docWidth)/(2*A);if(_fileDocument[curFileId].Viewers[E].BigHeight==_docHeight){Q=(_fileDocument[curFileId].Viewers[E].ActualHeight-_docHeight)/(2*A)}else{Q=(_fileDocument[curFileId].Viewers[E].BigHeight-_docHeight)/(2*A)}}if(K==90){newTranslateX=Q;newTranslateY=-(F+addHeight);F=newTranslateX;Q=newTranslateY}else{if(K==180){newTranslateX=-(F+shadowWidth);newTranslateY=-(Q+addHeight);F=newTranslateX;Q=newTranslateY}else{if(K==270){newTranslateX=-(Q+addHeight-(marHeight-shadowWidth));newTranslateY=F;F=newTranslateX;Q=newTranslateY}}}if(N.style.msTransform!==undefined){N.style.msTransform="rotate("+K+"deg) scale("+A+") translateX("+F+"px) translateY("+Q+"px)"}else{if(N.style.MozTransform!==undefined){N.style.MozTransform="rotate("+K+"deg) scale("+A+") translateX("+F+"px) translateY("+Q+"px)"}else{if(N.style.OTransform!==undefined){N.style.OTransform="rotate("+K+"deg) scale("+A+") translateX("+F+"px) translateY("+Q+"px)"}else{if(N.style.webkitTransform!==undefined){N.style.webkitTransform="rotate("+K+"deg) scale("+A+") translateX("+F+"px) translateY("+Q+"px)"}else{N.style.transform="rotate("+K+"deg) scale("+A+") translateX("+F+"px) translateY("+Q+"px)"}}}}if(_viewerMode=="multi"){var B=_fileDocument[curFileId].GetShowIndex(O);var H=PreCountHeight(B);$("#_plcBigImg").scrollTop(Math.ceil(H));addShowDocIds(false)}if(_imageFormat=="Bitmap"){CssBitmapLoading(O)}}function CssBitmapLoading(D){var A=_fileDocument[curFileId].Viewers[D];DocWidthAndHeight();if(_viewerMode=="multi"){var E=A.Left;var G=0;var C=E+document.getElementById("page"+D).offsetLeft+A.ActualWidth/2-BitLoadWidth/2;G=G+_pageHeight/2-BitLoadHeight/2;for(var F=0;F<_totalPageCount;F++){var B=_fileDocument[curFileId].GetPageIndex(F);var I=PreCountHeight(F);var H=G+I;var A=_fileDocument[curFileId].Viewers[B];$("#pageImg"+B).css({"left":C+"px","top":H+"px"})}}else{var E=document.getElementById("imgBig").offsetLeft;var G=document.getElementById("imgBig").offsetTop;for(var F=0;F<_totalPageCount;F++){var B=_fileDocument[curFileId].GetPageIndex(F);$("#pageImg"+B).hide();if(B==D){$("#pageImg"+B).show()}}var A=_fileDocument[curFileId].Viewers[D];E=E+A.ActualWidth/2-BitLoadWidth/2;G=G+A.ActualHeight/2-BitLoadHeight/2;$("#pageImg"+D).css({"left":E+"px","top":G+"px"})}}function addShowPageIds(){if(currentActivePanel!=1){return}var H=new Array();var F=$("#_plcImgsThumbs").scrollTop();var G=$(".thumbnail").outerHeight(true);if(G==25){G=$(".thumbDiv").outerHeight(true)}var C=$("#_plcImgsThumbs").height();var B=parseInt(C/G)+1;var D=parseInt(F/G);if(_showPageIds.length==_totalPageCount){return}for(var E=0;E<B;E++){var I=D+E;if(I>-1&&I<_totalPageCount){var A=_fileDocument[curFileId].GetPageIndex(I);if(!_showPageIds.in_array(A)){_showPageIds.push(A);H.push(A)}}}refreshThumViewer(H)}_thumbErrorArray=new Array();function refreshThumViewer(A){var E="";E+=getRootPath();E+="/"+_resourceFolder+"/images/thumb_upload.gif";for(var D=0;D<A.length;D++){var F=A[D];var C=_fileDocument[curFileId].Viewers[F];if(C==null||C.PageIndex==null){continue}var B=ThumbSrc(F);$("#thumbnail_"+F).attr("src",B);$("#thumbnail_"+F).bind("error",function(){var I=this.id;var H=I.substring(I.indexOf("_")+1);if(_thumbErrorArray[H]==null){_thumbErrorArray[H]=0}var G=_thumbErrorArray[H]+1;if(G>3){$("#thumbnail_"+H).hide();_thumbErrorArray[H]=0;$("#refresh_"+H).show()}else{_thumbErrorArray[H]=G;$("#thumbnail_"+H).attr("src",E);$("#thumbnail_"+H).attr("src",ThumbSrc(H))}})}}function RefreshCurrentThumb(B,C,A){var D=(C)?C:window.event;if(window.event){D.canvelBubble=true}else{D.stopPropagation()}var E="";E=getRootPath();E+="/"+_resourceFolder+"/images/thumb_upload.gif";var F=_fileDocument[curFileId].Viewers[A];$("#refresh_"+A).hide();$("#thumbnail_"+A).show();if(F==null||F.PageIndex==null){return}$("#thumbnail_"+A).attr("src",E);$("#thumbnail_"+A).attr("src",ThumbSrc(A))}var curImportantRequest=new Array();function addShowDocIds(G){var F=new Array();curImportantRequest=new Array();var H=$("#_plcBigImg").scrollTop();var B=PrePageCount(H);var A=parseInt(_docHeight/_pageHeight)+1;var I;if(isInitOpen){A=A-1}I=B;for(var D=0;D<=A;D++){I=B+D;if(I>-1&&I<_totalPageCount){var C=_fileDocument[curFileId].GetPageIndex(I);if(!_showDocSrc.in_array(C)){F.push(C);curImportantRequest.push(C);break}}}if(F.length==0&&G){var E=B+A+10;I++;if(I<_totalPageCount&&I<E){var C=_fileDocument[curFileId].GetPageIndex(I);while(_showDocSrc.in_array(C)){I++;if(I<_totalPageCount&&I<E){C=_fileDocument[curFileId].GetPageIndex(I)}else{return}}F.push(C)}}refreshPageViewers(F)}function refreshPageViewers(C){if(_imageFormat=="Bitmap"){for(var A=0;A<C.length;A++){var E=C[A];var B=_fileDocument[curFileId].Viewers[E];if(B==null||B.PageIndex==null){continue}AddImage(E)}}else{if(C.length!=0){for(var A=0;A<_DocSrcRequest.length;A++){var D=_DocSrcRequest[A];if(!C.in_array(D)){if(_fileDocument[curFileId].Viewers[D].svgAjaxRequest){_fileDocument[curFileId].Viewers[D].svgAjaxRequest.abort();_DocSrcRequest.remove(D)}if(_fileDocument[curFileId].Viewers[D].charRectsAjaxRequest){_fileDocument[curFileId].Viewers[D].charRectsAjaxRequest.abort()}}}}for(var A=0;A<C.length;A++){var E=C[A];var B=_fileDocument[curFileId].Viewers[E];if(B==null||B.PageIndex==null){continue}if(_fileDocument[curFileId].ViewerSvgContent[E]!=null){svgContentToDiv(E)}else{if(!_DocSrcRequest.in_array(E)){addSvgContent(E,true)}}}}}function ChangeDivCssClass(A){$("div").removeClass("thumb_select");selectId="#lbl_"+A;$(selectId).addClass("thumb_select")}function changePageNavigationStyle(){var C=getProjectName();var A=C+"/"+_resourceFolder+"/images/RE_wt_iconsB1.png";$("#re_func_upPage").css("background","url('"+A+"') no-repeat -73px 0px");$("#re_func_upPage").hover(function(){$(this).css("background","url('"+A+"') no-repeat -73px 0px #727272")},function(){$(this).css("background","url('"+A+"') no-repeat -73px 0px")});$("#re_func_upPage").unbind("click");$("#re_func_upPage").bind("click",UpPage);$("#re_func_downPage").css("background","url('"+A+"') no-repeat -103px 0px");$("#re_func_downPage").hover(function(){$(this).css("background","url('"+A+"') no-repeat -103px 0px #727272")},function(){$(this).css("background","url('"+A+"') no-repeat -103px 0px")});$("#re_func_downPage").unbind("click");$("#re_func_downPage").bind("click",DownPage);currentPg=parseInt(_curCorrectPageId);if(currentPg==0){var B=C+"/"+_resourceFolder+"/images/RE_wt_iconsC1.png";$("#re_func_upPage").css("background","url('"+B+"') no-repeat -73px 0px");$("#re_func_upPage").hover(function(){$(this).css("background","url('"+B+"') no-repeat -73px 0px")},function(){$(this).css("background","url('"+B+"') no-repeat -73px 0px")});$("#re_func_upPage").unbind("click")}if(currentPg==_totalPageCount-1){var B=C+"/"+_resourceFolder+"/images/RE_wt_iconsC1.png";$("#re_func_downPage").css("background","url('"+B+"') no-repeat -103px 0px");$("#re_func_downPage").hover(function(){$(this).css("background","url('"+B+"') no-repeat -103px 0px")},function(){$(this).css("background","url('"+B+"') no-repeat -103px 0px")});$("#re_func_downPage").unbind("click")}}function resizeThumbViewerByCSS3(D,E){D=document.getElementById(D);var C=_fileDocument[curFileId].Viewers[E];var F=C.Rotate*90;var B=0;var A=0;if(C.thumbShowHeight<C.thumbShowWidth){if(F==90){B=-(C.thumbShowHeight-C.thumbShowWidth)/2;A=-(C.thumbShowHeight-C.thumbShowWidth)/2}else{if(F==270){B=(C.thumbShowHeight-C.thumbShowWidth)/2;A=(C.thumbShowHeight-C.thumbShowWidth)/2}}}else{if(F==90){B=-(C.thumbShowHeight-C.thumbShowWidth)/2;A=0}else{if(F==270){B=(C.thumbShowHeight-C.thumbShowWidth)/2;A=0}}}if(D.style.msTransform!==undefined){D.style.msTransform="rotate("+F+"deg) translateX("+B+"px) translateY("+A+"px)"}else{if(D.style.MozTransform!==undefined){D.style.MozTransform="rotate("+F+"deg) translateX("+B+"px) translateY("+A+"px)"}else{if(D.style.OTransform!==undefined){D.style.OTransform="rotate("+F+"deg) translateX("+B+"px) translateY("+A+"px)"}else{if(D.style.webkitTransform!==undefined){D.style.webkitTransform="rotate("+F+"deg) translateX("+B+"px) translateY("+A+"px)"}else{D.style.transform="rotate("+F+"deg) translateX("+B+"px) translateY("+A+"px)"}}}}}function ImageViewerAnnotationResize(E){if(_viewerMode=="single"){drawImageViewerAnnotations(E)}else{var B=_fileDocument[curFileId];for(var A=0;A<B.ViewerPageIndex.length;A++){var D=B.ViewerPageIndex[A];var C=_fileDocument[curFileId].Viewers[D];C.GetViewerLeftTop()}drawContinuesAnnotations()}}function showLoading(){$("#loading").show();if(_fileDocument[curFileId]==null){return}var A=_fileDocument[curFileId].GetPageIndex(_curCorrectPageId);if(_imageFormat=="Svg"){$("#pageImg"+A).remove()}else{$("#pageImg"+A).remove()}}function hideLoading(){$("#imgBig").show();$("#draw_canvas").show();$("#loading").hide();isInitOpen=false}function ChangeThumbScrollBar(C,E){if(currentActivePanel!=1){return}else{var A=$(".thumbnail").outerHeight(true);var B=$("#_plcImgsThumbs").scrollTop();var D=$("#_plcImgsThumbs")[0].scrollHeight;var G=$("#_plcImgsThumbs").height();var F=C*A;if(F>=B&&F<=(B+G-A)){}else{if(F<0){$("#_plcImgsThumbs").scrollTop(0)}else{if(F>D){$("#_plcImgsThumbs").scrollTop(D)}else{if(E){$("#_plcImgsThumbs").scrollTop(F)}else{if(F<(B+G)&&F>B){F=$("#_plcImgsThumbs").scrollTop()+A;$("#_plcImgsThumbs").scrollTop(F)}else{$("#_plcImgsThumbs").scrollTop(F)}}}}}}}function SortPage(K){var B=K.attr("id");idPosition=B.indexOf("_");var C=B.substring(idPosition+1);var J=_fileDocument[curFileId].GetShowIndex(C);_fileDocument[curFileId].ViewerPageIndex.remove(C);var E=$("#_thumbImg").children("div");var F=new Array();var G=new Array();var H="";for(index in E){var D=E.eq(index).attr("id");if(D!=null){idPosition=D.indexOf("_");var A=D.substring(idPosition+1);F[index]=A;G[A]=index;if(A==C){_fileDocument[curFileId].ViewerPageIndex.insertAt(index,A)}}}_fileDocument[curFileId].SortPage(G);var I=_fileDocument[curFileId].GetShowIndex(C);if(J!=I){ExchangeOrder(C,I)}}function ExchangeOrder(B,F){var D=$("#page"+B).clone();$("#page"+B).remove();if(F==_totalPageCount-1){var C=F-1;var E=_fileDocument[curFileId].GetPageIndex(C);$("#page"+E).after(D)}else{var A=F+1;var E=_fileDocument[curFileId].GetPageIndex(A);$("#page"+E).before(D)}if(_viewerMode=="multi"){MultiPageAnnotation()}}function ThumbStretch(){if(_isStretch){ThumbShrink();_isStretch=false}else{ThumbExpansion();_isStretch=true}}function RefreshPage(){var I=$("#_plcImgsThumbs").scrollTop();var A=$(".thumbnail").outerHeight(true);var J=parseInt(I/A);var E=$("#_plcImgsThumbs").height();var D=parseInt(E/A)+1;var B="";B=getRootPath();B+="/"+_resourceFolder+"/images/thumb_upload.gif";var K=getRootPath();K+="/"+_resourceFolder+"/images/upload.gif";for(var C=0;C<D+1;C++){var G=J+C;var H=_fileDocument[curFileId].GetPageIndex(G);var F=_fileDocument[curFileId].Viewers[H];if(F==null||F.PageIndex==null){continue}HidePageAnnotations(H,true);$("#thumbnail_"+H).attr("src",B);$("#thumbnail_"+H).attr("src",ThumbSrc(H));ShowPageAnnotations(H,true)}var H=_fileDocument[curFileId].GetPageIndex(_curCorrectPageId);var F=_fileDocument[curFileId].Viewers[H];$("#page"+H).attr("src",K);HidePageAnnotations(H,false);FileIsExist(H,false);if(isExist){document.getElementById("page"+H).src=getFolder("page")+"/"+H+".png"}else{if(_zoomListIndex<=maxIndex){RectifyZoom();if(F.Currentzoom>_actualZoomIndex){CreateNewImage(H)}}else{document.getElementById("page"+H).src=_fileDocument[curFileId].Viewers[H].GetSrc()}}ShowPageAnnotations(H,false)}var TwoButtons=[{text:"Submit",click:function(){$(this).dialog("close");TestFileMD5()}},{text:"Cancel",click:function(){$(this).dialog("close")}}];var NeButton=[{text:"Cancel",click:function(){$(this).dialog("close")}}];var dialogOpen=false;function ShowUploadDialog(){upDialogType="upload";$("#loading_div").hide();var C="<div class=descr>Upload a file to have it displayed in the viewer.</div><br/>";C+="<div><input id='FileToUpload' type='file' name='FileToUpload' class='input' onchange='FileCheck()'/></div><br/>";C+="<div id='_fileSize'></div><div id='error'></div><br/>";C+="<div class=descr>Supports:<br/>&nbsp&nbsp&nbspWord(.doc,.docx,.docm,.dotx,.dotm)<br/>&nbsp&nbsp&nbspExcel(.xls,.xlsx,.xlsm,.xltx)<br/>&nbsp&nbsp&nbspPowerPoint(.ppt,.pptx,.ppsx,.pptm,.potm,.potx,.ppsm)<br/>&nbsp&nbsp&nbspPDF(.pdf)<br/>&nbsp&nbsp&nbspTiff(.tiff,.tif)<br/>&nbsp&nbsp&nbspDICOM(.dcm)<br/>&nbsp&nbsp&nbspImage formats(.gif,.png,.jpeg,...)</div>";$("#content").html(C);$(".descr").css("color","#9d9d9d");$("#dialog").dialog({autoOpen:false,title:"File Upload",minWidth:600,height:480,resizable:true});$("#dialog").dialog("option","buttons",NeButton);showLoading();var B=(viewer_clientWidth-600)/2;var A=(viewer_clientHeight-480)/2;window.scrollTo(0,0);$("#dialog").dialog({position:[B,A]});$("#dialog").dialog("open");dialogOpen=true;$("#dialog").on("dialogbeforeclose",function(E,D){$("#loading_div").show();$("#loading").hide();if(!_isHaveDocument){DisableToolbar();_isDisabled=true}else{if(_isDisabled){EnableToolbar();_isDisabled=false}}dialogOpen=false})}function FileCheck(){newFileName=$("#FileToUpload").val();var A=getSuffix(newFileName);A=A.toLowerCase();$("#_fileSize").html("");if(!_fileFormat.in_array(A)){$("#error").html("Temporarily does not support this file format");$("#error").css("color","#ff0000");var B=$("#dialog").dialog("option","buttons").length;if(B==2){$("#dialog").dialog("option","buttons",NeButton)}AsyncRecord(A);return}else{$("#error").html("");var B=$("#dialog").dialog("option","buttons").length;if(B==1){$("#dialog").dialog("option","buttons",TwoButtons)}}var C=document.getElementById("FileToUpload").files[0];if(C){var D="Size:";if(C.size>1024*1024){D+=(Math.round(C.size*100/(1024*1024))/100).toString()+"MB"}else{D+=(Math.round(C.size*100/1024)/100).toString()+"KB"}}$("#_fileSize").html(D)}function AsyncRecord(A){A=A.substring(1);var C={action:"AsyncRecord",Suffix:A};var B={type:"POST",url:getServerHandlerUrl(),async:true,data:C,success:function(D){},error:function(D){}};$.ajax(B)}function IsExistSameFile(_fileMD5){var str={action:"IsExistFileMD5",fileMD5:_fileMD5};var response="";var options={type:"POST",url:getServerHandlerUrl(),async:false,data:str,success:function(result){result=eval("("+result+")");if(result.state=="success"){response=result.msg}},error:function(err){}};$.ajax(options);return response}function TestFileMD5(){showLoading();var A=new FileReader();blobSlice=File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice;file=document.getElementById("FileToUpload").files[0];chunkSize=2097152;chunks=Math.ceil(file.size/chunkSize);currentChunk=0;spark=new SparkMD5.ArrayBuffer();A.onload=function(D){var C=D.target.result;spark.append(C);currentChunk++;if(currentChunk<chunks){B()}else{var F=spark.end();var E=IsExistSameFile(F);if(E!=""){ParameterDocumentLoad(E);return}else{ajaxFileUpload()}}};function B(){var D=currentChunk*chunkSize;var C=D+chunkSize>=file.size?file.size:D+chunkSize;A.readAsArrayBuffer(blobSlice.call(file,D,C))}B()}function ajaxFileUpload(){$("#loading_div").html("0%");$.ajaxFileUpload({url:getCurrentAspx(),secureuri:false,fileElementId:"FileToUpload",dataType:"json",progress:function(A){if(A.lengthComputable){var B=Math.round(A.loaded*100/A.total).toString()+"%";$("#loading_div").html(B)}},success:function(B,A){$("#loading_div").html("Loading");if(typeof(B.error)!="undefined"){}else{ParameterDocumentLoad(B)}},error:function(C,B,A){$("#loading_div").html("Loading");alert(A);LoadErrorHandle()}});return false}var onlineButtons=[{text:"Open",click:function(){_isHaveDocument=true;if(onlineSrcCheck()){$(this).dialog("close");openOnlineDoc()}}},{text:"Cancel",click:function(){$(this).dialog("close")}}];function ShowOnlineDialog(){upDialogType="online";$("#loading_div").hide();$("#content").empty();var C="<div style='font-size:15px;font-weight:bold;'>Enter the URL to view the online document</div>";C+="<div style='font-size:15px;color:#666666'>(Must be http:// or https:// and a Word,Excel,PowerPoint,PDF,or other supported document)</div><br/>";C+="<input id='_onlineValue' style='font-size:12px;width:525px;height:25px;'></input>";C+="<div id='_onlineCheck' style='font-size:15px;'></div>";$("#content").append(C);$("#dialog").dialog({autoOpen:false,title:"Open an online document",minWidth:600,height:300,resizable:true});$("#dialog").dialog("option","buttons",onlineButtons);showLoading();var B=(viewer_clientWidth-600)/2;var A=(viewer_clientHeight-300)/2;window.scrollTo(0,0);$("#dialog").dialog({position:[B,A]});$("#dialog").dialog("open");dialogOpen=true;$("#dialog").on("dialogbeforeclose",function(E,D){$("#loading_div").show();$("#loading").hide();if(!_isHaveDocument){DisableToolbar();_isDisabled=true}else{if(_isDisabled){EnableToolbar();_isDisabled=false}}dialogOpen=false})}function onlineSrcCheck(){var B=$("#_onlineValue").val().trim();if(B==null||B==""){$("#_onlineCheck").html("(URL can not be empty!!!)");$("#_onlineCheck").css("color","#ff0000");return false}else{if(B.indexOf("http://")!=0&&B.indexOf("https://")!=0){$("#_onlineCheck").html("(Invalid URL,Please re-enter!!!)");$("#_onlineCheck").css("color","#ff0000");return false}else{var A=B.substring(B.lastIndexOf("."));A=A.toLowerCase();if(!_fileFormat.in_array(A)){$("#_onlineCheck").html("(Temporarily does not support this file format!!!)");$("#_onlineCheck").css("color","#ff0000");AsyncRecord(A);return false}}}return true}function openOnlineDoc(){showLoading();var A={type:"POST",url:getCurrentAspx(),async:false,data:{src:$("#_onlineValue").val()},success:function(B){ParameterDocumentLoad(B);upDialogType="upload"},error:function(){LoadErrorHandle()}};$.ajax(A)}var upDialogType="upload";function LoadErrorHandle(){window.document.title=_fileName;$("#loading").hide();if(_fid==null||_fid==""){_isHaveDocument=false;thumbHidden()}if(upDialogType=="upload"){ShowUploadDialog()}else{if(upDialogType=="online"){ShowOnlineDialog()}}}function InitializeVariables(){_showPageIds=new Array();_fileDocument=new Array();_showDocSrc=new Array();WidthArray=new Array();HeightArray=new Array();otherWidths=new Array();otherHeights=new Array();_thumbErrorArray=new Array();_pageErrorArray=new Array();outLine=new Array();_viewerMode="single";isInitOpen=true;$("#navi_pagePart").empty();CreatePagePart("#navi_pagePart");$("#_plcImgsThumbs").scrollTop(0);_recieveSvg=new Array();_curCorrectPageId=0;flagIndex=null;isAddShowDocIDs=0;plcImgHeight=0}function LoadServerDemoFile(fileName){str={action:"LoadServerFile",relativePath:fileName};_isHaveDocument=true;if(dialogOpen){$("#dialogOCR").remove();dialogOpen=false}if(ocrDialog){$("#dialogOCR").remove();ocrDialog=false}showLoading();var options={type:"POST",url:getServerHandlerUrl(),async:false,data:str,success:function(response){var arr=eval("("+response+")");if(arr.state=="success"){var IDName=arr.msg;var position=IDName.lastIndexOf("|");newFileName=IDName.substring(0,position);newFid=IDName.substring(position+1);if(_isDisabled){EnableToolbar();_isDisabled=false}window.document.title=newFileName;OnLoadReady()}else{$("#loading").hide();if(arr.msg=="The specified file can not be found"){FileNotFound()}else{alert(arr.msg)}}},error:function(err){}};$.ajax(options)}function SaveFile(_sortIndex){var includeAnnotation=document.getElementById("checkboxAnno").checked;showLoading();var str="";if(includeAnnotation){str={action:"SaveFile",fid:_fid,fileName:_fileName,password:curDocPassWord,sortIndex:_sortIndex,jsonDoc:GetJsonDoc()}}else{str={action:"SaveFile",fid:_fid,fileName:_fileName,password:curDocPassWord,sortIndex:_sortIndex,jsonDoc:""}}var options={type:"POST",url:getServerHandlerUrl(),async:false,data:str,success:function(response){var arr=eval("("+response+")");if(arr.state=="success"){saveFile=arr.msg;var options1={type:"POST",url:getCurrentAspx(),async:false,data:{RECommand:"FileSave",fid:_fid,fileName:saveFile},success:function(response){if(response!=null){if(response.indexOf("<!DOCTYPE html")!=-1){return}else{window.open(response)}}},error:function(err){}};$.ajax(options1);$("#loading").hide()}else{$("#loading").hide();if(arr.msg=="The specified file can not be found"){FileNotFound()}else{alert(arr.msg)}}},error:function(err){}};$.ajax(options)}function ConvertToTiff(C){var E=document.getElementById("checkboxAnno").checked;var B=1;if(_suffix==".pdf"||_wordFormat.in_array(_suffix)||_excelFormat.in_array(_suffix)||_pptFormat.in_array(_suffix)){B=$("#ratio").val();B=B.substring(0,B.length-1)/100}showLoading();var F;var D="";if(E){D={action:"ConvertToTiff",fid:_fid,fileName:_fileName,password:curDocPassWord,scaleValue:B,sortIndex:C,jsonDoc:GetJsonDoc()}}else{D={action:"ConvertToTiff",fid:_fid,fileName:_fileName,password:curDocPassWord,scaleValue:B,sortIndex:C,jsonDoc:""}}var A={type:"POST",url:getServerHandlerUrl(),async:false,data:D,success:function(G){OpenSpecifiedFile(G)},error:function(G){}};$.ajax(A);$("#loading").hide()}function ConvertToWord(B){var D=document.getElementById("checkboxAnno").checked;showLoading();var E;var C="";if(D){C={action:"ConvertToDOCX",fid:_fid,fileName:_fileName,password:curDocPassWord,sortIndex:B,jsonDoc:GetJsonDoc()}}else{C={action:"ConvertToDOCX",fid:_fid,fileName:_fileName,password:curDocPassWord,sortIndex:B,jsonDoc:""}}var A={type:"POST",url:getServerHandlerUrl(),async:false,data:C,success:function(F){OpenSpecifiedFile(F)},error:function(F){}};$.ajax(A);$("#loading").hide()}function PrintFile(B){var D=document.getElementById("checkboxAnno").checked;showLoading();var E;var C="";if(D){C={action:"PrintFile",fid:_fid,fileName:_fileName,password:curDocPassWord,sortIndex:B,jsonDoc:GetJsonDoc()}}else{C={action:"PrintFile",fid:_fid,fileName:_fileName,password:curDocPassWord,sortIndex:B,jsonDoc:""}}var A={type:"POST",url:getServerHandlerUrl(),async:false,data:C,success:function(F){OpenSpecifiedFile(F)},error:function(F){}};$.ajax(A);$("#loading").hide()}function GetJsonDoc(){var A=new Array();A=CopyData();return $.toJSON(A[curFileId])}function OpenSpecifiedFile(response){var arr=eval("("+response+")");if(arr.state=="error"){if(arr.msg=="The specified file can not be found"){FileNotFound()}else{alert(arr.msg)}}else{var name=arr.msg;saveFile=getFolder("output")+"/"+encodeURIComponent(name);if(document.all){window.open(saveFile)}else{if(JudgeBrowser()=="Chrome"){window.open(saveFile)}else{window.open(saveFile)}}}}function ShowDialog(C){var H="";var F="";var G="";if(C=="print"){if(_suffix==".pdf"){alert("The format of this file is pdf,No need for conversion");return}H="Print to PDF";F="Print"}else{if(C=="save"){var B=new Array(".pdf",".tif",".tiff",".png",".bmp",".RLE",".DIB",".jpg",".jpeg",".jfif",".jpe");if(!B.in_array(_suffix)&&_suffix!=".docx"&&_suffix!=".pptx"&&_suffix!=".xlsx"){alert("This feature is not yet open in the trial version");return}H="Save the Document";F="Save"}else{if(C=="convert"){if(_suffix==".tif"){alert("The format of this file is tif,No need for conversion");return}H="Convert to Tiff";F="Convert";G="scaling value:<select id='ratio'></select>"}else{if(C=="toWord"){H="Convert PDF to DOCX";F="Convert"}}}}$("#loading_div").hide();$("#content").empty();var A="<div id='_anno'><input type='checkbox' id='checkboxAnno'>include annotations</div><br/>";$("#content").append(A);if(G!=""&&(_suffix==".pdf"||_wordFormat.in_array(_suffix)||_excelFormat.in_array(_suffix)||_pptFormat.in_array(_suffix))){$("#content").append(G);for(var D=_zoomItems.length-5;D>=0;D--){$("#ratio").append($("<option></option>").html(_zoomItems[D]))}$("#ratio").val("100%").attr("selected",true)}$("#dialog").dialog({autoOpen:false,title:H,width:600,minWidth:400,height:230,buttons:[{text:F,click:function(){$("#dialog").dialog("close");SpecificOperate(C)}},{text:"Cancel",click:function(){$(this).dialog("close")}}],resizable:false});_fileDocument[curFileId].IsAnnos();if(_IsAnnos){$("#checkboxAnno").attr("checked",true);$("#_anno").css("color","#000000")}else{$("#checkboxAnno").attr("disabled",true);$("#_anno").css("color","#b2b0a7")}showLoading();var I=(viewer_clientWidth-600)/2;var E=(viewer_clientHeight-230)/2;window.scrollTo(0,0);$("#dialog").dialog({position:[I,E]});$("#dialog").dialog("open");dialogOpen=true;$("#dialog").on("dialogbeforeclose",function(K,J){$("#loading_div").show();$("#loading").hide();dialogOpen=false})}function SpecificOperate(D){var E="";if(_suffix==".pdf"||_tifFormat.in_array(_suffix)){var F=false;for(var B=0;B<_fileDocument[curFileId].ViewerPageIndex.length;B++){E+=_fileDocument[curFileId].ViewerPageIndex[B]+";";if(_fileDocument[curFileId].ViewerPageIndex[B]!=B){F=true}}if(!F){E=""}}if(D=="print"){PrintFile(E)}else{if(D=="save"){SaveFile(E)}else{if(D=="convert"){ConvertToTiff(E)}else{if(D=="toWord"){ConvertToWord(E)}else{var A=new Array();var C=new Array();for(var B=0;B<_totalPageCount;B++){if(indexCheckedArray[B]==1){A.push(_fileDocument[curFileId].GetPageIndex(B));C.push(B)}}if(D=="delete"){DeletePage(A)}else{if(D=="insert"){AddPages(C)}else{if(D=="sort"){}else{if(D=="combine"){CombineDocument()}else{if(D=="split"){SplitDocument(A)}}}}}}}}}}function CombineDocument(){showLoading();var data={action:"CombineDocument",fid:_fid,fileName:_fileName,docIndexArray:_fileDocument[curFileId].ViewerPageIndex,splitArray:IndexArray};var options={type:"POST",url:getServerHandlerUrl(),async:false,data:data,success:function(response){var arr=eval("("+response+")");if(arr.state=="success"){}else{alert(arr.msg)}},error:function(err){}};$.ajax(options);$("#loading").hide()}function SplitDocument(IndexArray){showLoading();var data={action:"SplitDocument",fid:_fid,fileName:_fileName,docIndexArray:_fileDocument[curFileId].ViewerPageIndex,splitArray:IndexArray};var options={type:"POST",url:getServerHandlerUrl(),async:false,data:data,success:function(response){var arr=eval("("+response+")");if(arr.state=="success"){}else{alert(arr.msg)}},error:function(err){}};$.ajax(options);$("#loading").hide()}var indexTable=false;var indexCheckedArray=new Array();function ShowProcessDialog(F){var A="";var D="";var C="";var E="Note:Separated by semicolon between index and index,for example:3;8;";var G="";var B="";if(F=="delete"){A="Delete Pages";D="Delete";C+="Select pages to be deleted:&nbsp;&nbsp;";G+="Meaning:Page 1,5,8 will be deleted from the document"}else{if(F=="insert"){A="Insert Empty Pages";D="Insert";C="Select the location you want to insert:&nbsp;&nbsp;"}else{if(F=="sort"){A="Sort Pages";D="Sort";C=""}else{if(F=="combine"){A="Combine Documents";D="Combine";CombineHandle();ProcessDialog(F,A,D);return}else{if(F=="split"){A="Split Document";D="Split";C="Select the split page indexs:&nbsp;&nbsp;";G="Meaning:The source file will be divided into three smaller documents,[Page1 - Page3],[Page4 - Page8] and the rest pages";B+="<input type='checkbox' id='checkboxAnno'>include annotations"}}}}}BaseIndexHandle(C,E,G,B);ProcessDialog(F,A,D)}function ProcessDialog(D,A,B){$("#dialog").dialog({autoOpen:false,title:A,width:600,minWidth:400,height:300,buttons:[{text:B,click:function(){$(this).dialog("close");SpecificOperate(D)}},{text:"Cancel",click:function(){$(this).dialog("close")}}],resizable:false});_fileDocument[curFileId].IsAnnos();if(_IsAnnos){$("#checkboxAnno").attr("checked",true);$("#_anno").css("color","#000000")}else{$("#checkboxAnno").attr("disabled",true);$("#_anno").css("color","#b2b0a7")}showLoading();var E=(viewer_clientWidth-600)/2;var C=(viewer_clientHeight-300)/2;window.scrollTo(0,0);$("#dialog").dialog({position:[E,C]});dialogOpen=true;$("#dialog").dialog("open");$("#dialog").on("dialogbeforeclose",function(G,F){$("#loading_div").show();$("#loading").hide();dialogOpen=false})}function BaseIndexHandle(D,E,G,C){$("#loading_div").hide();$("#content").empty();var F="#000000";var B="#000000";if(JudgeBrowser()=="FireFox"){F="#bbbbbb";B="#dddddd"}D="<div id='_processIndexPanel'><div style='float:left;'>"+D+"</div><input id='_pageIdList' style='float:left;position:relative;width:213px;height:15px;' oninput='IndexChange(event)'><div id='_indexPanelIcon' style='float:left;width:15px;height:19px;border:1px solid "+F+";border-bottom:1px solid "+B+";border-left:none;'></div></div><br/><br/>";D+="<div id='_anno'>"+C+"</div><br/>";D+="<div id='_note' style='float:left;color:#999999;'>"+E+"<br/><br/>";D+="<div style='float:left;color:#999999;'>"+G+"</div></div>";$("#content").append(D);CreateIndexPanel("#_processIndexPanel",F);for(var A=0;A<_totalPageCount;A++){indexCheckedArray[A]=0}$("[name = indexCheckbox]:checkbox").bind("click",function(){var H=this.id;var K=document.getElementById(H).checked;var L=H.substring(H.indexOf("_")+1);if(K){indexCheckedArray[L]=1}else{indexCheckedArray[L]=0}var J="";for(var I=0;I<_totalPageCount;I++){if(indexCheckedArray[I]==1){J+=(I+1)+";"}}$("#_pageIdList").val(J)});indexTable=false;$("#_IndexPanel").hide();$("#_indexPanelIcon").bind("click",function(){if(indexTable){$("#_IndexPanel").hide();$("#_note").show();indexTable=false}else{$("#_IndexPanel").show();var I=$("#_pageIdList").position().left;var J=$("#_pageIdList").position().top+$("#_pageIdList").outerHeight();$("#_IndexPanel").css({left:I+"px",top:J+"px"});$("#_note").hide();indexTable=true;var K=$("#_pageIdList").val().split(";");for(var H=0;H<K.length;H++){var L=K[H]-1;if(L>-1&&L<_totalPageCount){$("#process_"+L).attr("checked",true)}}}})}function CombineHandle(){$("#loading_div").hide();$("#content").empty();var B="Select One ";B="<div id='_processIndexPanel'><div style='float:left;'>"+B+"</div><input id='_pageIdList' style='float:left;position:relative;width:213px;height:15px;' oninput='IndexChange(event)'><div id='_indexPanelIcon' style='float:left;width:15px;height:19px;border:1px solid "+borderColor+";border-bottom:1px solid "+borderBColor+";border-left:none;'></div></div><br/><br/><br/>";B+="<div id='_note' style='float:left;color:#999999;'>"+noteContent+"<br/><br/>";B+="<div style='float:left;color:#999999;'>"+meanContent+"</div></div>";$("#content").append(B);CreateIndexPanel("#_processIndexPanel",borderColor);for(var A=0;A<_totalPageCount;A++){indexCheckedArray[A]=0}$("[name = indexCheckbox]:checkbox").bind("click",function(){var C=this.id;var F=document.getElementById(C).checked;var G=C.substring(C.indexOf("_")+1);if(F){indexCheckedArray[G]=1}else{indexCheckedArray[G]=0}var E="";for(var D=0;D<_totalPageCount;D++){if(indexCheckedArray[D]==1){E+=(D+1)+";"}}$("#_pageIdList").val(E)});indexTable=false;$("#_IndexPanel").hide();$("#_indexPanelIcon").bind("click",function(){if(indexTable){$("#_IndexPanel").hide();$("#_note").show();indexTable=false}else{$("#_IndexPanel").show();var D=$("#_pageIdList").position().left;var E=$("#_pageIdList").position().top+$("#_pageIdList").outerHeight();$("#_IndexPanel").css({left:D+"px",top:E+"px"});$("#_note").hide();indexTable=true;var F=$("#_pageIdList").val().split(";");for(var C=0;C<F.length;C++){var G=F[C]-1;if(G>-1&&G<_totalPageCount){$("#process_"+G).attr("checked",true)}}}})}function IndexChange(C){var D=$("#_pageIdList").val().split(";");for(var B=0;B<_totalPageCount;B++){$("#process_"+B).prop("checked",false)}for(var B=0;B<D.length-1;B++){var A=D[B]-1;if(A>-1&&A<_totalPageCount){indexCheckedArray[A]=1;$("#process_"+A).prop("checked",true)}}}function CreateIndexPanel(B,D){var E="<div id='_IndexPanel' style='position:absolute;background:#ffffff;border:1px solid "+D+";border-top:none;width:232px;border-radius:2px;height:120px;overflow:auto;'><div style='width:210px;height:auto;'>";var A="<table style='width:100%;height:auto;line-height:20px;><tr>'";for(var C=0;C<_totalPageCount;C++){if(C%4==0){A+="</tr><tr>"}A+="<td><div><input type='checkbox' id='process_"+C+"' name='indexCheckbox'><label for='process_"+C+"'>"+(C+1)+"</label></div></td>"}A+="</table>";E+=A+"</div></div>";$(B).append(E)}var ocrLanguage=new Array("English","German","French","Italian","Dutch","Portuguese","Spanish","Arabic");function OCRDocument(){$("#loading_div").hide();$("#content").empty();var E="OCR Language:&nbsp;&nbsp;&nbsp;<select id='_ocrLanguage' style='width:110px;'></select><br/><br/>";$("#content").append(E);for(var A=0;A<ocrLanguage.length;A++){$("#_ocrLanguage").append($("<option></option>").html(ocrLanguage[A]))}$("#_ocrLanguage").val("English").attr("selected",true);var D="OCR PageIndex:&nbsp;&nbsp;&nbsp;<select id='_ocrPageIndex' style='width:110px;'></select>";$("#content").append(D);for(var A=1;A<=_totalPageCount;A++){$("#_ocrPageIndex").append($("<option></option>").html(A))}$("#_ocrPageIndex").val(_curCorrectPageId+1).attr("selected",true);$("#dialog").dialog({autoOpen:false,title:"OCR Page Text",width:600,minWidth:400,height:230,buttons:[{text:"OCRText",click:function(){$(this).dialog("close");OCRRequest()}},{text:"Cancel",click:function(){$(this).dialog("close")}}],resizable:false});showLoading();var B=(viewer_clientWidth-600)/2;var C=(viewer_clientHeight-230)/2;window.scrollTo(0,0);$("#dialog").dialog({position:[B,C]});dialogOpen=true;$("#dialog").dialog("open");$("#dialog").on("dialogbeforeclose",function(G,F){$("#loading_div").show();$("#loading").hide();dialogOpen=false})}var ocrTextPageIndex=0;function OCRRequest(){var pageIndex=$("#_ocrPageIndex").val()-1;var language=$("#_ocrLanguage").val();var str={action:"OCRDocumentText",pageIndex:pageIndex,fid:_fid,fileName:_fileName,password:curDocPassWord,Language:language};var options={type:"POST",url:getServerHandlerUrl(),async:false,data:str,success:function(result){result=eval("("+result+")");if(result.state=="success"){ocrTextPageIndex=pageIndex;ShowOCRText(result.msg)}else{alert(result.msg)}},error:function(err){}};$.ajax(options)}var ocrDialog=false;function ShowOCRText(D){$("#loading").hide();$("#customPanel").append("<div id='dialogOCR' style='border:2px solid #b2b0a7'><p id='ocrContent'></p></div>");var B="<div style='width:465px;height:310px;overflow:auto;font-family:Calibri;font-size:13px;box-shadow:1px 1px 1px #000000 inset;'><div style='margin-top:3px;margin-left:3px;width:auto;height:auto;'>"+D+"</div><div>";$("#ocrContent").append(B);$("#dialogOCR").dialog({autoOpen:false,title:"Page Text",width:500,minWidth:400,height:400,buttons:[],resizable:false});var C=(viewer_clientWidth-500)/2;var A=(viewer_clientHeight-400)/2;window.scrollTo(0,0);$("#dialogOCR").dialog({position:[C,A]});ocrDialog=true;$("#dialogOCR").dialog("open");$("#dialogOCR").on("dialogbeforeclose",function(F,E){$("#dialogOCR").remove();ocrDialog=false})}var _loadAnnosPanelShow=false;function LoadAnnos(loadAnnosId){noSelectAnno();var id=loadAnnosId.id;$(".showByDrag").removeClass("mouseStyleAnnotation");$(".showByDrag").addClass("mouseStyleMove");RemoveAnnoSelectDraw();if(_loadAnnosPanelShow){$("#_loadAnnosPanel").hide();_loadAnnosPanelShow=false}else{HideAllPropanel();$("#_loadAnnosPanel").show();_loadAnnosPanelShow=true;var offWidth=$("#"+id).offset().left;var offHeight=$("#"+id).offset().top+$("#"+id).outerHeight(true);$("#_loadAnnosPanel").css({left:offWidth,top:offHeight,});$("#annoListTile").show();$("#_annoListTitle").html("Please waite......");$("#annoList").hide();$("#loadAnnos").hide();var str={action:"GetAnnosNameList",fid:_fid,fileName:_fileName};var options={type:"POST",url:getServerHandlerUrl(),async:true,data:str,success:function(response){result=eval("("+response+")");var annoNameList=result.msg.split(";");if(annoNameList.length-1==0){$("#_annoListTitle").html("No comments information");cancelLoadAnnoFiles()}else{$("#annoListTile").hide();$("#annoList").show();$("#_annoList").empty();annoListTextArray=new Array();$("#_annoList").append("<table id='_annoListTable'></table>");for(var i=0;i<annoNameList.length-1;i++){var position=annoNameList[i].indexOf(",");var fileName=annoNameList[i].substring(0,position);var time=annoNameList[i].substring(position+1);var str="<tr id='_annoList_"+i+"_item'><td><input type='checkbox' id='_annoList_"+i+"' style='text-align:center;line-height:25px;' name='checkbox'><label class='_annoListText' id='_annoList_"+i+"_text' for='_annoList_"+i+"' style='font-weight:bold;'>"+fileName+"</label></td>";str+="<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><label>["+time+"]</label></td><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>";str+="<td><div class='_annoListDelete' id='_annoList_"+i+"_delete' Onclick='DeleteAnnoXmlFile(this);'></div></td></tr>";$("#_annoListTable").append(str);TargetHover("#_annoList_"+i+"_delete",true);annoListTextArray.push("_annoList_"+i+"_text")}$("#loadAnnos").show()}},error:function(err){$("#_loadAnnosPanel").hide();_loadAnnosPanelShow=false}};$.ajax(options)}}function DeleteAnnoXmlFile(E){var B=confirm("Are you sure to delete this annotation group!");if(B==true){var F=E.id;var D=F.lastIndexOf("_");var C=F.substring(0,D);var A=$("#"+C+"_text").html();DeleteFile(A);$("#"+C+"_item").remove();annoListTextArray.remove(C+"_text");if(annoListTextArray.length==0){$("#annoList").hide();$("#loadAnnos").hide();$("#annoListTile").show();$("#_annoListTitle").html("No comments information");$("#_exAnnoFileList").html("No comments information");$("#saveAnnos").hide();cancelLoadAnnoFiles()}}}function DeleteFile(A){$.post(getServerHandlerUrl(),{"action":"DeleteAnnoFile","fid":_fid,"fileName":A+".xml"})}var _saveAnnosPanelShow=false;function SaveAnnos(B){noSelectAnno();var D=B.id;if(_saveAnnosPanelShow){$("#_saveAnnosPanel").hide();_saveAnnosPanelShow=false}else{HideAllPropanel();$("#_saveAnnosPanel").show();_saveAnnosPanelShow=true;$("#_annoName").val(annoSaveName);var C=$("#"+D).offset().left;var A=$("#"+D).offset().top+$("#"+D).outerHeight(true);$("#_saveAnnosPanel").css({left:C,top:A,});modeRadioChange()}}function AddPage(F){var I=_fileDocument[curFileId].GetPageIndex(_curCorrectPageId);for(var H=0;H<F.length;H++){var B=F[H];var E=_fileDocument[curFileId].GetPageIndex(B);var L=WidthArray[E];var G=HeightArray[E];_fileDocument[curFileId].AddPage(B);var K=_fileDocument[curFileId].GetPageIndex(B);WidthArray[K]=L;HeightArray[K]=G;if(_imageFormat=="Bitmap"){var D="<img class='docImages' id='page"+K+"' style='width:"+L+"px;height:"+G+"px;background:#ffffff'/>"}else{var D="<div class='docImages' id='page"+K+"' style='width:"+L+"px;height:"+G+"px;background:#ffffff;'>"}beforeId="#page"+E;$(beforeId).before(D);$("#page"+K).css("border","1px solid #000000");$("#page"+K).css("box-shadow","3px 3px 0px #000000");_showDocSrc.push(K);var J="<div class='thumbnail' id='lbl_"+K+"' onclick='ChangePg("+K+")'>";J+="<div class='thumbDiv' id='thumbDiv_"+K+"' style='width:"+_thumbWidth+"px;height:"+_thumbHeight+"px;background:#ffffff;'></div></div>";J+="<div id='thumbPgId_"+K+"' class='thumbPgId'>"+(B+1)+"</div></div>";beforeId="#lbl_"+E;$(beforeId).before(J)}$("#pageIdList").empty();for(var H=1;H<=_totalPageCount;H++){var A=H+" / "+_totalPageCount;var C=H;$("#pageIdList").append($("<option></option>").val(C).html(A))}ChangePg(K)}function AjaxAddPages(addArray){var indexStr="";for(var i=0;i<addArray.length;i++){indexStr+=addArray[i]+";"}var str={action:"AddPages",fid:_fid,fileName:_fileName,addIndexs:indexStr};var options={type:"POST",url:getServerHandlerUrl(),async:false,data:str,success:function(response){var result=eval("("+response+")");if(result.state=="success"){var arr=result.msg;var tempWidthArray=new Array();var tempHeightArray=new Array();_size=arr.pageSize.split(";");for(var i=0;i<_size.length-1;i++){var position=_size[i].indexOf("|");var width=_size[i].substring(0,position);var height=_size[i].substring(position+1);var regEx=new RegExp(/[^0-9]/);if(regEx.exec(width)!=null&&regEx.exec(width)!="."){tempWidthArray[i]=Math.round(width.replace(regEx.exec(width),"."))}else{tempWidthArray[i]=Math.round(width)}if(regEx.exec(height)!=null&&regEx.exec(height)!="."){tempHeightArray[i]=Math.round(height.replace(regEx.exec(height),"."))}else{tempHeightArray[i]=Math.round(height)}AddPage(addArray,tempWidthArray,tempHeightArray)}}else{alert(result.msg)}},error:function(err){alert(err)}};$.ajax(options)}function addDocument(currentPg){$.post(getServerHandlerUrl(),{"action":"AddPageToFile","Fid":_fid},function(result,status){result=eval("("+result+")");if(result.state=="success"){var arr=result.msg;_totalPageCount=parseInt(arr);$("#totalPageIndex").text(_totalPageCount)}else{alert(result.msg)}})}function DeletePage(G){var I=window.confirm("Are you sure to delete? All deleted pages will not exist anymore.");if(I!=true){return false}var C=_fileDocument[curFileId].GetPageIndex(_curCorrectPageId);var D=C;for(var H=0;H<G.length;H++){var F=G[H];var B=_fileDocument[curFileId].GetShowIndex(F);_totalPageCount--;deleteId="lbl_"+F;$("#"+deleteId).remove();deleteId="page"+F;$("#"+deleteId).remove();_fileDocument[curFileId].DeletePage(B);RefreshDeleteMsg(F);if(F==C){_curCorrectPageId=0;var D=_fileDocument[curFileId].GetPageIndex(B);if(D==null){D=_totalPageCount-1}C=D}}if(_totalPageCount==0){_fileName="RasterEdge WebViewer";_fid="";$("#_plcBigImg").scrollTop(0);LoadErrorHandle()}else{$("#totalPageIndex").text(_totalPageCount);$("#pageIdList").empty();for(var H=1;H<=_totalPageCount;H++){var A=H+" / "+_totalPageCount;var E=H;$("#pageIdList").append($("<option></option>").val(E).html(A))}ChangePg(D)}}function RefreshDeleteMsg(A){_showPageIds.remove(A);_showDocSrc.remove(A);_fileDocument[curFileId].ViewerPageIndex.remove(A);WidthArray[A]=0;HeightArray[A]=0;_maxWidth=WidthArray.max();_maxHeight=HeightArray.max()}function btnRotate90(){pageIndex=parseInt(_curCorrectPageId);pageIndex=_fileDocument[curFileId].GetPageIndex(pageIndex);thumbId="thumbnail_"+pageIndex;_fileDocument[curFileId].Viewers[pageIndex].ChangeRotate("1");ChangeViewerPosition(pageIndex);resizeDocViewerByCSS3("imgBig",pageIndex);resizeThumbViewerByCSS3(thumbId,pageIndex);RotateAnnotations(pageIndex,_fileDocument[curFileId].Viewers[pageIndex].Rotate)}function addBtnRotate(){var B=getProjectName();var A=B+"/"+_resourceFolder+"/images/RE_wt_iconsA1.png";$("#navi_rotate").css("background","url('"+A+"') no-repeat -762px 0px");TargetHover("#navi_rotate",true);if(signRotate==0){$("#navi_rotate").bind("click",btnRotate90);signRotate=1}}function removeBtnRotate(){var B=getProjectName();var A=B+"/"+_resourceFolder+"/images/RE_wt_iconsB1.png";$("#navi_rotate").css("background","url('"+A+"') no-repeat -762px 0px");TargetHover("#navi_rotate",false);if(signRotate==1){$("#navi_rotate").unbind("click");signRotate=0}}function btnRotate180(){pageIndex=parseInt(_curCorrectPageId);pageIndex=_fileDocument[curFileId].GetPageIndex(pageIndex);thumbId="thumbnail_"+pageIndex;_fileDocument[curFileId].Viewers[pageIndex].ChangeRotate("2");ChangeViewerPosition(pageIndex);resizeDocViewerByCSS3("imgBig",pageIndex);resizeThumbViewerByCSS3(thumbId,pageIndex);RotateAnnotations(pageIndex,_fileDocument[curFileId].Viewers[pageIndex].Rotate)}function btnRotate270(){pageIndex=parseInt(_curCorrectPageId);pageIndex=_fileDocument[curFileId].GetPageIndex(pageIndex);thumbId="thumbnail_"+pageIndex;_fileDocument[curFileId].Viewers[pageIndex].ChangeRotate("-1");ChangeViewerPosition(pageIndex);resizeDocViewerByCSS3("imgBig",pageIndex);resizeThumbViewerByCSS3(thumbId,pageIndex);RotateAnnotations(pageIndex,_fileDocument[curFileId].Viewers[pageIndex].Rotate)}function btnFull(){var B=getProjectName();var A=B+"/"+_resourceFolder+"/images/RE_wt_iconsA1.png";if(!_isFull){origiWidth=$(".re_content").width();offWidth=$(".re_content").offset().left;ChangeControlSize();_isFull=true;$(".re_func_full").css("background","url('"+A+"') no-repeat -513px 0px");TargetHover(".re_func_full",true)}else{RestoreSize();ContentCss();_isFull=false;$(".re_func_full").css("background","url('"+A+"') no-repeat -545px 0px");TargetHover(".re_func_full",true)}CommentsPosition()}function ChangeFooterStyle(){$("#pageIdList").empty();InitBtnCss();for(var A=1;A<=_totalPageCount;A++){var B=A+" / "+_totalPageCount;var C=A;$("#pageIdList").append($("<option></option>").val(C).html(B))}$("#pageIdList").bind("change",ChangeItem)}function InitBtnCss(){sym=new Array(false,false);var B=getProjectName();var A=B+"/"+_resourceFolder+"/images/RE_wt_iconsB1.png";$("#navi_first").css("background","url('"+A+"') no-repeat -635px 0px");TargetHover("#navi_first",false);$("#navi_pre").css("background","url('"+A+"') no-repeat -613px 0px");TargetHover("#navi_pre",false);A=B+"/"+_resourceFolder+"/images/RE_wt_iconsB1.png";$("#navi_ne").css("background","url('"+A+"') no-repeat -684px 0px");TargetHover("#navi_ne",false);$("#navi_last").css("background","url('"+A+"') no-repeat -662px 0px");TargetHover("#navi_last",false)}function ChangeItem(){var B=$(this).val()-1;var A=_fileDocument[curFileId].GetPageIndex(B);var C=true;if(B>parseInt(_curCorrectPageId)){C=false}ChangeThumbScrollBar(B,C);ChangePg(A);$("#pageIdList").blur()}function ChangeBtnStyle(){var C=parseInt(_curCorrectPageId);var B=getProjectName();if(C==0){if(sym[0]){var A=B+"/"+_resourceFolder+"/images/RE_wt_iconsB1.png";$("#navi_first").css("background","url('"+A+"') no-repeat -635px 0px");TargetHover("#navi_first",false);$("#navi_first").unbind("click");$("#navi_pre").css("background","url('"+A+"') no-repeat -613px 0px");TargetHover("#navi_pre",false);$("#navi_pre").unbind("click");sym[0]=false}if(!sym[1]){A=B+"/"+_resourceFolder+"/images/RE_wt_iconsA1.png";$("#navi_ne").css("background","url('"+A+"') no-repeat -684px 0px");TargetHover("#navi_ne",true);$("#navi_ne").bind("click",DownPage);$("#navi_last").css("background","url('"+A+"') no-repeat -662px 0px");TargetHover("#navi_last",true);$("#navi_last").bind("click",LastPage);sym[1]=true}}else{if(C==_totalPageCount-1){if(sym[1]){A=B+"/"+_resourceFolder+"/images/RE_wt_iconsB1.png";$("#navi_ne").css("background","url('"+A+"') no-repeat -684px 0px");TargetHover("#navi_ne",false);$("#navi_ne").unbind("click");$("#navi_last").css("background","url('"+A+"') no-repeat -662px 0px");TargetHover("#navi_last",false);$("#navi_last").unbind("click");sym[1]=false}if(!sym[0]){var A=B+"/"+_resourceFolder+"/images/RE_wt_iconsA1.png";$("#navi_first").css("background","url('"+A+"') no-repeat -635px 0px");TargetHover("#navi_first",true);$("#navi_first").bind("click",FirstPage);$("#navi_pre").css("background","url('"+A+"') no-repeat -613px 0px");TargetHover("#navi_pre",true);$("#navi_pre").bind("click",UpPage);sym[0]=true}}else{if(!sym[0]){var A=B+"/"+_resourceFolder+"/images/RE_wt_iconsA1.png";$("#navi_first").css("background","url('"+A+"') no-repeat -635px 0px");TargetHover("#navi_first",true);$("#navi_first").bind("click",FirstPage);$("#navi_pre").css("background","url('"+A+"') no-repeat -613px 0px");TargetHover("#navi_pre",true);$("#navi_pre").bind("click",UpPage);sym[0]=true}if(!sym[1]){A=B+"/"+_resourceFolder+"/images/RE_wt_iconsA1.png";$("#navi_ne").css("background","url('"+A+"') no-repeat -684px 0px");TargetHover("#navi_ne",true);$("#navi_ne").bind("click",DownPage);$("#navi_last").css("background","url('"+A+"') no-repeat -662px 0px");TargetHover("#navi_last",true);$("#navi_last").bind("click",LastPage);sym[1]=true}}}}function FirstPage(){var A=_fileDocument[curFileId].GetPageIndex(0);var B=true;if(0>parseInt(_curCorrectPageId)){B=false}ChangeThumbScrollBar(0,B);ChangePg(A)}function LastPage(){var A=_fileDocument[curFileId].GetPageIndex(_totalPageCount-1);var B=true;if(_totalPageCount-1>parseInt(_curCorrectPageId)){B=false}ChangeThumbScrollBar(_totalPageCount-1,B);ChangePg(A)}function UpPage(){var A=parseInt(_curCorrectPageId);if(A>0){to_page=A-1;ChangeThumbScrollBar(to_page,true);to_page=_fileDocument[curFileId].GetPageIndex(to_page);ChangePg(to_page)}return false}function DownPage(){var A=parseInt(_curCorrectPageId);totalPages=_totalPageCount-1;if(A<totalPages){to_page=A+1;ChangeThumbScrollBar(to_page,false);to_page=_fileDocument[curFileId].GetPageIndex(to_page);ChangePg(to_page)}return false}function ChangeDocScrollBar(D,C){var G=PreCountHeight(D);$("#_plcBigImg").scrollTop(Math.ceil(G)+5);var F=_fileDocument[curFileId].GetPageIndex(D);var A=WidthArray.indexOf(_maxWidth);_fileDocument[curFileId].Viewers[A].GetFirstViewerLeftTop();var E=_fileDocument[curFileId].Viewers[A].ActualWidth;if(!otherWidths.in_array(F)){$("#_plcBigImg").scrollLeft(0)}else{(otherWidths.in_array(F))}_fileDocument[curFileId].Viewers[F].GetViewerLeftTop();var B=(E-_fileDocument[curFileId].Viewers[F].ActualWidth)/2;$("#_plcBigImg").scrollLeft(Math.ceil(B)+3)}function BindZoomEvent(){$("#zoomList").bind("change",setZoomValue)}function setZoomValue(){_zoomListIndex=parseInt($(this).get(0).selectedIndex);var E=parseInt(_curCorrectPageId);var D=_fileDocument[curFileId].GetPageIndex(E);var C=_fileDocument[curFileId].Viewers[D];if(_zoomListIndex>=0&&_zoomListIndex<=15){var B=_zoomItems[_zoomListIndex].length;var A=_zoomItems[_zoomListIndex].substring(0,B-1);_pageSizeType=2;_zoomIndex=parseFloat(A)/10;ChangeViewerPosition(D);resizeDocViewerByCSS3("imgBig",D);if(_imageFormat=="Bitmap"){if(_zoomListIndex<=maxIndex){RectifyZoom();if(C.Currentzoom>_actualZoomIndex){CreateNewImage(D)}}}ImageViewerAnnotationResize(D);CSSZoomInOrOut()}else{map()}$("#zoomList").blur()}function map(){var C=parseInt(_curCorrectPageId);C=_fileDocument[curFileId].GetPageIndex(C);var B=_fileDocument[curFileId].Viewers[C];switch(_zoomListIndex){case 17:btnOneToOne();_zoomListIndex=8;break;case 18:var A=(_docHeight/B.OneToOne_Height*100).toFixed(2);btnBestFit(A);_zoomListIndex=setPercentPosition(A);break;case 19:var A=(_docWidth/B.OneToOne_Width*100).toFixed(2);_zoomListIndex=setPercentPosition(A);btnFitWidth(A);break}}function setPercentPosition(B){var E=_zoomItems.length;for(var C=0;C<E-3;C++){var D=_zoomItems[C].length;var A=parseInt(_zoomItems[C].substring(0,D-1));if(B>=parseFloat(A)){return C}}return E-4}function btnZoomIn(){var D=_zoomRatio*_zoomIndex;var C=$("#_plcBigImg").scrollTop()/D;var A=$("#_plcBigImg").scrollLeft()/D;pageIndex=parseInt(_curCorrectPageId);var B=_fileDocument[curFileId].GetPageIndex(pageIndex);var E=_fileDocument[curFileId].Viewers[B];_pageSizeType=2;ChangeZoomIndex("1");ChangeViewerPosition(B);resizeDocViewerByCSS3("imgBig",B);if(_imageFormat=="Bitmap"){if(_zoomListIndex<=maxIndex){RectifyZoom();if(E.Currentzoom>_actualZoomIndex){CreateNewImage(B)}}}$("#_plcBigImg").scrollTop(C*_zoomRatio*_zoomIndex);$("#_plcBigImg").scrollLeft(A*_zoomRatio*_zoomIndex);ImageViewerAnnotationResize(B);CSSZoomInOrOut()}function btnZoomOut(){var C=_zoomRatio*_zoomIndex;var B=$("#_plcBigImg").scrollTop()/C;var A=$("#_plcBigImg").scrollLeft()/C;pageIndex=parseInt(_curCorrectPageId);actualIndex=_fileDocument[curFileId].GetPageIndex(pageIndex);_pageSizeType=2;ChangeZoomIndex("-1");ChangeViewerPosition(actualIndex);resizeDocViewerByCSS3("imgBig",actualIndex);$("#_plcBigImg").scrollTop(B*_zoomRatio*_zoomIndex);$("#_plcBigImg").scrollLeft(A*_zoomRatio*_zoomIndex);ImageViewerAnnotationResize(actualIndex);CSSZoomInOrOut()}var _zoomInFlag=true;var _zoomOutFlag=true;function CSSZoomInOrOut(){var B=getProjectName();var A=B+"/"+_resourceFolder+"/images/RE_wt_iconsB1.png";if(_zoomListIndex==0){$("#navi_zoomIn").css("background","url('"+A+"') no-repeat -735px 0px");TargetHover("#navi_zoomIn",false);if(_zoomInFlag){$("#navi_zoomIn").removeAttr("onClick");$("#navi_zoomIn").unbind("click");_zoomInFlag=false}}else{if(_zoomListIndex==15){$("#navi_zoomOut").css("background","url('"+A+"') no-repeat -707px 0px");TargetHover("#navi_zoomOut",false);if(_zoomOutFlag){$("#navi_zoomOut").removeAttr("onClick");$("#navi_zoomOut").unbind("click");_zoomOutFlag=false}}else{iconUrl1=B+"/"+_resourceFolder+"/images/RE_wt_iconsA1.png";if(!_zoomInFlag){$("#navi_zoomIn").css("background","url('"+iconUrl1+"') no-repeat -735px 0px");TargetHover("#navi_zoomIn",true);$("#navi_zoomIn").bind("click",btnZoomIn);_zoomInFlag=true}if(!_zoomOutFlag){$("#navi_zoomOut").css("background","url('"+iconUrl1+"') no-repeat -707px 0px");TargetHover("#navi_zoomOut",true);$("#navi_zoomOut").bind("click",btnZoomOut);_zoomOutFlag=true}}}}function ChangeZoomIndex(D){if(D=="-1"){_zoomListIndex++;if(_zoomListIndex>15){_zoomListIndex=15}}else{if(D=="1"){_zoomListIndex--;if(_zoomListIndex<0){_zoomListIndex=0}}}$("#zoomList").val(_zoomItems[_zoomListIndex]);var B=_zoomItems[_zoomListIndex].length;var A=_zoomItems[_zoomListIndex].substring(0,B-1);_zoomIndex=parseFloat(A)/10;var C=_zoomIndex+";"+_zoomListIndex}function btnFitWidth(A){pageIndex=parseInt(_curCorrectPageId);actualIndex=_fileDocument[curFileId].GetPageIndex(pageIndex);var B=_fileDocument[curFileId].Viewers[actualIndex];if(_imageFormat=="Bitmap"){_pageSizeType=0;_zoomIndex=_defaultZoonIndex}else{if(_imageFormat=="Svg"){_zoomIndex=A/10}}ChangeViewerPosition(actualIndex);resizeDocViewerByCSS3("imgBig",actualIndex);if(_imageFormat=="Bitmap"){if(_zoomListIndex<=maxIndex){RectifyZoom();if(B.Currentzoom>_actualZoomIndex){CreateNewImage(actualIndex)}}}ImageViewerAnnotationResize(actualIndex)}function btnBestFit(A){pageIndex=parseInt(_curCorrectPageId);actualIndex=_fileDocument[curFileId].GetPageIndex(pageIndex);var B=_fileDocument[curFileId].Viewers[actualIndex];if(_imageFormat=="Bitmap"){_pageSizeType=1;_zoomIndex=_defaultZoonIndex}else{if(_imageFormat=="Svg"){_zoomIndex=A/10}}ChangeViewerPosition(actualIndex);resizeDocViewerByCSS3("imgBig",actualIndex);if(_imageFormat=="Bitmap"){if(_zoomListIndex<=maxIndex){RectifyZoom();if(B.Currentzoom>_actualZoomIndex){CreateNewImage(actualIndex)}}}ImageViewerAnnotationResize(actualIndex)}function btnOneToOne(){pageIndex=parseInt(_curCorrectPageId);actualIndex=_fileDocument[curFileId].GetPageIndex(pageIndex);_pageSizeType=2;_zoomIndex=_defaultZoonIndex;ChangeViewerPosition(actualIndex);resizeDocViewerByCSS3("imgBig",actualIndex);ImageViewerAnnotationResize(actualIndex)}function DeleteAllAnnotation(){selectDiv=new Array()}function DeleteAnnotation(){for(var A=0;A<selectDiv.length;A++){deleteDivId=selectDiv[A];$("#div_"+deleteDivId).remove();$("#thumbImg_"+deleteDivId).remove();_fileDocument[curFileId].DeleteAnno(deleteDivId);if(isLoadOrSave&&!isUnSaveAnnos){isUnSaveAnnos=true}}selectDiv=new Array();noSelectAnno();isHaveAnnos()}function btnSinglePage(){var E=$("#_plcBigImg").scrollTop();$("#navi_multi").removeClass("iconBorder");$("#navi_single").addClass("iconBorder");var F=parseInt(_curCorrectPageId);var B=E-PreCountHeight(_curCorrectPageId);thisPg=_fileDocument[curFileId].GetPageIndex(F);_viewerMode="single";var D=_fileDocument[curFileId];for(var C=0;C<D.ViewerPageIndex.length;C++){var A=D.ViewerPageIndex[C];if(A!=thisPg){$("#page"+A).hide();$("#pageImg"+A).hide()}}ChangeViewerPosition(thisPg);resizeDocViewerByCSS3("imgBig",thisPg);if(_imageFormat=="Svg"){if(!_showDocSrc.in_array(thisPg)){if(_fileDocument[curFileId].ViewerSvgContent[thisPg]!=null){svgContentToDiv(thisPg)}else{if(!_DocSrcRequest.in_array(thisPg)){addSvgContent(thisPg,true)}}}}else{AddImage(thisPg)}$("#_plcBigImg").scrollTop(B);addBtnRotate();SinglePageAnnotation(thisPg)}function btnContinuesPage(){var C=$("#_plcBigImg").scrollTop();$("#navi_single").removeClass("iconBorder");$("#navi_multi").addClass("iconBorder");removeBtnRotate();restoreRotate();_viewerMode="multi";var D=parseInt(_curCorrectPageId);actualIndex=_fileDocument[curFileId].GetPageIndex(D);var B=_fileDocument[curFileId];for(var A=0;A<B.ViewerPageIndex.length;A++){$("#page"+B.ViewerPageIndex[A]).show();$("#pageImg"+B.ViewerPageIndex[A]).show()}ChangeViewerPosition(actualIndex);resizeDocViewerByCSS3("imgBig",actualIndex);ImageViewerAnnotationResize(actualIndex);$("#_plcBigImg").scrollTop($("#_plcBigImg").scrollTop()+C);MultiPageAnnotation()}var selectTextType="";function SelectTextRedaction(){selectTextType="redact";RemoveAnnoSelectDraw();$(".showByDrag").unbind("mousedown",dragImageMouseDown);$(".showByDrag").unbind("mousemove",dragImageMouseMove);$(".showByDrag").unbind("mouseup",dragImageMouseUp);if(selectTextIcon){$("#re_func_selectText").removeClass("iconBorder");selectTextIcon=false}else{$(".showByDrag").removeClass("mouseStyleMove");$(".showByDrag").addClass("mouseStyleSelect");$("#draw_canvas").bind("mousedown",selectDown);$("#draw_canvas").bind("mousemove",selectMove);$("#draw_canvas").bind("mouseup",selectUp);down_flag=false;for(var A=0;A<draggableNumArray.length;A++){$("#div_"+draggableNumArray[A]).draggable("disable")}}}function SelectTextEvent(){selectTextType="select";RemoveAnnoSelectDraw();if(selectTextIcon){$("#draw_canvas").unbind("mousedown",selectDown);$("#draw_canvas").unbind("mousemove",selectMove);$("#draw_canvas").unbind("mouseup",selectUp);$(".showByDrag").removeClass("mouseStyleSelect");$(".showByDrag").addClass("mouseStyleMove");$("#re_func_selectText").removeClass("iconBorder");$(".showByDrag").bind("mousedown",dragImageMouseDown);$(".showByDrag").bind("mousemove",dragImageMouseMove);$(".showByDrag").bind("mouseup",dragImageMouseUp);var C=new Array();for(var A=0;A<draggableNumArray.length;A++){var B=draggableNumArray[A];if(document.getElementById("div_"+B)==null){C.push(B)}else{$("#div_"+draggableNumArray[A]).draggable("enable")}}for(var A=0;A<C.length;A++){draggableNumArray.remove(C[A])}selectTextIcon=false}else{$(".showByDrag").unbind("mousedown",dragImageMouseDown);$(".showByDrag").unbind("mousemove",dragImageMouseMove);$(".showByDrag").unbind("mouseup",dragImageMouseUp);$(".showByDrag").removeClass("mouseStyleMove");$(".showByDrag").addClass("mouseStyleSelect");$("#re_func_selectText").addClass("iconBorder");$("#draw_canvas").bind("mousedown",selectDown);$("#draw_canvas").bind("mousemove",selectMove);$("#draw_canvas").bind("mouseup",selectUp);down_flag=false;selectTextIcon=true;for(var A=0;A<draggableNumArray.length;A++){$("#div_"+draggableNumArray[A]).draggable("disable")}}}function RemoveAnnoSelectDraw(){if(currentAnnoStyleId!=""){if(_annotationLastType=="Line"||_annotationLastType=="Arrow"){$("#draw_canvas").unbind("mousedown",MouseDown);$("#draw_canvas").unbind("mousemove",MouseMove)}else{$("#draw_canvas").unbind("mousedown",MouseDown);$("#draw_canvas").unbind("mousemove",MouseMove);$("#draw_canvas").unbind("mouseup",MouseUp)}$("#"+currentAnnoStyleId).removeClass("annoSelect");currentAnnoStyleId="";$(".showByDrag").removeClass("mouseStyleAnnotation")}$(".showByDrag").bind("mousedown",dragImageMouseDown);$(".showByDrag").bind("mousemove",dragImageMouseMove);$(".showByDrag").bind("mouseup",dragImageMouseUp);$(".showByDrag").addClass("mouseStyleMove")}var selectTextIcon=false;var selectXDown;var selectYDown;var start_xpoint=0;var start_ypoint=0;var end_xpoint=0;var end_ypoint=0;var selectPageRotate=0;var selectDown=function(B){down_flag=true;parent_left=$("#_plcBigImg").offset().left;parent_top=$("#_plcBigImg").offset().top;nScrollLeft=$("#_plcBigImg")[0].scrollLeft-5;nScrollTop=$("#_plcBigImg")[0].scrollTop-5;B=B||window.event;selectXDown=B.pageX-parent_left+nScrollLeft;selectYDown=B.pageY-parent_top+nScrollTop;if(_viewerMode=="single"){drawPageIndex=parseInt(_curCorrectPageId);drawActualIndex=_fileDocument[curFileId].GetPageIndex(drawPageIndex);var C=_fileDocument[curFileId].Viewers[drawActualIndex];selectPageRotate=C.Rotate}for(var A=0;A<selectTextPages.length;A++){$("#page"+selectTextPages[A]+" svg #reSelectTextSvg").remove()}};var selectMove=function(B){if(down_flag){end_xpoint=B.pageX-parent_left+nScrollLeft;end_ypoint=B.pageY-parent_top+nScrollTop;start_xpoint=selectXDown;start_ypoint=selectYDown;if(selectPageRotate==0&&end_ypoint<start_ypoint||selectPageRotate==1&&end_xpoint>start_xpoint||selectPageRotate==2&&end_ypoint>start_ypoint||selectPageRotate==3&&end_xpoint<start_xpoint){start_xpoint=end_xpoint;start_ypoint=end_ypoint;end_xpoint=selectXDown;end_ypoint=selectYDown}$(".reSelectTextSvg").remove();var C=_zoomRatio*_zoomIndex;HighlightSelectText(C,selectPageRotate);for(var A=0;A<selectTextPages.length;A++){var F=_fileDocument[curFileId].Viewers[selectTextPages[A]];F.GetViewerLeftTop();var D=F.Left;var E=F.Top;if(_viewerMode=="multi"){E+=PreCountHeight(_fileDocument[curFileId].GetShowIndex(selectTextPages[A]))}var G="<div class='reSelectTextSvg' style='left:"+D+"px;top:"+E+"px;width:"+F.ActualWidth+"px;height:"+F.ActualHeight+"px;'>";G+="<svg class='svg' width='100%' height='100%' version='1.1' xmlns='http://www.w3.org/2000/svg'>";G+=selectSvgArray[A]+"</svg></div>";$("#draw_canvas").append(G)}}};var redactId="";var selectUp=function(E){down_flag=false;end_xpoint=E.pageX-parent_left+nScrollLeft;end_ypoint=E.pageY-parent_top+nScrollTop;start_xpoint=selectXDown;start_ypoint=selectYDown;if(selectPageRotate==0&&end_ypoint<start_ypoint||selectPageRotate==1&&end_xpoint>start_xpoint||selectPageRotate==2&&end_ypoint>start_ypoint||selectPageRotate==3&&end_xpoint<start_xpoint){start_xpoint=end_xpoint;start_ypoint=end_ypoint;end_xpoint=selectXDown;end_ypoint=selectYDown}$(".reSelectTextSvg").remove();HighlightSelectText(1,0);if(selectTextType=="select"){for(var F=0;F<selectTextPages.length;F++){$("#page"+selectTextPages[F]+" svg").append(selectSvgArray[F]);var Q=$("#page"+selectTextPages[F]).html();$("#page"+selectTextPages[F]).html(Q)}$("#textCopy").remove();var A="<div id='textCopy' class='reCopyText'>"+selectTextString+"</div>";$("body").append(A);if(document.selection){document.selection.empty();var D=document.body.createTextRange();D.moveToElmentText(document.getElementById("textCopy"));D.select()}else{if(window.getSelection){window.getSelection().removeAllRanges();var D=document.createRange();D.selectNode(document.getElementById("textCopy"));window.getSelection().addRange(D)}}}else{if(selectTextType=="redact"){$("#draw_canvas").unbind("mousedown",selectDown);$("#draw_canvas").unbind("mousemove",selectMove);$("#draw_canvas").unbind("mouseup",selectUp);$(".showByDrag").removeClass("mouseStyleSelect");$(".showByDrag").addClass("mouseStyleMove");$(".showByDrag").bind("mousedown",dragImageMouseDown);$(".showByDrag").bind("mousemove",dragImageMouseMove);$(".showByDrag").bind("mouseup",dragImageMouseUp);var B=new Array();for(var F=0;F<draggableNumArray.length;F++){var T=draggableNumArray[F];if(document.getElementById("div_"+T)==null){B.push(T)}else{$("#div_"+draggableNumArray[F]).draggable("enable")}}for(var F=0;F<B.length;F++){draggableNumArray.remove(B[F])}if(selectRedactRects.length==0){return}var X=new Array();var H=new Array();var O=selectRedactRects[0].OnPageIndex;H.push(O);var R=_fileDocument[curFileId].Viewers[O];var L=new Annotation({OnPageIndex:O,Type:"TextRedacts",Rotate:R.Rotate,ViewerLeft:R.Left,ViewerTop:R.Top,ViewerWidth:R.ActualWidth,ViewerHeight:R.ActualHeight,ViewerScaleX:R.ScaleX,ViewerScaleY:R.ScaleY,});L.AddAnnoStyle(TextRedact);var G=new Array();var S=new Array();var V=new Array();var M=new Array();for(var F=0;F<selectRedactRects.length;F++){var K=selectRedactRects[F];if(K.OnPageIndex==O){M.push(K)}else{var Z=new PageTextRedacts({curPageRectRedacts:M});L.RedactRects=Z;X.push(L);M=new Array();O=K.OnPageIndex;H.push(O);var R=_fileDocument[curFileId].Viewers[O];var L=new Annotation({OnPageIndex:O,Type:"TextRedacts",Rotate:R.Rotate,ViewerLeft:R.Left,ViewerTop:R.Top,ViewerWidth:R.ActualWidth,ViewerHeight:R.ActualHeight,ViewerScaleX:R.ScaleX,ViewerScaleY:R.ScaleY,});L.AddAnnoStyle(TextRedact);M.push(K)}G.push(K.ShowLeft);S.push(K.ShowWidth+K.ShowLeft)}if(M.length!=0){var Z=new PageTextRedacts({curPageRectRedacts:M});L.RedactRects=Z;var Y=L.RedactRects.curPageRectRedacts;X.push(L)}var C=0;if(redactId!=""){C=redactId}else{C=num}for(var F=0;F<X.length;F++){var P=X[F];P.RedactRects.relativePages=H;P.Index=C;_fileDocument[curFileId].Viewers[P.OnPageIndex].Annotations[C]=P}var I=G.min();var J=selectRedactRects[0].ShowTop;var N=S.max()-I;var W=selectRedactRects[selectRedactRects.length-1];var U=W.ShowTop-selectRedactRects[0].ShowTop+W.ShowHeight;var Q="<div class='new_rect' id='div_"+C+"' style='left:"+I+"px;top:"+J+"px;width:"+N+"px;height:"+U+"px'>";Q+="<div class='rightRedact' style='left:"+(W.ShowLeft-I+W.ShowWidth-3)+"px;' id='rRightDown_"+C+"'></div><div class='leftRedact' style='left:"+(selectRedactRects[0].ShowLeft-I-3)+"px;' id='rLeftUp_"+C+"'></div>";Q+="<svg class='svg' id='svg_"+C+"' width='100%' height='100%' version='1.1' xmlns='http://www.w3.org/2000/svg'>";for(var F=0;F<selectRedactRects.length;F++){var K=selectRedactRects[F];Q+="<rect class='anno_redact' id='annotation_"+C+"_"+F+"' x='"+(K.ShowLeft-I)+"' y='"+(K.ShowTop-J)+"' width='"+K.ShowWidth+"' height='"+K.ShowHeight+"' style='fill:"+K.FillColor+";'/>"}Q+="</svg></div>";$("#draw_canvas").append(Q);if(redactId==""){num++}redactId="";$(".leftRedact").bind("mousedown",function(){selectXDown=W.ShowLeft+W.ShowWidth;selectYDown=W.ShowTop+W.ShowHeight;$("#div_"+C).remove();redactId=this.id.substring(this.id.indexOf("_")+1);ContinueTextRedaction()});$(".rightRedact").bind("mousedown",function(){selectXDown=selectRedactRects[0].ShowLeft;selectYDown=selectRedactRects[0].ShowTop;$("#div_"+C).remove();redactId=this.id.substring(this.id.indexOf("_")+1);ContinueTextRedaction()});if(!canSaveAnnos){enableSaveAnnos();canSaveAnnos=true}}}};function ContinueTextRedaction(){down_flag=true;if(_viewerMode=="single"){drawPageIndex=parseInt(_curCorrectPageId);drawActualIndex=_fileDocument[curFileId].GetPageIndex(drawPageIndex);var B=_fileDocument[curFileId].Viewers[drawActualIndex];selectPageRotate=B.Rotate}selectTextType="redact";RemoveAnnoSelectDraw();if(selectTextIcon){$(".showByDrag").removeClass("mouseStyleSelect");$(".showByDrag").addClass("mouseStyleMove");$("#re_func_selectText").removeClass("iconBorder");selectTextIcon=false}else{$(".showByDrag").unbind("mousemove",dragImageMouseMove);$(".showByDrag").unbind("mouseup",dragImageMouseUp);$(".showByDrag").removeClass("mouseStyleMove");$(".showByDrag").addClass("mouseStyleSelect");$("#draw_canvas").bind("mousemove",selectMove);$("#draw_canvas").bind("mouseup",selectUp);for(var A=0;A<draggableNumArray.length;A++){$("#div_"+draggableNumArray[A]).draggable("disable")}}}var selectTextPages=new Array();var selectSvgArray=new Array();var selectTextString="";var selectRedactRects=new Array();function HighlightSelectText(D,F){if(start_xpoint=="undefined"||start_ypoint=="undefined"||end_xpoint=="undefined"||end_ypoint=="undefined"){return}selectTextString="";selectRedactRects=new Array();selectTextPages=new Array();selectSvgArray=new Array();var A=PrePageCount(start_ypoint);var B=PrePageCount(end_ypoint);GetPageActualPosition(A,start_xpoint,start_ypoint,"start");GetPageActualPosition(B,end_xpoint,end_ypoint,"end");if(_viewerMode=="multi"){var C=0;var G=0;var H=0;var E=0;if(A==B){SelectInOnePage(A,D,F)}else{SelectTextInPages(A,B,D,F)}}else{drawPageIndex=parseInt(_curCorrectPageId);SelectInOnePage(drawPageIndex,D,F)}}function SelectInOnePage(F,G,H){var B=new Array();var A=_fileDocument[curFileId].GetPageIndex(F);B=_fileDocument[curFileId].ViewerChars[A];if(typeof(B)=="undefined"){alert("Text information is being transferred, please wait!!");down_flag=false;return}if(typeof(B)=="string"){alert(B);down_flag=false;return}if(_excelFormat.in_array(_suffix)){var E=GetCellStartIndex(B);if(E=="undefined"){return}var D=GetCellEndIndex(B,end_xpoint,end_ypoint);if(D=="undefined"){return}SelectExcelTextInOnePage(A,G,H,E,D,false,false)}else{var I=GetLineStartIndex(B);if(I=="undefined"){return}var C=GetLineEndIndex(B,I);if(C=="undefined"){return}SelectTextInOnePage(A,G,H,I,C,false,false)}}function GetLineStartIndex(A){var B="undefined";if(start_ypoint>A[A.length-1].MaxHeight){}else{if(start_ypoint<A[0].MinHeight||start_ypoint>=A[0].MinHeight&&A[0].MaxHeight>=start_ypoint){B=0;var D=A[B].CharBoundaryLst;var F=D[0].X;var E=D[D.length-1].X+D[D.length-1].W;if(start_xpoint>=F&&E>=start_xpoint||start_xpoint<F){return B}else{B="undefined"}}}for(var C=1;C<A.length;C++){if(start_ypoint>=A[C].MinHeight&&A[C].MaxHeight>=start_ypoint||start_ypoint>=A[C-1].MaxHeight&&A[C].MaxHeight>=start_ypoint){B=C;var D=A[B].CharBoundaryLst;var F=D[0].X;var E=D[D.length-1].X+D[D.length-1].W;if(start_xpoint>=F&&E>=start_xpoint){break}}}return B}function GetLineEndIndex(A,B){var G="undefined";if(end_ypoint<A[0].MinHeight){}else{if(B==0){if(end_ypoint>=A[0].MinHeight&&A[0].MaxHeight>=end_ypoint){G=0;var D=A[G].CharBoundaryLst;var F=D[0].X;var E=D[D.length-1].X+D[D.length-1].W;if(end_xpoint>=F&&E>=end_xpoint||end_xpoint>E){return G}}B=1}for(var C=B;C<A.length;C++){if(end_ypoint>=A[C].MinHeight&&A[C].MaxHeight>=end_ypoint||end_ypoint>=A[C-1].MaxHeight&&A[C].MaxHeight>=end_ypoint){G=C;var D=A[G].CharBoundaryLst;var F=D[0].X;var E=D[D.length-1].X+D[D.length-1].W;if(end_xpoint>=F&&E>=end_xpoint){break}}}}return G}function GetCharStartIndex(B,C){var D="undefined";if(C){D=0}else{if(start_xpoint<B[0].X){D=-1}else{if(start_xpoint>B[B.length-1].X+B[B.length-1].W){D=B.length}else{if(start_xpoint>=B[0].X&&B[0].X+B[0].W>=start_xpoint){D=0}else{for(var A=1;A<B.length;A++){if(start_xpoint>=B[A].X&&(B[A].X+B[A].W)>=start_xpoint||start_xpoint>(B[A-1].X+B[A-1].W)&&start_xpoint<B[A].X){D=A;break}}}}}}return D}function GetCharEndIndex(C,D){var A="undefined";if(D){A=C.length-1}else{if(end_xpoint<C[0].X){A=-1}else{if(end_xpoint>C[C.length-1].X+C[C.length-1].W){A=C.length}else{if(end_xpoint>=C[C.length-1].X&&C[C.length-1].X+C[C.length-1].W>=end_xpoint){A=C.length-1}else{for(var B=0;B<C.length-1;B++){if(end_xpoint>=C[B].X&&C[B].X+C[B].W>=end_xpoint||end_xpoint>C[B].X+C[B].W&&end_xpoint<C[B+1].X){A=B;break}}}}}}return A}function GetCellStartIndex(A){var E="undefined";var D=A[0].CellRegion.Y;var F=A[A.length-1].CellRegion.Y+A[A.length-1].CellRegion.Height;if(start_ypoint<D){E=0;var C=A[E].CellRegion;while(start_xpoint>=C.X+C.W){E++;C=A[E].CellRegion}}else{if(start_ypoint>F){}else{for(var B=0;B<A.length;B++){var C=A[B].CellRegion;if(start_ypoint>=C.Y&&C.Y+C.H>=start_ypoint){if(start_xpoint>=C.X&&C.X+C.W>=start_xpoint){E=B;break}}}}}return E}function GetCellEndIndex(A){var E="undefined";var D=A[0].CellRegion.Y;var F=A[A.length-1].CellRegion.Y+A[A.length-1].CellRegion.H;if(end_ypoint<D){}else{if(end_ypoint>F){E=A.length-1}else{for(var B=0;B<A.length;B++){var C=A[B].CellRegion;if(end_ypoint>=C.Y&&C.Y+C.H>=end_ypoint){if(end_xpoint>=C.X&&C.X+C.W>=end_xpoint){E=B;break}}}}}return E}function GetLineHighRect(A,F,I,E,H,B){var C="";var G=0;var D=_fileDocument[curFileId].Viewers[A];if(typeof(E[H])=="undefined"||typeof(E[B-1])=="undefined"){return}if(I==0){G=E[B-1].X+E[B-1].W-E[H].X;C+="<rect x='"+E[H].X*F+"' y='"+E[H].Y*F+"' width='"+G*F+"' height='"+E[H].H*F+"'></rect>"}else{if(I==1){G=E[B-1].X+E[B-1].W-E[H].X;C+="<rect x='"+(D.ActualWidth-(shadowWidth+E[H].Y+E[H].H)*F)+"' y='"+E[H].X*F+"' width='"+E[H].H*F+"' height='"+G*F+"'></rect>"}else{if(I==2){G=E[B-1].X+E[B-1].W-E[H].X;C+="<rect x='"+(D.ActualWidth-(shadowWidth+E[H].X+G)*F)+"' y='"+(D.ActualHeight-(shadowWidth+E[H].Y+E[H].H)*F)+"' width='"+G*F+"' height='"+E[H].H*F+"'></rect>"}else{if(I==3){G=E[B-1].X+E[B-1].W-E[H].X;C+="<rect x='"+E[H].Y*F+"' y='"+(D.ActualHeight-(shadowWidth+G+E[H].X)*F)+"' width='"+E[H].H*F+"' height='"+G*F+"'></rect>"}}}}if(typeof(E[H])!="undefined"){AddRedactAnnos(A,E[H].X,E[H].Y,G,E[H].H)}return C}function SelectTextInOnePage(A,H,K,M,L,I,F){var E="<g id='reSelectTextSvg' fill='#0000FF' fill-opacity='0.5'>";var B=new Array();B=_fileDocument[curFileId].ViewerChars[A];var D=B[M].CharBoundaryLst;var C=GetCharStartIndex(D,I);D=B[L].CharBoundaryLst;var J=GetCharEndIndex(D,F);if(M==L){if(J==-1||C==D.length){return}if(C==-1){C=0}if(J==D.length){J=D.length-1}E+=GetLineHighRect(A,H,K,D,C,J+1);selectTextString+=B[M].StringVale.substring(C,J+1)}else{D=B[M].CharBoundaryLst;if(C==-1){C=0}E+=GetLineHighRect(A,H,K,D,C,D.length);selectTextString+=B[M].StringVale.substring(C);for(var G=M+1;G<L;G++){D=B[G].CharBoundaryLst;E+=GetLineHighRect(A,H,K,D,0,D.length);selectTextString+=B[G].StringVale}D=B[L].CharBoundaryLst;if(J==-1){}else{if(J==D.length){J=D.length-1}E+=GetLineHighRect(A,H,K,D,0,J+1);selectTextString+=B[L].StringVale.substring(0,J+1)}}selectTextPages.push(A);selectSvgArray.push(E+"</g>")}function SelectExcelTextInOnePage(R,B,G,I,T,J,D){var S="<g id='reSelectTextSvg' fill='#0000FF' fill-opacity='0.5'>";var C=new Array();C=_fileDocument[curFileId].ViewerChars[R];var M=0;var H=0;var P=0;var N=0;if(I==T){S+=SelectTextInOneCell(R,B,G,C,I,J,D)}else{var O=C[I].CellBoundaryList;var A=C[T].CellBoundaryList;var F=I;while(O.length==0){I+=1;O=C[I].CellBoundaryList;if(I==C.length-1){if(O.length==0){return}}}if(I<T){var K=T;while(A.length==0){T-=1;A=C[T].CellBoundaryList}if(I<T){if(F!=I){S+=globalCellContent(R,B,G,O)}else{if(start_ypoint<O[0].MinHeight){S+=globalCellContent(R,B,G,O)}else{if(start_ypoint>O[O.length-1].MaxHeight){}else{for(var Q=0;Q<O.length;Q++){if(start_ypoint>=O[Q].MinHeight&&O[Q].MaxHeight>=start_ypoint){M=Q;break}}var L=O[M].CharBoundaryLst;P=GetCellCharStartIndex(O,M);if(P==L.length){}else{S+=GetLineHighRect(R,B,G,L,P,L.length);selectTextString+=O[M].StringVale.substring(P);for(var Q=M+1;Q<O.length;Q++){L=O[Q].CharBoundaryLst;S+=GetLineHighRect(R,B,G,L,0,L.length);selectTextString+=O[Q].StringVale}}}}}for(var Q=I+1;Q<T;Q++){var E=C[Q].CellBoundaryList;S+=globalCellContent(R,B,G,E)}if(K!=T){S+=globalCellContent(R,B,G,A)}else{if(end_ypoint<A[0].MinHeight){}else{if(end_ypoint>A[A.length-1].MaxHeight){S+=globalCellContent(R,B,G,A)}else{for(var Q=0;Q<A.length;Q++){if(end_ypoint>=A[Q].MinHeight&&A[Q].MaxHeight>=end_ypoint){H=Q;break}}N=GetCellCharEndIndex(A,H);if(N==-1){}else{for(var Q=0;Q<H;Q++){L=A[Q].CharBoundaryLst;S+=GetLineHighRect(R,B,G,L,0,L.length);selectTextString+=A[Q].StringVale}L=A[H].CharBoundaryLst;S+=GetLineHighRect(R,B,G,L,0,N+1);selectTextString+=A[H].StringVale.substring(0,N+1)}}}}}else{if(I==T){if(I==F){S+=SelectTextInOneCell(R,B,G,C,I,J,true)}else{S+=SelectTextInOneCell(R,B,G,C,I,true,true)}}}}else{if(I==T){if(I==F){S+=SelectTextInOneCell(R,B,G,C,I,J,D)}else{S+=SelectTextInOneCell(R,B,G,C,I,true,D)}}else{if(I>T){}}}}selectTextPages.push(R);selectSvgArray.push(S+"</g>")}function globalPageContent(E,D,C){if(_excelFormat.in_array(_suffix)){globalExcelPageCount(E,D,C);return}var F="<g id='reSelectTextSvg' fill='#0000FF' fill-opacity='0.5'>";var A=new Array();A=_fileDocument[curFileId].ViewerChars[E];for(var B=0;B<A.length;B++){lineChars=A[B].CharBoundaryLst;F+=GetLineHighRect(E,D,C,lineChars,0,lineChars.length);selectTextString+=A[B].StringVale}selectTextPages.push(E);selectSvgArray.push(F+"</g>")}function globalExcelPageCount(E,D,C){var G="<g id='reSelectTextSvg' fill='#0000FF' fill-opacity='0.5'>";var A=new Array();A=_fileDocument[curFileId].ViewerChars[E];for(var B=0;B<A.length;B++){var F=A[B].CellBoundaryList;globalCellContent(E,D,C,F)}selectTextPages.push(E);selectSvgArray.push(G+"</g>")}function globalCellContent(F,E,D,G){var A="";for(var B=0;B<G.length;B++){var C=G[B].CharBoundaryLst;A+=GetLineHighRect(F,E,D,C,0,C.length);selectTextString+=G[B].StringVale}return A}function SelectTextInPages(A,C,E,F){if(_excelFormat.in_array(_suffix)){SelectExcelTextInPages(A,C,E,F)}var B=new Array();actualIndex=_fileDocument[curFileId].GetPageIndex(A);B=_fileDocument[curFileId].ViewerChars[actualIndex];if(typeof(B)=="undefined"){alert("Text information is being transferred, please wait!!");down_flag=false;return}if(typeof(B)=="string"){alert(B);down_flag=false;return}if(start_ypoint<B[0].MinHeight){globalPageContent(actualIndex,E,F)}else{if(start_ypoint>B[B.length-1].MaxHeight){}else{var H=GetLineStartIndex(B);if(H=="undefined"){return}var G=B.length-1;SelectTextInOnePage(actualIndex,E,F,H,G,false,true)}}for(var D=A+1;D<C;D++){actualIndex=_fileDocument[curFileId].GetPageIndex(D);globalPageContent(actualIndex,E,F)}actualIndex=_fileDocument[curFileId].GetPageIndex(C);B=_fileDocument[curFileId].ViewerChars[actualIndex];if(typeof(B)=="undefined"){alert("Text information is being transferred, please wait!!");down_flag=false;return}if(typeof(B)=="string"){alert(B);down_flag=false;return}if(end_ypoint<B[0].MinHeight){}else{if(end_ypoint>B[B.length-1].MaxHeight){globalPageContent(actualIndex,E,F)}else{var H=0;var G=GetLineEndIndex(B,H);if(G=="undefined"){return}SelectTextInOnePage(actualIndex,E,F,H,G,true,false)}}}function SelectExcelTextInPages(B,D,F,K){var C=new Array();var A=_fileDocument[curFileId].GetPageIndex(B);C=_fileDocument[curFileId].ViewerChars[A];if(typeof(C)=="undefined"){alert("Text information is being transferred, please wait!!");down_flag=false;return}if(typeof(C)=="string"){alert(C);down_flag=false;return}var I=C[0].CellRegion.Y;var H=C[C.length-1].CellRegion.Y+C[C.length-1].CellRegion.H;if(start_ypoint<I){globalExcelPageCount(A,F,K)}else{if(start_ypoint>H){}else{var E=GetCellStartIndex(C);if(E=="undefined"){return}var G=C.length-1;SelectExcelTextInOnePage(A,F,K,E,G,false,true)}}for(var J=B+1;J<D;J++){A=_fileDocument[curFileId].GetPageIndex[J];globalExcelPageCount(A,F,K)}A=_fileDocument[curFileId].GetPageIndex(D);C=_fileDocument[curFileId].ViewerChars[A];if(typeof(C)=="undefined"){alert("Text information is being transferred, please wait!!");down_flag=false;return}if(typeof(C)=="string"){alert(C);down_flag=false;return}if(end_ypoint<I){}else{if(end_ypoint>H){globalPageContent(A,F,K)}else{var E=0;var G=GetCellEndIndex(A,end_xpoint,end_ypoint);if(G=="undefined"){return}SelectExcelTextInOnePage(A,F,K,E,G,true,false)}}}function SelectTextInOneCell(A,G,J,B,D,H,E){var K="";var I=B[D].CellBoundaryList;if(I.length==0){return}if(H){lineStartIndex=0;charStartIndex=0}else{lineStartIndex=GetCellLineStartIndex(I);if(lineStartIndex=="undefined"){return}charStartIndex=GetCellCharStartIndex(I,lineStartIndex)}if(E){lineEndIndex=I.length-1;charEndIndex=I[lineEndIndex].length-1}else{lineEndIndex=GetCellLineEndIndex(I);if(lineEndIndex=="undefined"){return}charEndIndex=GetCellCharEndIndex(I,lineEndIndex)}var C=I[lineStartIndex].CharBoundaryLst;if(lineStartIndex==lineEndIndex){if(charEndIndex==-1||charStartIndex==C.length){return}K+=GetLineHighRect(A,G,J,C,charStartIndex,charEndIndex+1);selectTextString+=I[lineStartIndex].StringVale.substring(charStartIndex,charEndIndex+1)}else{C=I[lineStartIndex].CharBoundaryLst;K+=GetLineHighRect(A,G,J,C,charStartIndex,C.length);selectTextString+=I[lineStartIndex].StringVale.substring(charStartIndex);for(var F=lineStartIndex+1;F<lineEndIndex;F++){C=I[F].CharBoundaryLst;K+=GetLineHighRect(A,G,J,C,0,C.length);selectTextString+=I[F].StringVale}C=I[lineEndIndex].CharBoundaryLst;if(charEndIndex==-1){}else{if(charEndIndex==C.length){charEndIndex=C.length-1}K+=GetLineHighRect(A,G,J,C,0,charEndIndex+1);selectTextString+=I[lineEndIndex].StringVale.substring(0,charEndIndex+1)}}return K}function GetCellLineStartIndex(C){var A="undefined";if(start_ypoint<C[0].MinHeight){A=0}else{if(start_ypoint>C[C.length-1].MaxHeight){}else{for(var B=0;B<C.length;B++){if(start_ypoint>=C[B].MinHeight&&C[B].MaxHeight>=start_ypoint){A=B;break}}}}return A}function GetCellLineEndIndex(C){var B="undefined";if(end_ypoint<C[0].MinHeight){}else{if(end_ypoint>C[C.length-1].MaxHeight){B=C.length-1}else{for(var A=lineStartIndex;A<C.length;A++){if(end_ypoint>=C[A].MinHeight&&C[A].MaxHeight>=end_ypoint){B=A;break}}}}return B}function GetCellCharStartIndex(E,A){var D="undefined";var C=E[A].CharBoundaryLst;if(start_xpoint<C[0].X){D=0}else{if(start_xpoint>C[C.length-1].X+C[C.length-1].W){D=C.length}else{for(var B=0;B<C.length;B++){if(start_xpoint>=C[B].X&&C[B].X+C[B].W>=start_xpoint){D=B;break}}}}return D}function GetCellCharEndIndex(E,D){var A="undefined";var C=E[D].CharBoundaryLst;if(end_xpoint<C[0].X){A=-1}else{if(end_xpoint>C[C.length-1].X+C[C.length-1].W){A=C.length-1}else{for(var B=0;B<C.length;B++){if(end_xpoint>=C[B].X&&C[B].X+C[B].W>=end_xpoint){A=B;break}}}}return A}function AddRedactAnnos(D,B,C,E,A){var F=_fileDocument[curFileId].Viewers[D];var G=new Annotation({OnPageIndex:D,Type:"RectRedacts",Left:B,Top:C,Width:E,Height:A,Rotate:F.Rotate,ViewerLeft:F.Left,ViewerTop:F.Top,ViewerWidth:F.ActualWidth,ViewerHeight:F.ActualHeight,ViewerScaleX:F.ScaleX,ViewerScaleY:F.ScaleY,});G.AddAnnoStyle(TextRedact);G.GetShowPosition();G.CalculateOnRotate();selectRedactRects.push(G)}function GetPageActualPosition(A,F,G,J){var H=_zoomRatio*_zoomIndex;var I=_fileDocument[curFileId].GetPageIndex(A);var E=_fileDocument[curFileId].Viewers[I];var D=G;var K=E.Top;if(_viewerMode=="multi"){var L=PreCountHeight(A);D=G-L;K=boxWidth*H;F=(F-E.Left)*E.ScaleX/H;G=(D-K)*E.ScaleY/H}else{if(E.Rotate==0){F=(F-E.Left)*E.ScaleX/H;G=(D-K)*E.ScaleY/H}else{if(E.Rotate==1){var C=(G-K)*E.ScaleY/H;var B=($("#draw_canvas").outerWidth()-F-E.Left)*E.ScaleX/H;F=C;G=B}else{if(E.Rotate==2){var C=(E.Left+E.ActualWidth-(shadowWidth+2*boxWidth)*H-F)*E.ScaleX/H;var B=($("#draw_canvas").outerHeight()-G-E.Top)*E.ScaleY/H;F=C;G=B}else{if(E.Rotate==3){var C=($("#draw_canvas").outerHeight()-G-E.Top)*E.ScaleY/H;var B=(F-E.Left)*E.ScaleX/H;F=C;G=B}}}}}if(J=="start"){start_xpoint=F;start_ypoint=G}else{end_xpoint=F;end_ypoint=G}}function restoreRotate(){var B=_fileDocument[curFileId];for(var A=0;A<B.ViewerPageIndex.length;A++){var D=B.ViewerPageIndex[A];thumbId="thumbnail_"+D;var C=_fileDocument[curFileId].Viewers[D];if(C.Rotate==0){continue}else{if(C.Rotate==1){_fileDocument[curFileId].Viewers[D].ChangeRotate("1");_fileDocument[curFileId].Viewers[D].ChangeRotate("2");resizeThumbViewerByCSS3(thumbId,D);RotateAnnotations(D,_fileDocument[curFileId].Viewers[D].Rotate)}else{if(C.Rotate==2){_fileDocument[curFileId].Viewers[D].ChangeRotate("2");resizeThumbViewerByCSS3(thumbId,D);RotateAnnotations(D,_fileDocument[curFileId].Viewers[D].Rotate)}else{if(C.Rotate==3){_fileDocument[curFileId].Viewers[D].ChangeRotate("1");resizeThumbViewerByCSS3(thumbId,D);RotateAnnotations(D,_fileDocument[curFileId].Viewers[D].Rotate)}}}}}}function getFolder(A){var A=getRootPath()+"/"+_cacheFolder+"/"+_fid+"/"+A;return A}function GetRelativeFolder(A){var A=_cacheFolder+"/"+_fid+"/"+A;return A}var isFullScreen=false;document.onkeydown=function(B){B=B||window.event;var C=_zoomRatio*_zoomIndex;if(B.keyCode==40){$("#_plcBigImg").scrollTop($("#_plcBigImg").scrollTop()+10*C)}else{if(B.keyCode==38){$("#_plcBigImg").scrollTop($("#_plcBigImg").scrollTop()-10*C)}else{if(B.keyCode==37){$("#_plcBigImg").scrollLeft($("#_plcBigImg").scrollLeft()-10*C)}else{if(B.keyCode==39){$("#_plcBigImg").scrollLeft($("#_plcBigImg").scrollLeft()+10*C)}else{if(B.keyCode==122){if(isFullScreen){isFullScreen=false;var A=JudgeBrowser();if((A=="IE"||A=="Chrome")&&_isFull){resizeFunction()}}else{isFullScreen=true;if(JudgeBrowser()=="Chrome"){document.documentElement.webkitRequestFullScreen()}}}}}}}};var isCtrlDown=false;$(document).keydown(function(A){if(A.ctrlKey){isCtrlDown=true}});$(document).keyup(function(A){isCtrlDown=false});var scrollFunc=function(A){A=A||window.event;if(A&&A.preventDefault){A.preventDefault();A.stopPropagation()}else{A.returnvalue=false;return false}};String.prototype.startWith=function(B){var A=new RegExp("^"+B);return A.test(this)};String.prototype.endWith=function(B){var A=new RegExp(B+"$");return A.test(this)};String.prototype.replaceAll=function(A,B){return this.replace(new RegExp(A,"gm"),B)};function getRootPath(){var B=window.document.location.href;var A=B.indexOf("?");if(A!=-1){B=B.substring(0,A)}A=B.lastIndexOf("/");B=B.substring(0,A);return B}function getCurrentAspx(){var A=getRootPath();A+="/"+_defaultPage;return A}function getServerHandlerUrl(){var A=getRootPath()+_viewer._serverUrl;return A}function getProjectName(){var B=window.document.location.pathname;var A=B.lastIndexOf("/");B=B.substring(0,A);return B}function JudgeIsPdf(){if(_suffix!=".pdf"){return false}return true}function getSuffix(A){var B=A.lastIndexOf(".");var C=A.substring(B);return C}function CorrespondType(){if(_imageFormat=="Svg"||_suffix==".jbig2"){_pageSizeType=2;$("#zoomList").val("Actual Size").attr("selected",true);_zoomListIndex=17}else{if(_imageFormat=="Bitmap"){_pageSizeType=1;$("#zoomList").val("Fit Page").attr("selected",true);_zoomListIndex=18}}}var isExistToWord=false;function InitFileType(){disArray=false;if(isExistToWord){$("#re_func_toWord").remove();isExistToWord=false}if(_suffix!=".pdf"&&!_wordFormat.in_array(_suffix)&&!_excelFormat.in_array(_suffix)&&!_pptFormat.in_array(_suffix)){_imageFormat="Bitmap";if(_isIpad){$("#outlineIcon").hide();$("#searchIcon").hide()}else{$("#tabs").tabs("option","disabled",[2,3])}disArray=true}else{var E="";if(_suffix==".pdf"){E=_viewer._pdfViewer;var C=new ToolbarItem({CssClass:"re_func_btn",CssId:"re_func_toWord",Title:"Convert To DOCX",Event:'ShowDialog("toWord");'});$("#_files").append(C.CreateHtml());isExistToWord=true}else{if(_wordFormat.in_array(_suffix)){E=_viewer._wordViewer}else{if(_excelFormat.in_array(_suffix)){E=_viewer._excelViewer}else{if(_pptFormat.in_array(_suffix)){E=_viewer._pptViewer}}}}if(E==0){_imageFormat="Bitmap"}else{_imageFormat="Svg"}if(disArray&&_isIpad){$("#outlineIcon").show();$("#searchIcon").show()}$("#tabs").tabs("option","disabled",[])}if(_suffix!=_preSuffix){CorrespondType(_suffix)}if(selectTextIcon){$(".showByDrag").removeClass("mouseStyleSelect");$(".showByDrag").addClass("mouseStyleMove");$("#draw_canvas").unbind("mousedown",selectDown);$("#draw_canvas").unbind("mousemove",selectMove);$("#draw_canvas").unbind("mouseup",selectUp);$("#re_func_selectText").removeClass("iconBorder");selectTextIcon=false}RemoveAnnoSelectDraw();var D=getProjectName();var B=D+"/"+_resourceFolder+"/images/selectText.png";var G=D+"/"+_resourceFolder+"/images/selectText2.png";var A=D+"/"+_resourceFolder+"/images/selectTextRedactA.png";var F=D+"/"+_resourceFolder+"/images/selectTextRedactB.png";$("#re_func_selectText").css("background","url('"+G+"') no-repeat 4px 7px");TargetHover("#re_func_selectText",false);$("#re_func_selectText").unbind("click");$("#re_func_textRedact").css("background","url('"+F+"') no-repeat 0px 3px");TargetHover("#re_func_textRedact",false);$("#re_func_textRedact").unbind("click");if((_wordFormat.in_array(_suffix)||_pptFormat.in_array(_suffix)||_excelFormat.in_array(_suffix)||_suffix==".pdf")&&_imageFormat=="Svg"){$("#re_func_selectText").css("background","url('"+B+"') no-repeat 4px 7px");TargetHover("#re_func_selectText",true);$("#re_func_selectText").bind("click",SelectTextEvent);$("#re_func_textRedact").css("background","url('"+A+"') no-repeat 0px 3px");TargetHover("#re_func_textRedact",true);$("#re_func_textRedact").bind("click",SelectTextRedaction)}}function SetViewerMode(){if(_suffix==".pdf"||_wordFormat.in_array(_suffix)||_pptFormat.in_array(_suffix)){_viewerMode="multi";btnContinuesPage()}else{btnSinglePage()}}var Sys={};function JudgeBrowser(){var B=navigator.userAgent.toLowerCase();var A;(A=B.match(/msie ([\d.]+)/))?Sys.ie=A[1]:0;(A=B.match(/firefox\/([\d.]+)/))?Sys.firefox=A[1]:0;(A=B.match(/chrome\/([\d.]+)/))?Sys.chrome=A[1]:0;(A=B.match(/version\/([\d.]+).*safari/))?Sys.safari=A[1]:0;if(Sys.ie){return"IE"}if(Sys.firefox){return"FireFox"}if(Sys.chrome){return"Chrome"}if(Sys.safari){return"Safari"}}function JudgeIE(){if(!!window.ActiveXObject||"ActiveXObject" in window){return true}else{return false}}function TargetHover(B,A){if(!A){$(B).unbind("mouseenter").unbind("mouseleave");$(B).css("cursor","text")}else{$(B).hover(function(){$(this).css("background-color","#dcdcdc");$(this).css("cursor","pointer")},function(){$(this).css("background-color","")})}}function ThumbSrc(B){var A="";FileIsExist(B,true);if(isExist){A=getFolder("thumb")+"/"+B+".png"}else{A=_fileDocument[curFileId].Viewers[B].GetThumbSrc()}return A}var test=true;var currentClickId;function btnOutLine(I){var H=I.id;if(H==currentClickId){return}else{$("#"+currentClickId).removeClass("clickColor");currentClickId=H;$("#"+H).addClass("clickColor")}var B=H.substring(H.indexOf("_")+1);var C=outLine[B];var D=C.PageIndex;var E=C.PointF.X;var F=C.PointF.Y;var G=_zoomRatio*_zoomIndex;E=Math.ceil(E*G);if($("#_plcBigImg").scrollLeft()<E){E=$("#_plcBigImg").scrollLeft()}F=Math.ceil(F*G)-40;if(D==_curCorrectPageId){if(_viewerMode=="single"){$("#_plcBigImg").scrollLeft(E);$("#_plcBigImg").scrollTop(F)}else{var A=_fileDocument[curFileId].GetShowIndex(D);ChangeDocScrollBar(A,_pageHeight);$("#_plcBigImg").scrollLeft(E);$("#_plcBigImg").scrollTop($("#_plcBigImg").scrollTop()+F)}}else{ChangePg(D);if(_viewerMode=="single"){$("#_plcBigImg").scrollLeft(E);$("#_plcBigImg").scrollTop(F)}else{var A=_fileDocument[curFileId].GetShowIndex(D);ChangeDocScrollBar(A,_pageHeight);$("#_plcBigImg").scrollLeft(E);$("#_plcBigImg").scrollTop($("#_plcBigImg").scrollTop()+F)}}}var test=true;var currentResultId;function btnSearch(D){var I=D.id;if(I==currentResultId){return}else{$("#"+currentResultId).removeClass("selectResult");currentResultId=I;$("#"+I).addClass("selectResult");$("#"+I).css("color","#551a8b")}var B=I.substring(I.indexOf("_")+1);var G=searchArray[B];var A=G.CharResults[0];var E=A.PageIndex;var F=A.Rec.X.Value;var J=A.Rec.Y.Value;var H=_zoomRatio*_zoomIndex;F=Math.ceil(F*H);J=Math.ceil(J*H)-40;if(E==_curCorrectPageId){if(_viewerMode=="single"){$("#_plcBigImg").scrollLeft(F);$("#_plcBigImg").scrollTop(J)}else{var C=_fileDocument[curFileId].GetShowIndex(E);ChangeDocScrollBar(C,_pageHeight);$("#_plcBigImg").scrollLeft(F);$("#_plcBigImg").scrollTop($("#_plcBigImg").scrollTop()+J)}}else{ChangePg(E);if(_viewerMode=="single"){$("#_plcBigImg").scrollLeft(F);$("#_plcBigImg").scrollTop(J)}else{var C=_fileDocument[curFileId].GetShowIndex(E);ChangeDocScrollBar(C,_pageHeight);$("#_plcBigImg").scrollLeft(F);$("#_plcBigImg").scrollTop($("#_plcBigImg").scrollTop()+J)}}}var activePanel=new Array();function btnDownOrUp(A){var D=A.id;var C=D.substring(D.indexOf("_")+1);var B="outLine_"+C+"_next";if(activePanel.in_array(B)){Rotate("outLineIcon_"+C,0);$("#"+B).hide();activePanel.remove(B)}else{Rotate("outLineIcon_"+C,90);$("#"+B).show();activePanel.push(B)}}function Rotate(A,B){A=document.getElementById(A);if(A.style.msTransform!==undefined){A.style.msTransform="rotate("+B+"deg)"}else{if(A.style.MozTransform!==undefined){A.style.MozTransform="rotate("+B+"deg)"}else{if(A.style.OTransform!==undefined){A.style.OTransform="rotate("+B+"deg)"}else{if(A.style.webkitTransform!==undefined){A.style.webkitTransform="rotate("+B+"deg)"}else{A.style.transform="rotate("+B+"deg)"}}}}}Array.prototype.indexOf=function(B){for(var A=0;A<this.length;A++){if(this[A]==B){return A}}return -1};Array.prototype.remove=function(B){var A=this.indexOf(B);if(A>-1){this.splice(A,1)}};function PreCountHeight(D){var B=0;for(var A=0;A<D;A++){var C=_fileDocument[curFileId].GetPageIndex(A);if(otherHeights.in_array(C)){_fileDocument[curFileId].Viewers[C].GetViewerLeftTop();B+=_fileDocument[curFileId].Viewers[C].ActualHeight}else{B+=_pageHeight}}return B}function PrePageCount(C){var B=0;var D=parseInt(C/_pageHeight);for(var A=0;A<=D;A++){var E=_fileDocument[curFileId].GetPageIndex(A);if(otherHeights.in_array(E)){_fileDocument[curFileId].Viewers[E].GetViewerLeftTop();B+=_fileDocument[curFileId].Viewers[E].ActualHeight}else{B+=_pageHeight}}if(parseFloat(B)>=parseFloat(C)){return D}else{for(var A=D;A<_totalPageCount;A++){var E=_fileDocument[curFileId].GetPageIndex(A);if(otherWidths.in_array(E)){_fileDocument[curFileId].Viewers[E].GetViewerLeftTop();B+=_fileDocument[curFileId].Viewers[E].ActualHeight}else{B+=_pageHeight}D++;if(B>=C){return D}}}}function FileNotFound(){if(!OnceShow){OnceShow=true;alert("Content can not be found,Please re-open this file!!");var A=window.document.location.href;window.location.href=A;OnceShow=false}}function AlertPanel(B,A){$("#_alertContent").html(B);$("#_alertPanel").show();SignPanelPosition("#_alertPanel");$("#_alertPanel").css("background",A);setTimeout(function(){$("#_alertPanel").hide()},1500)}function ShowConfirmDialog(){$("#loading_div").hide();$("#content").empty()}function unpack(F){var A=new Array();if(F.length<1){return null}for(var B=1;B<F.length;B++){var E=F[B];var D=new Object();D.StringVale=E[0];D.MinHeight=E[1];D.MaxHeight=E[2];D.CharBoundaryLst=new Array();if(typeof(E[3])!="undefind"){for(var C=0;C<E[3].length;C++){D.CharBoundaryLst[C]=new Object();D.CharBoundaryLst[C].X=E[3][C][0];D.CharBoundaryLst[C].Y=E[3][C][1];D.CharBoundaryLst[C].W=E[3][C][2];D.CharBoundaryLst[C].H=E[3][C][3]}D.CharStyleLst=new Array();A[B-1]=D}}return A}function unpackCell(E){var A=new Array();if(E.length<1){return null}for(var B=1;B<E.length;B++){var F=E[B];var D=new Object();if(F.length>0){var C=F[0];if(C.length==4){D.CellRegion=new Object();D.CellRegion.X=C[0];D.CellRegion.Y=C[1];D.CellRegion.W=C[2];D.CellRegion.H=C[3]}}if(F.length>1){D.CellBoundaryList=unpack(F[1])}A[B-1]=D}return A}function unpackSearch(B){var F=new Array();if(B.length<1){return F}for(var E=1;E<B.length;E++){var J=B[E];var I=new Object();I.MatchedString=J[0];I.ContextString=J[1];I.KeywordOffset=J[2];I.KeywordLength=J[3];I.CharResults=new Array();I.CombinedResultArea=new Array();if(typeof(J[4])!="undefined"){for(var D=0;D<J[4].length;D++){var H=J[4][D];var C=new Object();C.PageIndex=H[0];C.CharValue=H[1];C.CharIndex=H[2];C.IndexAtPage=H[3];if(H[4]==1){C.IsSystemFont=true}else{C.IsSystemFont=false}C.Rec=unpackREReactangle(H[5]);I.CharResults[D]=C}}if(typeof(J[5])!="undefined"){for(var D=0;D<J[5].length;D++){var G=J[5][D];var A=new Object();A.PageIndex=G[0];A.Area=unpackREReactangle(G[1]);I.CombinedResultArea[D]=A}}F[E-1]=I}return F}function unpackREReactangle(A){if(typeof(A)=="undefined"){return null}var B=new Object();B.X=new Object();B.X.Unit=5;B.X.Value=A[0];B.Y=new Object();B.Y.Unit=5;B.Y.Value=A[1];B.Width=new Object();B.Width.Unit=5;B.Width.Value=A[2];B.Height=new Object();B.Height.Unit=5;B.Height.Value=A[3];return B}
/* Hammer.JS - v2.0.4 - 2014-09-28
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2014 Jorik Tangelder;
 * Licensed under the MIT license */
(function(h,q,k,AD){var A9=["","webkit","moz","MS","ms","o"];var Ad=q.createElement("div");var AC="function";var Bj=Math.round;var Al=Math.abs;var c=Date.now;function Bh(Br,Bp,Bq){return setTimeout(AF(Br,Bq),Bp)}function n(Bq,Br,Bp){if(Array.isArray(Bq)){AR(Bq,Bp[Br],Bp);return true}return false}function AR(Br,Bq,Bp){var Bs;if(!Br){return}if(Br.forEach){Br.forEach(Bq,Bp)}else{if(Br.length!==AD){Bs=0;while(Bs<Br.length){Bq.call(Bp,Br[Bs],Bs,Br);Bs++}}else{for(Bs in Br){Br.hasOwnProperty(Bs)&&Bq.call(Bp,Br[Bs],Bs,Br)}}}}function Z(Bq,Bt,Br){var Bs=Object.keys(Bt);var Bp=0;while(Bp<Bs.length){if(!Br||(Br&&Bq[Bs[Bp]]===AD)){Bq[Bs[Bp]]=Bt[Bs[Bp]]}Bp++}return Bq}function Aa(Bp,Bq){return Z(Bp,Bq,true)}function Af(Bq,Bt,Br){var Bp=Bt.prototype,Bs;Bs=Bq.prototype=Object.create(Bp);Bs.constructor=Bq;Bs._super=Bp;if(Br){Z(Bs,Br)}}function AF(Br,Bp){return function Bq(){return Br.apply(Bp,arguments)}}function j(Bp,Bq){if(typeof Bp==AC){return Bp.apply(Bq?Bq[0]||AD:AD,Bq)}return Bp}function Au(Bq,Bp){return(Bq===AD)?Bp:Bq}function g(Br,Bp,Bq){AR(b(Bp),function(Bs){Br.addEventListener(Bs,Bq,false)})}function m(Br,Bp,Bq){AR(b(Bp),function(Bs){Br.removeEventListener(Bs,Bq,false)})}function Ao(Bp,Bq){while(Bp){if(Bp==Bq){return true}Bp=Bp.parentNode}return false}function w(Bq,Bp){return Bq.indexOf(Bp)>-1}function b(Bp){return Bp.trim().split(/\s+/g)}function Ba(Bs,Bq,Bp){if(Bs.indexOf&&!Bp){return Bs.indexOf(Bq)}else{var Br=0;while(Br<Bs.length){if((Bp&&Bs[Br][Bp]==Bq)||(!Bp&&Bs[Br]===Bq)){return Br}Br++}return -1}}function A(Bp){return Array.prototype.slice.call(Bp,0)}function J(Bp,Bu,Bw){var Br=[];var Bt=[];var Bs=0;while(Bs<Bp.length){var Bq=Bu?Bp[Bs][Bu]:Bp[Bs];if(Ba(Bt,Bq)<0){Br.push(Bp[Bs])}Bt[Bs]=Bq;Bs++}if(Bw){if(!Bu){Br=Br.sort()}else{Br=Br.sort(function Bv(By,Bx){return By[Bu]>Bx[Bu]})}}return Br}function AO(Bq,Bt){var Br,Bu;var Bp=Bt[0].toUpperCase()+Bt.slice(1);var Bs=0;while(Bs<A9.length){Br=A9[Bs];Bu=(Br)?Br+Bp:Bt;if(Bu in Bq){return Bu}Bs++}return AD}var P=1;function t(){return P++}function z(Bp){var Bq=Bp.ownerDocument;return(Bq.defaultView||Bq.parentWindow)}var C=/mobile|tablet|ip(ad|hone|od)|android/i;var Aq=("ontouchstart" in h);var I=AO(h,"PointerEvent")!==AD;var Bn=Aq&&C.test(navigator.userAgent);var Bk="touch";var Az="pen";var l="mouse";var V="kinect";var F=25;var f=1;var AL=2;var AY=4;var Bl=8;var Ar=1;var AX=2;var Bg=4;var At=8;var Ae=16;var Ai=AX|Bg;var Bf=At|Ae;var AW=Ai|Bf;var Ak=["x","y"];var A5=["clientX","clientY"];function A7(Br,Bp){var Bq=this;this.manager=Br;this.callback=Bp;this.element=Br.element;this.target=Br.options.inputTarget;this.domHandler=function(Bs){if(j(Br.options.enable,[Br])){Bq.handler(Bs)}};this.init()}A7.prototype={handler:function(){},init:function(){this.evEl&&g(this.element,this.evEl,this.domHandler);this.evTarget&&g(this.target,this.evTarget,this.domHandler);this.evWin&&g(z(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&m(this.element,this.evEl,this.domHandler);this.evTarget&&m(this.target,this.evTarget,this.domHandler);this.evWin&&m(z(this.element),this.evWin,this.domHandler)}};function AK(Bq){var Br;var Bp=Bq.options.inputClass;if(Bp){Br=Bp}else{if(I){Br=A2}else{if(Bn){Br=Bo}else{if(!Aq){Br=X}else{Br=p}}}}return new (Br)(Bq,s)}function s(Br,Bq,Bt){var Bv=Bt.pointers.length;var Bp=Bt.changedPointers.length;var Bs=(Bq&f&&(Bv-Bp===0));var Bu=(Bq&(AY|Bl)&&(Bv-Bp===0));Bt.isFirst=!!Bs;Bt.isFinal=!!Bu;if(Bs){Br.session={}}Bt.eventType=Bq;AH(Br,Bt);Br.emit("hammer.input",Bt);Br.recognize(Bt);Br.session.prevInput=Bt}function AH(Bt,Bu){var Bq=Bt.session;var Bx=Bu.pointers;var Bs=Bx.length;if(!Bq.firstInput){Bq.firstInput=Ab(Bu)}if(Bs>1&&!Bq.firstMultiple){Bq.firstMultiple=Ab(Bu)}else{if(Bs===1){Bq.firstMultiple=false}}var Bw=Bq.firstInput;var Bv=Bq.firstMultiple;var By=Bv?Bv.center:Bw.center;var Bp=Bu.center=G(Bx);Bu.timeStamp=c();Bu.deltaTime=Bu.timeStamp-Bw.timeStamp;Bu.angle=AJ(By,Bp);Bu.distance=W(By,Bp);M(Bq,Bu);Bu.offsetDirection=B(Bu.deltaX,Bu.deltaY);Bu.scale=Bv?r(Bv.pointers,Bx):1;Bu.rotation=Bv?L(Bv.pointers,Bx):0;AG(Bq,Bu);var Br=Bt.element;if(Ao(Bu.srcEvent.target,Br)){Br=Bu.srcEvent.target}Bu.target=Br}function M(Bp,Bt){var Bs=Bt.center;var Bq=Bp.offsetDelta||{};var Bu=Bp.prevDelta||{};var Br=Bp.prevInput||{};if(Bt.eventType===f||Br.eventType===AY){Bu=Bp.prevDelta={x:Br.deltaX||0,y:Br.deltaY||0};Bq=Bp.offsetDelta={x:Bs.x,y:Bs.y}}Bt.deltaX=Bu.x+(Bs.x-Bq.x);Bt.deltaY=Bu.y+(Bs.y-Bq.y)}function AG(Bx,Bw){var Bu=Bx.lastInterval||Bw,Br=Bw.timeStamp-Bu.timeStamp,Bs,Bp,Bz,Bq;if(Bw.eventType!=Bl&&(Br>F||Bu.velocity===AD)){var By=Bu.deltaX-Bw.deltaX;var Bv=Bu.deltaY-Bw.deltaY;var Bt=AS(Br,By,Bv);Bp=Bt.x;Bz=Bt.y;Bs=(Al(Bt.x)>Al(Bt.y))?Bt.x:Bt.y;Bq=B(By,Bv);Bx.lastInterval=Bw}else{Bs=Bu.velocity;Bp=Bu.velocityX;Bz=Bu.velocityY;Bq=Bu.direction}Bw.velocity=Bs;Bw.velocityX=Bp;Bw.velocityY=Bz;Bw.direction=Bq}function Ab(Br){var Bq=[];var Bp=0;while(Bp<Br.pointers.length){Bq[Bp]={clientX:Bj(Br.pointers[Bp].clientX),clientY:Bj(Br.pointers[Bp].clientY)};Bp++}return{timeStamp:c(),pointers:Bq,center:G(Bq),deltaX:Br.deltaX,deltaY:Br.deltaY}}function G(Br){var Bp=Br.length;if(Bp===1){return{x:Bj(Br[0].clientX),y:Bj(Br[0].clientY)}}var Bs=0,Bt=0,Bq=0;while(Bq<Bp){Bs+=Br[Bq].clientX;Bt+=Br[Bq].clientY;Bq++}return{x:Bj(Bs/Bp),y:Bj(Bt/Bp)}}function AS(Br,Bp,Bq){return{x:Bp/Br||0,y:Bq/Br||0}}function B(Bp,Bq){if(Bp===Bq){return Ar}if(Al(Bp)>=Al(Bq)){return Bp>0?AX:Bg}return Bq>0?At:Ae}function W(Bp,Bs,Br){if(!Br){Br=Ak}var Bq=Bs[Br[0]]-Bp[Br[0]],Bt=Bs[Br[1]]-Bp[Br[1]];return Math.sqrt((Bq*Bq)+(Bt*Bt))}function AJ(Bp,Bs,Br){if(!Br){Br=Ak}var Bq=Bs[Br[0]]-Bp[Br[0]],Bt=Bs[Br[1]]-Bp[Br[1]];return Math.atan2(Bt,Bq)*180/Math.PI}function L(Bq,Bp){return AJ(Bp[1],Bp[0],A5)-AJ(Bq[1],Bq[0],A5)}function r(Bq,Bp){return W(Bp[0],Bp[1],A5)/W(Bq[0],Bq[1],A5)}var As={mousedown:f,mousemove:AL,mouseup:AY};var Bm="mousedown";var H="mousemove mouseup";function X(){this.evEl=Bm;this.evWin=H;this.allow=true;this.pressed=false;A7.apply(this,arguments)}Af(X,A7,{handler:function Ac(Bq){var Bp=As[Bq.type];if(Bp&f&&Bq.button===0){this.pressed=true}if(Bp&AL&&Bq.which!==1){Bp=AY}if(!this.pressed||!this.allow){return}if(Bp&AY){this.pressed=false}this.callback(this.manager,Bp,{pointers:[Bq],changedPointers:[Bq],pointerType:l,srcEvent:Bq})}});var An={pointerdown:f,pointermove:AL,pointerup:AY,pointercancel:Bl,pointerout:Bl};var Y={2:Bk,3:Az,4:l,5:V};var A4="pointerdown";var o="pointermove pointerup pointercancel";if(h.MSPointerEvent){A4="MSPointerDown";o="MSPointerMove MSPointerUp MSPointerCancel"}function A2(){this.evEl=A4;this.evWin=o;A7.apply(this,arguments);this.store=(this.manager.session.pointerEvents=[])}Af(A2,A7,{handler:function Aw(Bq){var Bv=this.store;var Bt=false;var Br=Bq.type.toLowerCase().replace("ms","");var Bw=An[Br];var Bp=Y[Bq.pointerType]||Bq.pointerType;var Bu=(Bp==Bk);var Bs=Ba(Bv,Bq.pointerId,"pointerId");if(Bw&f&&(Bq.button===0||Bu)){if(Bs<0){Bv.push(Bq);Bs=Bv.length-1}}else{if(Bw&(AY|Bl)){Bt=true}}if(Bs<0){return}Bv[Bs]=Bq;this.callback(this.manager,Bw,{pointers:Bv,changedPointers:[Bq],pointerType:Bp,srcEvent:Bq});if(Bt){Bv.splice(Bs,1)}}});var T={touchstart:f,touchmove:AL,touchend:AY,touchcancel:Bl};var R="touchstart";var d="touchstart touchmove touchend touchcancel";function Ag(){this.evTarget=R;this.evWin=d;this.started=false;A7.apply(this,arguments)}Af(Ag,A7,{handler:function Bc(Br){var Bp=T[Br.type];if(Bp===f){this.started=true}if(!this.started){return}var Bq=i.call(this,Br,Bp);if(Bp&(AY|Bl)&&Bq[0].length-Bq[1].length===0){this.started=false}this.callback(this.manager,Bp,{pointers:Bq[0],changedPointers:Bq[1],pointerType:Bk,srcEvent:Br})}});function i(Br,Bp){var Bs=A(Br.touches);var Bq=A(Br.changedTouches);if(Bp&(AY|Bl)){Bs=J(Bs.concat(Bq),"identifier",true)}return[Bs,Bq]}var Av={touchstart:f,touchmove:AL,touchend:AY,touchcancel:Bl};var AA="touchstart touchmove touchend touchcancel";function Bo(){this.evTarget=AA;this.targetIds={};A7.apply(this,arguments)}Af(Bo,A7,{handler:function E(Br){var Bp=Av[Br.type];var Bq=O.call(this,Br,Bp);if(!Bq){return}this.callback(this.manager,Bp,{pointers:Bq[0],changedPointers:Bq[1],pointerType:Bk,srcEvent:Br})}});function O(Bq,Bw){var Bp=A(Bq.touches);var Bu=this.targetIds;if(Bw&(f|AL)&&Bp.length===1){Bu[Bp[0].identifier]=true;return[Bp,Bp]}var Bs,Br,Bt=A(Bq.changedTouches),Bx=[],Bv=this.target;Br=Bp.filter(function(By){return Ao(By.target,Bv)});if(Bw===f){Bs=0;while(Bs<Br.length){Bu[Br[Bs].identifier]=true;Bs++}}Bs=0;while(Bs<Bt.length){if(Bu[Bt[Bs].identifier]){Bx.push(Bt[Bs])}if(Bw&(AY|Bl)){delete Bu[Bt[Bs].identifier]}Bs++}if(!Bx.length){return}return[J(Br.concat(Bx),"identifier",true),Bx]}function p(){A7.apply(this,arguments);var Bp=AF(this.handler,this);this.touch=new Bo(this.manager,Bp);this.mouse=new X(this.manager,Bp)}Af(p,A7,{handler:function u(Br,Bq,Bt){var Bp=(Bt.pointerType==Bk),Bs=(Bt.pointerType==l);if(Bp){this.mouse.allow=false}else{if(Bs&&!this.mouse.allow){return}}if(Bq&(AY|Bl)){this.mouse.allow=true}this.callback(Br,Bq,Bt)},destroy:function AB(){this.touch.destroy();this.mouse.destroy()}});var U=AO(Ad.style,"touchAction");var Am=U!==AD;var AZ="compute";var AN="auto";var a="manipulation";var Bi="none";var AT="pan-x";var AV="pan-y";function Be(Bp,Bq){this.manager=Bp;this.set(Bq)}Be.prototype={set:function(Bp){if(Bp==AZ){Bp=this.compute()}if(Am){this.manager.element.style[U]=Bp}this.actions=Bp.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Bp=[];AR(this.manager.recognizers,function(Bq){if(j(Bq.options.enable,[Bq])){Bp=Bp.concat(Bq.getTouchAction())}});return K(Bp.join(" "))},preventDefaults:function(Bs){if(Am){return}var Bv=Bs.srcEvent;var Bu=Bs.offsetDirection;if(this.manager.session.prevented){Bv.preventDefault();return}var Bt=this.actions;var Bp=w(Bt,Bi);var Br=w(Bt,AV);var Bq=w(Bt,AT);if(Bp||(Br&&Bu&Ai)||(Bq&&Bu&Bf)){return this.preventSrc(Bv)}},preventSrc:function(Bp){this.manager.session.prevented=true;Bp.preventDefault()}};function K(Bp){if(w(Bp,Bi)){return Bi}var Bq=w(Bp,AT);var Br=w(Bp,AV);if(Bq&&Br){return AT+" "+AV}if(Bq||Br){return Bq?AT:AV}if(w(Bp,a)){return a}return AN}var Bb=1;var A1=2;var N=4;var AU=8;var S=AU;var Ah=16;var AP=32;function Q(Bp){this.id=t();this.manager=null;this.options=Aa(Bp||{},this.defaults);this.options.enable=Au(this.options.enable,true);this.state=Bb;this.simultaneous={};this.requireFail=[]}Q.prototype={defaults:{},set:function(Bp){Z(this.options,Bp);this.manager&&this.manager.touchAction.update();return this},recognizeWith:function(Bp){if(n(Bp,"recognizeWith",this)){return this}var Bq=this.simultaneous;Bp=A0(Bp,this);if(!Bq[Bp.id]){Bq[Bp.id]=Bp;Bp.recognizeWith(this)}return this},dropRecognizeWith:function(Bp){if(n(Bp,"dropRecognizeWith",this)){return this}Bp=A0(Bp,this);delete this.simultaneous[Bp.id];return this},requireFailure:function(Bq){if(n(Bq,"requireFailure",this)){return this}var Bp=this.requireFail;Bq=A0(Bq,this);if(Ba(Bp,Bq)===-1){Bp.push(Bq);Bq.requireFailure(this)}return this},dropRequireFailure:function(Bp){if(n(Bp,"dropRequireFailure",this)){return this}Bp=A0(Bp,this);var Bq=Ba(this.requireFail,Bp);if(Bq>-1){this.requireFail.splice(Bq,1)}return this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Bp){return !!this.simultaneous[Bp.id]},emit:function(Bq){var Bp=this;var Bs=this.state;function Br(Bt){Bp.manager.emit(Bp.options.event+(Bt?e(Bs):""),Bq)}if(Bs<AU){Br(true)}Br();if(Bs>=AU){Br(true)}},tryEmit:function(Bp){if(this.canEmit()){return this.emit(Bp)}this.state=AP},canEmit:function(){var Bp=0;while(Bp<this.requireFail.length){if(!(this.requireFail[Bp].state&(AP|Bb))){return false}Bp++}return true},recognize:function(Bq){var Bp=Z({},Bq);if(!j(this.options.enable,[this,Bp])){this.reset();this.state=AP;return}if(this.state&(S|Ah|AP)){this.state=Bb}this.state=this.process(Bp);if(this.state&(A1|N|AU|Ah)){this.tryEmit(Bp)}},process:function(Bp){},getTouchAction:function(){},reset:function(){}};function e(Bp){if(Bp&Ah){return"cancel"}else{if(Bp&AU){return"end"}else{if(Bp&N){return"move"}else{if(Bp&A1){return"start"}}}}return""}function AM(Bp){if(Bp==Ae){return"down"}else{if(Bp==At){return"up"}else{if(Bp==AX){return"left"}else{if(Bp==Bg){return"right"}}}}return""}function A0(Br,Bp){var Bq=Bp.manager;if(Bq){return Bq.get(Br)}return Br}function Ax(){Q.apply(this,arguments)}Af(Ax,Q,{defaults:{pointers:1},attrTest:function(Bq){var Bp=this.options.pointers;return Bp===0||Bq.pointers.length===Bp},process:function(Bs){var Bt=this.state;var Bq=Bs.eventType;var Bp=Bt&(A1|N);var Br=this.attrTest(Bs);if(Bp&&(Bq&Bl||!Br)){return Bt|Ah}else{if(Bp||Br){if(Bq&AY){return Bt|AU}else{if(!(Bt&A1)){return A1}}return Bt|N}}return AP}});function AI(){Ax.apply(this,arguments);this.pX=null;this.pY=null}Af(AI,Ax,{defaults:{event:"pan",threshold:10,pointers:1,direction:AW},getTouchAction:function(){var Bq=this.options.direction;var Bp=[];if(Bq&Ai){Bp.push(AV)}if(Bq&Bf){Bp.push(AT)}return Bp},directionTest:function(Br){var Bq=this.options;var Bv=true;var Bu=Br.distance;var Bp=Br.direction;var Bs=Br.deltaX;var Bt=Br.deltaY;if(!(Bp&Bq.direction)){if(Bq.direction&Ai){Bp=(Bs===0)?Ar:(Bs<0)?AX:Bg;Bv=Bs!=this.pX;Bu=Math.abs(Br.deltaX)}else{Bp=(Bt===0)?Ar:(Bt<0)?At:Ae;Bv=Bt!=this.pY;Bu=Math.abs(Br.deltaY)}}Br.direction=Bp;return Bv&&Bu>Bq.threshold&&Bp&Bq.direction},attrTest:function(Bp){return Ax.prototype.attrTest.call(this,Bp)&&(this.state&A1||(!(this.state&A1)&&this.directionTest(Bp)))},emit:function(Bp){this.pX=Bp.deltaX;this.pY=Bp.deltaY;var Bq=AM(Bp.direction);if(Bq){this.manager.emit(this.options.event+Bq,Bp)}this._super.emit.call(this,Bp)}});function A8(){Ax.apply(this,arguments)}Af(A8,Ax,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Bi]},attrTest:function(Bp){return this._super.attrTest.call(this,Bp)&&(Math.abs(Bp.scale-1)>this.options.threshold||this.state&A1)},emit:function(Bq){this._super.emit.call(this,Bq);if(Bq.scale!==1){var Bp=Bq.scale<1?"in":"out";this.manager.emit(this.options.event+Bp,Bq)}}});function AE(){Q.apply(this,arguments);this._timer=null;this._input=null}Af(AE,Q,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[AN]},process:function(Bs){var Br=this.options;var Bt=Bs.pointers.length===Br.pointers;var Bp=Bs.distance<Br.threshold;var Bq=Bs.deltaTime>Br.time;this._input=Bs;if(!Bp||!Bt||(Bs.eventType&(AY|Bl)&&!Bq)){this.reset()}else{if(Bs.eventType&f){this.reset();this._timer=Bh(function(){this.state=S;this.tryEmit()},Br.time,this)}else{if(Bs.eventType&AY){return S}}}return AP},reset:function(){clearTimeout(this._timer)},emit:function(Bp){if(this.state!==S){return}if(Bp&&(Bp.eventType&AY)){this.manager.emit(this.options.event+"up",Bp)}else{this._input.timeStamp=c();this.manager.emit(this.options.event,this._input)}}});function Ap(){Ax.apply(this,arguments)}Af(Ap,Ax,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Bi]},attrTest:function(Bp){return this._super.attrTest.call(this,Bp)&&(Math.abs(Bp.rotation)>this.options.threshold||this.state&A1)}});function A3(){Ax.apply(this,arguments)}Af(A3,Ax,{defaults:{event:"swipe",threshold:10,velocity:0.65,direction:Ai|Bf,pointers:1},getTouchAction:function(){return AI.prototype.getTouchAction.call(this)},attrTest:function(Bp){var Br=this.options.direction;var Bq;if(Br&(Ai|Bf)){Bq=Bp.velocity}else{if(Br&Ai){Bq=Bp.velocityX}else{if(Br&Bf){Bq=Bp.velocityY}}}return this._super.attrTest.call(this,Bp)&&Br&Bp.direction&&Bp.distance>this.options.threshold&&Al(Bq)>this.options.velocity&&Bp.eventType&AY},emit:function(Bp){var Bq=AM(Bp.direction);if(Bq){this.manager.emit(this.options.event+Bq,Bp)}this.manager.emit(this.options.event,Bp)}});function v(){Q.apply(this,arguments);this.pTime=false;this.pCenter=false;this._timer=null;this._input=null;this.count=0}Af(v,Q,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[a]},process:function(Bv){var Bt=this.options;var Br=Bv.pointers.length===Bt.pointers;var Bw=Bv.distance<Bt.threshold;var Bs=Bv.deltaTime<Bt.time;this.reset();if((Bv.eventType&f)&&(this.count===0)){return this.failTimeout()}if(Bw&&Bs&&Br){if(Bv.eventType!=AY){return this.failTimeout()}var Bq=this.pTime?(Bv.timeStamp-this.pTime<Bt.interval):true;var Bp=!this.pCenter||W(this.pCenter,Bv.center)<Bt.posThreshold;this.pTime=Bv.timeStamp;this.pCenter=Bv.center;if(!Bp||!Bq){this.count=1}else{this.count+=1}this._input=Bv;var Bu=this.count%Bt.taps;if(Bu===0){if(!this.hasRequireFailures()){return S}else{this._timer=Bh(function(){this.state=S;this.tryEmit()},Bt.interval,this);return A1}}}return AP},failTimeout:function(){this._timer=Bh(function(){this.state=AP},this.options.interval,this);return AP},reset:function(){clearTimeout(this._timer)},emit:function(){if(this.state==S){this._input.tapCount=this.count;this.manager.emit(this.options.event,this._input)}}});function Aj(Bq,Bp){Bp=Bp||{};Bp.recognizers=Au(Bp.recognizers,Aj.defaults.preset);return new Ay(Bq,Bp)}Aj.VERSION="2.0.4";Aj.defaults={domEvents:false,touchAction:AZ,enable:true,inputTarget:null,inputClass:null,preset:[[Ap,{enable:false}],[A8,{enable:false},["rotate"]],[A3,{direction:Ai}],[AI,{direction:Ai},["swipe"]],[v],[v,{event:"doubletap",taps:2},["tap"]],[AE]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Bd=1;var AQ=2;function Ay(Bq,Bp){Bp=Bp||{};this.options=Aa(Bp,Aj.defaults);this.options.inputTarget=this.options.inputTarget||Bq;this.handlers={};this.session={};this.recognizers=[];this.element=Bq;this.input=AK(this);this.touchAction=new Be(this,this.options.touchAction);D(this,true);AR(Bp.recognizers,function(Bs){var Br=this.add(new (Bs[0])(Bs[1]));Bs[2]&&Br.recognizeWith(Bs[2]);Bs[3]&&Br.requireFailure(Bs[3])},this)}Ay.prototype={set:function(Bp){Z(this.options,Bp);if(Bp.touchAction){this.touchAction.update()}if(Bp.inputTarget){this.input.destroy();this.input.target=Bp.inputTarget;this.input.init()}return this},stop:function(Bp){this.session.stopped=Bp?AQ:Bd},recognize:function(Bu){var Bp=this.session;if(Bp.stopped){return}this.touchAction.preventDefaults(Bu);var Bs;var Br=this.recognizers;var Bt=Bp.curRecognizer;if(!Bt||(Bt&&Bt.state&S)){Bt=Bp.curRecognizer=null}var Bq=0;while(Bq<Br.length){Bs=Br[Bq];if(Bp.stopped!==AQ&&(!Bt||Bs==Bt||Bs.canRecognizeWith(Bt))){Bs.recognize(Bu)}else{Bs.reset()}if(!Bt&&Bs.state&(A1|N|AU)){Bt=Bp.curRecognizer=Bs}Bq++}},get:function(Br){if(Br instanceof Q){return Br}var Bq=this.recognizers;for(var Bp=0;Bp<Bq.length;Bp++){if(Bq[Bp].options.event==Br){return Bq[Bp]}}return null},add:function(Bp){if(n(Bp,"add",this)){return this}var Bq=this.get(Bp.options.event);if(Bq){this.remove(Bq)}this.recognizers.push(Bp);Bp.manager=this;this.touchAction.update();return Bp},remove:function(Bq){if(n(Bq,"remove",this)){return this}var Bp=this.recognizers;Bq=this.get(Bq);Bp.splice(Ba(Bp,Bq),1);this.touchAction.update();return this},on:function(Bq,Bp){var Br=this.handlers;AR(b(Bq),function(Bs){Br[Bs]=Br[Bs]||[];Br[Bs].push(Bp)});return this},off:function(Bq,Bp){var Br=this.handlers;AR(b(Bq),function(Bs){if(!Bp){delete Br[Bs]}else{Br[Bs].splice(Ba(Br[Bs],Bp),1)}});return this},emit:function(Bq,Bs){if(this.options.domEvents){A6(Bq,Bs)}var Br=this.handlers[Bq]&&this.handlers[Bq].slice();if(!Br||!Br.length){return}Bs.type=Bq;Bs.preventDefault=function(){Bs.srcEvent.preventDefault()};var Bp=0;while(Bp<Br.length){Br[Bp](Bs);Bp++}},destroy:function(){this.element&&D(this,false);this.handlers={};this.session={};this.input.destroy();this.element=null}};function D(Bp,Bq){var Br=Bp.element;AR(Bp.options.cssProps,function(Bt,Bs){Br.style[AO(Br.style,Bs)]=Bq?Bt:""})}function A6(Bq,Br){var Bp=q.createEvent("Event");Bp.initEvent(Bq,true,true);Bp.gesture=Br;Br.target.dispatchEvent(Bp)}Z(Aj,{INPUT_START:f,INPUT_MOVE:AL,INPUT_END:AY,INPUT_CANCEL:Bl,STATE_POSSIBLE:Bb,STATE_BEGAN:A1,STATE_CHANGED:N,STATE_ENDED:AU,STATE_RECOGNIZED:S,STATE_CANCELLED:Ah,STATE_FAILED:AP,DIRECTION_NONE:Ar,DIRECTION_LEFT:AX,DIRECTION_RIGHT:Bg,DIRECTION_UP:At,DIRECTION_DOWN:Ae,DIRECTION_HORIZONTAL:Ai,DIRECTION_VERTICAL:Bf,DIRECTION_ALL:AW,Manager:Ay,Input:A7,TouchAction:Be,TouchInput:Bo,MouseInput:X,PointerEventInput:A2,TouchMouseInput:p,SingleTouchInput:Ag,Recognizer:Q,AttrRecognizer:Ax,Tap:v,Pan:AI,Swipe:A3,Pinch:A8,Rotate:Ap,Press:AE,on:g,off:m,each:AR,merge:Aa,extend:Z,inherit:Af,bindFn:AF,prefixed:AO});if(typeof define==AC&&define.amd){define(function(){return Aj})}else{if(typeof module!="undefined"&&module.exports){module.exports=Aj}else{h[k]=Aj}}})(window,document,"Hammer");var resizeFunction=function(){if(_isFull){ChangeControlSize()}else{ContentCss();if(dialogOpen){if(_isIpad){window.scrollTo(0,0);widthCenter=(viewer_clientWidth-$("#dialog").width())/2;heightCenter=(viewer_clientHeight-$("#dialog").height())/2;$("#dialog").dialog({position:[widthCenter,heightCenter]})}else{$("#dialog").dialog({position:{my:"center",at:"center center"}})}}}if(showCommentsPanel){CommentsPosition()}};window.onresize=function(){viewer_clientWidth=window.innerWidth;viewer_clientHeight=window.innerHeight;resizeFunction()};var clientwidth;function ChangeControlSize(){$(".re_header").hide();var G=viewer_clientWidth;clientwidth=G;var I=viewer_clientHeight;$(".re_container").width(G+"px");$(".re_container").css("margin-left","0px");ToolbarCss(G);$(".re_content").width(G+"px");var A=$("#_plcTabs").outerWidth(true);var F;if(_isStretch){F=G-A}else{F=G-tabWidth}$("#_plcBigImg").width(F+"px");$("#re_canvas").width((F-17)+"px");_docWidth=F-27;footerContentOffset(G);$("#_footerImg").css("padding","0px "+rightOffset+"px 0px "+leftOffset+"px");$("#_footerImg").width(G-(leftOffset+rightOffset)+"px");var E=$(".re_func_toolbar").outerHeight()+7;var B=$("#_footerImg").height();$(".re_footer").hide();var D=I-E-B;$("#_plcTabs").height(D);$("#_plcResize").height(D);$("#_plcImgsThumbs").height(D-40-$("#_plcNavi").outerHeight());$("#_plcBigImg").height(D);$("#re_canvas").height(D-17);$("#_searchResult").height(D-$("#_plcNavi").outerHeight()-135);_docHeight=D-22;LoadingCss(G,I-6);if(_fid!=null&&_fid!=""){_fileDocument[curFileId].ChangeState();var H=parseInt(_curCorrectPageId);actualIndex=_fileDocument[curFileId].GetPageIndex(H);var C=_fileDocument[curFileId].Viewers[actualIndex];if(_imageFormat=="Svg"){Adaptive(C)}ChangeViewerPosition(actualIndex);resizeDocViewerByCSS3("imgBig",actualIndex);changePosition();if(_imageFormat=="Bitmap"){if(_zoomListIndex<=maxIndex){RectifyZoom();if(C.Currentzoom>_actualZoomIndex){CreateNewImage(actualIndex)}}}ImageViewerAnnotationResize(actualIndex);showIndex=_fileDocument[curFileId].GetShowIndex(actualIndex);addShowPageIds()}}function ReAllocate(C){var A=C+tabWidth+_resizePartWidth;var E;if(_isFull){E=clientwidth-A}else{E=viewerContainer_width-A}$("#_plcTabs").css({"width":A+"px"});$("#tabs").css({"width":A+"px"});$("#_plcImgsThumbs").css({"width":(C-20)+"px"});$("#_plcNavi").css({"width":C+"px"});$("#_plcBigImg").css({"width":E+"px"});$("#re_canvas").css({"width":(E-17)+"px"});_docWidth=E-27;var B=parseInt(_curCorrectPageId);actualIndex=_fileDocument[curFileId].GetPageIndex(B);if(_imageFormat=="Svg"){var D=_fileDocument[curFileId].Viewers[actualIndex];Adaptive(D)}ChangeViewerPosition(actualIndex);resizeDocViewerByCSS3("imgBig",actualIndex);ImageViewerAnnotationResize(actualIndex);changePosition()}function RestoreSize(){$(".re_header").show();var D=origiWidth;$(".re_container").width(D+"px");$(".re_container").css("margin-left",offWidth+"px");ToolbarCss(D);$(".re_content").width(D+"px");var B=$("#_plcTabs").outerWidth(true);var A;if(_isStretch){A=D-B}else{A=D-tabWidth}if(A<0){ReAllocate(D-tabWidth-_resizePartWidth)}$("#_plcBigImg").width(A+"px");$("#re_canvas").width((A-17)+"px");_docWidth=A-27;footerContentOffset(D);$("#_footerImg").css("padding","0px "+rightOffset+"px 0px "+leftOffset+"px");$("#_footerImg").width(D-(leftOffset+rightOffset)+"px");_docHeight=_height;$("#_plcTabs").height(contentHeight);$("#_plcResize").height(contentHeight);$("#_plcImgsThumbs").height(contentHeight-$("#_plcNavi").outerHeight()-40);$("#_searchResult").height(contentHeight-$("#_plcNavi").outerHeight()-135);$("#_plcBigImg").height(contentHeight);$("#re_canvas").height(contentHeight-17);LoadingCss(D,contentHeight+$(".re_func_toolbar").outerHeight()+_footerHeight);$(".re_footer").show();if(_fid!=null&&_fid!=""){_fileDocument[curFileId].ChangeState();var C=parseInt(_curCorrectPageId);actualIndex=_fileDocument[curFileId].GetPageIndex(C);if(_imageFormat=="Svg"){var E=_fileDocument[curFileId].Viewers[actualIndex];Adaptive(E)}ChangeViewerPosition(actualIndex);resizeDocViewerByCSS3("imgBig",actualIndex);ImageViewerAnnotationResize(actualIndex);changePosition()}}function ThumbShrink(){$("#_plcTabs").css({"width":tabWidth+"px"});$("#_plcImgsThumbs").hide();var D;if(_isFull){D=clientwidth-tabWidth}else{D=viewerContainer_width-tabWidth}$("#_plcBigImg").width(D+"px");$("#re_canvas").width((D-17)+"px");if(_fid!=null&&_fid!=""){_docWidth=D-27;_fileDocument[curFileId].ChangeState();var C=parseInt(_curCorrectPageId);actualIndex=_fileDocument[curFileId].GetPageIndex(C);if(_imageFormat=="Svg"){var E=_fileDocument[curFileId].Viewers[actualIndex];Adaptive(E)}ChangeViewerPosition(actualIndex);resizeDocViewerByCSS3("imgBig",actualIndex);ImageViewerAnnotationResize(actualIndex);changePosition()}var B=getProjectName();var A=B+"/"+_resourceFolder+"/images/RE_wt_iconsA1.png";$("#_exIcon").css("background","url('"+A+"') no-repeat -686px 0px");$("#tabs").tabs("enable",0)}function ThumbExpansion(){$("#_plcTabs").css({"width":(_leftPartWidth)+"px"});$("#_plcImgsThumbs").show();var C;var A=$("#_plcTabs").outerWidth(true);if(_isFull){C=clientwidth-A}else{C=_width+27}_docWidth=C-27;$("#_plcBigImg").width(C+"px");$("#re_canvas").width((C-10)+"px");if(_fid!=null&&_fid!=""){_fileDocument[curFileId].ChangeState();var B=parseInt(_curCorrectPageId);actualIndex=_fileDocument[curFileId].GetPageIndex(B);if(_imageFormat=="Svg"){var D=_fileDocument[curFileId].Viewers[actualIndex];Adaptive(D)}ChangeViewerPosition(actualIndex);resizeDocViewerByCSS3("imgBig",actualIndex);ImageViewerAnnotationResize(actualIndex);changePosition()}$("#_exIcon").css("background","");$("#tabs").tabs("option","disabled",[0])}function Adaptive(A){_currentZoomIndex=parseInt($("#zoomList").get(0).selectedIndex);if(_currentZoomIndex==18){_zoomIndex=(_docHeight/A.OneToOne_Height*100).toFixed(2)/10}else{if(_currentZoomIndex==19){_zoomIndex=(_docWidth/A.OneToOne_Width*100).toFixed(2)/10}}}function changePosition(){if($("#zoomList").val()=="Fit Page"){var C=parseInt(_curCorrectPageId);C=_fileDocument[curFileId].GetPageIndex(C);var B=_fileDocument[curFileId].Viewers[C];var A=(_docHeight/B.OneToOne_Height*100).toFixed(2);_zoomListIndex=setPercentPosition(A)}else{if($("#zoomList").val()=="Fit Width"){var C=parseInt(_curCorrectPageId);C=_fileDocument[curFileId].GetPageIndex(C);var B=_fileDocument[curFileId].Viewers[C];var A=(_docWidth/B.OneToOne_Width*100).toFixed(2);_zoomListIndex=setPercentPosition(A)}}}function CreateREWebViewer(A){CreateTabViewer(A);CreateREDocumentViewer(A);CreateREFooterViewer(A)}var currentActivePanel=0;var thumbIdArray=new Array("_thumbImg","_thumbOutLine","_thumbSearch");var disArray=false;function CreateTabViewer(C){var E=getProjectName();var G=E+"/"+_resourceFolder+"/images/RE_wt_iconsA1.png";var D=E+"/"+_resourceFolder+"/images/RE_wt_iconsC1.png";var N="<div id='tabPanel1' style='float:left;'</div>";$(C).append(N);var B=_leftPartWidth;var M=contentHeight;var L="<div id='_plcTabs' style='background:#efefef;width:"+B+"px;height:"+M+"px;'></div>";$("#tabPanel1").append(L);var A="<div id='tabs' style='background:#efefef;float:left'></div>";$("#_plcTabs").append(A);var J="<ul id='_tabUl'></ul>";$("#tabs").append(J);var I="<li><a id='_exIcon' href='#thumbPanel1' style='background:#efefef;width:20px;height:18px;margin-top:-8px;margin-left:14px;'></a></li>";var K="<li title='Thumbnails'><a id='thumbIcon' href='#thumbPanel1' style='width:29px;height:34px;margin-left:3px;'></a></li>";var H="<li title='OutLines'><a id='outlineIcon' href='#thumbPanel1' style='width:32px;height:34px;'></a></li>";var F="<li title='TextSearch'><a id='searchIcon' href='#thumbPanel1' style='width:32px;height:34px;'></a></li>";$("#_tabUl").append(I);$("#_tabUl").append(K);$("#_tabUl").append(H);$("#_tabUl").append(F);$("#thumbIcon").css("background","url('"+D+"') no-repeat 0px 0px");$("#_exIcon").css("background","url('"+G+"') no-repeat -686px 0px");$("#outlineIcon").css("background","url('"+D+"') no-repeat -104px 0px");$("#searchIcon").css("background","url('"+D+"') no-repeat -137px 0px");CreateResizePanel("#tabs");CreateREThumbViewer("#tabs");$("#tabs").tabs();$("#tabs").tabs("option","collapsible",true);$("#tabs").tabs("option","active",false);$("#_exIcon").css("background","");$("#tabs").tabs("option","disabled",[0]);$("#tabs").tabs().addClass("ui-tabs-vertical ui-helper-clearfix");$("#tabs li").removeClass("ui-corner-top").addClass("ui-corner-left");$("#tabs").on("tabsactivate",function(R,O){var Q=$("#tabs").tabs("option","active").toString();if(Q=="false"){ThumbShrink();$("#thumbIcon").blur();$("#tabs").tabs("enable",0)}else{$("#_plcNavi").show();ThumbExpansion();if(Q=="0"){$(".ui-tabs-vertical .ui-tabs-nav li.ui-tabs-active").css("border-top","0px");$(".ui-tabs-vertical .ui-tabs-nav li.ui-tabs-active").css("padding-bottom","1px");$("#tabs").tabs("option","active",currentActivePanel);$("#_exIcon").blur()}else{for(var P=0;P<thumbIdArray.length;P++){$("#"+thumbIdArray[P]).hide()}if(Q=="1"){$("#_title").html("Pages");$("#_thumbImg").show();currentActivePanel=1;ChangeThumbScrollBar(_curCorrectPageId,true);ReAllocate(_leftPartWidth-tabWidth);if(_isIpad){var S=document.getElementById("_thumbOutLine");S.addEventListener("gesturestart",GestureStart,false);S.addEventListener("gesturechange",GestureChange,false)}else{$("#_plcResize").unbind("mousedown",resizeMouseDown)}$("#_plcResize").removeClass("resizeCursor");$("#_plcImgsThumbs").css("background","#dcdcdc");$("#thumbIcon").blur();addShowPageIds()}else{if(Q=="2"){$("#_title").html("OutLines");$("#_thumbOutLine").show();ReAllocate(_leftPartWidth-tabWidth);if(_isIpad){var S=document.getElementById("_thumbOutLine");S.addEventListener("gesturestart",GestureStart,false);S.addEventListener("gesturechange",GestureChange,false)}else{$("#_plcResize").bind("mousedown",resizeMouseDown)}$("#_plcResize").addClass("resizeCursor");$("#_plcImgsThumbs").css("background","#ffffff");$("#outlineIcon").blur();currentActivePanel=2}else{if(Q=="3"){$("#_title").html("Search");$("#_thumbSearch").show();ReAllocate(_leftPartWidth-tabWidth+80);if(_isIpad){var S=document.getElementById("_thumbOutLine");S.addEventListener("gesturestart",GestureStart,false);S.addEventListener("gesturechange",GestureChange,false)}else{$("#_plcResize").unbind("mousedown",resizeMouseDown)}$("#_plcResize").removeClass("resizeCursor");$("#_plcImgsThumbs").css("background","#ffffff");$("#searchIcon").blur();currentActivePanel=3}}}if(disArray){$("#tabs").tabs("option","disabled",[0,2,3])}else{$("#tabs").tabs("option","disabled",[0])}}}})}var GestureStart=function GestureStart(A){currentThumbWidth=$("#_plcNavi").width()};var GestureChange=function GestureChange(B){var D=_leftPartWidth-tabWidth;var C;if(_isFull){C=clientwidth-tabWidth-100}else{C=viewerContainer_width-tabWidth-100}scale=event.scale;var A=scale*currentThumbWidth;if(A>=D&&A<=C){ReAllocate(A)}};var IsResizeDown=false;var resizeMouseDown=function(A){IsResizeDown=true;A=A||window.event;xDown=A.pageX;xMove=A.pageX;currentThumbWidth=$("#_plcNavi").width();$(".showByDrag").unbind("mousemove",dragImageMouseMove);$(".showByDrag").unbind("mouseup",dragImageMouseUp);$(".showByDrag").bind("mousemove",resizeMouseMove);$(".showByDrag").bind("mouseup",resizeMouseUp);$(".re_container").bind("mousemove",resizeMouseMove);$(document).bind("mouseup",resizeMouseUp)};var resizeMouseMove=function(A){if(IsResizeDown){$(".showByDrag").removeClass("mouseStyleMove");$(".showByDrag").addClass("resizeCursor");$("#_plcImgsThumbs").addClass("resizeCursor");$("#draw_canvas").addClass("resizeCursor");A=A||window.event;if(xMove==A.pageX){return}else{xMove=A.pageX}move_x=xMove-xDown;var C=_leftPartWidth-tabWidth;var B;if(_isFull){B=clientwidth-tabWidth-100}else{B=viewerContainer_width-tabWidth-100}if(currentThumbWidth+move_x>=C&&currentThumbWidth+move_x<=B){ReAllocate(currentThumbWidth+move_x)}}};var resizeMouseUp=function(A){IsResizeDown=false;$(".showByDrag").bind("mousemove",dragImageMouseMove);$(".showByDrag").bind("mouseup",dragImageMouseUp);$(".showByDrag").removeClass("resizeCursor");$(".showByDrag").addClass("mouseStyleMove");$(".showByDrag").unbind("mousemove",resizeMouseMove);$(".showByDrag").unbind("mouseup",resizeMouseUp);$("#draw_canvas").removeClass("resizeCursor");$("#draw_canvas").addClass("defaultCursor");$("#_plcImgsThumbs").removeClass("resizeCursor");$("#_plcImgsThumbs").addClass("defaultCursor");$(".re_container").unbind("mousemove",resizeMouseMove);$(document).unbind("mouseup",resizeMouseUp)};function CreateREThumbViewer(A){var B="<div id='thumbPanel1' style='float:left;'></div>";$(A).append(B);CreateNavigateViewer("#thumbPanel1");CreateREThumbPart("#thumbPanel1")}function CreateNavigateViewer(B){var D=getProjectName();var E=D+"/"+_resourceFolder+"/images/RE_wt_iconsA1.png";var H=_leftPartWidth-tabWidth;var C=21;var A="<div id='_plcNavi' style='background:#efefef;width:"+H+"px;height:"+C+"px;border-bottom:#b2b0a7 1px solid'></div>";$(B).append(A);var G="<div id='_title' style='font-weight:bold;margin-top:2px; margin-left:2px;font-size:10px; float:left;'></div>";var F="<div id='_icon' class='pointCursor' style='margin-top:-9px;width:15px;height:30px;float:right;'onclick='thumbHidden();'></div>";$("#_plcNavi").append(G);$("#_plcNavi").append(F);$("#_title").html("Pages");$("#_icon").css("background","url('"+E+"') no-repeat -620px 0px")}function thumbHidden(){$("#_plcNavi").hide();$("#tabs").tabs("option","active",false);ThumbShrink()}function CreateREThumbPart(A){var F=_leftPartWidth-tabWidth-20;var G=contentHeight-$("#_plcNavi").outerHeight()-40;var E="<div id='_plcImgsThumbs' class='RE_ThumbViewer'style='padding:20px 10px 20px 10px;background:#dcdcdc;width:"+F+"px;height:"+G+"px;overflow-x:scroll;'></div>";var C="<div id='_thumbImg' ></div>";var D="<div id='_thumbOutLine'></div>";var B="<div id='_thumbSearch' style='font-size:13px;color:#333333;'></div>";$(A).append(E);$("#_plcImgsThumbs").append(C);$("#_plcImgsThumbs").append(D);$("#_plcImgsThumbs").append(B);CreateSearchControl("_thumbSearch")}function clearSubmit(A){if(A.keyCode==13){searchText();return false}}var _isDefault;function CreateSearchControl(C){$("#"+C).append("<div id='_searchHead'></div>");$("#_searchHead").css("font-size","12px");var G=(_leftPartWidth-tabWidth+50);var K=G-48;var F=24;if(_isIpad){K=G-58;F=26}var D="<div style='width:"+G+"px;height:"+F+"px;border:1px solid #999999;border-radius:3px;float:left;'>";D+="<div id='_searchIcon' title='Search' onclick='searchText()'></div>";D+="<input id='_search' style='width:"+K+"px;padding-top:3px;border:0px;float:left;' onkeydown='return clearSubmit(event)'/>";D+="<div id='_searchClear' title='Clear Search' onClick='clearSearch()'></div></div>";var B="<div id='_searchOptions' style='margin-top:10px;width:"+(G-2)+"px;height:25px;float:left;'>";B+="<div style='float:left;'><input type='checkbox' id='_ignoreCase' style='text-align:center;line-height:25px;'><label for='_ignoreCase'>Ignore case</label></div>";B+="<div style='margin-left:20px;float:left;'><input type='checkbox' id='_wholeWord' style='text-align:center;line-height:25px;'><label for='_wholeWord'>Whole word</label></div>";B+="</div>";var E="<label id='_labelCount' style='margin-top:5px;color:#666666;float:left;'></label>";$("#_searchHead").append(D);$("#_searchHead").append(B);$("#_ignoreCase").attr("checked",true);$("#_searchHead").append(E);var K=_leftPartWidth-tabWidth+70;var F=contentHeight-$("#_plcNavi").outerHeight()-135;var J="<div id='_searchResult' style='overflow:auto;margin-top:15px;width:"+K+"px;height:"+F+"px;float:left;'><div>";var A="";A+=getRootPath();A+="/"+_resourceFolder+"/images/thumb_upload.gif";var H="<img id='search_load' style='padding-top:"+(F/2-10)+"px;padding-left:"+(K/2-20)+"px;' src ='"+A+"'/>";$("#"+C).append(J);$("#_searchResult").hide();$("#"+C).append(H);$("#search_load").hide();var I=document.getElementById("_search");I.onblur=function(){if(I.value==""){I.value="Search Document";_isDefault=true;$("#_search").css("color","#999999")}};I.onfocus=function(){if(I.value=="Search Document"&&_isDefault){I.value="";_isDefault=false;$("#_search").css("color","#333333")}};I.onblur()}var searchArray=new Array();var svgPageResult=new Array();var textSearch="";var isIgnoreCase=false;var isWholeWord=false;function searchText(){tempIsIgnoreCase=document.getElementById("_ignoreCase").checked;tempIsWholeWord=document.getElementById("_wholeWord").checked;if(textSearch.toLowerCase()==$("#_search").val().toLowerCase()&&searchArray.length!=0){if(tempIsIgnoreCase==isIgnoreCase&&tempIsWholeWord==isWholeWord){return}}isIgnoreCase=tempIsIgnoreCase;isWholeWord=tempIsWholeWord;if(_suffix!=".pdf"&&!_svgFormat.in_array(_suffix)&&_imageFormat!="SVG"){alert("This feature is not yet open in the trial version");return}textSearch=$("#_search").val();if(textSearch=="Search Document"&&_isDefault){alert("Please enter a search term");return}if(textSearch.length<3){alert("Searching for at least three letters");document.getElementById("_search").onfocus();return}if(searchArray.length!=0){$("#_searchResult").empty();$("#_labelCount").html("");$("_selectText").remove();searchArray=new Array();svgPageResult=new Array();var fileDoc=_fileDocument[curFileId];for(var i=0;i<fileDoc.ViewerPageIndex.length;i++){$("#page"+fileDoc.ViewerPageIndex[i]+" svg #_selectText").remove()}}$("#_searchResult").hide();$("#_labelCount").html("");$("#search_load").show();var resultCount=0;if(textSearch!=""&&!_isDefault){$.post(getServerHandlerUrl(),{"action":"GetSearchResult","fid":_fid,"fileName":_fileName,password:curDocPassWord,"matchedString":textSearch,"IsMatchCase":isIgnoreCase,"IsWholeWord":isWholeWord},function(result,status){result=eval("("+result+")");if(result.state=="success"){currentResultId=null;$("#search_load").hide();var arr=result.msg;var actualCount=arr.resultCount;searchArray=unpackSearch(arr.Result);addSearResult(textSearch,actualCount)}else{alert(result.msg);$("#search_load").hide()}})}}function addSearResult(J,S){$("#_searchResult").show();$("#_labelCount").html(S+" matches");$("#_selectText").remove();resultCount=searchArray.length;var I="<g id='_selectText'+ fill='#ff6600' fill-opacity='0.5'>";var H=searchArray[0].CombinedResultArea[0].PageIndex;var O="";for(var F=0;F<resultCount;F++){var D=searchArray[F];D.ContextString=HandleMatchString(D.ContextString);var P=D.KeywordOffset;var B=D.CharResults.length;var C=D.ContextString.substring(0,P);var G=D.ContextString.substring(P,P+B);var R=D.ContextString.substring(P+B);if(!_fileDocument[curFileId].ViewerPageIndex.in_array(D.CombinedResultArea[0].PageIndex)){S--;continue}var M="<span style='font-weight:bold;color:#555555;'>Page "+(D.CombinedResultArea[0].PageIndex+1)+"</span><br/>";M+="..."+C+"<span style='color:#a74a27;font-size:12px;font-weight:bold'>"+G+"</span>"+R+"...";var A="<div class='searchResult' id='result_"+F+"' style='width:"+(_leftPartWidth-tabWidth+50)+"px;height:auto;line-height:20px;border:1px solid #999999;border-radius:2px;' title='Item"+(F+1)+"' onClick='btnSearch(this)'>"+M+"</div>";$("#_searchResult").append(A);var Q=D.CombinedResultArea;for(var E=0;E<Q.length;E++){var N=Q[E];var L=N.PageIndex;if(L==H){O+="<rect x='"+N.Area.X.Value+"' y='"+N.Area.Y.Value+"' width='"+N.Area.Width.Value+"' height='"+N.Area.Height.Value+"'></rect>";if(F==resultCount-1){if(_showDocSrc.in_array(H)){$("#page"+H+" svg").append(I+O+"</g>");var K=$("#page"+H).html();$("#page"+H).html(K)}else{svgPageResult[H]=I+O+"</g>"}}}else{if(_showDocSrc.in_array(H)){$("#page"+H+" svg").append(I+O+"</g>");var K=$("#page"+H).html();$("#page"+H).html(K)}else{svgPageResult[H]=I+O+"</g>"}H=L;O="<rect x='"+N.Area.X.Value+"' y='"+N.Area.Y.Value+"' width='"+N.Area.Width.Value+"' height='"+N.Area.Height.Value+"'></rect>";if(F==resultCount-1){if(_showDocSrc.in_array(H)){$("#page"+H+" svg").append(I+O+"</g>");var K=$("#page"+H).html();$("#page"+H).html(K)}else{svgPageResult[H]=I+O+"</g>"}}}}}if(resultCount!=S){var M="<span style='color:#ff0000'>Too many results, please increase the length of the search string....... </span>";var A="<div style='width:"+(_leftPartWidth-tabWidth+20)+"px;height:auto;line-height:20px;border:1px solid #999999;border-radius:2px;'>"+M+"</div>";$("#_searchResult").append(A)}}function HandleMatchString(A){var C=A.length;for(var B=0;B<C;B++){if(A.charCodeAt(B)<61727&&A.charCodeAt(B)>61472){var D=new RegExp(/[^[\uf021-\uf0ff]/);A=A.replace(A[B]," ")}}return A}function clearSearch(){$("#_search").val("");document.getElementById("_search").onblur();$("#_searchResult").empty();$("#_labelCount").html("");$("_selectText").remove();searchArray=new Array();svgPageResult=new Array();textSearch="";currentResultId=null;for(var A=0;A<_totalPageCount;A++){var B=_fileDocument[curFileId].GetPageIndex(A);$("#page"+B+" svg #_selectText").remove()}}function CreateResizePanel(C){var D=_resizePartWidth;var B=contentHeight;var A="<div id='_plcResize' style='float:right;background:#b2b0a7;position:relative;width:"+_resizePartWidth+"px;height:"+B+"px;'></div>";$(C).append(A)}var objDeletePg={text:"Delete",func:function(){var B=this.id;B=B.substring(B.indexOf("_")+1);var A=new Array();A.push(B);DeletePage(A)}};var ThumbMenuData=[[objDeletePg]];function CreateThumbImageControl(J){$("#"+J).empty();for(var H=0;H<_totalPageCount;H++){var C="<div class='thumbnail' id='lbl_"+H+"' onclick='ChangePg("+H+")'></div>";$("#"+J).append(C);var D=_fileDocument[curFileId].Viewers[H];var G=D.ThumbWidth;var B=D.ThumbHeight;var I="<div class='thumbDiv' id='thumbDiv_"+H+"' style='width:"+G+"px;height:"+B+"px;text-align:center;'></div>";$("#lbl_"+H).append(I);CreateThumbImage("#thumbDiv_"+H,H);var E="<div id='refresh_"+H+"' style='width:32px;height:30px;margin-left:"+(G/2-16)+"px;margin-top:"+B/2+"px;' onclick='RefreshCurrentThumb(this,event,"+H+");'></div>";$("#thumbDiv_"+H).append(E);var F=getProjectName();var K=F+"/"+_resourceFolder+"/images/RE_navi_refresh.png";$("#refresh_"+H).css("background","url('"+K+"') no-repeat 0px 0px");$("#refresh_"+H).hide();var A="<div id='thumbPgId_"+H+"' class='thumbPgId'>"+(H+1)+"</div>";$("#thumbDiv_"+H).after(A)}if(_suffix==".pdf"||_tifFormat.in_array(_suffix)){AddSmartDeletePage()}}function AddSmartDeletePage(){for(var A=0;A<_totalPageCount;A++){$("#lbl_"+A).smartMenu(ThumbMenuData,{name:A})}}function CreateOutLineControl(I){$("#"+I).empty();var H=new Array();var A=new Array();for(var E=0;E<outLine.length;E++){var B=outLine[E];if(B.Level==1){H.push(E)}A.push(B.Text.length)}H.push(outLine.length);var F=A.max()*7+80;$("#"+I).css({"width":F+"px"});var C=getProjectName();var D=C+"/"+_resourceFolder+"/images/RE_wt_iconsA1.png";CreatePartPanel(H,I,D);var G=$("#tabs").tabs("option","active").toString();if(G!=2){$("#"+I).hide()}}function CreatePartPanel(K,N,E){var A;var C;if(K==null){return}for(var F=0;F<K.length-1;F++){A=K[F];C=K[F+1];var B=outLine[A];if(A==C||A+1==C){var I=(B.Level-1)*15+18;if(B.Text==""||B.Text==null){B.Text="null"}var D="<div class='outline_hover' id='outLineContent_"+A+"' style='height:28px;margin-left:"+I+"px;'title='"+B.Text+"' onclick='btnOutLine(this)'>"+B.Text+"</div>";$("#"+N).append(D)}else{var I=(B.Level-1)*15;if(B.Text==""||B.Text==null){B.Text="null"}var D="<div id='outLine_"+A+"'style='height:28px;margin-left:"+I+"px;'><div id='outLineIcon_"+A+"' style='float:left;width:18px;height:28px;margin-top:-8px;' onclick='btnDownOrUp(this);'></div><div class='outline_hover'id='outLineContent_"+A+"'title='"+B.Text+"' onclick='btnOutLine(this)'>"+B.Text+"</div></div>";$("#"+N).append(D);$("#outLineIcon_"+A).css("background","url('"+E+"') no-repeat -684px 0px");var L="<div id='outLine_"+A+"_next'></div>";$("#"+N).append(L);var M=outLine[A+1];var J=M.Level;var G=new Array();for(var H=A+1;H<C;H++){M=outLine[H];if(M.Level==J){G.push(H)}else{if(M.Level<J){G.push(H);J=M.Level}}}G.push(C);CreatePartPanel(G,"outLine_"+A+"_next",E);$("#outLine_"+A+"_next").hide()}}}function CreateREDocumentViewer(C){var E="<div id='docPanel1'style='float:left;'></div>";$(C).append(E);var G=_docWidth+27;var F=contentHeight;var A="<div id='_plcBigImg' style='background:#bbbbbb;overflow:auto;position:relative;width:"+G+"px;height:"+F+"px;'></div>";$("#docPanel1").append(A);var H="<div id='re_canvas' style='background:#bbbbbb;position:relative;width:"+(G-17)+"px;height:"+(F-17)+"px;'></div>";$("#_plcBigImg").append(H);var D="<div id='draw_canvas' class='RE_DocumentViewer' style='margin:5px 5px 0px 5px;position:relative;width:"+(G-27)+"px;height:"+(F-22)+"px;'></div>";$("#re_canvas").append(D);var B="<div id='imgBig'  class='showByDrag'></div>";$("#draw_canvas").append(B)}maxWidth=0;maxHeight=0;var boxWidth=1;var shadowWidth=3;var addWidth=5;var marHeight=5;var addHeight=7;var BitLoadWidth=0;var BitLoadHeight=0;function CreateDocImageControl(H){$("#"+H).empty();$(".svg_rect").remove();DocWidthAndHeight();for(var D=0;D<_totalPageCount;D++){var B=_fileDocument[curFileId].Viewers[D];if(!B.Init){B.GetInitialSize();B.Init=true}var G=B.FirstActualWidth;var E=B.FirstActualHeight;LoadWidthAndHeight(G,E);var A="";A+=getRootPath();A+="/"+_resourceFolder+"/images/upload.gif";var C="";if(_imageFormat=="Bitmap"){C="<img class='docImages' id='page"+D+"' style='width:"+G+"px;height:"+E+"px;background:#ffffff' src=''/>";$("#"+H).append(C);$("#page"+D).css("border","1px solid #000000");$("#page"+D).css("box-shadow","3px 3px 0px #000000");var F="<div class='svg_rect' id='pageImg"+D+"' style='left:"+(loadWidth-BitLoadWidth)/2+"px;top:"+(loadHeight-BitLoadHeight)/2+"px;width:"+BitLoadWidth+"px;height:"+BitLoadHeight+"px;'>";F+="<svg width='100%' height='100%' version='1.1' xmlns='http://www.w3.org/2000/svg'>";F+="<image class='annotation' x='0px' y='0px' width='"+BitLoadWidth+"px' height='"+BitLoadHeight+"px' xlink:href='"+_resourceFolder+"/images/upload.gif'/></svg></div>";$("#draw_canvas").append(F)}else{C="<div class='docImages' id='page"+D+"' style='width:"+G+"px;height:"+E+"px;background:#ffffff;'>";C+="<img id='pageImg"+D+"' style='width:"+BitLoadWidth+"px;height:"+BitLoadHeight+"px;padding-left:"+(loadWidth-BitLoadWidth)/2+"px;padding-top:"+(loadHeight-BitLoadHeight)/2+"px;' src='"+A+"'/></div>";$("#"+H).append(C);$("#page"+D).css("border","1px solid #000000");$("#page"+D).css("box-shadow","3px 3px 0px #000000")}}}function DocWidthAndHeight(){if(_isFull){DocWindowWidth=$("#_plcBigImg").width();DocWindowHeight=$("#_plcBigImg").height()}else{DocWindowWidth=_rightPartWidth;DocWindowHeight=contentHeight}}function LoadWidthAndHeight(B,A){if(DocWindowWidth<B){loadWidth=DocWindowWidth}else{loadWidth=B}if(DocWindowHeight<A){loadHeight=DocWindowHeight}else{loadHeight=A}BitLoadWidth=loadWidth/5;BitLoadHeight=loadHeight/4}var leftOffset;var rightOffset;function CreateREFooterViewer(A){var F="<div id='navPanel' style='float:left;'></div>";$(A).append(F);footerContentOffset(viewerContainer_width);var C=viewerContainer_width-(leftOffset+rightOffset);var D=_footerHeight;var G="<div id='_footerImg' style='text-align:center;padding:0px "+rightOffset+"px 0px "+leftOffset+"px;width:"+C+"px;height:"+D+"px;background:#efefef;'></div>";$("#navPanel").append(G);var B="<div id='navi_pagePart'></div>";$("#_footerImg").append(B);CreatePagePart("#navi_pagePart");var E="<div id='navi_rotate' title='rotate page'></div>";$("#_footerImg").append(E);CreateTextSelectPart("#_footerImg");CreateZoomPart("#_footerImg");CreatePageModePart("#_footerImg")}function CreatePagePart(C){var A="<div id='navi_first' title='first page'></div>";$(C).append(A);var D="<div id='navi_pre' title='previous Page'></div>";$(C).append(D);var E="<div id='selectCss'><select class='navi_page' id='pageIdList' style='width:100px'></select></div>";$(C).append(E);var B="<div id='navi_ne' title='next page'></div>";$(C).append(B);var F="<div id='navi_last' title='last page'></div>";$(C).append(F)}function CreateZoomPart(D){var E=getProjectName();var C=E+"/"+_resourceFolder+"/images/RE_select.gif";var G="<div id='navi_zoomPart'></div>";$(D).append(G);var B="<div id='selectCss'><select class='navi_zoom' id='zoomList'></select></div>";$("#navi_zoomPart").append(B);InitZoomItems("#zoomList");var F="<div id='navi_zoomOut' title='zoomOut' onclick='btnZoomOut()'></div>";$("#navi_zoomPart").append(F);var A="<div id='navi_zoomIn' title='zoomIn' onclick='btnZoomIn()'></div>";$("#navi_zoomPart").append(A)}function CreatePageModePart(B){var C="<div id='navi_pageMode'></div>";$(B).append(C);var D="<div id='navi_single' title ='single page' onclick='btnSinglePage()'></div>";$("#navi_pageMode").append(D);var A="<div id='navi_multi' title='continues page'onclick='btnContinuesPage()'></div>";$("#navi_pageMode").append(A)}function CreateTextSelectPart(A){var B="<div id='re_func_selectText' title='Select Text'></div>";$(A).append(B)}function CreateThumbImage(A,C){var D="";D+=getRootPath();D+="/"+_resourceFolder+"/images/thumb_upload.gif";var B="<img id='thumbnail_"+C+"' src ='"+D+"'/>";$(A).append(B)}function InitZoomItems(C){for(var A=0;A<_zoomItems.length;A++){if(A==16){var B="<option disabled='disabled'>"+_zoomItems[A]+"</option>";$(C).append(B)}else{$(C).append($("<option></option>").html(_zoomItems[A]))}}$(C).val("Fit Page").attr("selected",true)}var viewerContainer_width;var viewerContainer_height;var _docWidth;var _docHeight;var _thumbWidth;var _thumbHeight;var _minThumbnailWidth=68;var _minThumbnailHeight;var _maxThumbnailWidth=140;var _maxThumbnailHeight;var _thumbnailWidth;var _thumbnailHeight;var tabWidth=36;var _leftPartWidth;var _rightPartWidth;var contentHeight;var _resizePartWidth=2;var footerContentWidth=470;var _toolbarHeight=77;var _footerHeight=40;var viewer_clientWidth;var viewer_clientHeight;function PageLoadReady(){_isIpad=IsIpad();GetSystemFont();_defaultPage=_viewer._defaultPage;viewer_clientWidth=window.innerWidth;viewer_clientHeight=window.innerHeight;viewerContainer_width=parseInt(_viewer._viewerWidth);viewerContainer_height=parseInt(_viewer._viewerHeight);if(viewerContainer_width<604){viewerContainer_width=604}if(viewerContainer_height<300){viewerContainer_height=300}HeaderCss();AdaptiveCss();ContainerCss();CreateWebToolbar(".re_func_toolbar");if(_isIpad){$("#_annoTab").hide()}CreateREWebViewer(".re_content");if(_viewer._initialFullScreen){btnFull()}}function IsIpad(){var B=navigator.userAgent.toLowerCase();var A;A=B.match(/iPad/i);if(A=="ipad"){return true}else{return false}}function GetSystemFont(){$.post(getServerHandlerUrl(),{"action":"GetSystemFontFamilies"},function(result,status){result=eval("("+result+")");if(result.state=="success"){var arr=result.msg;textFontArray=arr.split("/")}else{textFontArray=new Array("Arial","Arial Black","Arial Narrow","Tahoma","Cambria","Times New Roman","Calibri","Verdana","")}})}function HeaderCss(){$(".re_container").width(viewerContainer_width);if(viewer_clientWidth<viewerContainer_width){$(".re_header").width(viewerContainer_width)}$(".re_header_content").width(viewerContainer_width)}function AdaptiveCss(){var C=tabWidth+20+17+_minThumbnailWidth;var D=tabWidth+20+17+_maxThumbnailWidth;var A=0.22;var B=viewerContainer_width*A;if(B>C){if(B<=D){_thumbnailWidth=B-tabWidth-17-20}else{_thumbnailWidth=_maxThumbnailWidth}}else{_thumbnailWidth=_minThumbnailWidth}_thumbWidth=_thumbnailWidth/1.5;_thumbHeight=_thumbWidth/0.8;_thumbnailHeight=_thumbHeight+40;_leftPartWidth=_thumbnailWidth+20+17+tabWidth+3;_rightPartWidth=viewerContainer_width-_leftPartWidth;_docWidth=_rightPartWidth-27;contentHeight=viewerContainer_height-(_toolbarHeight+7)-_footerHeight;_docHeight=contentHeight-22;_width=_docWidth;_height=_docHeight}function ContainerCss(){ToolbarCss(viewerContainer_width);ContentCss()}function ToolbarCss(B){$(".re_func_toolbar").width(B);$(".re_func_toolbar").height(_toolbarHeight);for(var A=0;A<toolbarTabId.length;A++){$("#"+toolbarTabId[A]).width(B-20)}}function ContentCss(){if(viewerContainer_width>viewer_clientWidth){$(".re_header").width(viewerContainer_width)}else{$(".re_header").width("100%")}$(".re_content").width(viewerContainer_width);$(".re_footer").width(viewerContainer_width-48);var A=(viewer_clientWidth-17-viewerContainer_width)/2;A=A>0?A:0;$(".re_container").css("margin-left",A+"px");$(".re_footer").css("margin-left",A+"px")}function LoadingCss(D,A){var B=(A-6)/2;var C=130;var E=B-C/2;$("#loading").css({"width":D+"px","height":A-E+"px"});$("#loading").css("padding-top",E+"px")}var passWordButtons=[{text:"Submit",click:function(){ParseDocumentWidthPassWord()}},{text:"Cancel",click:function(){$(this).dialog("close")}}];function ParameterDocumentLoad(E){E=E.trim();var D=E.indexOf("error:");if(D!=-1){alert(E);LoadErrorHandle()}else{var G=E.lastIndexOf(";");_fileIdName=E.substring(0,G);_isHasPassword=E.substring(G+1);if(_fileIdName==""){LoadErrorHandle()}else{var D=_fileIdName.lastIndexOf("|");newFileName=_fileIdName.substring(0,D);newFid=_fileIdName.substring(D+1);curDocPassWord="";if(_isHasPassword=="True"){$("#loading_div").hide();$("#content").empty();var A=_fileIdName.substring(0,_fileIdName.lastIndexOf("|"))+".pdf";var C="<div style='font-size:13px;font-weight:bold;'>Document '"+A+"' protected, enter 'Document Open Password'</div><br/>";C+="<div>Enter password:&nbsp;&nbsp;<input id='_passWord' style='font-size:12px;width:300px;height:25px;' onkeydown='return InputPassword(event)'></input></div>";$("#content").append(C);$("#dialog").dialog({autoOpen:false,title:"Password",minWidth:500,height:230,resizable:true});$("#dialog").dialog("option","buttons",passWordButtons);var F=(viewer_clientWidth-500)/2;var B=(viewer_clientHeight-230)/2;window.scrollTo(0,0);$("#dialog").dialog({position:[F,B]});$("#dialog").dialog("open");dialogOpen=true;$("#dialog").on("dialogbeforeclose",function(I,H){$("#loading_div").show();$("#loading").hide();if(!_isHaveDocument){DisableToolbar();_isDisabled=true}else{if(_isDisabled){EnableToolbar();_isDisabled=false}}dialogOpen=false})}else{DocumentLoad()}}}}function DocumentLoad(){_isHaveDocument=true;if(_isDisabled){EnableToolbar();_isDisabled=false}window.document.title=newFileName;_DocSrcRequest=new Array();currentCreateIndex=0;thumbCreateIndex=0;if(showCommentsPanel){HideCommentsPanel()}OnLoadReady()}function InputPassword(A){if(A.keyCode==13){ParseDocumentWidthPassWord();return false}}var curDocPassWord="";function ParseDocumentWidthPassWord(){var _passWord=$("#_passWord").val();var str={action:"DecryptionPDFDocument",fid:newFid,fileName:newFileName,passWord:_passWord};var response="";var options={type:"POST",url:getServerHandlerUrl(),async:false,data:str,success:function(result){result=eval("("+result+")");if(result.state=="success"){curDocPassWord=_passWord;$("#dialog").dialog("close");DocumentLoad()}else{if(result.state=="error"){alert("Incorrect password, make sure Caps Lock key is not pressed, and then try again!!")}}},error:function(err){}};$.ajax(options);return response}function footerContentOffset(A){if(footerContentWidth>=A){leftOffset=0;rightOffset=0}else{var C=A-footerContentWidth;var B=A*0.5-104;if(C<B){leftOffset=C;rightOffset=0}else{leftOffset=B;rightOffset=(A-footerContentWidth-leftOffset)*0.1}}}function DisableToolbar(){var C=getProjectName();var B=C+"/"+_resourceFolder+"/images/RE_wt_iconsB1.png";var D=C+"/"+_resourceFolder+"/images/ocr2.png";var A=C+"/"+_resourceFolder+"/images/selectText2.png";$("#re_func_print").css("background","url('"+B+"') no-repeat -39px 0px");TargetHover("#re_func_print",false);$("#re_func_print").removeAttr("onclick");$("#re_func_save").css("background","url('"+B+"') no-repeat -72px 0px");TargetHover("#re_func_save",false);$("#re_func_save").removeAttr("onclick");$("#re_func_convert").css("background","url('"+B+"') no-repeat -108px 0px");TargetHover("#re_func_convert",false);$("#re_func_convert").unbind("click");$("#re_func_ocr").css("background","url('"+D+"') no-repeat -2px 6px");TargetHover("#re_func_ocr",false);$("#re_func_ocr").removeAttr("onclick");$("#navi_first").css("background","url('"+B+"') no-repeat -635px 0px");TargetHover("#navi_first",false);$("#navi_pre").css("background","url('"+B+"') no-repeat -613px 0px");TargetHover("#navi_pre",false);$("#navi_ne").css("background","url('"+B+"') no-repeat -684px 0px");TargetHover("#navi_ne",false);$("#navi_last").css("background","url('"+B+"') no-repeat -662px 0px");TargetHover("#navi_last",false);$("#navi_single").css("background","url('"+B+"') no-repeat -804px 0px");TargetHover("#navi_single",false);$("#navi_single").removeAttr("onclick");$("#navi_multi").css("background","url('"+B+"') no-repeat -829px 0px");TargetHover("#navi_multi",false);$("#navi_multi").removeAttr("onclick");$("#navi_zoomIn").css("background","url('"+B+"') no-repeat -735px 0px");TargetHover("#navi_zoomIn",false);$("#navi_zoomIn").removeAttr("onclick");$("#navi_zoomOut").css("background","url('"+B+"') no-repeat -707px 0px");TargetHover("#navi_zoomOut",false);$("#navi_zoomOut").removeAttr("onclick");$("#re_func_selectText").css("background","url('"+A+"') no-repeat 4px 7px");TargetHover("#re_func_selectText",false);$("#navi_rotate").css("background","url('"+B+"') no-repeat -762px 0px");TargetHover("#navi_rotate",false);$("#zoomList").attr("disabled",true);$("#pageIdList").attr("disabled",true);$("#_exIcon").css("background","url('"+B+"') no-repeat -686px 0px");$("#tabs").tabs("disable");$(".re_func_toolbar").tabs("option","disabled",[1,2,3])}function EnableToolbar(){var C=getProjectName();var B=C+"/"+_resourceFolder+"/images/RE_wt_iconsA1.png";var D=C+"/"+_resourceFolder+"/images/ocr1.png";var A=C+"/"+_resourceFolder+"/images/selectText.png";$("#re_func_print").css("background","url('"+B+"') no-repeat -39px 0px");TargetHover("#re_func_print",true);$("#re_func_print").bind("click",function(){ShowDialog("print")});$("#re_func_save").css("background","url('"+B+"') no-repeat -72px 0px");TargetHover("#re_func_save",true);$("#re_func_save").bind("click",function(){ShowDialog("save")});$("#re_func_convert").css("background","url('"+B+"') no-repeat -108px 0px");TargetHover("#re_func_convert",true);$("#re_func_convert").bind("click");$("#re_func_ocr").css("background","url('"+D+"') no-repeat -2px 6px");TargetHover("#re_func_ocr",true);$("#re_func_ocr").bind("click",OCRDocument);$("#navi_single").css("background","url('"+B+"') no-repeat -804px 0px");TargetHover("#navi_single",true);$("#navi_single").bind("click",btnSinglePage);$("#navi_multi").css("background","url('"+B+"') no-repeat -829px 0px");TargetHover("#navi_multi",true);$("#navi_multi").bind("click",btnContinuesPage);$("#navi_zoomIn").css("background","url('"+B+"') no-repeat -735px 0px");TargetHover("#navi_zoomIn",true);$("#navi_zoomIn").bind("click",btnZoomIn);$("#navi_zoomOut").css("background","url('"+B+"') no-repeat -707px 0px");TargetHover("#navi_zoomOut",true);$("#navi_zoomOut").bind("click",btnZoomOut);$("#re_func_selectText").css("background","url('"+A+"') no-repeat 4px 7px");TargetHover("#re_func_selectText",true);$("#navi_rotate").css("background","url('"+B+"') no-repeat -762px 0px");TargetHover("#navi_rotate",true);$("#zoomList").attr("disabled",false);$("#pageIdList").attr("disabled",false);$("#_exIcon").css("background","url('"+B+"') no-repeat -686px 0px");$("#tabs").tabs("enable");$(".re_func_toolbar").tabs("option","disabled",[])}var canSaveAnnos=true;var canDelete=true;function enableSaveAnnos(){var B=getProjectName();var A=B+"/"+_resourceFolder+"/images/RE_wt_iconsA1.png";$(".re_func_saveAnnos").css("background","url('"+A+"') no-repeat -72px 0px");TargetHover(".re_func_saveAnnos",true);$(".re_func_saveAnnos").bind("click",function(){SaveAnnos(this)})}function enableDelete(){var B=getProjectName();var A=B+"/"+_resourceFolder+"/images/RE_wt_iconsA1.png";$(".re_func_deleteAnnotation").css("background","url('"+A+"') no-repeat -484px 0px");TargetHover(".re_func_deleteAnnotation",true);$(".re_func_deleteAnnotation").bind("click",DeleteAnnotation)}function disableSaveAnnos(){var B=getProjectName();var A=B+"/"+_resourceFolder+"/images/RE_wt_iconsB1.png";$(".re_func_saveAnnos").css("background","url('"+A+"') no-repeat -72px 0px");TargetHover(".re_func_saveAnnos",false);$(".re_func_saveAnnos").removeAttr("Onclick");$(".re_func_saveAnnos").unbind("click")}function disableDelete(){var B=getProjectName();var A=B+"/"+_resourceFolder+"/images/RE_wt_iconsB1.png";$(".re_func_deleteAnnotation").css("background","url('"+A+"') no-repeat -484px 0px");TargetHover(".re_func_deleteAnnotation",false);$(".re_func_deleteAnnotation").unbind("click")}function isHaveAnnos(){var B=_fileDocument[curFileId];for(var A=0;A<B.ViewerPageIndex.length;A++){var C=_fileDocument[curFileId].Viewers[B.ViewerPageIndex[A]];if(C.Annotations.length!=0){for(var D=0;D<C.Annotations.length;D++){if(C.Annotations[D]!=null){return}}}}if(canSaveAnnos){disableSaveAnnos();canSaveAnnos=false}if(canDelete){disableDelete();canDelete=true}}var _annoProPanel=false;function CreateWebToolbar(A){var B="<div id='customPanel'><div class='loadingImg' id='loading'><div class='loadingFont' id='loading_div'>Loading</div><div id='dialog'><p id='content'></p></div></div>";$(A).prepend(B);LoadingCss(viewerContainer_width,viewerContainer_height);$("#curtomPanel").hide();CreateAlertPanel();CreateToolbarItems(A)}var toolbarTabId=new Array();function CreateToolbarItems(B){var G="<ul id='_toolbarTabUl'></ul>";$(B).append(G);var C="<div id='_toolbarPanel'></div>";$(B).append(C);if(_viewerTopToolbar.items.length==0){$(".re_func_toolbar").hide();return}for(var I=0;I<_viewerTopToolbar.items.length;I++){var H=_viewerTopToolbar.items[I];var J=H.title;if(J=="File"){var A="<li><a id='_fileTab' href='#_toolbarPanel'><span style='padding:0px 15px 0px 15px;font-size:12px;font-weight:bold;'>File</span></a></li>";$("#_toolbarTabUl").append(A);CreateFileToolbar("#_toolbarPanel",_viewerTopToolbar.items[I])}else{if(J=="Annotation"){var D="<li><a id='_annoTab' href='#_toolbarPanel'><span style='padding:0px 15px 0px 15px;font-size:12px;font-weight:bold;'>Annotation</span></a></li>";$("#_toolbarTabUl").append(D);CreateAnnoToolbar("#_toolbarPanel",_viewerTopToolbar.items[I])}else{if(J=="Signature"){var E="<li><a id='_signTab' href='#_toolbarPanel'><span style='padding:0px 15px 0px 15px;font-size:12px;font-weight:bold;'>Signature</span></a></li>";$("#_toolbarTabUl").append(E);CreateSignToolbar("#_toolbarPanel",_viewerTopToolbar.items[I])}else{if(J=="Redact"){var F="<li><a id='_redactTab' href='#_toolbarPanel'><span style='padding:0px 15px 0px 15px;font-size:12px;font-weight:bold;'>Redact</span></a></li>";$("#_toolbarTabUl").append(F);CreateRedactToolbar("#_toolbarPanel",_viewerTopToolbar.items[I])}else{var K="<li><a href='#_toolbarPanel'><span style='padding:0px 15px 0px 15px;font-size:12px;font-weight:bold;'>"+J+"</span></a></li>";$("#_toolbarTabUl").append(K);CreateCusToolbar("#_toolbarPanel",I)}}}}}$(B).tabs();$(B).tabs("option","collapsible",false);$(B).tabs("option","active",0);$("#_processTab").hide();if(_annoProPanel){CreateCommentsPanel()}for(var I=1;I<toolbarTabId.length;I++){$("#"+toolbarTabId[I]).hide()}$(B).on("tabsactivate",function(O,L){var N=$(B).tabs("option","active").toString();for(var M=0;M<toolbarTabId.length;M++){$("#"+toolbarTabId[M]).hide();if(N==M){$("#"+toolbarTabId[M]).show()}}})}function CreateFileToolbar(B,L){var J="<div id='_files' style='width:"+(viewerContainer_width-20)+"px;'>";for(var E=0;E<L.items.length;E++){var F=L.items[E]._operation;if(F=="upload"){var C=new ToolbarItem({CssClass:"re_func_btn",CssId:"re_func_upload",Title:"Upload File",Event:"ShowUploadDialog();"});J+=C.CreateHtml()}else{if(F=="openOnlineDoc"){var A=new ToolbarItem({CssClass:"re_func_btn",CssId:"re_func_online",Title:"Open an online document",Event:"ShowOnlineDialog();"});J+=A.CreateHtml()}else{if(F=="print"){var D=new ToolbarItem({CssClass:"re_func_btn",CssId:"re_func_print",Title:"Print To PDF",Event:'ShowDialog("print");'});J+=D.CreateHtml()}else{if(F=="save"){var I=new ToolbarItem({CssClass:"re_func_btn",CssId:"re_func_save",Title:"Save File",Event:'ShowDialog("save");'});J+=I.CreateHtml()}else{if(F=="convert"){var H=new ToolbarItem({CssClass:"re_func_btn",CssId:"re_func_convert",Title:"Convert to Tiff file",Event:'ShowDialog("convert");'});J+=H.CreateHtml()}else{if(F=="ocr"){var G=new ToolbarItem({CssClass:"re_func_btn",CssId:"re_func_ocr",Title:"OCR",Event:"OCRDocument();"});J+=G.CreateHtml()}}}}}}}if(_viewer._btnFull){var K=new ToolbarItem({CssClass:"re_func_full",Event:"btnFull();"});J+=K.CreateHtml()}J+="</div>";$(B).append(J);toolbarTabId.push("_files")}function CreateProcessToolbar(D){var B="<div id='_process' style='width:"+(viewerContainer_width-20)+"px;'>";var G=new ToolbarItem({CssClass:"re_func_btn",CssId:"re_func_pageDelete",Title:"Delete Pages",Event:'ShowProcessDialog("delete")'});B+=G.CreateHtml();var F=new ToolbarItem({CssClass:"re_func_btn",CssId:"re_func_pageInsert",Title:"Insert Empty Pages",Event:'ShowProcessDialog("insert")'});B+=F.CreateHtml();var H=new ToolbarItem({CssClass:"re_func_btn",CssId:"re_func_pageSort",Title:"Rearrangement page",Event:'ShowProcessDialog("sort")'});B+=H.CreateHtml();var C=new ToolbarItem({CssClass:"re_func_btn",CssId:"re_func_fileCombine",Title:"Combine Documents",Event:'ShowProcessDialog("combine")'});B+=C.CreateHtml();var E=new ToolbarItem({CssClss:"re_func_btn",CssId:"re_func_fileSplit",Title:"Split Document",Event:'ShowProcessDialog("split")'});B+=E.CreateHtml();if(_viewer._btnFull){var A=new ToolbarItem({CssClass:"re_func_full",Event:"btnFull();"});B+=A.CreateHtml()}B+="</div>";$(D).append(B);toolbarTabId.push("_process")}function CreateAnnoToolbar(C,J){var B="<div id='_annotations' style='width:"+(viewerContainer_width-20)+"px;'>";if(J.items.length!=0){_annoProPanel=true}var E="";for(var M=0;M<J.items.length;M++){var O=J.items[M]._operation;if(O=="text"){var D=new ToolbarItem({CssId:"re_func_text",Title:"Text",Event:'draw_annotation("Text");ChangeIconStyle("re_func_text");'});B+=D.CreateHtml()}else{if(O=="freeHand"){var P=new ToolbarItem({CssId:"re_func_freeHand",Title:"Freehand",Event:'draw_annotation("Freehand");ChangeIconStyle("re_func_freeHand");'});B+=P.CreateHtml()}else{if(O=="highLight"){var A=new ToolbarItem({CssId:"re_func_highlight",Title:"Highlight",Event:'draw_annotation("Highlight");ChangeIconStyle("re_func_highlight");'});B+=A.CreateHtml()}else{if(O=="rectangle"){var G=new ToolbarItem({CssId:"re_func_filledRectangle",Title:"Rectangle",Event:'draw_annotation("FilledRectangle");ChangeIconStyle("re_func_filledRectangle");'});B+=G.CreateHtml()}else{if(O=="ellipse"){var I=new ToolbarItem({CssId:"re_func_ellipse",Title:"Ellipse",Event:'draw_annotation("Ellipse");ChangeIconStyle("re_func_ellipse");'});B+=I.CreateHtml()}else{if(O=="rubberStamp"){var Q=new ToolbarItem({CssId:"re_func_rubberStamp",Title:"RubberStamp",Event:'draw_annotation("RubberStamp");ChangeIconStyle("re_func_rubberStamp");'});B+=Q.CreateHtml()}else{if(O=="polygonLines"){var F=new ToolbarItem({CssId:"re_func_polygonLines",Title:"Polygon Lines",Event:'draw_annotation("PolygonLines");ChangeIconStyle("re_func_polygonLines");'});B+=F.CreateHtml()}else{if(O=="polygon"){var L=new ToolbarItem({CssId:"re_func_polygon",Title:"Polygon",Event:'draw_annotation("Polygon");ChangeIconStyle("re_func_polygon");'});B+=L.CreateHtml()}else{if(O=="line"){var R=new ToolbarItem({CssId:"re_func_line",Title:"Line",Event:'draw_annotation("Line");ChangeIconStyle("re_func_line");'});B+=R.CreateHtml()}else{if(O=="arrow"){var T=new ToolbarItem({CssId:"re_func_arrow",Title:"Arrow",Event:'draw_annotation("Arrow");ChangeIconStyle("re_func_arrow");'});B+=T.CreateHtml()}else{if(O=="delete"){var H=new ToolbarItem({CssClass:"re_func_deleteAnnotation",Title:"Delete selected Comments",Event:""});E+=H.CreateHtml()}else{if(O=="loadComments"){var S=new ToolbarItem({CssClass:"re_func_loadAnnos",CssId:"anno_loadComments",Title:"Load Comments",Event:""});E+=S.CreateHtml()}else{if(O=="saveComments"){var N=new ToolbarItem({CssClass:"re_func_saveAnnos",CssId:"anno_saveComments",Title:"Save Comments",Event:"SaveAnnos(this);"});E+=N.CreateHtml()}}}}}}}}}}}}}}if(E!=""){B+="<div class='_commonPart' style='width:auto;height:49px;'>"+E+"</div>"}if(_viewer._btnFull){var K=new ToolbarItem({CssClass:"re_func_full",Event:"btnFull();"});B+=K.CreateHtml()}B+="</div>";$(C).append(B);CreateSaveAnnosPanel();CreateLoadAnnosPanel();toolbarTabId.push("_annotations")}function CreateCommentsPanel(){var B="<div id='_commentsProPanel' style='border-radius:2px;box-shadow:2px 2px 5px #666;font-size:12px;position:absolute;'></div>";$("body").append(B);$("#_commentsProPanel").css({width:"280px",height:"40px",display:"block"});$("#_commentsProPanel").draggable();var A="<div id='appearDiv' style='width:auto;height:49px;'></div>";$("#_commentsProPanel").append(A);CreateProperPanel();$("#_commentsProPanel").hide()}var showCommentsPanel=false;function CommentsPosition(){var A=$(".re_content").offset().left+$(".re_content").outerWidth()-298;var B=$(".re_content").offset().top;$("#_commentsProPanel").css({left:A+"px",top:B+"px"})}function ShowCommentsPanel(A){if(!showCommentsPanel){$("#_commentsProPanel").show();CommentsPosition();showCommentsPanel=true}SetPanelItems(A)}function HideCommentsPanel(){$("#_commentsProPanel").hide();showCommentsPanel=false}function CreateSignToolbar(B,G){var A="<div id='_signatures' style='width:"+(viewerContainer_width-20)+"px;'>";if(G.items.length!=0){_annoProPanel=true}var D="";for(var I=0;I<G.items.length;I++){var J=G.items[I]._operation;if(J=="Freehand"){var K=new ToolbarItem({CssId:"re_func_freeHandSign",Title:"Create Freehand Signature",Event:'ShowSignPanel("FreeHand")'});A+=K.CreateHtml()}else{if(J=="Text"){var H=new ToolbarItem({CssId:"re_func_textSign",Title:"Create Text Signature",Event:'ShowSignPanel("Text")'});A+=H.CreateHtml()}else{if(J=="Date"){var M=new ToolbarItem({CssId:"re_func_dateSign",Title:"Create Date Signature",Event:"SelectSignature(this)"});A+=M.CreateHtml()}else{if(J=="signManager"){var N=new ToolbarItem({CssId:"re_func_manaSign",Title:"Manage Signatures",Event:"ShowSignManagePanel()"});A+=N.CreateHtml()}else{if(J=="delete"){var E=new ToolbarItem({CssClass:"re_func_deleteAnnotation",Title:"Delete selected Comments",Event:""});D+=E.CreateHtml()}else{if(J=="loadComments"){var L=new ToolbarItem({CssClass:"re_func_loadAnnos",CssId:"sign_loadComments",Title:"Load Comments",Event:""});D+=L.CreateHtml()}else{if(J=="saveComments"){var F=new ToolbarItem({CssClass:"re_func_saveAnnos",CssId:"sign_saveComments",Title:"Save Comments",Event:"SaveAnnos(this);"});D+=F.CreateHtml()}}}}}}}}if(D!=""){A+="<div class='_commonPart' style='width:auto;height:49px;'>"+D+"</div>"}if(_viewer._btnFull){var C=new ToolbarItem({CssClass:"re_func_full",Event:"btnFull();"});A+=C.CreateHtml()}A+="</div>";CreateSignManagePanel();CreateSignPanel();$(B).append(A);toolbarTabId.push("_signatures")}function CreateRedactToolbar(B,C){var F="<div id='_redacts' style='width:"+(viewerContainer_width-20)+"px;'>";var D="";for(var H=0;H<C.items.length;H++){var I=C.items[H]._operation;if(I=="rectRedact"){var K=new ToolbarItem({CssId:"re_func_rectRedact",Title:"Rectangle Redaction",Event:'drawRectRedact("FilledRectRedaction")'});F+=K.CreateHtml()}else{if(I=="textRedact"){var G=new ToolbarItem({CssId:"re_func_textRedact",Title:"Text Selection Redaction",Event:""});F+=G.CreateHtml()}else{if(I=="delete"){var E=new ToolbarItem({CssClass:"re_func_deleteAnnotation",Title:"Delete selected Comments",Event:""});D+=E.CreateHtml()}else{if(I=="loadComments"){var L=new ToolbarItem({CssClass:"re_func_loadAnnos",CssId:"redact_loadComments",Title:"Load Comments",Event:""});D+=L.CreateHtml()}else{if(I=="saveComments"){var A=new ToolbarItem({CssClass:"re_func_saveAnnos",CssId:"redact_saveComments",Title:"Save Comments",Event:"SaveAnnos(this);"});D+=A.CreateHtml()}}}}}}if(D!=""){F+="<div class='_commonPart' style='width:auto;height:49px;'>"+D+"</div>"}if(_viewer._btnFull){var J=new ToolbarItem({CssClass:"re_func_full",Event:"btnFull();"});F+=J.CreateHtml()}F+="</div>";$(B).append(F);toolbarTabId.push("_redacts")}function CreateCusToolbar(C,H){var J=_viewerTopToolbar.items[H];var D=handleId(J.title);var I="<div class='_customToolbar' id='"+D+"' style='width:"+(viewerContainer_width-20)+"px;'></div>";$(C).append(I);for(var G=0;G<J.items.length;G++){var B=J.items[G];if(B.htmlDom!=""){$("#"+D).append(B.htmlDom)}else{if(B.id!=""){var F="<div id='"+B.id+"' title='"+B._operation+"' style='float:left;'></div>";$("#"+D).append(F);$("#"+B.id).bind("click",B.event)}else{var A=handleId(B._operation);var F="<div id='_"+A+"' title='"+B._operation+"' Onclick='cusIconEvent("+H+","+G+")' style='float:left;'></div>";$("#"+D).append(F);$("#_"+A).css(B.style.cusCss);TargetHover("#_"+A,true)}}}if(_viewer._btnFull){var E=new ToolbarItem({CssClass:"re_func_full",Event:"btnFull();"});I=E.CreateHtml();$("#"+D).append(I)}toolbarTabId.push(D)}function handleId(A){var B=new RegExp(/[^\w+$]/);while(B.exec(A)!=null){A=A.replace(B.exec(A),"")}return A}function cusIconEvent(A,E){var B=_viewerTopToolbar.items[A];var D=B.items[E].params.cusCmd;showLoading();var C={type:"POST",url:getCurrentAspx(),async:false,data:D,success:function(F){ParameterDocumentLoad(F)},error:function(){LoadErrorHandle()}};$.ajax(C)}function CreateSignManagePanel(){var B="<div id='_signManagePanel' style='border-radius:2px;font-size:12px;box-shadow:2px 2px 5px #666;position:absolute;background:#efefef;z-index:999;'></div>";$("body").append(B);$("#_signManagePanel").css({width:"600px",height:"400px",display:"block"});var B="<div id='_signsManage' style='width:580px;height:330px;overflow:auto;margin:10px;'></div>";$("#_signManagePanel").append(B);var A="<div style='padding:10px;float:left'><div class='_signButton' Onclick='ShowSignPanel(\"FreeHand\");'>Draw New Signature </div>";A+="<div class='_signButton'  Onclick='ShowSignPanel(\"Text\");'>Type New Signature</div>";A+="<div class='_signButton'  Onclick='HideSignPanel();'>Cancel</div>";A+="</div>";$("#_signManagePanel").append(A);$("#_signManagePanel").hide()}function ShowSignManagePanel(){$("#loading").show();$("#loading_div").hide();$("#_signPanel").hide();$("#_signManagePanel").show();SignPanelPosition("#_signManagePanel")}function CreateSignPanel(){var C="<div id='_signPanel' style='border-radius:2px;font-size:12px;box-shadow:2px 2px 5px #666;position:absolute;background:#efefef;z-index:999;'></div>";$("body").append(C);$("#_signPanel").css({width:"600px",height:"350px",display:"block",});var B="<div id='_signContent' style='width:600px;height:300px;float:left;'>";B+="<div id='_signFreeHand' style='background:#ffffff;border:1px solid #999999;width:580px;height:280px;margin:10px;float:left;'></div>";B+="<div id='_signText' style='width:580px;height:280px;margin:10px;float:left;overflow:auto;'></div></div>";var D="<div style='padding:10px;float:left'><div class='_signButton' id='_signSave' Onclick='SaveSignToManager();'>Save</div>";D+="<div class='_signButton' id='_signClear' Onclick='ClearSignPanel();'>Clear</div>";D+="<div class='_signButton' id='_signCancel' Onclick='HideSignPanel();'>Cancel</div>";D+="</div>";$("#_signPanel").append(B);$("#_signPanel").append(D);var A="<table id='_signTextTable' style='color:#333333;width:100%;'>";A+="<tr><td colspan='2' style='text-align:center;'>Type your signature:</td></tr>";A+="<tr><td colspan='2' style='text-align:center;'><input id='_signTextValue' oninput='OnInput(event)' style='width:230px;'></input></td></tr>";A+="<tr><td><div class='_signTextInput' id='Agency_FB' style='font-family:Agency FB'></div></td>";A+="<td><div class='_signTextInput' id='Berlin_Sans_FB' style='font-family:Berlin Sans FB'></div></td></tr>";A+="<tr><td><div class='_signTextInput' id='Arial' style='font-family:Arial'></div></td>";A+="<td><div class='_signTextInput' id='Verdana' style='font-family:Verdana'></div></td></tr>";A+="<tr><td><div class='_signTextInput' id='Batang' style='font-family:Batang'></div></td>";A+="<td><div class='_signTextInput' id='Gungsuh' style='font-family:Gungsuh'></div></td></tr>";A+="<tr><td><div class='_signTextInput' id='Segoe_Script' style='font-family:Segoe Script'></div></td>";A+="<td><div class='_signTextInput' id='Impact' style='font-family:Impact'></div></td></tr>";A+="</table>";$("#_signText").append(A);$("._signTextInput").bind("click",function(){SelectedTextSign(this)});$("#_signPanel").hide()}var signTextFamilyID=new Array("Agency_FB","Berlin_Sans_FB","Arial","Verdana","Batang","Gungsuh","Segoe_Script","Impact");function OnInput(B){var C=$("#_signTextValue").val();if(C!=""){$("._signTextInput").show();for(var A=0;A<signTextFamilyID.length;A++){$("#"+signTextFamilyID[A]).html(C)}}else{$("._signTextInput").hide()}}var curSelectTextFontID="";function SelectedTextSign(C){if(curSelectTextFontID!=""){$("#"+curSelectTextFontID).removeClass("_signTextSelect")}var A=C.id;curSelectTextFontID=A;var D=A.replaceAll("_"," ");var B=$("#"+A).val();$("#"+curSelectTextFontID).addClass("_signTextSelect")}function SignPanelPosition(D){var B=$("#_plcBigImg").offset().left;var C=$("#_plcBigImg").offset().top;var E=$("#_plcBigImg").outerWidth(true);var A=$("#_plcBigImg").outerHeight(true);$(D).css({left:B+E/2-$(D).outerWidth(true)/2,top:C+A/2-$(D).outerHeight(true)/2})}var currentSignType="";var pointsParts=new Array();var signNum=0;function ShowSignPanel(G){currentSignType=G;$("#loading").show();$("#loading_div").hide();$("#_signManagePanel").hide();$("#_signPanel").show();$("#_signPanel").unbind("mouseup");if(G=="FreeHand"){$("#_signFreeHand").show();$("#_signFreeHand").empty();$("#_signText").hide();var C=0;var J=0;var L=0;var B=0;var H=new Array();var A=new Array();pointsParts=new Array();var I=false;var K=0;var E="";var F=function(N){C=$("#_signPanel").offset().left;J=$("#_signPanel").offset().top;I=true;H=new Array();A=new Array()};var D=function(O){if(I){L=O.pageX-C;B=O.pageY-J;$("#sign_"+signNum).remove();O=O||window.event;H[K]=L;A[K]=B;K++;E="";for(var N=0;N<H.length;N++){E+=H[N]+","+A[N]+" "}var P=drawFreehandSignWidthSVG(E);$("#_signFreeHand").append(P)}};var M=function(N){I=false;K=0;pointsParts.push(E)};$("#_signFreeHand").bind("mousedown",F);$("#_signFreeHand").bind("mousemove",D);$("#_signPanel").bind("mouseup",M)}else{if(G=="Text"){$("#_signFreeHand").hide();$("#_signText").show();$("#_signTextValue").val("");$("._signTextInput").hide()}}SignPanelPosition("#_signPanel")}function drawFreehandSignWidthSVG(C){var B="<svg id='sign_"+signNum+"' width='100%' height='100%' version='1.1' xmlns='http://www.w3.org/2000/svg'>";for(var A=0;A<pointsParts.length;A++){B+="<polyline points='"+pointsParts[A]+"' style='fill:none;stroke:black;stroke-width:3;'/>"}B+="<polyline points='"+C+"' style='fill:none;stroke:black;stroke-width:3;'/>";B+="</svg>";return B}function ClearSignPanel(){if(currentSignType=="FreeHand"){$("#_signFreeHand").empty();pointsParts=new Array()}else{if(currentSignType=="Text"){$("#_signTextValue").val("");$("._signTextInput").hide()}}}var saveSignsPoints=new Array();function SaveSignToManager(){var J="<div class='_signMButton' Onclick='SelectSignature(this);'>Use signature</div>";J+="<div class='_signMButton' Onclick='DeleteSignFromMangePanel(this);'>Delete Signature</div>";if(currentSignType=="FreeHand"){var K=$("#_signFreeHand").html();if(pointsParts.length==0){return}for(var E=0;E<pointsParts.length;E++){var A="";var C=pointsParts[E];var H=C.split(" ");for(var B=0;B<H.length-1;B++){var D=parseInt(0.7*parseFloat(H[B].split(",")[0]));var F=parseInt(0.7*parseFloat(H[B].split(",")[1]));A+=D+","+F+" "}pointsParts[E]=A}var I="<div class='_manaFHSign' id='manaSign_"+signNum+"'><div style='width:398px;height:200px;border:1px solid #666;'>";I+=drawFreehandSignWidthSVG("")+"</div>";I+=J;I+="</div>";$("#_signsManage").append(I);saveSignsPoints[signNum]=pointsParts}else{if(currentSignType=="Text"){if(curSelectTextFontID==""){curSelectTextFontID="Arial"}var G=curSelectTextFontID.replaceAll("_"," ");var I="<div class='_manaTxtSign' id='manaSign_"+signNum+"'><div style='font-family:"+G+";width:398px;height:70px;font-size:32px;border:1px solid #666;text-align:center;line-height:70px;'>";var K=$("#"+curSelectTextFontID).html();if(K==""){return}I+=K+"</div>"+J+"</div>";$("#_signsManage").append(I);saveSignsPoints[signNum]=G+":"+K}}signNum++;ShowSignManagePanel()}var signNumber=0;var parentClass="";function SelectSignature(A){$("#draw_canvas").unbind("click");if(selectTextIcon){$("#draw_canvas").unbind("mousedown",selectDown);$("#draw_canvas").unbind("mousemove",selectMove);$("#draw_canvas").unbind("mouseup",selectUp);$("#re_func_selectText").removeClass("iconBorder");$(".showByDrag").removeClass("mouseStyleSelect");selectTextIcon=false}else{$(".showByDrag").unbind("mousedown",dragImageMouseDown);$(".showByDrag").unbind("mousemove",dragImageMouseMove);$(".showByDrag").unbind("mouseup",dragImageMouseUp);$(".showByDrag").removeClass("mouseStyleMove")}$(".showByDrag").addClass("mouseStyleAnnotation");if(A.id=="re_func_dateSign"){parentClass="_manaDateSign"}else{var B=$(A).parent().attr("id");signNumber=B.substring(B.indexOf("_")+1);parentClass=$(A).parent().attr("class")}$("#draw_canvas").bind("click",AddSignatureToPage);HideSignPanel()}var AddSignatureToPage=function(A){A=A||window.event;var K=$("#_plcBigImg").offset().left;var F=$("#_plcBigImg").offset().top;var O=$("#_plcBigImg")[0].scrollLeft-5;var h=$("#_plcBigImg")[0].scrollTop-5;A=A||window.event;var U=A.pageX-K+O;var b=A.pageY-F+h;if(_viewerMode=="multi"){drawPageIndex=PrePageCount(b)}else{drawPageIndex=parseInt(_curCorrectPageId)}drawActualIndex=_fileDocument[curFileId].GetPageIndex(drawPageIndex);var J=0;var M=0;var B="";var H="";if(parentClass=="_manaFHSign"){B="fhSignature";var m=new Array();var P=new Array();P=saveSignsPoints[signNumber];for(var p=0;p<P.length;p++){m[p]=P[p]}var R=new Array();var c=new Array();var V=new Array();var r=new Array();for(var p=0;p<m.length;p++){var I=m[p];var o=I.split(" ");var l=new Array();var L=new Array();for(var n=0;n<o.length-1;n++){var W=parseInt(o[n].split(",")[0]);var s=parseInt(o[n].split(",")[1]);l.push(W);L.push(s)}R.push(l.min());c.push(L.min());V.push(l.max());r.push(L.max())}var f=R.min();var G=c.min();var C=V.max();var D=r.max();J=C-f;M=D-G;for(var p=0;p<m.length;p++){var I=m[p];var o=I.split(" ");var T="";for(var n=0;n<o.length-1;n++){var W=parseInt(o[n].split(",")[0])-f+U-J/2;var s=parseInt(o[n].split(",")[1])-G+b-M/2;T+=W+","+s+";"}T=T.substring(0,T.length-1);H+=T+"|"}H=H.substring(0,H.length-1)}else{if(parentClass=="_manaTxtSign"){B="txtSignature";var Q=saveSignsPoints[signNumber].indexOf(":");var g=saveSignsPoints[signNumber].substring(0,Q);var N=saveSignsPoints[signNumber].substring(Q+1);txtSignature.ShowedText=N;txtSignature.TextFont=g;var q=_zoomRatio*_zoomIndex;var E=document.createElement("canvas");context=E.getContext("2d");context.font="bold "+txtSignature.TextSize*q+"px "+g;metrics=context.measureText(N);J=metrics.width;M=txtSignature.TextSize*q}else{if(parentClass=="_manaDateSign"){B="dateSignature";var d=new Date();var S=d.getMonth()+1;S=S<10?"0"+S:S;var Z=d.getDate();Z=Z<10?"0"+Z:Z;var N=Z+"/"+S+"/"+d.getFullYear();dateSignature.ShowedText=N;var q=_zoomRatio*_zoomIndex;var E=document.createElement("canvas");context=E.getContext("2d");context.font="bold "+dateSignature.TextSize*q+"px "+dateSignature.TextFont;metrics=context.measureText(N);J=metrics.width;M=dateSignature.TextSize*q}}}var a=_fileDocument[curFileId].Viewers[drawActualIndex];a.GetViewerLeftTop();if(a.Rotate==1||a.Rotate==3){var Y=J;J=M;M=Y}var k=new Annotation({OnPageIndex:drawActualIndex,Type:B,Index:num,ShowLeft:U-J/2,ShowTop:b-M/2,ShowWidth:J,ShowHeight:M,Rotate:a.Rotate,ShowPoints:H,ViewerLeft:a.Left,ViewerTop:a.Top,ViewerWidth:a.ActualWidth,ViewerHeight:a.ActualHeight,ViewerScaleX:a.ScaleX,ViewerScaleY:a.ScaleY,ThumbViewerScaleX:a.ThumbScaleX,ThumbViewerScaleY:a.ThumbScaleY,ViewerOne2OneWidth:a.OneToOne_Width,ViewerOne2OneHeight:a.OneToOne_Height});var X=k.OutLineWidth/2*_zoomRatio*_zoomIndex;var N="<div class='new_rect' id='div_"+num+"' style='left:"+(U-J/2-X)+"px;top:"+(b-M/2-X)+"px;width:"+(J+2*X)+"px;height:"+(M+2*X)+"px'>";N+="<div class='rRightDown' id='rRightDown_"+num+"'></div><div class='rLeftDown' id='rLeftDown_"+num+"'></div><div class='rRightUp' id='rRightUp_"+num+"'></div><div class='rLeftUp' id='rLeftUp_"+num+"'></div><div class='rRight' id='rRight_"+num+"'></div><div class='rLeft' id='rLeft_"+num+"'></div><div class='rUp' id='rUp_"+num+"'></div><div class='rDown' id='rDown_"+num+"'></div>";N+=drawAnnotationWithSVG(k,"annotation",drawActualIndex,false);N+="</div>";$("#draw_canvas").append(N);$("#div_"+num).draggable({containment:"parent",scroll:false,handle:"svg .annotation",stop:function(){AnnoIsChanged()}});_fileDocument[curFileId].Viewers[drawActualIndex].Annotations[num]=k;selectDiv=new Array();selectDiv.push(num);BindImageViewerAnnotationClick(num);BindResize(num,B);addThumbViewerAnnotation(k,drawActualIndex);if(!canSaveAnnos){enableSaveAnnos();canSaveAnnos=true}$("#draw_canvas").unbind("click");$(".showByDrag").bind("mousedown",dragImageMouseDown);$(".showByDrag").bind("mousemove",dragImageMouseMove);$(".showByDrag").bind("mouseup",dragImageMouseUp);$(".showByDrag").removeClass("mouseStyleAnnotation");$(".showByDrag").addClass("mouseStyleMove");num++};function DeleteSignFromMangePanel(A){var B=$(A).parent().attr("id");$("#"+B).remove()}function HideSignPanel(){$("#loading_div").show();$("#loading").hide();$("#_signManagePanel").hide();$("#_signPanel").hide()}function CreateAlertPanel(){var A="<div id='_alertPanel' style='border-radius:2px;font-size:16px;color:#ffffff;box-shadow:2px 2px 5px #666;position:absolute;background:#efefef;'></div>";$("body").append(A);$("#_alertPanel").css({width:"auto",height:"auto",display:"block",});var B="<div id='_alertContent' style='padding:20px 40px 20px 40px;'><div>";$("#_alertPanel").append(B);$("#_alertPanel").hide()}function CreateLoadAnnosPanel(){var C="<div id='_loadAnnosPanel' style='border-radius:6px;font-size:12px;box-shadow:2px 2px 5px #666;position:absolute;background:#efefef;'></div>";$("body").append(C);$("#_loadAnnosPanel").css({width:"auto",height:"auto",display:"block",});var B="<table id='_loadAnnosTable' style='padding:8px;color:#333333;width:100%;'>";B+="<tr id='annoListTile'><td id='_annoListTitle'></td></tr>";B+="<tr id='annoList'><td><div id='_annoList' width='250px;'></div></td></tr></table>";$("#_loadAnnosPanel").append(B);var A="<button id='loadAnnos' style='font-size:10px;margin-bottom:5px;margin-right:10px;float:right;' OnClick='loadAnnotations();'>Load</button>";$("#_loadAnnosPanel").append(A);$("#_loadAnnosPanel").hide()}var isUnSaveAnnos=false;var isLoadOrSave=false;var tempNum=0;var indexArray=new Array();var tempAnnoArray=new Array();function loadAnnotations(){$("#_loadAnnosPanel").hide();_loadAnnosPanelShow=false;if(num!=0&&num>curSaveAnnoNum){for(var D=curSaveAnnoNum;D<num;D++){var H=D;for(var F=0;F<_fileDocument[curFileId].Viewers.length;F++){var B=_fileDocument[curFileId].Viewers[F];if(B==null||B.ShowIndex==null){continue}var C=new Array();for(index in B.Annotations){C[index]=B.Annotations[index];if(C[H]!=null){if(isUnSaveAnnos&&canSaveAnnos){var A=confirm("There are some annotations yet saved,Would you want to save?");if(A==true){$(".re_func_saveAnnos").trigger("click",[this]);return}else{isUnSaveAnnos=false;break}}}}}}}else{if(isUnSaveAnnos&&canSaveAnnos){var A=confirm("There are some annotations yet saved,Would you want to save?");if(A==true){$(".re_func_saveAnnos").trigger("click",[this]);return}else{isUnSaveAnnos=false}}}tempNum=0;indexArray=new Array();tempAnnoArray=new Array();var E=$("input[name='checkbox']:checked").length;if(E==0){AlertPanel("you should select some groups to load","#cc3333");$("#_loadAnnosPanel").show();_loadAnnosPanelShow=true;return}else{for(var F=0;F<num;F++){$("#div_"+F).remove();$("#thumbImg_"+F).remove();_fileDocument[curFileId].DeleteAnno(F)}$("input[name='checkbox']:checked").each(function(){var J=$("#"+this.id+"_text").html();var K=LoadXml(J);if(!K){AlertPanel("Browser does not support xml document reading","#cc3333");return}});AlertPanel("Annotation Data is successfully imported","#66cc33");for(var F=0;F<tempAnnoArray.length;F++){var G=tempAnnoArray[F].OnPageIndex;var H=tempAnnoArray[F].Index;if(_fileDocument[curFileId].Viewers[G]==null){continue}_fileDocument[curFileId].Viewers[G].Annotations[H]=tempAnnoArray[F]}if(_viewerMode=="single"){var I=_fileDocument[curFileId].GetPageIndex(_curCorrectPageId);drawImageViewerAnnotations(I)}else{drawContinuesAnnotations()}num=tempNum;curSaveAnnoNum=num;isUnSaveAnnos=false;isLoadOrSave=true}if(!canSaveAnnos){enableSaveAnnos();canSaveAnnos=true}}var isCanLoadAnnoFile=false;function cancelLoadAnnoFiles(){if(isCanLoadAnnoFile){var B=getProjectName();var A=B+"/"+_resourceFolder+"/images/RE_wt_iconsB1.png";$(".re_func_loadAnnos").css("background","url('"+A+"') no-repeat 0px 0px");TargetHover(".re_func_loadAnnos",false);$(".re_func_loadAnnos").unbind("click");$(".re_func_loadAnnos").attr("title","no comments information");setTimeout(function(){$("#_loadAnnosPanel").hide();_loadAnnosPanelShow=false},1500);isCanLoadAnnoFile=false}}function enableLoadAnnoFiles(){if(!isCanLoadAnnoFile){var B=getProjectName();var A=B+"/"+_resourceFolder+"/images/RE_wt_iconsA1.png";$(".re_func_loadAnnos").css("background","url('"+A+"') no-repeat 0px 0px");TargetHover(".re_func_loadAnnos",true);$(".re_func_loadAnnos").bind("click",function(){LoadAnnos(this)});$(".re_func_loadAnnos").attr("title","Load Comments");isCanLoadAnnoFile=true}}function LoadXml(A){var C=getFolder("output")+"/"+A+".xml";var B=true;$.ajax({url:C,dataType:"xml",type:"GET",timeout:2000,asyn:false,error:function(D){B=false},success:function(D){xmlToDrawAnnotations(D)}});return B}function xmlToDrawAnnotations(C){var B=_fileDocument[curFileId];for(var A=0;A<B.ViewerPageIndex.length;A++){var D=B.ViewerPageIndex[A];$($(C).find("page"+D)).find("annotation").each(function(I){zoomId=_zoomIndex;pageSizeType=_pageSizeType;rotateId=_fileDocument[curFileId].Viewers[D].Rotate;var Q=_fileDocument[curFileId].Viewers[D];Q.GetViewerLeftTop();var L=tempNum++;var V=$(this);var d=$(V).attr("creator");var e=$(V).attr("createTime");var J=$(V).attr("modified");var f=$(V).attr("type");var b=parseFloat($(V).attr("left"));var Z=parseFloat($(V).attr("top"));var h=parseFloat($(V).attr("width"));var g=parseFloat($(V).attr("height"));var T=$(V).attr("points");var U=$(V).attr("lineColor");var a=parseFloat($(V).attr("lineWidth"));var R=$(V).attr("fillColor");var G="";var E="";var H="";var W="";var i=0;var S=new Array();if(f=="RubberStamp"||f=="Text"||f=="txtSignature"||f=="dateSignature"){G=$(V).attr("showedText");E=$(V).attr("text");H=$(V).attr("textColor");W=$(V).attr("textFont");i=parseFloat($(V).attr("textSize"));style=$(V).attr("textStyle");var Y=$(V).attr("textStyle").split(";");S=new Array();for(var O=0;O<Y.length-1;O++){S.push(Y[O])}}var N=parseFloat($(V).attr("opacity"));var P=new Annotation({OnPageIndex:D,Type:f,Index:L,User:d,CreateTime:e,Modified:J,ShowLeft:0,ShowTop:0,ShowWidth:0,ShowHeight:0,Left:b,Top:Z,Width:h,Height:g,Points:T,Rotate:rotateId,PageSizeType:pageSizeType,ZoomIndex:zoomId,ViewerLeft:Q.Left,ViewerTop:Q.Top,ViewerWidth:Q.ActualWidth,ViewerHeight:Q.ActualHeight,ViewerScaleX:Q.ScaleX,ViewerScaleY:Q.ScaleY,ThumbViewerScaleX:Q.ThumbScaleX,ThumbViewerScaleY:Q.ThumbScaleY,ViewerOne2OneWidth:Q.OneToOne_Width,ViewerOne2OneHeight:Q.OneToOne_Height});P.OutLineColor=U;P.OutLineWidth=a;P.FillColor=R;P.ShowedText=G;P.Text=E;P.TextColor=H;P.TextFont=W;P.TextSize=i;P.TextStyle=S;P.Transparency=N;P.GetShowPosition();P.CalculateOnRotate();var M=new PageTextRedacts();if(f=="TextRedacts"){var X=V.find("redactRects").attr("relativePages");var F=X.split(";");var K=new Array();for(var c=0;c<F.length-1;c++){K.push(F[c])}V.find("redactRects").find("pageRedact").each(function(j){var k=$(this);var m=parseInt(k.attr("pageId"));var l=new Annotation({OnPageIndex:m,Type:f,Index:L,User:d,CreateTime:e,Modified:J,Rotate:rotateId,PageSizeType:pageSizeType,ZoomIndex:zoomId,ViewerLeft:Q.Left,ViewerTop:Q.Top,ViewerWidth:Q.ActualWidth,ViewerHeight:Q.ActualHeight,ViewerScaleX:Q.ScaleX,ViewerScaleY:Q.ScaleY});l.AddAnnoStyle(TextRedact);l.Transparency=N;l.OutLineWidth=a;l.FillColor=R;M=new PageTextRedacts({relativePages:K});k.find("redactAnno").each(function(o){var n=$(this);var p=new Annotation({OnPageIndex:m,Type:$(n).attr("type"),Left:$(n).attr("left"),Top:$(n).attr("top"),Width:$(n).attr("width"),Height:$(n).attr("height"),Points:$(n).attr("points"),Rotate:rotateId,PageSizeType:pageSizeType,ZoomIndex:zoomId,ViewerLeft:Q.Left,ViewerTop:Q.Top,ViewerWidth:Q.ActualWidth,ViewerHeight:Q.ActualHeight,ViewerScaleX:Q.ScaleX,ViewerScaleY:Q.ScaleY,ThumbViewerScaleX:Q.ThumbScaleX,ThumbViewerScaleY:Q.ThumbScaleY,ViewerOne2OneWidth:Q.OneToOne_Width,ViewerOne2OneHeight:Q.OneToOne_Height});p.AddAnnoStyle(TextRedact);p.Transparency=$(n).attr("opacity");p.FillColor=$(n).attr("fillColor");p.GetShowPosition();p.CalculateOnRotate();M.curPageRectRedacts.push(p)});l.RedactRects=M;tempAnnoArray.push(l)})}else{tempAnnoArray.push(P)}addThumbViewerAnnotation(P,D);indexArray.push(L)})}}var annoSaveName="";function CreateSaveAnnosPanel(){var C="<div id='_saveAnnosPanel' style='border-radius:6px;font-size:12px;box-shadow:2px 2px 5px #666;position:absolute;background:#efefef;'></div>";$("body").append(C);$("#_saveAnnosPanel").css({width:"auto",height:"auto",display:"block",});var B="<table id='_saveAnnosTable' style='padding:5px;color:#333333;width:100%;'>";B+="<tr id='appendMode'><td colspan='2'><input type='radio' id='_appendModeNew' name='appendMode' value='newFile' onchange='modeRadioChange(this);' checked>";B+="<label for='_appendModeNew' style='font-weight:bold;'>Save to a new group comments</label></td><tr>";B+="<tr id='annosUser'><td>&nbsp;&nbsp;&nbsp;</td><td>Name:<input style='width:100px;' id='_annoName'/></td></tr>";B+="<tr><td colspan='2'><input type='radio' id='_appendModeOld' name='appendMode' value='overwrite' onchange='modeRadioChange();'>";B+="<label for='_appendModeOld' style='font-weight:bold;'>Save and overwrite an existing group comments</label></td></tr>";B+="<tr id='_existAnnoFiles'><td>&nbsp;&nbsp;&nbsp;</td><td><div id='_exAnnoFileList'></div></td></tr></table>";$("#_saveAnnosPanel").append(B);$("#_annoName").keyup(function(D){if(D.keyCode==13){SaveAnnotations()}});$("#_textProPanel").hide();var A="<button id='saveAnnos' style='font-size:10px;margin-bottom:5px;margin-right:10px;float:right;' OnClick='SaveAnnotations();'>Save</button>";$("#_saveAnnosPanel").append(A);$("#_saveAnnosPanel").hide();$("#_exAnnoFileList").hide();createChildPanel=false}var createChildPanel=false;function modeRadioChange(){var radioId=$('input:radio[name="appendMode"]:checked').val();if(radioId=="newFile"){$("#annosUser").show();$("#_exAnnoFileList").hide();$("#saveAnnos").show()}else{if(radioId=="overwrite"){$("#annosUser").hide();$("#_exAnnoFileList").show();$("#_exAnnoFileList").empty();var str={action:"GetAnnosNameList",fid:_fid,fileName:_fileName};var options={type:"POST",url:getServerHandlerUrl(),async:true,data:str,success:function(response){result=eval("("+response+")");var annoNameList=result.msg.split(";");if(annoNameList.length-1==0){$("#_exAnnoFileList").html("No comments information");cancelLoadAnnoFiles();$("#saveAnnos").hide()}else{annoListTextArray=new Array();$("#_exAnnoFileList").append("<table id='_exAnnoFileTable'></table>");for(var i=0;i<annoNameList.length-1;i++){var position=annoNameList[i].indexOf(",");var fileName=annoNameList[i].substring(0,position);var time=annoNameList[i].substring(position+1);var str="<tr id='_annoRList_"+i+"_item'><td><input type='radio' name='saveFile' id='_annoRList_"+i+"' style='text-align:center;line-height:25px;' value='"+fileName+"'><label id='_annoRList_"+i+"_text' for='_annoRList_"+i+"' style='font-size:15px;font-weight:bold;'>"+fileName+"</label></td>";str+="<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td><td><label>["+time+"]</label></td><td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>";str+="<td><div class='_annoListDelete' id='_annoRList_"+i+"_delete' Onclick='DeleteAnnoXmlFile(this);'></div></td></tr>";$("#_exAnnoFileTable").append(str);TargetHover("#_annoList_"+i+"_delete",true);annoListTextArray.push("_annoRList_"+i+"_text")}$("#_annoList_0").attr("checked",true)}},error:function(err){$("#_exAnnoFileList").html("No comments information!")}};$.ajax(options)}}}var curSaveAnnoNum=0;function SaveAnnotations(){var appendMode=document.getElementById("_appendModeNew").checked;if(appendMode){annoSaveName=$("#_annoName").val();if(annoSaveName==""){AlertPanel("Please enter a name for your annotations","#cc3333");return}else{var str={action:"GetAnnosNameList",fid:_fid,fileName:_fileName};var options={type:"POST",url:getServerHandlerUrl(),async:true,data:str,success:function(response){result=eval("("+response+")");var annoNameList=result.msg.split(";");var fileNameList=new Array();for(var i=0;i<annoNameList.length-1;i++){var temp=annoNameList[i].split(",");fileNameList.push(temp[0])}if(fileNameList.in_array(annoSaveName)){AlertPanel("The name already exists!!","#cc3333");return}else{SaveAnnosToFile(appendMode)}},error:function(err){alert(err)}};$.ajax(options)}}else{var loadLength=$("input:radio[name='saveFile']:checked").length;if(loadLength==0){AlertPanel("you should select one groups to overwrite","#cc3333");return}else{annoSaveName=$('input:radio[name="saveFile"]:checked').val();SaveAnnosToFile(appendMode)}}}function SaveAnnosToFile(appendMode){var str={action:"SaveAnnotations",fid:_fid,fileName:annoSaveName,_appendMode:appendMode,jsonDoc:GetJsonDoc()};var options={type:"POST",url:getServerHandlerUrl(),async:true,data:str,success:function(response){var arr=eval("("+response+")");if(arr.state=="success"){AlertPanel("Annotations successfully saved","#66cc33");$(".rRightDown").css("visibility","hidden");$(".rLeftDown").css("visibility","hidden");$(".rLeftUp").css("visibility","hidden");$(".rRightUp").css("visibility","hidden");$(".rRight").css("visibility","hidden");$(".rLeft").css("visibility","hidden");$(".rUp").css("visibility","hidden");$(".rDown").css("visibility","hidden");$(".top").css("visibility","hidden");$(".bottom").css("visibility","hidden");enableLoadAnnoFiles();curSaveAnnoNum=num;$("#_saveAnnosPanel").hide();_saveAnnosPanelShow=false;isUnSaveAnnos=false;isLoadOrSave=true}else{AlertPanel(arr.msg,"#cc3333")}},error:function(err){}};$.ajax(options)}var hideArray=new Array("OutLine","Fill","Text");var showArray=new Array();function CreateProperPanel(){var D="<div id='_proTable' style='position:relative;top:30%;font-size:9px;color:#333333;height:49px;'></div>";$("#appearDiv").append(D);var E="<div id='OutLine' style='float:left;'><div id='OutLine_Icon' style='float:left;'></div><div id='OutLine_text' style='padding-right:2px;line-height:20px;float:left;'>Shape OutLine</div></div>";$("#_proTable").append(E);var C="<div id='Fill' style='float:left;'><div id='Fill_Icon' style='float:left;'></div><div id='Fill_text' style='padding-right:2px;line-height:20px;float:left;'>Shape Fill</div></div>";$("#_proTable").append(C);var A="<div id='Text' style='float:left;'><div id='Text_Icon' style='float:left;'></div><div id='Text_text' style='padding-right:2px;line-height:20px;float:left;'>Shape Text</div></div>";$("#_proTable").append(A);for(var B=0;B<hideArray.length;B++){$("#"+hideArray[B]).css("opacity","0.25");TargetHover("#"+hideArray[B],false)}CreateTableColor();CreateOutLinePanel();CreateFillPanel();CreateTextPanel()}var ColorHexArray=new Array("ffffff","000000","eeece1","1f497d","4f81bd","c0504d","9bbb59","8064a2","4bacc6","f79646","f2f2f2","7f7f7f","ddd9c3","c6d9f0","dbe5f1","f2dcdb","ebf1dd","e5e0ec","dbeef3","fdeada","d8d8d8","595959","c4bd97","8db3e2","b8cce4","e5b9b7","d7e3bc","ccc1d9","b7dde8","fbd5b5","bfbfbf","3f3f3f","938953","548dd4","95b3d7","d99694","c3d69b","b2a2c7","92cddc","fac08f","a5a5a5","262626","494429","17365d","366092","953734","76923c","5f497a","31859b","e36c09","7f7f7f","0c0c0c","1d1b10","0f243e","244061","632423","4f6128","3f3151","205867","974806","c00000","ff0000","ffc000","ffff00","92d050","00b050","00b0f0","0070c0","002060","7030a0");var ColorTitleArray=new Array("White","Black","Tan","Dark Blue","Blue","Red","Olive Green","Purple","Aqua","Orange","White,Darker-5%","Black,Lighter-50%","Tan,Darker-10%","Dark Blue,Lighter-80%","Blue,Lighter-80%","Red,Lighter-80%","Olive Green,Lighter-80%","Purple,Lighter-80%","Aqua,Lighter-80%","Orange,Lighter-80%","White,Darker-15%","Black,Lighter-35%","Tan,Darker-25%","Dark Blue,Lighter-60%","Blue,Lighter-60%","Red,Lighter-60%","Olive Green,Lighter-60%","Purple,Lighter-60%","Aqua,Lighter-60%","Orange,Lighter-60%","White,Darker-25%","Black,Lighter-25%","Tan,Darker-50%","Dark Blue,Lighter-40%","Blue,Lighter-40%","Red,Lighter-40%","Olive Green,Lighter-40%","Purple,Lighter-40%","Aqua,Lighter-40%","Orange,Lighter-40%","White,Darker-35%","Black,Lighter-15%","Tan,Darker-75%","Dark Blue,Darker-25%","Blue,Darker-25%","Red,Darker-25%","Olive Green,Darker-25%","Purple,Darker-25%","Aqua,Darker-25%","Orange,Darker-25%","White,Darker-50%","Black,Lighter-5%","Tan,Darker-90%","Dark Blue,Darker-50%","Blue,Darker-50%","Red,Darker-50%","Olive Green,Lighter-50%","Purple,Lighter-50%","Aqua,Darker-50%","Orange,Darker-50%","Dark Red","Red","Orange","Yellow","Light Green","Green","Light Blue","Blue","Dark Blue","Purple");function CreateTableColor(){var C="<div id='_tableColor' style='position:absolute;background:#ffffff;width:183px;height:170px;display:block;z-index:999;'></div>";$("body").append(C);var B="<table style='width:100%;font-size:12px;border:1px solid #c6c6c6'>";B+="<tr class='cellColor' id='_tableColorTitle'><td colspan='10' rowspan='2' rowstyle='text-align:center;'><div id='_titleColor' style='float:left;'></div><div style='float:left;'>&nbsp;&nbsp;&nbsp;&nbsp;Automatic</div></td></tr><tr></tr>";for(var A=0;A<60;A++){if(A%10==0){B+="</tr><tr>"}B+="<td><div id='"+ColorHexArray[A]+"' style='background:#"+ColorHexArray[A]+";' title='"+ColorTitleArray[A]+"' class='cellColor'></div></td>"}B+="</tr><tr><td colspan='10' rowspan='3' style='font-weight:bold;'  title='"+ColorTitleArray[A]+"'>Standard Colors</td></tr><tr><tr></tr>";for(var A=60;A<ColorHexArray.length;A++){B+="<td><div id='"+ColorHexArray[A]+"' style='background:#"+ColorHexArray[A]+";' title='"+ColorTitleArray[A]+"' class='cellColor'></div></td>"}B+="</tr></table>";$("#_tableColor").append(B);$(".cellColor").bind("click",function(){CellColorSelected(this)});$("#_tableColor").hide()}function CreateOutLinePanel(){var C="<div id='_outLineProPanel' style='border-radius:6px;font-size:12px;box-shadow:2px 2px 5px #666;position:absolute;background:#efefef;'></div>";$("body").append(C);$("#_outLineProPanel").css({width:"auto",height:"auto",display:"block",});var B="<table id='_outLineTable' style='padding:5px;color:#333333;width:100%;'>";B+="<tr><td id='_shapeOutLine' colspan='2' style='text-align:center;'>Shape OutLine</td></tr>";B+="<tr id='outLineWidth'><td>Weight:</td><td><select id='_outLineWidth' style='width:70px;'></select></td></tr>";B+="<tr id='outLineColor'><td>Color:</td><td><div class='REcolor' id='_outLineColor' Onclick='ShowTableColor(this);'></div></td></tr></table>";$("#_outLineProPanel").append(B);var A="<button id='closeOutLine' style='font-size:10px;margin-right:5px;float:right;' Onclick='closePro(this);'>Cancel</button><button id='OutLine' style='font-size:10px;margin-left:20px;margin-bottom:5px;margin-right:20px;float:right;' OnClick='ChangePro(this);'>OK</button>";$("#_outLineProPanel").append(A);IntiOutLineWidth("_outLineWidth");$("#_outLineWidth").bind("change",function(){var E=$("#_shapeOutLine").css("border-right-color");var D=parseInt($(this).get(0).selectedIndex);$("#_shapeOutLine").css("border",D+"px solid "+E)});$("#_outLineProPanel").hide()}function CreateFillPanel(){var B="<div id='_fillProPanel' style='border-radius:6px;box-shadow:2px 2px 5px #666;position:absolute;background:#efefef;'></div>";$("body").append(B);$("#_fillProPanel").css({width:"auto",height:"auto",display:"block",});var C="<table id='_fillTable' style='padding:5px;font-size:12px;color:#333333;width:100%;'>";C+="<tr><td id='_shapeFill' colspan='2' style='border:1px solid #000000;text-align:center;'>Shape Fill</td></tr>";C+="<tr id='fillColor'><td>Color:</td><td><div class='REcolor' id='_fillColor' Onclick='ShowTableColor(this);'></div></td></tr>";C+="<tr id='transparency'><td>Opacity:</td><td><select id='_transparency' style='width:70px;'></select></td></tr></table>";$("#_fillProPanel").append(C);var A="<button id='closeFill' style='font-size:10px;margin-right:5px;float:right;' Onclick='closePro(this);'>Cancel</button><button id='Fill' style='font-size:10px;margin-left:20px;margin-bottom:5px;margin-right:20px;float:right;' OnClick='ChangePro(this);'>OK</button>";$("#_fillProPanel").append(A);InitTransItem("_transparency");$("#_transparency").bind("change",function(){var D=parseInt($(this).get(0).selectedIndex)/10;$("#_shapeFill").css("opacity",D)});$("#_fillProPanel").hide()}function CreateTextPanel(){var B="<div id='_textProPanel' style='border-radius:6px;box-shadow:2px 2px 5px #666;position:absolute;background:#efefef;'></div>";$("body").append(B);$("#_textProPanel").css({width:"auto",height:"auto",display:"block",});var C="<table id='_textTable' style='padding:5px;font-size:12px;color:#333333;width:100%;'>";C+="<tr><td id='_shapeText' colspan='2' style='border:1px solid #000000;text-align:center;'>Shape Text</td></tr>";C+="<tr id='showText'><td>Text:</td><td><input style='width:120px;' id='_showedText'/></td></tr>";C+="<tr id='textColor'><td>Color:</td><td><div class='REcolor' id='_textColor' Onclick='ShowTableColor(this);'></div></td></tr>";C+="<tr id='textFont'><td>Font:</td><td><select id='_textFont' style='width:110px;'></select></td></tr>";C+="<tr id='textSize'><td>Size:</td><td><select style='width:70px;' id='_textSize'></select></td></tr>";C+="<tr id='textStyle'><td>Style:</td><td><div class='_textStyle' id='_textStyleB'></div><div class='_textStyle' id='_textStyleI'></div><div class='_textStyle' id='_textStyleU'></div><div class='_textStyle' id='_textStyleS'></div></td></tr></table>";$("#_textProPanel").append(C);var A="<button id='closeText' style='font-size:10px;margin-right:5px;float:right' Onclick='closePro(this);'>Cancel</button><button id='Text' style='font-size:10px;margin-left:60px;margin-bottom:5px;margin-right:20px;float:right;' OnClick='ChangePro(this);'>OK</button>";$("#_textProPanel").append(A);$("._textStyle").bind("click",function(){TextStyleSelected(this)});InitTextFont("_textFont");InitTextFontSize("_textSize");$("#_textFont").bind("change",function(){var D=textFontArray[parseInt($(this).get(0).selectedIndex)];$("#_shapeText").css("font-family",D)});$("#_textProPanel").hide()}var showTableColor=false;var tableColorParent="";function ShowTableColor(C){tableColorParent=C;if(showTableColor){$("#_tableColor").hide();showTableColor=false}else{var D=C.id;var B=$("#"+D).offset().left;var A=$("#"+D).offset().top+$("#"+D).outerHeight(true);$("#_tableColor").show();$("#_tableColor").css({left:B,top:A,});showTableColor=true}}function CellColorSelected(B){var A="000000";if(B.id!="_tableColorTitle"){A=B.id.toUpperCase()}$("#"+tableColorParent.id).html(A);$("#"+tableColorParent.id).css("background","#"+A);if(tableColorParent.id=="_outLineColor"){$("#_shapeOutLine").css("border-color","#"+A);$("#_shapeOutLine").css("color","#"+A)}else{if(tableColorParent.id=="_fillColor"){$("#_shapeFill").css("background","#"+A)}else{if(tableColorParent.id=="_textColor"){$("#_shapeText").css("color","#"+A)}}}$("#_tableColor").hide();showTableColor=false}var globalTextStyle=new Array();function TextStyleSelected(C){var D=C.id;var A=D.substring(D.length-1);var B="";switch(A){case"B":B="bold";break;case"I":B="italic";break;case"U":B="underline";break;case"S":B="line-through";break}if(globalTextStyle.in_array(B)){globalTextStyle.remove(B);$("#"+D).removeClass("textStyleSelect")}else{globalTextStyle.push(B);$("#"+D).addClass("textStyleSelect")}ShapeTextFontStyle("_shapeText")}function ShapeTextFontStyle(C){$("#"+C).css("font-weight","normal");$("#"+C).css("font-style","normal");$("#"+C).css("text-decoration","none");var B="";for(var A=0;A<globalTextStyle.length;A++){if(globalTextStyle[A]=="bold"){$("#"+C).css("font-weight","bold")}else{if(globalTextStyle[A]=="italic"){$("#"+C).css("font-style","italic")}else{if(B==""){B+=globalTextStyle[A]}else{B+=" "+globalTextStyle[A]}}}}if(B!=""){$("#"+C).css("text-decoration",B)}}function IntiOutLineWidth(B){for(var A=0;A<10;A++){$("#"+B).append($("<option></option>").html(A))}}function InitTransItem(B){$("#"+B).append($("<option></option>").html("0"));for(var A=1;A<10;A++){$("#"+B).append($("<option></option>").html("0."+A))}$("#"+B).append($("<option></option>").html("1"));$("#"+B).val("0.4").attr("selected",true)}var textFontArray=new Array();function InitTextFont(B){for(var A=0;A<textFontArray.length-1;A++){$("#"+B).append($("<option></option>").html(textFontArray[A]))}$("#"+B).val("Arial").attr("selected",true);textFontArray=null}var textFontSize=new Array("5","7","9","11","12","14","16","18","20","22","24","26","28","36","48","72");function InitTextFontSize(B){for(var A=0;A<textFontSize.length;A++){$("#"+B).append($("<option></option>").html(textFontSize[A]))}$("#"+B).val("18").attr("selected",true)}var curOutLineColor="";var curFillColor="";var curTextColor="";var _outLineProPanelShow=false;var _fillProPanelShow=false;var _textProPanelShow=false;var ProperMenu=function(B){var F;var E=false;if(currentAnnoStyleId!=""){F=currentAnnoStyleId.toLowerCase()}else{if(annoPro_flag!=""){var C=annoPro_flag.lastIndexOf(";");F=annoPro_flag.substring(C+1);E=true}else{return}}B=B||window.event;var G=this.id;if(G=="OutLine"){if(_outLineProPanelShow){if(showTableColor){$("#_tableColor").hide();showTableColor=false}$("#_outLineProPanel").hide();_outLineProPanelShow=false}else{HideAllPropanel();$("#_outLineProPanel").show();_outLineProPanelShow=true;var D=$("#"+G).offset().left;var A=$("#"+G).offset().top+$("#"+G).outerHeight(true);$("#_outLineProPanel").css({left:D,top:A,});SetOutLinePanel(F,E)}}else{if(G=="Fill"){if(_fillProPanelShow){if(showTableColor){$("#_tableColor").hide();showTableColor=false}$("#_fillProPanel").hide();_fillProPanelShow=false}else{HideAllPropanel();$("#_fillProPanel").show();_fillProPanelShow=true;var D=$("#"+G).offset().left;var A=$("#"+G).offset().top+$("#"+G).outerHeight(true);$("#_fillProPanel").css({left:D,top:A,});SetFillPanel(F,E)}}else{if(G=="Text"){if(_textProPanelShow){if(showTableColor){$("#_tableColor").hide();showTableColor=false}$("#_textProPanel").hide();_textProPanelShow=false}else{HideAllPropanel();$("#_textProPanel").show();_textProPanelShow=true;var D=$("#"+G).offset().left;var A=$("#"+G).offset().top+$("#"+G).outerHeight(true);$("#_textProPanel").css({left:D,top:A,});SetTextPanel(F,E)}}}}};function SetOutLinePanel(E,A){var B;var C;var D;$("#outLineColor").show();$("#outLineWidth").show();if(E=="re_func_rubberstamp"||E=="re_func_arrow"){if(A){D=getCurrentAnnotation();if(D!=null&&D.Index!=null){B=D.OutLineWidth;C=D.FillColor}}else{if(E=="re_func_rubberstamp"){B=RubberStampAnnoStyle.OutLineWidth;C=RubberStampAnnoStyle.FillColor}else{if(E=="re_func_arrow"){B=ArrowAnnoStyle.OutLineWidth;C=ArrowAnnoStyle.FillColor}}}$("#outLineColor").hide();$("#_outLineWidth").val(B);$("#_shapeOutLine").css("border",B+"px solid");$("#_shapeOutLine").css("border-color",C);curOutLineColor=C}else{if(E=="re_func_txtsignature"||E=="re_func_datesignature"){if(A){D=getCurrentAnnotation();if(D!=null&&D.Index!=null){C=D.TextColor}}else{if(E=="re_func_txtsignature"){C=txtSignature.TextColor}else{if(E=="re_func_datesignature"){C=dateSignature.TextColor}}}$("#outLineWidth").hide();if(C.indexOf("#")!=-1){$("#_outLineColor").html(C.substring(1))}else{$("#_outLineColor").html(C)}$("#_outLineColor").css("background",C);$("#_shapeOutLine").css({"color":C});curOutLineColor=C}else{if(A){D=getCurrentAnnotation();if(D!=null&&D.Index!=null){B=D.OutLineWidth;C=D.OutLineColor}}else{if(E=="re_func_text"){B=TextAnnoStyle.OutLineWidth;C=TextAnnoStyle.OutLineColor}else{if(E=="re_func_fhsignature"){B=fhSignature.OutLineWidth;C=fhSignature.OutLineColor}else{if(E=="re_func_freehand"){B=FreehandAnnoStyle.OutLineWidth;C=FreehandAnnoStyle.OutLineColor}else{if(E=="re_func_line"){B=LineAnnoStyle.OutLineWidth;C=LineAnnoStyle.OutLineColor}else{if(E=="re_func_polygonlines"){B=PolygonLinesAnnoStyle.OutLineWidth;C=PolygonLinesAnnoStyle.OutLineColor}else{if(E=="re_func_filledrectangle"){B=FilledRectangleAnnoStyle.OutLineWidth;C=FilledRectangleAnnoStyle.OutLineColor}else{if(E=="re_func_rectangle"){B=RectangleAnnoStyle.OutLineWidth;C=RectangleAnnoStyle.OutLineColor}else{if(E=="re_func_highlight"){B=HighlightAnnoStyle.OutLineWidth;C=HighlightAnnoStyle.OutLineColor}else{if(E=="re_func_ellipse"){B=EllipseAnnoStyle.OutLineWidth;C=EllipseAnnoStyle.OutLineColor}else{if(E=="re_func_polygon"){B=PolygonAnnoStyle.OutLineWidth;C=PolygonAnnoStyle.OutLineColor}else{if(E=="re_func_rubberstamp"){B=RubberStampAnnoStyle.OutLineWidth;C=RubberStampAnnoStyle.FillColor}}}}}}}}}}}}$("#_outLineWidth").val(B);if(C.indexOf("#")!=-1){$("#_outLineColor").html(C.substring(1))}else{$("#_outLineColor").html(C)}$("#_outLineColor").css("background",C);$("#_shapeOutLine").css("border",B+"px solid");$("#_shapeOutLine").css("border-color",C);$("#_shapeOutLine").css({"color":C});curOutLineColor=C}}}var fillColorItemShow=true;function SetFillPanel(D,A){var C;var B;$("#fillColor").show();if(D=="re_func_freehand"||D=="re_func_line"||D=="re_func_polygonlines"){if(A){annotation=getCurrentAnnotation();if(annotation!=null&&annotation.Index!=null){C=annotation.OutLineColor;B=annotation.Transparency}}else{if(D=="re_func_freehand"){C=FreehandAnnoStyle.OutLineColor;B=FreehandAnnoStyle.Transparency}else{if(D=="re_func_line"){C=LineAnnoStyle.OutLineColor;B=LineAnnoStyle.Transparency}else{if(D=="re_func_polygonlines"){C=PolygonLinesAnnoStyle.OutLineColor;B=PolygonLinesAnnoStyle.Transparency}}}}$("#_transparency").val(B);$("#fillColor").hide()}else{if(A){annotation=getCurrentAnnotation();if(annotation!=null&&annotation.Index!=null){C=annotation.FillColor;B=annotation.Transparency}}else{if(D=="re_func_text"){C=TextAnnoStyle.FillColor;B=TextAnnoStyle.Transparency}else{if(D=="re_func_arrow"){C=ArrowAnnoStyle.OutLineColor;B=ArrowAnnoStyle.Transparency}else{if(D=="re_func_filledrectangle"){C=FilledRectangleAnnoStyle.FillColor;B=FilledRectangleAnnoStyle.Transparency}else{if(D=="re_func_highlight"){C=HighlightAnnoStyle.FillColor;B=HighlightAnnoStyle.Transparency}else{if(D=="re_func_ellipse"){C=EllipseAnnoStyle.FillColor;B=EllipseAnnoStyle.Transparency}else{if(D=="re_func_polygon"){C=PolygonAnnoStyle.FillColor;B=PolygonAnnoStyle.Transparency}else{if(D=="re_func_rubberstamp"){C=RubberStampAnnoStyle.FillColor;B=RubberStampAnnoStyle.Transparency}}}}}}}}if(C.indexOf("#")!=-1){$("#_fillColor").html(C.substring(1))}else{$("#_fillColor").html(C)}$("#_fillColor").css("background",C);$("#_transparency").val(B)}$("#_shapeFill").css({background:C,opacity:B});curFillColor=C}var curShowedText="";function SetTextPanel(G,A){var D;var F;var B;var C;var E;$("#textColor").show();$("#showText").show();$("#textSize").show();if(G=="re_func_text"){if(A){annotation=getCurrentAnnotation();if(annotation!=null&&annotation.Index!=null){D=annotation.ShowedText;F=annotation.TextColor;B=annotation.TextFont;C=annotation.TextSize;E=annotation.TextStyle}}else{D=TextAnnoStyle.ShowedText;F=TextAnnoStyle.TextColor;B=TextAnnoStyle.TextFont;C=TextAnnoStyle.TextSize;E=TextAnnoStyle.TextStyle}$("#_textColor").css("background",F);if(F.indexOf("#")!=-1){$("#_textColor").html(F.substring(1))}else{$("#_textColor").html(F)}$("#showText").hide();curShowedText=D}else{if(G=="re_func_rubberstamp"){if(A){annotation=getCurrentAnnotation();if(annotation!=null&&annotation.Index!=null){D=annotation.ShowedText;F=annotation.FillColor;B=annotation.TextFont;C=annotation.TextSize;E=annotation.TextStyle}}else{D=RubberStampAnnoStyle.ShowedText;F=RubberStampAnnoStyle.FillColor;B=RubberStampAnnoStyle.TextFont;C=RubberStampAnnoStyle.TextSize;E=RubberStampAnnoStyle.TextStyle}$("#_showedText").val(D);$("#textColor").hide();$("#textSize").hide()}}$("#_textFont").val(B);$("#_textSize").val(C);setTextStyleIcon(E);ShapeTextFontStyle("_shapeText");$("#_shapeText").css({"color":F,"font-size":"18px","font-family":B});curTextColor=F}function setTextStyleIcon(C){var B=new Array("_textStyleB","_textStyleI","_textStyleU","_textStyleS");for(var A=0;A<B.length;A++){$("#"+B[A]).removeClass("textStyleSelect")}globalTextStyle=new Array();for(var A=0;A<C.length;A++){switch(C[A]){case"bold":$("#_textStyleB").addClass("textStyleSelect");globalTextStyle.push("bold");break;case"italic":$("#_textStyleI").addClass("textStyleSelect");globalTextStyle.push("italic");break;case"underline":$("#_textStyleU").addClass("textStyleSelect");globalTextStyle.push("underline");break;case"line-through":$("#_textStyleS").addClass("textStyleSelect");globalTextStyle.push("line-through");break}}ShapeTextFontStyle("_shapeText")}function SetPanelItems(B){for(var A=0;A<hideArray.length;A++){$("#"+hideArray[A]).css("opacity","1");TargetHover("#"+hideArray[A],true);var C=hideArray[A];$("#"+C).bind("click",ProperMenu)}if(B=="re_func_text"||B=="re_func_rubberstamp"){hideArray=new Array();showArray=new Array("OutLine","Fill","Text")}else{if(B=="re_func_fhsignature"||B=="re_func_txtsignature"||B=="re_func_datesignature"){hideArray=new Array("Text","Fill");showArray=new Array("OutLine")}else{hideArray=new Array("Text");showArray=new Array("OutLine","Fill")}}for(var A=0;A<hideArray.length;A++){$("#"+hideArray[A]).css("opacity","0.25");TargetHover("#"+hideArray[A],false);$("#"+hideArray[A]).unbind("click")}}var changeArray=new Array("outLineWidth","outLineColor","fillColor","transparency","showText","textColor","textFont","textSize","textStyle");function ChangePro(A){category=A.id;var C;if(currentAnnoStyleId!=""){C=currentAnnoStyleId.toLowerCase()}else{if(annoPro_flag!=""){var B=annoPro_flag.lastIndexOf(";");C=annoPro_flag.substring(B+1)}}if(curOutLineColor!=$("#_outLineColor").html()){curOutLineColor=$("#_outLineColor").html();if($("#_outLineColor").html().indexOf("#")==-1){curOutLineColor="#"+curOutLineColor}}if(curFillColor!=$("#_fillColor").html()){curFillColor=$("#_fillColor").html();if($("#_fillColor").html().indexOf("#")==-1){curFillColor="#"+curFillColor}}if(curTextColor!=$("#_textColor").html()){curTextColor=$("#_textColor").html();if($("#_textColor").html().indexOf("#")==-1){curTextColor="#"+curTextColor}}if(annoPro_flag==""){if(C=="re_func_text"){if(category=="OutLine"){TextAnnoStyle.OutLineWidth=parseFloat($("#_outLineWidth").val());TextAnnoStyle.OutLineColor=curOutLineColor}else{if(category=="Fill"){TextAnnoStyle.FillColor=curFillColor;TextAnnoStyle.Transparency=$("#_transparency").val()}else{if(category=="Text"){TextAnnoStyle.TextColor=curTextColor;TextAnnoStyle.TextFont=$("#_textFont").val();TextAnnoStyle.TextSize=$("#_textSize").val();TextAnnoStyle.TextStyle=globalTextStyle}}}}else{if(C=="re_func_freehand"){if(category=="OutLine"){FreehandAnnoStyle.OutLineWidth=parseFloat($("#_outLineWidth").val());FreehandAnnoStyle.OutLineColor=curOutLineColor}else{if(category=="Fill"){FreehandAnnoStyle.Transparency=$("#_transparency").val()}}}else{if(C=="re_func_arrow"){if(category=="OutLine"){ArrowAnnoStyle.OutLineWidth=parseFloat($("#_outLineWidth").val())}else{if(category=="Fill"){ArrowAnnoStyle.FillColor=curFillColor;ArrowAnnoStyle.OutLineColor=curFillColor;ArrowAnnoStyle.Transparency=$("#_transparency").val()}}}else{if(C=="re_func_line"){if(category=="OutLine"){LineAnnoStyle.OutLineWidth=parseFloat($("#_outLineWidth").val());LineAnnoStyle.OutLineColor=curOutLineColor}else{if(category=="Fill"){LineAnnoStyle.Transparency=$("#_transparency").val()}}}else{if(C=="re_func_polygonlines"){if(category=="OutLine"){PolygonLinesAnnoStyle.OutLineWidth=parseFloat($("#_outLineWidth").val());PolygonLinesAnnoStyle.OutLineColor=curOutLineColor}else{if(category=="Fill"){PolygonLinesAnnoStyle.Transparency=$("#_transparency").val()}}}else{if(C=="re_func_filledrectangle"){if(category=="OutLine"){FilledRectangleAnnoStyle.OutLineWidth=parseFloat($("#_outLineWidth").val());FilledRectangleAnnoStyle.OutLineColor=curOutLineColor}else{if(category=="Fill"){FilledRectangleAnnoStyle.FillColor=curFillColor;FilledRectangleAnnoStyle.Transparency=$("#_transparency").val()}}}else{if(C=="re_func_rectangle"){if(category=="OutLine"){RectangleAnnoStyle.OutLineWidth=parseFloat($("#_outLineWidth").val());RectangleAnnoStyle.OutLineColor=curOutLineColor}else{if(category=="Fill"){RectangleAnnoStyle.Transparency=$("#_transparency").val()}}}else{if(C=="re_func_highlight"){if(category=="OutLine"){HighlightAnnoStyle.OutLineWidth=parseFloat($("#_outLineWidth").val());HighlightAnnoStyle.OutLineColor=curOutLineColor}else{if(category=="Fill"){HighlightAnnoStyle.FillColor=curFillColor;HighlightAnnoStyle.Transparency=$("#_transparency").val()}}}else{if(C=="re_func_ellipse"){if(category=="OutLine"){EllipseAnnoStyle.OutLineWidth=parseFloat($("#_outLineWidth").val());EllipseAnnoStyle.OutLineColor=curOutLineColor}else{if(category=="Fill"){EllipseAnnoStyle.FillColor=curFillColor;EllipseAnnoStyle.Transparency=$("#_transparency").val()}}}else{if(C=="re_func_polygon"){if(category=="OutLine"){PolygonAnnoStyle.OutLineWidth=parseFloat($("#_outLineWidth").val());PolygonAnnoStyle.OutLineColor=curOutLineColor}else{if(category=="Fill"){PolygonAnnoStyle.FillColor=curFillColor;PolygonAnnoStyle.Transparency=$("#_transparency").val()}}}else{if(C=="re_func_rubberstamp"){if(category=="OutLine"){RubberStampAnnoStyle.OutLineWidth=parseFloat($("#_outLineWidth").val())}else{if(category=="Fill"){RubberStampAnnoStyle.FillColor=curFillColor;RubberStampAnnoStyle.TextColor=curFillColor;RubberStampAnnoStyle.OutLineColor=curFillColor;RubberStampAnnoStyle.Transparency=$("#_transparency").val()}else{if(category=="Text"){RubberStampAnnoStyle.ShowedText=$("#_showedText").val();RubberStampAnnoStyle.Text=RubberStampAnnoStyle.ShowedText;RubberStampAnnoStyle.TextColor=curTextColor;RubberStampAnnoStyle.TextFont=$("#_textFont").val();RubberStampAnnoStyle.TextSize=$("#_textSize").val();RubberStampAnnoStyle.TextStyle=globalTextStyle}}}}else{if(C=="re_func_fhsignature"){fhSignature.OutLineWidth=parseFloat($("#_outLineWidth").val());fhSignature.OutLineColor=curOutLineColor}else{if(C=="re_func_txtsignature"){txtSignature.TextColor=curOutLineColor}else{if(C=="re_func_datesignature"){dateSignature.TextColor=curOutLineColor}}}}}}}}}}}}}}}else{if(annoPro_flag!=""){ChangeAnnoStyle(category,C)}}if(category=="OutLine"){$("#_outLineProPanel").hide();_outLineProPanelShow=false}else{if(category=="Fill"){$("#_fillProPanel").hide();_fillProPanelShow=false}else{if(category=="Text"){$("#_textProPanel").hide();_textProPanelShow=false}}}}function getCurrentAnnotation(){var B=annoPro_flag.indexOf(";");var E=annoPro_flag.substring(0,B);var C=annoPro_flag.substring(B+1);var A=C.substring(0,C.indexOf(";"));var D=_fileDocument[curFileId].Viewers[E].Annotations[A];return D}function ChangeAnnoStyle(A,B){var G=annoPro_flag.indexOf(";");var E=annoPro_flag.substring(0,G);var H=annoPro_flag.substring(G+1);var F=H.substring(0,H.indexOf(";"));$("#div_"+F).remove();$("#thumbImg_"+F).remove();var J=_fileDocument[curFileId].Viewers[E].Annotations[F];if(J!=null&&J.Index!=null){if(B=="re_func_text"){if(A=="OutLine"){J.OutLineWidth=parseFloat($("#_outLineWidth").val());J.OutLineColor=curOutLineColor}else{if(A=="Fill"){J.FillColor=curFillColor;J.Transparency=$("#_transparency").val()}else{if(A=="Text"){J.TextColor=curTextColor;J.TextFont=$("#_textFont").val();J.TextSize=$("#_textSize").val();J.TextStyle=globalTextStyle}}}}else{if(B=="re_func_freehand"||B=="re_func_line"||B=="re_func_polygonlines"||B=="re_func_rectangle"){if(A=="OutLine"){J.OutLineWidth=parseFloat($("#_outLineWidth").val());J.OutLineColor=curOutLineColor}else{J.Transparency=$("#_transparency").val()}}else{if(B=="re_func_filledrectangle"||B=="re_func_highlight"||B=="re_func_ellipse"||B=="re_func_polygon"){if(A=="OutLine"){J.OutLineWidth=parseFloat($("#_outLineWidth").val());J.OutLineColor=curOutLineColor}else{if(A=="Fill"){J.FillColor=curFillColor;J.Transparency=$("#_transparency").val()}}}else{if(B=="re_func_rubberstamp"||B=="re_func_arrow"){if(A=="OutLine"){J.OutLineWidth=parseFloat($("#_outLineWidth").val())}else{if(A=="Fill"){J.FillColor=curFillColor;J.TextColor=curFillColor;J.OutLineColor=curFillColor;J.Transparency=$("#_transparency").val()}else{if(A=="Text"){J.ShowedText=$("#_showedText").val();J.Text=J.ShowedText;J.TextFont=$("#_textFont").val();J.TextStyle=globalTextStyle}}}}else{if(B=="re_func_fhsignature"){J.OutLineWidth=parseFloat($("#_outLineWidth").val());J.OutLineColor=curOutLineColor}else{if(B=="re_func_txtsignature"||B=="re_func_datesignature"){J.TextColor=curOutLineColor}}}}}}_fileDocument[curFileId].Viewers[E].Annotations[F].ReSetByZoom();drawLeft=J.ShowLeft;drawTop=J.ShowTop;drawWidth=J.ShowWidth;drawHeight=J.ShowHeight;var C=J.OutLineWidth/2*_zoomRatio*_zoomIndex;append_string="<div class='new_rect' id='div_"+F+"' style='left:"+(drawLeft-C)+"px;top:"+(drawTop-C)+"px;width:"+(drawWidth+2*C)+"px;height:"+(drawHeight+2*C)+"px'>";if(J.Type=="Line"||J.Type=="Arrow"){var D=J.ShowPoints.split(";");for(var K=0;K<D.length;K++){var I=D[K].split(",");if(typeof(I)!="undefined"){x_points[K]=parseFloat(I[0]);y_points[K]=parseFloat(I[1])}}append_string+=addLineOrArrowHandler(J.Type,x_points,y_points,F,C)}else{append_string+="<div class='rRightDown' id='rRightDown_"+F+"'></div><div class='rLeftDown' id='rLeftDown_"+F+"'></div><div class='rRightUp' id='rRightUp_"+F+"'></div><div class='rLeftUp' id='rLeftUp_"+F+"'></div><div class='rRight' id='rRight_"+F+"'></div><div class='rLeft' id='rLeft_"+F+"'></div><div class='rUp' id='rUp_"+F+"'></div><div class='rDown' id='rDown_"+F+"'></div>"}append_string+=drawAnnotationWithSVG(J,"annotation",E,false);append_string+="</div>";$("#draw_canvas").append(append_string);if(J.Type=="Text"){(function(M){var N=document.getElementById("annotation_"+J.Index+"");if(_isIpad){var L=new Hammer.Manager(N);L.add(new Hammer.Tap({event:"doubletap",taps:2}));L.on("doubletap",function(O){EditText(N)})}else{N.ondblclick=function(){EditText(N)}}})(J.Index)}BindImageViewerAnnotationClick(J.Index);BindResize(J.Index,F);$("#div_"+J.Index).draggable({containment:"parent",scroll:false,handle:"svg .annotation",stop:function(){AnnoIsChanged()}});if(!draggableNumArray.in_array(J.Index)){draggableNumArray.push(J.Index)}}addThumbViewerAnnotation(J,E);if(isLoadOrSave&&!isUnSaveAnnos){isUnSaveAnnos=true}}var _proPanelShow=false;function closePro(A){category=A.id;if(category=="closeOutLine"){$("#_outLineProPanel").hide();_outLineProPanelShow=false}else{if(category=="closeFill"){$("#_fillProPanel").hide();_fillProPanelShow=false}else{if(category=="closeText"){$("#_textProPanel").hide();_textProPanelShow=false}}}}var currentAnnoStyleId="";function ChangeIconStyle(B){$("#"+currentAnnoStyleId).removeClass("annoSelect");$("#"+B).addClass("annoSelect");if(B!="navi_single"&&B!="navi_multi"){if(selectTextIcon){$(".showByDrag").removeClass("mouseStyleSelect");$(".showByDrag").addClass("mouseStyleMove");$("#draw_canvas").unbind("mousedown",selectDown);$("#draw_canvas").unbind("mousemove",selectMove);$("#draw_canvas").unbind("mouseup",selectUp);$("#re_func_selectText").removeClass("iconBorder");selectTextIcon=false}noSelectAnno();currentAnnoStyleId=B;var C=currentAnnoStyleId.toLowerCase();HideAllPropanel();ShowCommentsPanel(C);for(var A=0;A<draggableNumArray.length;A++){$("#div_"+draggableNumArray[A]).draggable("disable")}}}function HideAllPropanel(){if(showTableColor){$("#_tableColor").hide();showTableColor=false}if(_outLineProPanelShow){$("#_outLineProPanel").hide();_outLineProPanelShow=false}if(_fillProPanelShow){$("#_fillProPanel").hide();_fillProPanelShow=false}if(_textProPanelShow){$("#_textProPanel").hide();_textProPanelShow=false}if(_saveAnnosPanelShow){$("#_saveAnnosPanel").hide();_saveAnnosPanelShow=false}if(_loadAnnosPanelShow){$("#_loadAnnosPanel").hide();_loadAnnosPanelShow=false}}var ToolbarItem=Class.create();ToolbarItem.prototype={initialize:function(A){this.SetOptions(A);this.CssClass=this.options.CssClass;this.CssId=this.options.CssId;this.Title=this.options.Title;this.Event=this.options.Event},SetOptions:function(A){this.options={CssClass:"",CssId:"",Title:"",Event:"",};Extend(this.options,A||{})},CreateHtml:function(){var A="<div ";A+="class='"+this.CssClass+"' ";A+="id='"+this.CssId+"' ";A+="title='"+this.Title+"' ";A+="onclick='"+this.Event+"' ";A+="></div>";return A},};var DocumentData=Class.create();DocumentData.prototype={initialize:function(A){this.SetOptions(A);this.Index=this.options.Index;this.Viewers=this.options.Viewers},SetOptions:function(A){this.options={Index:0,Viewers:new Array(),};Extend(this.options,A||{})},};var ViewerData=Class.create();ViewerData.prototype={initialize:function(A){this.SetOptions(A);this.PageIndex=this.options.PageIndex;this.ShowIndex=this.options.ShowIndex;this.IsNewPage=this.options.IsNewPage;this.ThumbWidth=this.options.ThumbWidth;this.ThumbHeight=this.options.ThumbHeight;this.OneToOne_Width=this.options.OneToOne_Width;this.OneToOne_Height=this.options.OneToOne_Height;this.Annotations=this.options.Annotations},SetOptions:function(A){this.options={PageIndex:0,ShowIndex:0,IsNewPage:false,ThumbWidth:0,ThumbHeight:0,OneToOne_Width:0,OneToOne_Height:0,Annotations:new Array(),};Extend(this.options,A||{})},};var AnnotationData=Class.create();AnnotationData.prototype={initialize:function(A){this.SetOptions(A);this.User=this.options.User;this.CreateTime=this.options.CreateTime;this.Modified=this.options.Modified;this.OnPageIndex=this.options.OnPageIndex;this.Type=this.options.Type;this.Left=this.options.Left;this.Top=this.options.Top;this.Width=this.options.Width;this.Height=this.options.Height;this.Points=this.options.Points;this.OutLineColor=this.options.OutLineColor;this.OutLineWidth=this.options.OutLineWidth;this.FillColor=this.options.FillColor;this.ShowedText=this.options.ShowedText;this.Text=this.options.Text;this.TextColor=this.options.TextColor;this.TextFont=this.options.TextFont;this.TextSize=this.options.TextSize;this.TextStyle=this.options.TextStyle;this.TextPadding=this.options.TextPadding;this.Transparency=this.options.Transparency;this.RedactRects=this.options.RedactRects},SetOptions:function(A){this.options={User:"",CreateTime:"",Modified:"",OnPageIndex:0,Type:"",Left:0,Top:0,Width:0,Height:0,Points:"",OutLineColor:"",OutLineWidth:0,FillColor:"",ShowedText:"",Text:"",TextColor:"",TextFont:"",TextSize:0,TextStyle:new Array(),TextPadding:0,Transparency:0.4,RedactRects:new PageTextRedacts(),};Extend(this.options,A||{})}};function CopyData(){var K=new Array();var L=new DocumentData({Index:curFileId});K[curFileId]=L;for(var F=0;F<_fileDocument[curFileId].Viewers.length;F++){var I=_fileDocument[curFileId].Viewers[F];if(I==null||I.ShowIndex==null){K[curFileId].Viewers[F]=null;continue}var G=new ViewerData();G.PageIndex=I.PageIndex;G.ShowIndex=I.PageIndex;G.IsNewPage=I.IsNewPage;G.ThumbWidth=I.ThumbWidth;G.ThumbHeight=I.ThumbHeight;G.OneToOne_Width=I.OneToOne_Width;G.OneToOne_Height=I.OneToOne_Height;for(var E=0;E<I.Annotations.length;E++){var M=I.Annotations[E];if(M==null){G.Annotations[E]=null;continue}var H=new AnnotationData();H.User=M.User;H.CreateTime=M.CreateTime;H.Modified=M.Modified;H.OnPageIndex=M.OnPageIndex;H.Type=M.Type;H.Left=M.Left;H.Top=M.Top;H.Width=M.Width;H.Height=M.Height;H.Points=M.Points;H.OutLineColor=M.OutLineColor;H.OutLineWidth=M.OutLineWidth;H.FillColor=M.FillColor;H.ShowedText=M.ShowedText;H.Text=M.Text;H.TextColor=M.TextColor;H.TextFont=M.TextFont;H.TextSize=M.TextSize;H.TextStyle=M.TextStyle;H.TextPadding=M.TextPadding;H.Transparency=M.Transparency;H.RedactRects=new PageTextRedacts();if(H.Type=="TextRedacts"){var N=M.RedactRects.relativePages;for(var J=0;J<N.length;J++){H.RedactRects.relativePages.push(N[J])}var B=M.RedactRects.curPageRectRedacts;for(var A=0;A<B.length;A++){var C=B[A];var D=new AnnotationData();D.OnPageIndex=C.OnPageIndex;D.Type=C.Type;D.Left=C.Left;D.Top=C.Top;D.Width=C.Width;D.Height=C.Height;D.FillColor=C.FillColor;D.Transparency=C.Transparency;H.RedactRects.curPageRectRedacts.push(D)}}G.Annotations[E]=H}K[curFileId].Viewers[F]=G}return K};